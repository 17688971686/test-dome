<#assign path=request.contextPath/>
<meta charset="UTF-8">
<div ng-include src="'${path}/contents/app/common/dialog-alert.tmpl.html'"></div>
<div ng-include src="'${path}/contents/app/common/dialog-confirm.tmpl.html'"></div>

<div class="well well-sm" style="background:white;">
    <ol class="breadcrumb">
        <li>其他</li>
        <li class="active" >个人代办设置</li>
    </ol>
    <form id="form" name="form" >
        <table class="table table-bordered  dataTable">
            <tr>
                <td colspan="6">
                    <h4><strong>个人信息</strong></h4>
                </td>
            </tr>
            <tr>
                <td class="text-right" width="11%">登录名：</td>
                <td width="22%">
                    {{vm.model.loginName}}
                </td>
                <td class="text-right" width="11%">工号：</td>
                <td width="22%">
                    {{vm.model.userNo}}
                </td>
                <td rowspan="3" class="text-right" width="11%" style="vertical-align: middle;">用户头像：</td>
                <td rowspan="3" width="22%"><img style="margin: 10px 0px;" src="" width="80" height="80" alt=""/></td>
            </tr>

            <tr>
                <td class="text-right">姓名：</td>
                <td>
                    {{vm.model.displayName}}
                </td>
                <td class="text-right">性别：</td>
                <td>
                    <select ng-model="vm.model.userSex" name="userSex" id="userSex" class="form-control select-sm " ng-disabled="true">
                        <option ng-repeat="x in DICT.SEX.dicts" value="{{x.dictName}}" ng-selected="x.dictName == vm.model.userSex">{{x.dictName}}</option>
                    </select>

                </td>
            </tr>

            <tr>
                <td class="text-right">所在部门：</td>
                <td>
                    <select ng-model="vm.model.orgId" ng-disabled="true" id="orgId" name="orgId" class="form-control select-sm" data-val="true" data-val-required="必填">
                        <option ng-repeat="x in vm.org" ng-selected="vm.model.orgDto.id == x.id"  value="{{x.id}}" >{{x.name}}</option>
                    </select>
                </td>
                <td class="text-right">在职情况：</td>
                <td>
                    <select ng-model="vm.model.jobState" ng-disabled="true" id="jobState" name="jobState"class="form-control select-sm " data-val="true" data-val-required="必填">
                        <option value="t" ng-selected="vm.model.jobState == 't'">在职</option>
                        <option value="f" ng-selected="vm.model.jobState == 'f'">离职</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td class="text-right">联系手机：</td>
                <td>
                    {{vm.model.userMPhone}}
                </td>
                <td class="text-right">联系电话：</td>
                <td>
                    {{vm.model.userPhone}}
                </td>
                <td class="text-right">电子邮件：</td>
                <td>
                   {{vm.model.email}}
                </td>
            </tr>

            <tr>
                <td class="text-right">职务：</td>
                <td>
                    <select ng-model="vm.model.position" ng-disabled="true" id="position" name="position" class="form-control input-sm ">
                        <option value="01" ng-selected="vm.model.position == '01'">中心主任</option>
                        <option value="02" ng-selected="vm.model.position == '02'">中心副主任</option>
                        <option value="03" ng-selected="vm.model.position == '03'">部长</option>
                        <option value="04" ng-selected="vm.model.position == '04'">工程师</option>
                    </select>
                </td>
                <td class="text-right">代办人：</td>
                <td colspan="3">
                    <div ng-if="vm.model.takeUserId">
                        <strong>{{vm.taskUserName}} </strong>
                    </div>
                    <div ng-if="!vm.model.takeUserId">
                        <span >无</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="6">
                   <h4><strong>代办设置</strong></h4>
                </td>
            </tr>
            <tr>
                <td class="text-right">
                    代办人列表：
                </td>
                <td colspan="5">
                    <select style="width: 150px;" ng-model="vm.takeUserId">
                        <option ng-repeat="x in vm.takeUserList |filter:{jobState:'t'}" value="{{x.id}}" ng-selected="x.id == vm.model.takeUserId">{{x.displayName}}</option>
                    </select>
                    <button class="btn btn-sm btn-success" ng-click="vm.saveTakeUser()" ng-disabled="vm.model.takeUserId" ><span class="glyphicon glyphicon-ok"></span>保存</button>
                    <button class="btn btn-sm btn-warning" ng-click="vm.cancelTakeUser()" ng-disabled="!vm.model.takeUserId" ><span class="glyphicon glyphicon-remove"></span>取消代办</button>
                    【设置用户代办之后，流转给你的任务将会自动转给代办人处理】
                </td>
            </tr>
            <tr ng-if="vm.ruProcessTaskList">
                <td colspan="6">
                    <h4><strong>待办项目列表</strong></h4>
                </td>
            </tr>
            <tr ng-if="vm.ruProcessTaskList">
                <td colspan="6">
                    <table class="table table-bordered">
                        <tr class="active">
                            <td>序号</td>
                            <td>项目名称</td>
                            <td>项目阶段</td>
                            <td>办理环节</td>
                            <td>签收日期</td>
                            <td>剩余工作日</td>
                            <td>操作</td>
                        </tr>
                        <tr ng-repeat="pt in vm.ruProcessTaskList">
                            <td>{{$index + 1}}</td>
                            <td>{{pt.projectName}}</td>
                            <td>{{pt.reviewStage}}</td>
                            <td>{{pt.nodeNameValue}}</td>
                            <td>{{pt.signDate}}</td>
                            <td>{{pt.surplusDays}}</td>
                            <td>
                                <Button class="btn btn-xs btn-success" ng-click="vm.transTask(pt.taskId)">流程转办</Button>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr ng-if="vm.ruTaskList">
                <td colspan="6">
                    <h4><strong>待办任务列表</strong></h4>
                </td>
            </tr>
            <tr ng-if="vm.ruTaskList">
                <td colspan="6">
                    <table class="table table-bordered">
                        <tr class="active">
                            <td>序号</td>
                            <td>任务名称</td>
                            <td>办理环节</td>
                            <td>当前处理人</td>
                            <td>流程类别</td>
                            <td>操作</td>
                        </tr>
                        <tr ng-repeat="rt in vm.ruTaskList">
                            <td>{{$index + 1}}</td>
                            <td>{{rt.instanceName}}</td>
                            <td>{{rt.nodeNameValue}}</td>
                            <td>{{rt.displayName}}</td>
                            <td>{{rt.processName}}</td>
                            <td>
                                <Button class="btn btn-xs btn-success" ng-click="vm.transTask(rt.taskId)">流程转办</Button>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

        </table>
    </form>
</div>