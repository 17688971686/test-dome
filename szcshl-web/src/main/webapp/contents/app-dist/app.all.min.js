!function(){"use strict";angular.module("app",["ui.router","kendo.directives"]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/index"),t.state("index",{url:"/index",templateUrl:rootPath+"/admin/gtasks.html",controller:"adminCtrl",controllerAs:"vm"}).state("etasks",{url:"/etasks",templateUrl:rootPath+"/admin/etasks.html",controller:"adminEndCtrl",controllerAs:"vm"}).state("role",{url:"/role",templateUrl:rootPath+"/role/html/list.html",controller:"roleCtrl",controllerAs:"vm"}).state("roleEdit",{url:"/roleEdit/:id",templateUrl:rootPath+"/role/html/edit.html",controller:"roleEditCtrl",controllerAs:"vm"}).state("user",{url:"/user",templateUrl:rootPath+"/user/html/list.html",controller:"userCtrl",controllerAs:"vm"}).state("userEdit",{url:"/userEdit/:id",templateUrl:rootPath+"/user/html/edit.html",controller:"userEditCtrl",controllerAs:"vm"}).state("org",{url:"/org",templateUrl:rootPath+"/org/html/list.html",controller:"orgCtrl",controllerAs:"vm"}).state("orgEdit",{url:"/orgEdit/:id",templateUrl:rootPath+"/org/html/edit.html",controller:"orgEditCtrl",controllerAs:"vm"}).state("orgUser",{url:"/orgUser/:id",templateUrl:rootPath+"/org/html/orgUser.html",controller:"orgUserCtrl",controllerAs:"vm"}).state("log",{url:"/log",templateUrl:rootPath+"/log/html/list.html",controller:"logCtrl",controllerAs:"vm"}).state("upload",{url:"/upload/:uploadid",templateUrl:rootPath+"/upload/html/edit.html",controller:"uploadEditCtrl",controllerAs:"vm"}).state("meeting",{url:"/meeting",templateUrl:rootPath+"/meeting/html/list.html",controller:"meetingCtrl",controllerAs:"vm"}).state("meetingEdit",{url:"/meetingEdit/:id",templateUrl:rootPath+"/meeting/html/edit.html",controller:"meetingEditCtrl",controllerAs:"vm"}).state("room",{url:"/room/:workProgramId",templateUrl:rootPath+"/room/html/roomlist.html",controller:"roomCtrl",controllerAs:"vm"}).state("roomCount",{url:"/roomCount/:id",templateUrl:rootPath+"/room/html/countlist.html",controller:"roomCountCtrl",controllerAs:"vm"}).state("company",{url:"/company",templateUrl:rootPath+"/company/html/list.html",controller:"companyCtrl",controllerAs:"vm"}).state("companyEdit",{url:"/companyEdit/:id",templateUrl:rootPath+"/company/html/edit.html",controller:"companyEditCtrl",controllerAs:"vm"}).state("accountPwd",{url:"/accountPwd",templateUrl:rootPath+"/account/html/changePwd.html",controller:"homeCtrl",controllerAs:"vm"}).state("demo",{url:"/demo",templateUrl:rootPath+"/demo/html/list.html",controller:"demoCtrl",controllerAs:"vm"}).state("myTest",{url:"/myTest",templateUrl:rootPath+"/myTest/html/list.html",controller:"myTestCtrl",controllerAs:"vm"}).state("myTestEdit",{url:"/myTestEdit/:id",templateUrl:rootPath+"/myTest/html/edit.html",controller:"myTestEditCtrl",controllerAs:"vm"}).state("dict",{url:"/dict",templateUrl:rootPath+"/dict/html/list.html",controller:"dictCtrl",controllerAs:"vm"}).state("dict.edit",{url:"/edit/:id",templateUrl:rootPath+"/dict/html/edit.html",controller:"dictEditCtrl",controllerAs:"vm"}).state("expert",{url:"/expert",templateUrl:rootPath+"/expert/html/queryAllList.html",controller:"expertCtrl",controllerAs:"vm"}).state("expertAudit",{url:"/expertAudit",templateUrl:rootPath+"/expert/html/audit.html",controller:"expertAuditCtrl",controllerAs:"vm"}).state("expertRepeat",{url:"/expertRepeat",templateUrl:rootPath+"/expert/html/repeat.html",controller:"expertRepeatCtrl",controllerAs:"vm"}).state("expertEdit",{url:"/expertEdit/:expertID",templateUrl:rootPath+"/expert/html/edit.html",controller:"expertEditCtrl",controllerAs:"vm"}).state("expertReviewEdit",{url:"/expertReview/:workProgramId",templateUrl:rootPath+"/expertReview/html/selectExpert.html",controller:"expertSelectCtrl",controllerAs:"vm"}).state("addSign",{url:"/addSign",templateUrl:rootPath+"/sign/html/add.html",controller:"signCreateCtrl",controllerAs:"vm"}).state("fillSign",{url:"/fillSign/:signid",templateUrl:rootPath+"/sign/html/fillin.html",controller:"signFillinCtrl",controllerAs:"vm"}).state("listSign",{url:"/listSign",templateUrl:rootPath+"/sign/html/list.html",controller:"signCtrl",controllerAs:"vm"}).state("flowSign",{url:"/flowSign",templateUrl:rootPath+"/sign/html/flow.html",controller:"signFlowCtrl",controllerAs:"vm"}).state("signFlowDeal",{url:"/signFlowDeal/:signid/:taskId/:processInstanceId",templateUrl:rootPath+"/sign/html/flowDeal.html",controller:"signFlowDealCtrl",controllerAs:"vm"}).state("signDetails",{url:"/signDetails/:signid",templateUrl:rootPath+"/sign/html/signDetails.html",controller:"signDetailsCtrl",controllerAs:"vm"}).state("endSignDetail",{url:"/endSignDetail/:signid/:processInstanceId",templateUrl:rootPath+"/sign/html/signEndDetails.html",controller:"signEndCtrl",controllerAs:"vm"}).state("workprogramEdit",{url:"/workprogramEdit/:signid",templateUrl:rootPath+"/workprogram/html/edit.html",controller:"workprogramEditCtrl",controllerAs:"vm"}).state("dispatchEdit",{url:"/dispatchEdit/:signid",templateUrl:rootPath+"/dispatch/html/edit.html",controller:"dispatchEditCtrl",controllerAs:"vm"}).state("fileRecordEdit",{url:"/fileRecordEdit/:signid",templateUrl:rootPath+"/fileRecord/html/edit.html",controller:"fileRecordEditCtrl",controllerAs:"vm"}).state("officeUserList",{url:"/officeUserList",templateUrl:rootPath+"/officeUser/html/list.html",controller:"officeUserCtrl",controllerAs:"vm"}).state("officeUserEdit",{url:"/officeUserEdit/:officeID",templateUrl:rootPath+"/officeUser/html/edit.html",controller:"officeUserEditCtrl",controllerAs:"vm"}).state("listDept",{url:"/listDept",templateUrl:rootPath+"/dept/html/list.html",controller:"deptCtrl",controllerAs:"vm"}).state("deptEdit",{url:"/deptEdit/:deptId",templateUrl:rootPath+"/dept/html/edit.html",controller:"deptEditCtrl",controllerAs:"vm"}).state("deptOfficeUser",{url:"/deptOfficeUser/:deptId",templateUrl:rootPath+"/dept/html/listOfficeUser.html",controller:"deptOfficeUserCtrl",controllerAs:"vm"})}]).run(function(t,e,o,i){t.$state=o,t.$stateParams=i,t.$on("$stateChangeSuccess",function(e,o,i,n,r){t.previousState_name=n.name,t.previousState_params=r}),t.back=function(){t.previousState_name?o.go(t.previousState_name,t.previousState_params):window.history.back()},kendo.culture("zh-CN"),t.topSelectChange=function(t,e,o){for(var i=0;i<e.length;i++)if(o&&"code"==o){if(e[i].dictCode==t)return e[i].dicts}else if(e[i].dictName==t)return e[i].dicts},common.getTaskCount({$http:e}),common.initDictData({$http:e,scope:t})})}(),function(){"use strict";function t(t,e){var o=this;o.title="待办事项",function(){e.gtasksGrid(o)}()}angular.module("app").controller("adminCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e){var o=this;o.title="办结事项",function(){e.etasksGrid(o)}()}angular.module("app").controller("adminEndCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e){function o(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/tasks"),schema:{data:"value",total:function(t){return t.count?$("#GtasksCount").html(t.count):$("#GtasksCount").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:30},{field:"businessName",title:"任务名称",filterable:!1,width:180},{field:"flowName",title:"所属流程",width:180,filterable:!1},{field:"taskName",title:"当前环节",width:180,filterable:!1},{field:"createDate",title:"接收时间",width:150,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.isSuspended?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:180,template:function(t){return"FINAL_SIGN_FLOW"==t.flowKey?common.format($("#columnBtns").html(),"signFlowDeal",t.businessKey,t.taskId,t.processInstanceId):'<a class="btn btn-xs btn-danger" >流程已停用</a>'}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})}}}function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/endTasks"),schema:{data:"value",total:function(t){return t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:30},{field:"businessName",title:"任务名称",filterable:!1,width:180},{field:"createDate",title:"开始时间",width:150,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endDate",title:"结束时间",width:150,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"用时",width:180,filterable:!1,template:function(t){return t.durationTime?t.durationTime:'<span style="color:orangered;">已办结</span>'}},{field:"",title:"流程状态",width:120,filterable:!1,template:function(t){return'<span style="color:orangered;">已办结</span>'}},{field:"",title:"操作",width:80,template:function(t){if(t.processDefinitionId.indexOf("FINAL_SIGN_FLOW")>=0)return common.format($("#columnBtns").html(),"endSignDetail",t.businessKey,t.processInstanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})}}}return{gtasksGrid:o,etasksGrid:i}}angular.module("app").factory("adminSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t){t?(t.removeData("validator"),t.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(t)):($("form").removeData("validator"),$("form").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse("form"))}function e(t){var e="发生错误,系统已记录,我们会尽快处理！";void 0!=t.response&&(401==t.response.status&&(location.href=D.loginUrl),e=t.response.data.message||e),D.alert({vm:t.vm,msg:e,fn:function(){t.vm.isSubmit=!1,t.vm.disabledButton=!1,$(".alertDialog").modal("hide")}})}function o(t){var e=function(e){D.alert({vm:t.vm,msg:e,fn:function(){t.vm.isSubmit=!1,$(".alertDialog").modal("hide")}})};if(t.response.status>400)e("发生错误！");else{var o=t.response.data;o&&555==o.status?e(o.message):t.fn&&t.fn(o)}}function i(){for(var t=arguments[0],e=1;e<arguments.length;e++){var o=new RegExp("\\{"+(e-1)+"\\}","gm");t=t.replace(o,arguments[e])}return t}function n(t){var e=t.toString().replace(/[^0-9]/g,"");return parseInt(e,10)}function r(t){return isNaN(parseFloat(t,10))?0:parseFloat(t,10)}function a(){return $(window).height()-180}function c(t){t.vm.alertDialogMessage=t.msg,t.vm.alertDialogFn=function(){t.fn?(t.closeDialog&&1==t.closeDialog&&($(".alertDialog").modal("hide"),$(".modal-backdrop").remove()),t.fn()):$(".alertDialog").modal("hide")},$(".alertDialog").modal({backdrop:"static",keyboard:!1})}function l(t){t.vm.dialogConfirmTitle=t.title,t.vm.dialogConfirmMessage=t.msg,$(".confirmDialog").modal({backdrop:"static"}),t.vm.dialogConfirmSubmit=t.fn}function s(t,e){null==e&&(e=""),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+t+"=([^&#]*)"),i=o.exec(window.location.href);return null==i?e:i[1]}function d(t,e){return new kendo.data.DataSource({type:"odata",transport:m().transport(t,e),schema:m().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}})}function m(){return{filterable:{extra:!1,operators:{string:{contains:"包含",eq:"等于"},number:{eq:"等于",neq:"不等于",gt:"大于",lt:"小于"},date:{gt:"大于",lt:"小于"}}},pageable:{pageSize:10,previousNext:!0,buttonCount:5,refresh:!0,pageSizes:!0},schema:function(t){return{data:"value",total:function(t){return t.count},model:t}},transport:function(t,e,o){return{read:{url:t,dataType:"json",type:"post",beforeSend:function(t){t.setRequestHeader("Token",D.getToken())},data:function(){if(e){var t=common.buildOdataFilter(e);return t?o&&o.filter?{$filter:t+" and "+o.filter}:{$filter:t}:o&&o.filter?{$filter:o.filter}:{}}return{}}}}},noRecordMessage:{template:"暂时没有数据."}}}function u(t){var e=$(t).find("tr td:nth-child(1)").find("input:checked"),o=[];return e.each(function(){var t=$(this).attr("relId");o.push({name:"id",value:t})}),o}function f(t){t.headers={Token:D.getToken()},t.$http(t.httpOptions).then(t.success,function(e){t.onError&&t.onError(e),common.requestError({vm:t.vm,response:e})})}function p(){return{get:function(t,e){var o=this.getAll(t);return o?o[e]:null},getAll:function(t){var e=encodeURIComponent(t)+"=",o=document.cookie.indexOf(e),i=null,n={};if(o>-1){var r=document.cookie.indexOf(";",o);if(-1==r&&(r=document.cookie.length),i=document.cookie.substring(o+e.length,r),i.length>0){for(var a=i.split("&"),c=0,l=a.length;c<l;c++){var s=a[c].split("=");n[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return n}}return null},set:function(t,e,o,i,n,r,a){var c=this.getAll(t)||{};c[e]=o,this.setAll(t,c,i,n,r,a)},setAll:function(t,e,o,i,n,r){var a=encodeURIComponent(t)+"=",c=new Array;for(var l in e)l.length>0&&e.hasOwnProperty(l)&&c.push(encodeURIComponent(l)+"="+encodeURIComponent(e[l]));c.length>0?(a+=c.join("&"),o instanceof Date&&(a+=";expires="+o.toGMTString()),i&&(a+=";path="+i),n&&(a+=";domain="+n),r&&(a+=";secure")):a+=";expires="+new Date(0).toGMTString(),document.cookie=a},unset:function(t,e,o,i,n){var r=this.getAll(t);r&&(delete r[e],this.setAll(t,r,null,o,i,n))},unsetAll:function(t,e,o,i){this.setAll(t,null,new Date(0),e,o,i)}}}function h(){var t=p().getAll("data");return null!=t?t.token:""}function g(t){return t.error=function(t){401==t.status&&(location.href=D.loginUrl)},t}function v(t){var e=new Array,o=0;$(t).find("input,radio,select,textarea").each(function(t,i){if(i.name&&i.value){var n={};$(this).attr("operator")?n.operator=$(this).attr("operator"):n.operator="eq",n.name=$.trim(i.name),n.value=$.trim(i.value),e[o]=n,o++}});var i=0,n="";return $.each(e,function(){this.value&&(i>0&&(n+=" and "),n+=this.name+" "+this.operator+" '"+this.value+"'",i++)}),n}function w(t){t.$http({method:"get",url:rootPath+"/dict/dictItems"}).then(function(e){t.scope.dictMetaData=e.data;var o={};k(o,e.data),t.scope.DICT=o},function(t){alert("初始化数据字典失败")})}function k(t,e,o){if(e&&0!=e.length)if(o)for(var i=0;i<e.length;i++){var n=e[i];if(n.parentId&&n.parentId==o){t.dicts||(t.dicts=new Array);var r={};r.dictId=n.dictId,r.dictName=n.dictName,r.dictCode=n.dictCode,r.dictKey=n.dictKey,r.dictSort=n.dictSort,t.dicts.push(r),k(r,e,n.dictId)}}else for(var i=0;i<e.length;i++){var n=e[i];n.parentId||(t[n.dictCode]={},t[n.dictCode].dictId=n.dictId,t[n.dictCode].dictCode=n.dictCode,t[n.dictCode].dictName=n.dictName,t[n.dictCode].dictKey=n.dictKey,t[n.dictCode].dictSort=n.dictSort,k(t[n.dictCode],e,n.dictId))}}function b(t){return{async:{saveUrl:rootPath+"/file",removeUrl:rootPath+"/file/delete",autoUpload:!1},select:function(e){t.onSelect?t.onSelect(e):$.each(e.files,function(t,e){console.log("Name: "+e.name+"Size: "+e.size+" bytesExtension: "+e.extension)})},upload:function(e){if(t.onUpload)t.onUpload(e);else{e.files;console.log(e.response)}},success:function(e){if(t.onSuccess)t.onSuccess(e);else{var o=e.files;"upload"==e.operation&&(o[0].sysFileId=e.response.sysFileId)}},remove:function(e){if(t.onRemove)t.onRemove(e);else{var o=e.files;e.data={sysFileId:o[0].sysFileId}}}}}function S(t){t.$http({method:"get",url:rootPath+"/flow/html/tasksCount"}).then(function(t){$("#GtasksCount").html(t.data)})}var D={initJqValidation:t,requestError:e,requestSuccess:o,format:i,blockNonNumber:n,floatNumberInput:r,adminContentHeight:a,alert:c,confirm:l,getQuerystring:s,kendoGridConfig:m,getKendoCheckId:u,cookie:p,getToken:h,appPath:"",http:f,gridDataSource:g,loginUrl:window.rootPath+"/home/login",buildOdataFilter:v,initDictData:w,kendoGridDataSource:d,initUploadOption:b,getTaskCount:S};window.common=D,function(){$(document).on("click","#checkboxAll",function(){var t=$(this).is(":checked");$(".grid").find("tr td:nth-child(1)").find("input:checkbox").prop("checked",t)}),$("body").on("click",".grid tr",function(t){$(this).parent().find("tr").removeClass("selected"),$(this).addClass("selected")})}()}(),function(){"use strict";function t(t,e){var o=this;o.title="单位列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletecompany(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryConpany=function(){e.queryConpany(o)},function(){e.grid(o)}()}angular.module("app").controller("companyCtrl",t),t.$inject=["$location","companySvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="新增单位",i.iscompanyExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新单位"),i.create=function(){e.createcompany(i)},i.update=function(){e.updatecompany(i)},function(){i.isUpdate&&e.getcompanyById(i)}()}angular.module("app").controller("companyEditCtrl",t),t.$inject=["$location","companySvc","$state"]}(),function(){"use strict";function t(t,e){function o(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#form")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"coName",title:"单位名称",width:260,filterable:!1},{field:"coPhone",title:"单位电话",width:160,filterable:!1},{field:"coPC",title:"邮编",width:160,filterable:!1},{field:"coAddress",title:"地址",width:160,filterable:!1},{field:"coSite",title:"网站",width:160,filterable:!1},{field:"coSynopsis",title:"单位简介",width:160,filterable:!1},{field:"coType",title:"单位类型",width:160,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}function i(t){t.gridOptions.dataSource.read()}function n(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0;var o={method:"post",url:l,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=s}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function r(e){var o={method:"get",url:l+"/html/findByIdCompany",params:{id:e.id}},i=function(t){e.model=t.data,console.log(e.model)};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0,e.model.id=e.id;var o={method:"put",url:l,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function c(e,o){e.isSubmit=!0;var i={method:"delete",url:l,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}var l=rootPath+"/company",s="#/company";rootPath;return{grid:o,createcompany:n,getcompanyById:r,updatecompany:a,deletecompany:c,queryConpany:i}}angular.module("app").factory("companySvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){function o(){$("#datepicker").kendoDatePicker({culture:"zh-CN"})}function i(){$("#files").kendoUpload({async:{saveUrl:"/demo/save",removeUrl:"/demo/remove",autoUpload:!0}})}var n=this;n.title="",n.showDialog=function(){$(".myDialog").modal({backdrop:"static",keyboard:!1})},function(){o(),i()}()}angular.module("app").controller("demoCtrl",t),t.$inject=["$location","demoSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"put",url:o,data:e.model.password},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}}var o="/account/password";return{upload:e}}angular.module("app").factory("demoSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="处室管理",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteDept(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryDept=function(){e.queryDept(o)},function(){e.grid(o)}()}angular.module("app").controller("deptCtrl",t),t.$inject=["$location","deptSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="编辑处室",i.isuserExist=!1,i.deptId=o.params.deptId,i.deptId&&(i.isUpdate=!0,i.title="更新处室"),i.create=function(){e.createDept(i)},i.update=function(){e.updateDept(i)},function(){i.isUpdate&&e.getDeptById(i)}()}angular.module("app").controller("deptEditCtrl",t),t.$inject=["$location","deptSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"put",url:c,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function i(e,o){e.isSubmit=!0;var i={method:"delete",url:c,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function n(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"post",url:c,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function r(e){var o={method:"get",url:rootPath+"/dept/html/findById",params:{deptId:e.deptId}},i=function(t){t.data.offices&&(e.offices={},e.offiecs=t.data.offices),e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"/fingByOData",$("#formDept")),schema:common.kendoGridConfig().schema({id:"deptId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.deptId)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"deptName",title:"处室名称",width:100,filterable:!1},{field:"deptUserName",title:"联系人",width:100,filterable:!1},{field:"address",title:"地址",width:100,filterable:!1},{field:"deptType",title:"类型",width:100,filterable:!1},{field:"",title:"状态",width:100,filterable:!1,template:function(t){return t.status?5==t.status?"正常":7==t.status?"已删除":void 0:" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.deptId+"')",t.deptId,t.deptId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}var c=rootPath+"/dept",l="#/listDept";return{grid:a,getDeptById:r,createDept:n,deleteDept:i,updateDept:o,queryDept:e}}angular.module("app").factory("deptSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.title="办事处人员列表",n.id=e.params.deptId,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.deptOfficeGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.addOfficeUser=function(t){i.addOfficeUser(n,t)},n.remove=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),i.deletedeptOfficeUser(n,t)}})},n.removes=function(){var t=common.getKendoCheckId(".deptOfficeGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var i=e.join(",");n.remove(i)}},function(){i.grid(n),i.deptOfficeGrid(n)}()}angular.module("app").controller("deptOfficeUserCtrl",t),t.$inject=["$location","$state","deptSvc","deptOfficeUserSvc"]}(),function(){"use strict";function t(t){function e(e,o){var i={method:"post",url:rootPath+"/dept/addOfficeUser",params:{deptId:e.id,officeId:o}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.deptOfficeGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function o(e){var o={method:"get",url:common.format(s+"/getDepts")},i=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var o={method:"put",url:s,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function n(e,o){e.isSubmit=!0;var i={method:"delete",url:rootPath+"/dept/deleteOfficeUsers",params:{deptId:e.id,officeId:o}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function r(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"post",url:s,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function a(e){var o={method:"get",url:rootPath+"/dept/html/findById",params:{officeID:e.officeID}},i=function(t){t.data.dept&&(e.depts={}),e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#allUserGridBtns").html(),"vm.addOfficeUser('"+t.officeID+"')",t.officeID)}}];t.deptOfficeGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}var s=rootPath+"/dept",d="#/deptList",m=rootPath+"/dept/getDeptOfficeUsers",u=rootPath+"/dept/NotInoDeptfficeUsers";return{grid:l,getdeptById:a,createdept:r,deletedeptOfficeUser:n,updatedept:i,getDepts:o,deptOfficeGrid:c,addOfficeUser:e}}angular.module("app").factory("deptOfficeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="字典",i.model={},i.del=function(t){common.confirm({vm:i,title:"",msg:"删除字典将会连下级字典一起删除，确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteDict(i,t)}})},i.dels=function(){var t=i.dictsTree.getSelectedNodes();t&&t.length>0?i.del(t[0].id):common.alert({vm:i,msg:"请选择数据"})},function(){e.initDictTree(i)}()}angular.module("app").controller("dictCtrl",t),t.$inject=["$location","dictSvc","$scope"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.title="增加字典",n.model={},n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="编辑字典"),n.model.dictSort=0,n.createDict=function(){o.createDict(n)},n.updateDict=function(){o.updateDict(n)},n.dictTypeChange=function(){n.model.dictType&&(n.model.dictKey="")},n.apply=function(){t.$apply()},function(){n.isUpdate?o.getDictById(n):(n.model.dictCode="",o.initpZtreeClient(n))}()}angular.module("app").controller("dictEditCtrl",t),t.$inject=["$scope","$location","dictSvc","$state"]}(),function(){"use strict";function t(t,e,o){function i(e){var o={method:"get",url:common.format(f+"?dictCode={0}","DICT_SEX")},i=function(t){};common.http({vm:e,$http:t,httpOptions:o,success:i})}function n(e){var o={method:"get",url:u},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){if(e.treeData={},e.treeData=t.data.value,e.isUpdate&&e.treeData&&e.model.parentId)for(var o=0;o<e.treeData.length;o++)if(e.treeData[o].dictId==e.model.parentId){
e.model.parentDictName=e.treeData[o].dictName;break}}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(o,i){o.isSubmit=!0;var n={method:"delete",url:u,data:i},r=function(t){common.requestSuccess({vm:o,response:t,fn:function(){o.isSubmit=!1,location.href=m,common.alert({vm:o,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("dict",{},{reload:!0})}})}})};common.http({vm:o,$http:t,httpOptions:n,success:r})}function a(o){common.initJqValidation();var i=$("form").valid(),n=o.zpTree.getCheckedNodes(!0);if(n&&n.length>0&&(o.model.parentId=n[0].id),i){o.isSubmit=!0;var r={method:"post",url:u,data:o.model},a=function(t){common.requestSuccess({vm:o,response:t,fn:function(){common.alert({vm:o,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("dict",{},{reload:!0})}})}})};common.http({vm:o,$http:t,httpOptions:r,success:a})}}function c(o){if(common.initJqValidation(),$("form").valid()){o.isSubmit=!0;var i={method:"put",url:u,data:o.model},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){common.alert({vm:o,msg:"操作成功",fn:function(){o.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("dict.edit",{id:o.model.dictId},{reload:!0})}})}})};common.http({vm:o,$http:t,httpOptions:i,success:n})}}function l(o){var i={method:"get",url:u+"?$orderby=dictSort"},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){function i(t,o,i){e.go("dict.edit",{id:i.id})}var n,r={callback:{onClick:i},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},a=$linq(t.data.value).select(function(t){var e=null;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();n=$.fn.zTree.init($("#zTree"),r,a),o.dictsTree=n}})};common.http({vm:o,$http:t,httpOptions:i,success:n})}function s(e){var o={method:"get",url:u+"?$orderby=dictSort"},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var o={check:{enable:!0,chkStyle:"radio",radioType:"all"},callback:{},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},i=$linq(t.data.value).select(function(t){var e;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();e.zpTree=$.fn.zTree.init($("#pzTree"),o,i)}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function d(e){var o={method:"get",url:common.format(u+"?$filter=dictId eq '{0}'",e.id)},i=function(t){e.model=t.data.value[0],n(e)};common.http({vm:e,$http:t,httpOptions:o,success:i})}var m="#/dict",u=rootPath+"/dict",f=rootPath+"/dict/dictNameData";return{initDictTree:l,createDict:a,getDictById:d,updateDict:c,deleteDict:r,initpZtreeClient:s,getTreeData:n,getdictItems:i}}angular.module("app").factory("dictSvc",t),t.$inject=["$http","$state","$location"]}(),function(){"dispatch strict";function t(t,e,o){var i=this;i.title="项目发文编辑",i.isHide=!0,i.isHide2=!0,i.isSubmit=!1,i.saveProcess=!1,i.sign={},i.dispatchDoc={},i.dispatchDoc.signId=o.params.signid,i.linkSignId=" ",i.create=function(){e.saveDispatch(i)},i.count=function(){var t=i.dispatchDoc.declareValue,e=i.dispatchDoc.authorizeValue;if(t&&e){var o=t-e,n=100*(o/t).toFixed(4);i.dispatchDoc.extraRate=n,i.dispatchDoc.extraValue=o}},i.isSelect=function(){"合并发文"==i.dispatchDoc.dispatchWay?i.isHide=!1:i.isHide=!0},i.ischecked=function(){i.dispatchDoc.isRelated="是",i.isHide2=!1},i.ischecked2=function(){i.dispatchDoc.isRelated="否",i.isHide2=!0},i.gotoMergePage=function(){e.gotoMergePage(i)},i.search=function(){e.getSign(i)},i.chooseProject=function(){e.chooseProject(i)},i.cancelProject=function(){e.cancelProject(i)},i.onClose=function(){window.parent.$("#mwindow").data("kendoWindow").close()},i.mergeDispa=function(){e.mergeDispa(i)},i.formReset=function(){$("#searchform").find("input,select").val("")},i.search=function(){e.getsign(i)},i.fileNum=function(){e.fileNum(i)},function(){e.initDispatchData(i)}()}angular.module("app").controller("dispatchEditCtrl",t),t.$inject=["$location","dispatchSvc","$state"]}(),function(){"dispatch strict";function t(t,e){function o(t){if(t.isSubmit=!0,!t.dispatchDoc.id)return void common.alert({vm:t,msg:"请先保存再生成文件字号",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}});var o={method:"post",url:rootPath+"/dispatch/fileNum",params:{dispaId:t.dispatchDoc.id}},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){t.dispatchDoc.fileNum=e.data,t.isSubmit=!1,common.alert({vm:t,msg:"操作成功"})}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}function i(t){return t.dispatchDoc.id?"否"==$("#isRelated").find("option:selected").text()?void common.alert({vm:t,msg:"你已选择未关联,请重新选择再进行关联！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):($("#mwindow").kendoWindow({width:"1200px",height:"630px",title:"合并发文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),s(t),void m(t)):void common.alert({vm:t,msg:"请先保存再进行关联！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function n(t){var o={method:"get",url:rootPath+"/dispatch/initData",params:{signid:t.dispatchDoc.signId}},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){t.dispatchDoc=e.data.dispatch,t.proofread=e.data.mainUserList,t.org=e.data.orgList,t.linkSignId=e.data.linkSignId,"合并发文"==t.dispatchDoc.dispatchWay?t.isHide=!1:t.isHide=!0,"9"==t.dispatchDoc.isMainProject?t.isHide2=!1:t.isHide2=!0,t.dispatchDoc.fileNum&&(t.isSubmit=!0)}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}function r(t){var o={method:"get",url:rootPath+"/dispatch/mergeDispa",params:{signId:t.dispatchDoc.signId,linkSignId:t.linkSignId}},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){window.parent.$("#mwindow").data("kendoWindow").close(),common.alert({vm:t,msg:"操作成功！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}function a(t){if(common.initJqValidation($("#dispatch_form")),$("#dispatch_form").valid()){if("9"==t.dispatchDoc.isMainProject&&t.dispatchDoc.id&&" "==t.linkSignId)return void common.alert({vm:t,msg:"请关联其它项目",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}});var o={method:"post",url:rootPath+"/dispatch",data:t.dispatchDoc},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){common.alert({vm:t,msg:"操作成功！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),n(t)}})}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}}function c(t){var e=t.linkSignId,o=$("input[name='checksign']:checked"),i=[];0!=o.length&&($.each(o,function(t,e){i.push(e.value)}),e?e+=","+i.join(","):e=i.join(","),t.linkSignId=e,d(t),m(t))}function l(t){var e=t.linkSignId,o=$("input[name='checkss']:checked");0!=o.lenght&&($.each(o,function(t,o){e=0==e.lastIndexOf(o.value)?e.replace(o.value,""):e.replace(","+o.value,"")}),t.linkSignId=e,d(t),m(t))}function s(t){var o={method:"get",url:rootPath+"/dispatch/getSignByDId",params:{bussnessId:t.dispatchDoc.id}},i=function(e){t.selectedSign=e.data.signDtoList,t.linkSignId=e.data.linkSignId};common.http({vm:t,$http:e,httpOptions:o,success:i})}function d(t){var o={method:"get",url:rootPath+"/dispatch/getSelectedSign",params:{linkSignIds:t.linkSignId}},i=function(e){t.selectedSign=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i})}function m(t){t.sign.signid=t.linkSignId;var o={method:"post",url:rootPath+"/dispatch/getSign",data:t.sign},i=function(e){t.signs=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i,onError:function(t){}})}return{initDispatchData:n,saveDispatch:a,gotoMergePage:i,chooseProject:c,getsign:m,cancelProject:l,mergeDispa:r,fileNum:o,getselectedSign:d,getSeleSignBysId:s}}angular.module("app").factory("dispatchSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e){var o=this;o.searchAudit=function(){e.searchAudit(o)},o.auditToOfficial=function(){e.auditTo(o,2)},o.auditToAlternative=function(){e.auditTo(o,3)},o.auditToStop=function(){e.auditTo(o,4)},o.auditToRemove=function(){e.auditTo(o,5)},o.officialToAudit=function(){e.toAudit(o,2)},o.alternativeToAudit=function(){e.toAudit(o,3)},o.stopToAudit=function(){e.toAudit(o,4)},o.temoveToAudit=function(){e.toAudit(o,5)},function(){e.auditGrid(o)}()}angular.module("app").controller("expertAuditCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e){var o=this;o.data={},o.title="专家列表",o.search=function(){e.searchMuti(o)},o.searchAudit=function(){e.searchMAudit(o)},o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpert(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o)}()}angular.module("app").controller("expertCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e,o,i,n){var r=this;r.model={},r.title="专家信息录入",r.isuserExist=!1,r.isHide=!0,r.id=n.params.expertID,r.id&&(r.isUpdate=!0,r.title="更新专家",r.isHide=!1,r.expertID=r.id,i.getExpertById(r)),r.create=function(){i.createExpert(r)},r.update=function(){i.updateExpert(r)},r.gotoWPage=function(){o.gotoWPage(r)},r.updateWork=function(){o.updateWork(r)},r.createWork=function(){o.createWork(r)},r.saveWork=function(){o.saveWork(r)},r.deleteWork=function(){o.deleteWork(r)},r.onWClose=function(){window.parent.$("#wrwindow").data("kendoWindow").close()},r.onPClose=function(){window.parent.$("#pjwindow").data("kendoWindow").close()},r.gotoJPage=function(){e.gotoJPage(r)},r.updateProject=function(){e.updateProject(r)},r.createProject=function(){e.createProject(r)},r.saveProject=function(){e.saveProject(r)},r.delertProject=function(){e.delertProject(r)}}angular.module("app").controller("expertEditCtrl",t),t.$inject=["$location","projectExpeSvc","workExpeSvc","expertSvc","$state"]}(),function(){"use strict";function t(t,e){var o=this;!function(){e.repeatGrid(o)}()}angular.module("app").controller("expertRepeatCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t){function e(e){common.initJqValidation();$("form").valid();e.isSubmit=!0,e.model.expertID=e.expertID,e.model.birthDay=$("#birthDay").val(),e.model.createDate=$("#createDate").val();var o={method:"put",url:h,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function o(e,o){e.isSubmit=!0;var i={method:"delete",url:h,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function i(t){t.gridOptions.dataSource.read()}function n(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.birthDay=$("#birthDay").val(),e.model.graduateDate=$("#graduateDate").val();var o={method:"post",url:h,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model.expertID=t.data.expertID,e.isUpdate=!0,e.showBt=!0,e.isSubmit=!1,common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function r(e){var o={method:"get",url:h+"/findById",params:{id:e.id}},i=function(t){e.showBt=!0,e.model=t.data,t.data.work&&t.data.work.length>0&&(e.showWorkHistory=!0,e.work=t.data.work),t.data.project&&t.data.project.length>0&&(e.projectkHistory=!0,e.project=t.data.project)};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(t){var e=common.kendoGridDataSource(rootPath+"/expert/findByOData",$("#searchform")),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})};t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c(),dataBound:o,resizable:!0}}function c(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,template:"<span class='row-number'></span>"},{field:"name",title:"姓名",width:100,filterable:!0},{field:"sex",title:"性别",width:50,filterable:!0},{field:"degRee",title:"学位",width:100,filterable:!0},{field:"userPhone",title:"手机号码",width:100,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!0},{field:"degRee",title:"职务",width:100,filterable:!0},{field:"idCard",title:"身份证号",width:100,filterable:!0},{field:"maJor",title:"现从事专业",width:100,filterable:!0},{field:"acaDemy",title:"毕业院校",width:100,filterable:!0},{field:"expeRttype",title:"专家类别",width:100,filterable:!0},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.expertID+"')",t.expertID)}}]}function l(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:100,filterable:!1},{field:"degRee",title:"学位",width:100,filterable:!1},{field:"sex",title:"性别",width:50,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!1},{field:"degRee",title:"职务",width:100,filterable:!1},{field:"expeRttype",title:"专家类别",width:100,filterable:!1}]}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:25,sort:{field:"createdDate",dir:"desc"}}),o=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '2'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '3'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '4'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),r=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '5'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),a=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})};t.gridOptions1={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:a,resizable:!0},t.gridOptions2={dataSource:common.gridDataSource(o),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:a,resizable:!0},t.gridOptions3={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:a,resizable:!0},t.gridOptions4={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:a,resizable:!0},t.gridOptions5={dataSource:common.gridDataSource(r),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:a,resizable:!0}}function d(t){t.gridOptions1.dataSource.read(),t.gridOptions2.dataSource.read(),t.gridOptions3.dataSource.read(),t.gridOptions4.dataSource.read(),t.gridOptions5.dataSource.read()}function m(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findRepeatByOData"),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0}),o=function(){var t=this.items();$(t).each(function(t){$(this).find(".row-number").html(t+1)})};t.repeatGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c(),dataBound:o,resizable:!0}}function u(t,e){var o=common.getKendoCheckId("#grid"+e);if(0==o.length)common.alert({vm:t,msg:"请选择数据"});else{for(var i=[],n=0;n<o.length;n++)i.push(o[n].value);p(t,i.join(","),1)}}function f(t,e){var o=common.getKendoCheckId("#grid1");if(0==o.length)common.alert({vm:t,msg:"请选择数据"});else{for(var i=[],n=0;n<o.length;n++)i.push(o[n].value);p(t,i.join(","),e)}}function p(e,o,i){e.isSubmit=!0;var n={method:"post",url:h+"/updateAudit",params:{ids:o,flag:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions1.dataSource.read(),e.gridOptions2.dataSource.read(),e.gridOptions3.dataSource.read(),e.gridOptions4.dataSource.read(),e.gridOptions5.dataSource.read(),common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}var h=rootPath+"/expert";return{grid:a,auditGrid:s,getExpertById:r,createExpert:n,deleteExpert:o,updateExpert:e,searchMuti:i,searchAudit:d,repeatGrid:m,updateAudit:p,toAudit:u,auditTo:f}}angular.module("app").factory("expertSvc",t),t.$inject=["$http"]}(),function(){"projectExpe strict";function t(t){function e(e){common.initJqValidation();var o=$("input[name='checkpj']:checked");if(o.length<1)common.alert({vm:e,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}});else{var i="";$.each(o,function(t,e){i+=e.value+","}),e.isSubmit=!0;var r={method:"delete",url:rootPath+"/projectExpe/deleteProject",data:i},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,n(e)}})};common.http({vm:e,$http:t,httpOptions:r,success:a})}}function o(e){var o={method:"get",url:common.format(rootPath+"/projectExpe/getProject?$filter=peID eq '{0}'",e.peID)},i=function(t){e.model.projectName=t.data[0].projectName,e.model.projectType=t.data[0].projectType,$("#projectbeginTime").val(t.data[0].projectbeginTime),$("#projectendTime").val(t.data[0].projectendTime),e.isUpdate};common.http({vm:e,$http:t,httpOptions:o,success:i})}function i(e){if(common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()){e.isSubmit=!0,e.model.peID=e.peID,e.model.expertID=e.expertID,e.model.projectbeginTime=$("#projectbeginTime").val(),e.model.projectendTime=$("#projectendTime").val();var o={method:"put",url:rootPath+"/projectExpe/updateProject",data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#pjwindow").data("kendoWindow").close(),n(e),c(),common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})}}common.http({vm:e,$http:t,httpOptions:o,success:i})}function n(e){var o={method:"GET",url:rootPath+"/projectExpe/getProject?$filter=expert.expertID eq '"+e.model.expertID+"'"},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.project=t.data}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(t){var e=$("input[name='checkpj']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.peID=e.val(),o(t),t.expertID=t.model.expertID,a(t))}function a(t){$("#pjwindow").kendoWindow({width:"690px",height:"330px",title:"添加项目经历",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function c(){var t=$("#pjwindow").find("input");$.each(t,function(t,e){e.value=""})}function l(e){if(common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()){e.model.projectbeginTime=$("#projectbeginTime").val(),e.model.projectendTime=$("#projectendTime").val();var o={method:"post",url:rootPath+"/projectExpe/projectExpe",data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#pjwindow").data("kendoWindow").close(),c(),n(e),common.alert({vm:e,msg:"操作成功",fn:function(){e.projectkHistory=!0,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}return{getProject:n,createProject:l,updateProject:r,saveProject:i,getProjectById:o,delertProject:e,gotoJPage:a}}angular.module("app").factory("projectExpeSvc",t),t.$inject=["$http"]}(),function(){"workExpe strict";function t(t){function e(e){var o={method:"GET",url:rootPath+"/workExpe/getWork?$filter=expert.expertID eq '"+e.model.expertID+"'"},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.work=t.data}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function o(o){var i=$("input[name='checkwr']:checked");if(i.length<1)common.alert({vm:o,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}});else{var n="";$.each(i,function(t,e){n+=e.value+","}),o.isSubmit=!0;var r={method:"delete",url:rootPath+"/workExpe/deleteWork",data:n},a=function(t){common.requestSuccess({vm:o,response:t,fn:function(){o.isSubmit=!1,e(o)}})};common.http({vm:o,$http:t,httpOptions:r,success:a})}}function i(t){var e=$("input[name='checkwr']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.weID=e.val(),n(t),a(t),t.expertID=t.model.expertID)}function n(e){var o={method:"get",url:common.format(rootPath+"/workExpe/getWork?$filter=weID eq '{0}'",e.weID)},i=function(t){e.model.companyName=t.data[0].companyName,e.model.job=t.data[0].job,$("#beginTime").val(t.data[0].beginTime),$("#endTime").val(t.data[0].endTime),e.isUpdate};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(){var t=$("#wrwindow").find("input");$.each(t,function(t,e){e.value=""})}function a(t){$("#wrwindow").kendoWindow({width:"690px",height:"330px",title:"添加工作经历",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function e(e){var o={method:"GET",url:rootPath+"/workExpe/getWork?$filter=expert.expertID eq '"+e.model.expertID+"'"},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.work=t.data}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(o){if(common.initJqValidation($("#workForm")),$("#workForm").valid()){o.model.beginTime=$("#beginTime").val(),o.model.endTime=$("#endTime").val();var i={method:"post",url:rootPath+"/workExpe/workExpe",data:o.model},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){r(),window.parent.$("#wrwindow").data("kendoWindow").close(),e(o),common.alert({vm:o,msg:"操作成功",fn:function(){o.showWorkHistory=!0,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:o,$http:t,httpOptions:i,success:n})}}function l(o){if(common.initJqValidation(),$("form").valid()){o.model.weID=o.weID,o.model.expertID=o.expertID,o.model.beginTime=$("#beginTime").val(),o.model.endTime=$("#endTime").val();var i={method:"put",url:rootPath+"/workExpe/updateWork",data:o.model},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){e(o),r(),common.alert({vm:o,msg:"操作成功",fn:function(){window.parent.$("#wrwindow").data("kendoWindow").close(),o.showWorkHistory=!0,$(".alertDialog").modal("hide")}})}})};common.http({vm:o,$http:t,httpOptions:i,success:n})}}return{createWork:c,saveWork:l,deleteWork:o,updateWork:i,gotoWPage:a,getWorkById:n,getWork:e}}angular.module("app").factory("workExpeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="专家列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpertReview(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o)}()}angular.module("app").controller("expertReviewCtrl",t),t.$inject=["$location","expertReviewSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加附件",i.isuserExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新附件"),i.create=function(){e.createExpertReview(i)},i.update=function(){e.updateExpertReview(i)},function(){i.isUpdate&&e.getExpertReviewById(i)}()}angular.module("app").controller("expertReviewEditCtrl",t),t.$inject=["$location","expertReviewSvc","$state"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.title="选择专家",n.isAutoSelectExpert=!0,n.selExpertConfirm=!1,n.conditionIndex=1,n.conditions=new Array,n.autoExpertMap={},n.expertReview={},n.workProgram={},n.expertReview.workProgramId=i.params.workProgramId,function(){o.initConditionAndWP(n),e.initExpertGrid(n),e.initSelect(n)}(),n.showSelfExpertGrid=function(){e.initSelfExpert(n)},n.saveSelfExpert=function(){e.saveSelfExpert(n)},n.delertSelfExpert=function(){var t=$("input[name='seletedEp']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择操作对象"});else{for(var o=[],i=0;i<t.length;i++)o.push(t[i].value);var r=o.join(",");e.delertExpert(n,r)}},n.showOutExpertGrid=function(){e.showOutExpertGrid(n)},n.delertOutSelfExpert=function(){var t=$("input[name='seletedOutEp']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择操作对象"});else{for(var o=[],i=0;i<t.length;i++)o.push(t[i].value);var r=o.join(",");e.delertExpert(n,r)}},n.saveOutExpert=function(){e.saveOutExpert(n)},n.countMatchExperts=function(t){e.countMatchExperts(n,t)},n.checkIntegerValue=function(t,e,i){o.isUnsignedInteger(t)?($("#"+e+i).val(t),$("#errorsOfficialNum"+i).html(""),$("#errorsAlternativeNum"+i).html("")):($("#errorsOfficialNum"+i).html("只能填写数字"),$("#errorsAlternativeNum"+i).html("只能填写数字"))},n.addCondition=function(){n.isAutoSelectExpert?common.alert({vm:n,msg:"当前项目已经进行整体专家方案的抽取，不能再修改方案！"}):(n.condition={},n.condition.sort=n.conditionIndex,n.condition.workProgramId=n.expertReview.workProgramId,n.conditions.push(n.condition),n.conditionIndex++)},n.removeCondition=function(){if(n.isAutoSelectExpert)common.alert({vm:n,msg:"当前项目已经进行整体专家方案的抽取，不能再修改方案！"});else{var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>=1&&common.confirm({vm:n,title:"温馨提示",msg:"删除数据不可恢复，确定删除么？",fn:function(){$(".confirmDialog").modal("hide");for(var e=[],i=0;i<t.length;i++)n.conditions.forEach(function(o,r){t[i].value==o.sort&&(n.conditions.splice(r,1),o.id&&(angular.isUndefined(o.isSelete)||0==o.isSelete)&&e.push(o.id))});e.length>0&&o.deleteSelConditions(n,e.join(","))}})}},n.saveCondition=function(){n.isAutoSelectExpert?common.alert({vm:n,msg:"当前项目已经进行整体专家方案的抽取，不能再修改方案！"}):o.saveCondition(n)},n.showAutoExpertWin=function(){var t=!0;n.conditions.forEach(function(e,o){(angular.isUndefined(e.id)||""==e.id)&&(t=!1)}),t?common.alert({vm:n,msg:"功能正在开发中！"}):common.alert({vm:n,msg:"请先保存编辑的抽取方案！"})},n.resetAutoExpert=function(){common.alert({vm:n,msg:"功能待开发！"})},n.affirmExpert=function(){var t=$("input[name='seletedEp']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择操作对象"});else{for(var o=[],i=0;i<t.length;i++)o.push(t[i].value);var r=o.join(",");e.updateExpertState(n,r,"9")}}}angular.module("app").controller("expertSelectCtrl",t),t.$inject=["$location","expertReviewSvc","expertConditionSvc","$state"]}(),function(){"use strict";function t(t){function e(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:100,filterable:!1},{field:"degRee",title:"学位",width:100,filterable:!1},{field:"sex",title:"性别",width:50,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!1},{field:"degRee",title:"职务",width:100,filterable:!1},{field:"expeRttype",title:"专家类别",width:100,filterable:!1}]}function o(e){var o={method:"get",url:rootPath+"/expertReview/html/initByWorkProgramId",params:{workProgramId:e.expertReview.workProgramId}},i=function(t){if(e.selfExperts=[],e.selectExperts=[],e.selectIds=[],e.autoExperts=[],e.outsideExperts=[],t.data&&t.data.length>0)for(var o=0,i=t.data.length;o<i;o++)e.selectIds.push(t.data[o].expertDto.expertID),e.selectExperts.push(t.data[o].expertDto),"1"==t.data[o].selectType?e.autoExperts.push(t.data[o].expertDto):"2"==t.data[o].selectType?e.selfExperts.push(t.data[o].expertDto):"3"==t.data[o].selectType&&e.outsideExperts.push(t.data[o].expertDto);e.selectIds.length>0?e.excludeIds=e.selectIds.join(","):e.excludeIds=""};common.http({vm:e,$http:t,httpOptions:o,success:i})}function i(t){var o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#selfSelExpertForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.selfExpertOptions={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:e(),dataBound:o,resizable:!0};var n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#outSelExpertForm"),{filter:"state eq '3'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.outExpertOptions={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:e(),dataBound:o,resizable:!0}}function n(t){t.selfExpertOptions.dataSource.read(),$("#selfExpertDiv").kendoWindow({width:"860px",height:"500px",title:"自选评审专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function r(e){var i=common.getKendoCheckId("#selfExpertGrid");if(0==i.length)$("#selfExpertError").html("请选择一条专家数据才能保存！");else if(i.length>1)$("#selfExpertError").html("自选专家最多只能选择一个！");else{$("#selfExpertError").html(""),window.parent.$("#selfExpertDiv").data("kendoWindow").close(),e.iscommit=!0;var n={method:"post",
url:rootPath+"/expertReview/saveExpertReview",params:{expertIds:i[0].value,workProgramId:e.expertReview.workProgramId,selectType:"2"}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,o(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r,onError:function(t){e.iscommit=!1}})}}function a(e,o,i){var n={method:"get",url:rootPath+"/expertReview/refleshExpert",params:{workProgramId:o,selectType:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){"2"==i&&(e.selfExperts=t.data)}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}function c(e,o,i){e.iscommit=!0;var n={method:"post",url:rootPath+"/expertReview/updateExpertState",params:{workProgramId:e.expertReview.workProgramId,expertIds:o,state:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r,onError:function(t){e.iscommit=!1}})}function l(e,i){e.iscommit=!0;var n={method:"post",url:rootPath+"/expertReview/deleteExpert",params:{workProgramId:e.expertReview.workProgramId,expertIds:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,o(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r,onError:function(t){e.iscommit=!1}})}function s(t){t.outExpertOptions.dataSource.read(),$("#outExpertDiv").kendoWindow({width:"860px",height:"500px",title:"自选新专家、市外、境外专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function d(e){var i=common.getKendoCheckId("#outExpertGrid");if(0==i.length)$("#outExpertError").html("请选择一条专家数据才能保存！");else{$("#outExpertError").html(""),window.parent.$("#outExpertDiv").data("kendoWindow").close(),e.iscommit=!0;var n="";$.each(i,function(t,e){n+=0==t?e.value:","+e.value});var r={method:"post",url:rootPath+"/expertReview/saveExpertReview",params:{expertIds:n,workProgramId:e.expertReview.workProgramId,selectType:"3"}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,o(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:r,success:a,onError:function(t){e.iscommit=!1}})}}function m(e,i){e.iscommit=!0;var n={method:"post",url:rootPath+"/expertReview/deleteExpert",params:{workProgramId:e.expertReview.workProgramId,expertSelConditionId:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,o(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r,onError:function(t){e.iscommit=!1}})}function u(e,o){var i={};e.conditions.forEach(function(t,e){t.sort==o&&(i=t,i.maJorBig=$("#maJorBig"+t.sort).val(),i.maJorSmall=$("#maJorSmall"+t.sort).val(),i.expeRttype=$("#expeRttype"+t.sort).val())});var n={method:"post",url:rootPath+"/expert/countReviewExpert",data:i},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){$("#expertCount"+o).html(t.data)}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}rootPath;return{initExpertGrid:i,initSelect:o,initSelfExpert:n,saveSelfExpert:r,delertExpert:l,refleshExpert:a,updateExpertState:c,showOutExpertGrid:s,saveOutExpert:d,deleteAutoSelExpert:m,countMatchExperts:u}}angular.module("app").factory("expertReviewSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){function e(e){var o={method:"get",url:rootPath+"/expertSelCondition/html/findByWorkProId",params:{workProId:e.expertReview.workProgramId}},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){t.data.conditionList&&(e.conditions=t.data.conditionList,e.conditions.length>0&&(e.conditions.forEach(function(t,o){t.sort>e.conditionIndex&&(e.conditionIndex=t.sort)}),e.conditionIndex++)),t.data.workProgram&&(e.workProgram=t.data.workProgram,e.workProgram.isSelete&&9==e.workProgram.isSelete?e.isAutoSelectExpert=!0:e.isAutoSelectExpert=!1,e.workProgram.isComfireResult&&9==e.workProgram.isComfireResult?e.isComfireResult=!0:e.isComfireResult=!1)}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function o(e){if(e.conditions.length>0){var o=!0;if(e.conditions.forEach(function(t,n){t.workProgramId=e.expertReview.workProgramId,t.maJorBig=$("#maJorBig"+t.sort).val(),t.maJorSmall=$("#maJorSmall"+t.sort).val(),t.expeRttype=$("#expeRttype"+t.sort).val(),$("#officialNum"+t.sort).val()&&i($("#officialNum"+t.sort).val())?t.officialNum=$("#officialNum"+t.sort).val():($("#errorsOfficialNum"+t.sort).html("必填，且为数字"),o=!1),$("#alternativeNum"+t.sort).val()&&i($("#alternativeNum"+t.sort).val())?t.alternativeNum=$("#alternativeNum"+t.sort).val():($("#errorsAlternativeNum"+t.sort).html("必填，且为数字"),o=!1),o&&($("#errorsOfficialNum"+t.sort).html(""),$("#errorsAlternativeNum"+t.sort).html(""))}),o){var n={method:"post",url:rootPath+"/expertSelCondition/saveConditionList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.conditions)},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.conditions=t.data,e.conditions.forEach(function(t,o){t.workProgramId=e.expertReview.workProgramId}),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}}else common.alert({vm:e,msg:"请先设置条件再保存！",closeDialog:!0})}function i(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function n(e,o){e.iscommit=!0;var i={method:"delete",url:rootPath+"/expertSelCondition",params:{id:o,workProId:e.expertReview.workProgramId,deleteEP:!1}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.iscommit=!1,common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:i,success:n,onError:function(t){e.iscommit=!1}})}return{initConditionAndWP:e,saveCondition:o,deleteSelConditions:n,isUnsignedInteger:i}}angular.module("app").factory("expertConditionSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="项目归档编辑",i.fileRecord={},i.fileRecord.signId=o.params.signid,i.signId=o.params.signid,function(){e.initFileRecordData(i)}(),i.create=function(){e.saveFileRecord(i)}}angular.module("app").controller("fileRecordEditCtrl",t),t.$inject=["$location","fileRecordSvc","$state"]}(),function(){"use strict";function t(t,e){function o(t){var o={method:"get",url:rootPath+"/fileRecord/html/initFillPage",params:{signId:t.fileRecord.signId}},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){null!=e.data&&""!=e.data&&(t.fileRecord=e.data.file_record,t.fileRecord.signId=t.signId,t.signUserList=e.data.sign_user_List)}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}function i(t){if(common.initJqValidation($("#fileRecord_form")),$("#fileRecord_form").valid()){t.signUser&&(t.fileRecord.signUserid=t.signUser.id,t.fileRecord.signUserName=t.signUser.displayName),t.saveProcess=!0;var o={method:"post",url:rootPath+"/fileRecord",data:t.fileRecord},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){t.saveProcess=!1,common.alert({vm:t,msg:"操作成功！"})}})};common.http({vm:t,$http:e,httpOptions:o,success:i,onError:function(e){t.saveProcess=!1}})}}return{initFileRecordData:o,saveFileRecord:i}}angular.module("app").factory("fileRecordSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="",o.changePwd=function(){e.changePwd(o)}}angular.module("app").controller("homeCtrl",t),t.$inject=["$location","homeSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"put",url:o,data:e.model.password},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}}var o="/account/password";return{changePwd:e}}angular.module("app").factory("homeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o){function i(t){var e=t.flow.processInstanceId;(angular.isUndefined(t.flow.hideFlowImg)||0==t.flow.hideFlowImg)&&(t.picture=rootPath+"/flow/processInstance/img/"+e);var o=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/processInstance/history/"+e),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:30},{field:"activityName",title:"环节名称",width:120,filterable:!1},{field:"assignee",title:"处理人",width:80,filterable:!1},{field:"startTime",title:"开始时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endTime",title:"结束时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"duration",title:"处理时长",width:120,filterable:!1},{field:"message",title:"处理信息",width:300,filterable:!1}];t.historygrid={dataSource:common.gridDataSource(o),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var e=this.items();$(e).each(function(o){o==e.length-1&&l(t),$(this).find(".row-number").html(o+1)})}}}function n(e){var i={method:"get",url:rootPath+"/flow/processInstance/flowNodeInfo",params:{taskId:e.flow.taskId,processInstanceId:e.flow.processInstanceId}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.flow=t.data,e.flow.businessMap&&(e.flow.businessMap.viceDirectors&&(e.businessTr=!0,e.ZHB_SP_SW=!0,e.viceDirectors=e.flow.businessMap.viceDirectors),e.flow.businessMap.orgs&&(e.businessTr=!0,e.FGLD_SP_SW=!0,e.orgs=e.flow.businessMap.orgs),e.flow.businessMap.users&&(e.businessTr=!0,e.BM_FB=!0,e.users=e.flow.businessMap.users)),o.initBusinessParams(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function r(o){if(common.initJqValidation($("#flow_form")),$("#flow_form").valid()){o.isCommit=!0;var i={method:"post",url:rootPath+"/flow/commit",data:o.flow},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){common.alert({vm:o,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?o.isCommit=!1:e.go("index")}})}})};common.http({vm:o,$http:t,httpOptions:i,success:n,onError:function(t){o.isCommit=!1}})}}function a(e){var o={method:"post",url:rootPath+"/flow/rollbacklast",data:e.flow},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(e){if(null==e.flow.back||null==e.flow.back.activitiId||""==e.flow.back.activitiId)return void common.alert({vm:e,msg:"请先选择要会退的环节！"});common.confirm({vm:e,title:"",msg:"确认回退吗？",fn:function(){e.flow.rollBackActiviti=e.flow.back.activitiId,e.flow.backNodeDealUser=e.flow.back.assignee;var o={method:"post",url:rootPath+"/flow/rollback",data:e.flow},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}})}function l(t){t.backNode=[];for(var e=t.historygrid.dataSource.data(),o=e.length,i=0;i<o;i++)e[i].assignee&&e[i].endTime&&t.backNode.push({activitiId:e[i].activityId,activitiName:e[i].activityName,assignee:e[i].assignee})}function s(t){t.nextDealUserList=t.nextDealUserMap[t.flow.nextNodeAcivitiId],t.nextDealUserList&&(t.flow.nextDealUser=t.nextDealUserList[0].loginName)}function d(e,o){var i={method:"post",url:rootPath+"/flow/suspend/"+o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function m(e,o){var i={method:"post",url:rootPath+"/flow/active/"+o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function u(e){if(null==e.flow.dealOption||""==e.flow.dealOption)return void common.alert({vm:e,msg:"请填写处理信息！"});var o={method:"post",url:rootPath+"/flow/deleteFLow",data:e.flow},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}return{initFlowData:i,getFlowInfo:n,commit:r,rollBackToLast:a,rollBack:c,initBackNode:l,initDealUerByAcitiviId:s,suspendFlow:d,activeFlow:m,deleteFlow:u}}angular.module("app").factory("flowSvc",t),t.$inject=["$http","$state","signFlowSvc"]}(),function(){"use strict";function t(t,e){var o=this;o.title="日志列表",function(){e.grid(o)}()}angular.module("app").controller("logCtrl",t),t.$inject=["$location","logSvc"]}(),function(){"use strict";function t(t,e){function o(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(i+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{field:"id",title:"ID",width:80,filterable:!1},{field:"level",title:"级别",width:100,filterable:!0},{field:"message",title:"日志内容",filterable:!1},{field:"userId",title:"操作者",width:150,filterable:!0},{field:"createdDate",title:"操作时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}var i=rootPath+"/log";rootPath;return{grid:o}}angular.module("app").factory("logSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var o=this;o.title="会议室列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteMeeting(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryMeeting=function(){e.queryMeeting(o)},function(){e.grid(o)}()}angular.module("app").controller("meetingCtrl",t),t.$inject=["$location","meetingSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加会议室",i.isuserExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新会议室"),i.create=function(){e.createMeeting(i)},i.update=function(){e.updateMeeting(i)},function(){i.isUpdate&&e.getMeetingById(i)}()}angular.module("app").controller("meetingEditCtrl",t),t.$inject=["$location","meetingSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var o={method:"put",url:c,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function i(e,o){e.isSubmit=!0;var i={method:"delete",url:c,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function n(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"post",url:c,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i,onError:function(t){e.iscommit=!1}})}}function r(e){var o={method:"get",url:c+"/html/findByIdMeeting",params:{id:e.id}},i=function(t){e.model=t.data,console.log(e.model)};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"/fingByOData",$("#meetingFrom")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"num",title:"会议室编号",width:200,filterable:!1},{field:"mrName",title:"会议室名称",width:200,filterable:!1},{field:"mrType",title:"会议室类型",width:180,filterable:!1},{field:"addr",title:"会议室地点",filterable:!1},{field:"mrStatus",title:"会议室状态",filterable:!1},{field:"capacity",title:"会议室容量",filterable:!1},{field:"userName",title:"会议室负责人",filterable:!1},{field:"userPhone",title:"负责人电话",filterable:!1},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}var c=rootPath+"/meeting",l="#/meeting";return{grid:a,getMeetingById:r,createMeeting:n,deleteMeeting:i,updateMeeting:o,queryMeeting:e}}angular.module("app").factory("meetingSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="My test",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteMytest(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o)}()}angular.module("app").controller("myTestCtrl",t),t.$inject=["$location","myTestSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加My test",i.isuserExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新My test"),i.create=function(){e.createMyTest(i)},i.update=function(){e.updateMyTest(i)},function(){i.isUpdate&&e.getMyTestById(i)}()}angular.module("app").controller("myTestEditCtrl",t),t.$inject=["$location","myTestSvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var o={method:"put",url:a,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function o(e,o){e.isSubmit=!0;var i={method:"delete",url:a,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"post",url:a,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function n(e){var o={method:"get",url:common.format(a+"?$filter=id eq '{0}'",e.id)},i=function(t){e.model=t.data.value[0]};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(a),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"testName",title:"测试名",width:100,filterable:!0},{field:"test01",title:"测试01",width:100,filterable:!0},{field:"test02",title:"测试02",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}var a=rootPath+"/myTest",c="#/myTest";return{grid:r,getMyTestById:n,createMyTest:i,deleteMyTest:o,updateMyTest:e}}angular.module("app").factory("myTestSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="处室人员管理",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOfficeUser(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryOffice=function(){e.queryOffice(o)},function(){e.grid(o)}()}angular.module("app").controller("officeUserCtrl",t),t.$inject=["$location","officeUserSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加人员",i.isuserExist=!1,i.officeID=o.params.officeID,i.officeID&&(i.isUpdate=!0,i.title="更新人员"),i.create=function(){e.createOfficeUser(i)},i.update=function(){e.updateOfficeUser(i)},function(){i.isUpdate&&e.getOfficeUserById(i),e.getDepts(i)}()}angular.module("app").controller("officeUserEditCtrl",t),t.$inject=["$location","officeUserSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function o(e){var o={method:"get",url:common.format(l+"/getDepts")},i=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var o={method:"put",url:l,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function n(e,o){e.isSubmit=!0;var i={method:"delete",url:l,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function r(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"post",url:l,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=s}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function a(e){var o={method:"get",url:rootPath+"/officeUser/html/findById",params:{officeID:e.officeID}},i=function(t){t.data.dept,e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#formOffice")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"deptName",title:"所在办事处",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeEmail",title:"邮件",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}var l=rootPath+"/officeUser",s="#/officeUserList";return{grid:c,getOfficeUserById:a,createOfficeUser:r,deleteOfficeUser:n,updateOfficeUser:i,getDepts:o,queryOffice:e}}angular.module("app").factory("officeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var o=this;o.title="部门列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOrg(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryOrg=function(){e.queryOrg(o)},function(){e.grid(o)}()}angular.module("app").controller("orgCtrl",t),t.$inject=["$location","orgSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="新增部门",i.isorgExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新部门"),i.create=function(){e.createOrg(i)},i.update=function(){e.updateOrg(i)},function(){e.initRoleUsers(i),i.isUpdate&&e.getOrgById(i)}()}angular.module("app").controller("orgEditCtrl",t),t.$inject=["$location","orgSvc","$state"]}(),function(){"use strict";function t(t,e){function o(t){t.gridOptions.dataSource.read()}function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/fingByOData",$("#orgForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"sort",dir:"asc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"orgIdentity",title:"部门标识",width:80,filterable:!1},{field:"name",title:"部门名称",width:130,filterable:!1},{field:"orgFunction",title:"职能",width:130,filterable:!1},{field:"orgDirectorName",title:"部门负责人",width:100,filterable:!1},{field:"orgSLeaderName",title:"分管领导",width:100,filterable:!1},{field:"orgPhone",title:"电话",width:130,filterable:!1},{field:"orgAddress",title:"地址",width:130,filterable:!1},{field:"remark",title:"描述",width:130,filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}function n(e){if(common.initJqValidation(),$("form").valid()&&0==e.isorgExist){e.isSubmit=!0;var o={method:"post",url:d,data:e.model};e.OrgDirectorUsers.forEach(function(t,o){t.id==e.model.orgDirector&&(e.model.orgDirectorName=t.displayName)}),e.orgMLeaderUsers.forEach(function(t,o){t.id==e.model.orgMLeader&&(e.model.orgMLeaderName=t.displayName)}),e.orgSLeaderUser.forEach(function(t,o){t.id==e.model.orgSLeader&&(e.model.orgSLeaderName=t.displayName)});var i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=m}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function r(e){var o={method:"get",url:common.format(d+"/getCompany")},i=function(t){e.company={},e.company=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(e){var o={method:"get",url:d+"/html/getOrgById",params:{id:e.id}},i=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(e){if(common.initJqValidation(),$("form").valid()&&0==e.isorgExist){e.isSubmit=!0,e.model.id=e.id,e.OrgDirectorUsers.forEach(function(t,o){t.id==e.model.orgDirector&&(e.model.orgDirectorName=t.displayName)}),e.orgMLeaderUsers.forEach(function(t,o){t.id==e.model.orgMLeader&&(e.model.orgMLeaderName=t.displayName)}),e.orgSLeaderUser.forEach(function(t,o){t.id==e.model.orgSLeader&&(e.model.orgSLeaderName=t.displayName)});var o={method:"put",url:d,data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function l(e,o){e.isSubmit=!0;var i={method:"delete",url:d,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function s(e){var o={method:"get",url:rootPath+"/user/initRoleUsers"},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.orgMLeaderUsers=t.data.DIRECTOR,e.orgSLeaderUser=t.data.VICE_DIRECTOR,e.OrgDirectorUsers=t.data.DEPT_LEADER}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}var d=rootPath+"/org",m="#/org";rootPath;return{grid:i,createOrg:n,getOrgById:a,updateOrg:c,deleteOrg:l,getCompany:r,initRoleUsers:s,queryOrg:o}}angular.module("app").factory("orgSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.id=e.params.id,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.orgUserGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.add=function(t){i.add(n,t)},n.remove=function(t){i.remove(n,t)},n.removes=function(){var t=common.getKendoCheckId(".orgUserGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var i=e.join(",");n.remove(i)}},function(){o.getOrgById(n),i.orgUserGrid(n),i.allUserGrid(n)}()}angular.module("app").controller("orgUserCtrl",t),t.$inject=["$location","$state","orgSvc","orgUserSvc"]}(),function(){"use strict";function t(t,e){function o(e,o){var i={method:"delete",url:rootPath+"/org/deleteUsers",params:{orgId:e.id,userId:o}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function i(e,o){var i={method:"post",url:rootPath+"/org/addUsers",params:{orgId:e.id,userId:o}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.orgUserGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(a+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{field:"loginName",title:"登录名",width:200,filterable:!0},{field:"displayName",title:"显示名",width:200,filterable:!0},{field:"comment",title:"描述",filterable:!1},{field:"",title:"操作",width:80,
template:function(t){return common.format($("#allUserGridBtns").html(),"vm.add('"+t.id+"')",t.id)}}];t.orgUserGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!1,serverFiltering:!1,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"loginName",title:"登录名",width:200,filterable:!1},{field:"displayName",title:"显示名",width:200,filterable:!1},{field:"comment",title:"描述",filterable:!1},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}var a=rootPath+"/org/userNotIn",c=rootPath+"/org/users";return{orgUserGrid:r,allUserGrid:n,add:i,remove:o}}angular.module("app").factory("orgUserSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var o=this;o.title="角色列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteRole(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o)}()}angular.module("app").controller("roleCtrl",t),t.$inject=["$location","roleSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加角色",i.isRoleExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新角色"),i.create=function(){e.createRole(i)},i.update=function(){e.updateRole(i)},i.checkRole=function(){e.checkRole(i)},function(){i.isUpdate?e.getRoleById(i):e.initZtreeClient(i)}()}angular.module("app").controller("roleEditCtrl",t),t.$inject=["$location","roleSvc","$state"]}(),function(){"use strict";function t(t,e){function o(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function i(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),o=$linq(t.model.resources).select(function(t){return t.path}).toArray(),i=e.getNodesByParam("level",1,null),n=$linq(i).where(function(t){return $linq(o).contains(t.path)}).toArray(),r=0,a=n.length;r<a;r++)e.checkNode(n[r],!0,!0)}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"roleName",title:"角色名称",width:200,filterable:!1},{field:"remark",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}function r(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0;var i=o(),n=$linq(i).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n;var r={method:"post",url:m,data:e.model},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=u}})}})};common.http({vm:e,$http:t,httpOptions:r,success:a})}}function a(t){}function c(e){var o={method:"post",url:rootPath+"/role/findById",params:{roleId:e.id}},i=function(t){e.model=t.data,e.isUpdate&&d(e)};common.http({vm:e,$http:t,httpOptions:o,success:i})}function l(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0,e.model.id=e.id;var i=o(),n=$linq(i).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n,e.model.createdDate="2017-04-07 12:00:00";var r={method:"put",url:m,data:e.model},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:r,success:a})}}function s(e,o){e.isSubmit=!0;var i={method:"delete",url:m,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function d(e){var o={method:"get",url:f},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var o={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},n=t.data;$.fn.zTree.init($("#zTree"),o,n),e.isUpdate&&i(e)}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}var m=rootPath+"/role",u="#/role",f=rootPath+"/sys/resource";return{grid:n,createRole:r,checkRole:a,getRoleById:c,updateRole:l,deleteRole:s,initZtreeClient:d}}angular.module("app").factory("roleSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var o=this;o.title="预定会议统计列表",o.queryRoomCount=function(){e.queryRoomCount(o)},o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteroomCount(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o),e.roomList(o),e.findAllOrg(o)}()}angular.module("app").controller("roomCountCtrl",t),t.$inject=["$location","roomCountSvc"]}(),function(){"use strict";function t(t,e){function o(t){t.gridOptions.dataSource.read()}function i(e){var o={method:"get",url:common.format(c+"/getOrg")},i=function(t){e.orglist={},e.orglist=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function n(e){var o={method:"get",url:common.format(a+"/roomNamelist")},i=function(t){e.roomlists={},e.roomlists=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(a+"/fingByOData",$("#roomCountform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{field:"rowNumber",title:"序号",width:40,filterable:!1,template:"<span class='row-number'></span>"},{field:"rbName",title:"会议名称",width:120,filterable:!1},{field:"addressName",title:"会议地点",width:120,filterable:!1},{field:"rbDay",title:"会议日期",width:160,filterable:!1},{field:"beginTimeStr",title:"会议开始时间",width:160,filterable:!1},{field:"endTimeStr",title:"会议结束时间",type:"date",width:160,filterable:!1},{field:"rbType",title:"会议类型",width:100,filterable:!1},{field:"dueToPeople",title:"会议预定人",width:100,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}var a=(rootPath,rootPath+"/room"),c=rootPath+"/user",c=rootPath+"/user";return{grid:r,queryRoomCount:o,roomList:n,findAllOrg:i}}angular.module("app").factory("roomCountSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.title="会议室预定列表",n.id=i.params.id,n.workProgramId=i.params.workProgramId,n.startDateTime=new Date("2006/6/1 08:00"),n.endDateTime=new Date("2030/6/1 21:00"),n.editRoom=function(){e.editRoom(n)},n.addRoom=function(){e.addRoom(n)},n.exportWeek=function(){e.exportWeek()},n.exportThisWeek=function(){e.exportThisWeek()},n.exportNextWeek=function(){e.exportNextWeek()},n.stageNextWeek=function(){e.stageNextWeek()},n.findMeeting=function(){e.findMeeting(n)},n.del=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteRoom(n,t)}})},n.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var i=e.join(",");n.del(i)}},function(){e.initRoom(n),e.showMeeting(n)}()}angular.module("app").controller("roomCtrl",t),t.$inject=["$location","roomSvc","$scope","$state"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加会议室预定",i.isuserExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新会议室"),function(){i.isUpdate&&e.getroomById(i)}()}angular.module("app").controller("roomEditCtrl",t),t.$inject=["$location","roomSvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(e.model.id=$("#id").val(),e.model.rbName=$("#rbName").val(),e.model.mrID=$("#mrID").val(),e.model.rbType=$("#rbType").val(),e.model.host=$("#host").val(),e.model.dueToPeople=$("#dueToPeople").val(),e.model.rbDay=$("#rbDay").val(),e.model.beginTime=$("#beginTime").val(),e.model.endTime=$("#endTime").val(),e.model.content=$("#content").val(),e.model.content=$("#remark").val(),common.initJqValidation($("#formRoom")),$("#formRoom").valid()){e.iscommit=!0;var o={method:"put",url:rootPath+"/room/updateRoom",data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function o(e){if(common.initJqValidation($("#formRoom")),$("#formRoom").valid()){var o={method:"post",url:rootPath+"/room/addRoom",data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function i(e){var o=new kendo.data.SchedulerDataSource({batch:!0,sync:function(){this.read()},transport:{read:function(e){var o=e.data.mrID,i=rootPath+"/room";o&&(i+="?"+o),t.get(i).success(function(t){e.success(t.value)}).error(function(t){console.log("查询数据失败！")})},create:function(o){if(common.initJqValidation($("#formRoom")),$("#formRoom").valid()){var i=o.data.models[0];if(i.rbDay=$("#rbDay").val(),i.beginTimeStr=$("#beginTime").val(),i.endTimeStr=$("#endTime").val(),i.beginTime=$("#rbDay").val()+" "+$("#beginTime").val()+":00",i.endTime=$("#rbDay").val()+" "+$("#endTime").val()+":00",e.workProgramId&&(i.workProgramId=e.workProgramId),new Date(i.endTime)<new Date(i.beginTime))return void $("#errorTime").html("开始时间不能大于结束时间!");var n={method:"post",url:rootPath+"/room/addRoom",data:i},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){r(e),$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.schedulerOptions.cancelEvent()}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}},update:function(o){if(common.initJqValidation($("#formRoom")),$("#formRoom").valid()){var i=o.data.models[0];if(i.rbDay=$("#rbDay").val(),i.beginTimeStr=$("#beginTime").val(),i.endTimeStr=$("#endTime").val(),i.beginTime=$("#rbDay").val()+" "+$("#beginTime").val()+":00",i.endTime=$("#rbDay").val()+" "+$("#endTime").val()+":00",new Date(i.endTime)<new Date(i.beginTime))return void $("#errorTime").html("开始时间不能大于结束时间!");var n={method:"put",url:rootPath+"/room/updateRoom",data:i},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){r(e),$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.schedulerOptions.cancelEvent()}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}},destroy:function(o){var i=o.data.models[0].id,n={method:"delete",url:d,data:i},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"删除成功",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:n,success:r})},parameterMap:function(t,e){if(console.log(e),"read"!==e&&t.models)return{models:kendo.stringify(t.models)}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,schema:{model:{id:"taskId",fields:{taskId:{from:"id"},title:{from:"addressName",defaultValue:"会议室"},start:{type:"date",from:"beginTime"},end:{type:"date",from:"endTime"}}}}});e.schedulerOptions={date:new Date,startTime:e.startDateTime,endTime:e.endDateTime,height:600,views:["day","workWeek",{type:"week",selected:!0},"month"],editable:{template:$("#customEditorTemplate").html()},eventTemplate:$("#event-template").html(),timezone:"Etc/UTC",dataSource:o,footer:!1}}function n(e){t.get(d+"/meeting").success(function(t){e.meetings={},e.meetings=t}).error(function(t){})}function r(t){t.mrID?t.schedulerOptions.dataSource.read({mrID:common.format("$filter=mrID eq '{0}'",t.mrID)}):t.schedulerOptions.dataSource.read()}function a(){window.open(d+"/exports")}function c(){window.open(d+"/exportWeek")}function l(){window.open(d+"/exportNextWeek")}function s(){window.open(d+"/stageNextWeek")}var d=rootPath+"/room";return{initRoom:i,showMeeting:n,findMeeting:r,exportWeek:a,exportThisWeek:c,exportNextWeek:l,stageNextWeek:s,addRoom:o,editRoom:e}}angular.module("app").factory("roomSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o){var i=this;i.model={},i.title="新增收文",i.create=function(){e.createSign(i)}}angular.module("app").controller("signCreateCtrl",t),t.$inject=["$location","signSvc","$state"]}(),function(){"use strict";function t(t,e,o,i,n){var r=this;r.title="收文列表",e.grid(r),r.querySign=function(){e.querySign(r)},r.del=function(t){common.confirm({vm:r,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteSign(r,t)}})},r.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:r,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var i=e.join(",");r.del(i)}},r.startFlow=function(t){common.confirm({vm:r,title:"",msg:"发起流程后，将不能对信息进行修改，确认发起流程么？",fn:function(){$(".confirmDialog").modal("hide"),e.startFlow(r,t)}})},r.stopFlow=function(t){common.confirm({vm:r,title:"",msg:"停止流程后，将无法对流程环节进行操作，确认停止么？",fn:function(){$(".confirmDialog").modal("hide"),i.suspend(r,t)}})},r.restartFlow=function(t){common.confirm({vm:r,title:"",msg:"确认重启流程么？",fn:function(){$(".confirmDialog").modal("hide"),i.activeFlow(r,t)}})},r.startNewFlow=function(t){common.confirm({vm:r,title:"",msg:"确认签收完成了么？",fn:function(){$(".confirmDialog").modal("hide"),n.startFlow(r,t)}})}}angular.module("app").controller("signCtrl",t),t.$inject=["$location","signSvc","$state","flowSvc","signFlowSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.model={},i.title="填写报审登记表",i.model.signid=o.params.signid,i.flowDeal=!1,e.initFillData(i),i.updateFillin=function(){e.updateFillin(i)},i.findOfficeUsersByDeptId=function(t){e.findOfficeUsersByDeptId(i,t)},i.regNumber=function(){e.regNumber(i)},$("#addOriginal").click(function(){e.add(i)}),$("#addCopy").click(function(){e.add(i)}),$("#sugFileDealOriginal").click(function(){e.sugFileDealOriginal(i)}),$("#sugFileDealCopy").click(function(){e.sugFileDealCopy(i)}),$("#sugOrgApplyOriginal").click(function(){e.sugOrgApplyOriginal(i)}),$("#sugOrgApplyCopy").click(function(){e.sugOrgApplyCopy(i)}),$("#sugOrgReqOriginal").click(function(){e.sugOrgReqOriginal(i)}),$("#sugOrgReqCopy").click(function(){e.sugOrgReqCopy(i)}),$("#sugProAdviseOriginal").click(function(){e.sugProAdviseOriginal(i)}),$("#sugProAdviseCopy").click(function(){e.sugProAdviseCopy(i)}),$("#proSugEledocOriginal").click(function(){e.proSugEledocOriginal(i)}),$("#proSugEledocCopy").click(function(){e.proSugEledocCopy(i)}),$("#sugMeetOriginal").click(function(){e.sugMeetOriginal(i)}),$("#sugMeetCopy").click(function(){e.sugMeetCopy(i)}),$("#studyPealOriginal").click(function(){e.studyPealOriginal(i)}),$("#studyProDealCopy").click(function(){e.studyProDealCopy(i)}),$("#studyFileDealOriginal").click(function(){e.studyFileDealOriginal(i)}),$("#studyFileDealCopy").click(function(){e.studyFileDealCopy(i)}),$("#studyOrgApplyOriginal").click(function(){e.studyOrgApplyOriginal(i)}),$("#studyOrgApplyCopy").click(function(){e.studyOrgApplyCopy(i)}),$("#studyOrgReqOriginal").click(function(){e.studyOrgReqOriginal(i)}),$("#studyOrgReqCopy").click(function(){e.studyOrgReqCopy(i)}),$("#studyProSugOriginal").click(function(){e.studyProSugOriginal(i)}),$("#studyProSugCopy").click(function(){e.studyProSugCopy(i)}),$("#studyMeetOriginal").click(function(){e.studyMeetOriginal(i)}),$("#studyMeetCopy").click(function(){e.studyMeetCopy(i)}),$("#envproReplyOriginal").click(function(){e.envproReplyOriginal(i)}),$("#envproReplyCopy").click(function(){e.envproReplyCopy(i)}),$("#planAddrOriginal").click(function(){e.planAddrOriginal(i)}),$("#planAddrCopy").click(function(){e.planAddrCopy(i)}),$("#reportOrigin").click(function(){e.reportOrigin(i)}),$("#reportCopy").click(function(){e.reportCopy(i)}),$("#eledocOriginal").click(function(){e.eledocOriginal(i)}),$("#eledocCopy").click(function(){e.eledocCopy(i)}),$("#energyOriginal").click(function(){e.energyOriginal(i)}),$("#energyCopy").click(function(){e.energyCopy(i)})}angular.module("app").controller("signFillinCtrl",t),t.$inject=["$location","signSvc","$state"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="项目待处理",e.pendingSign(i)}angular.module("app").controller("signFlowCtrl",t),t.$inject=["$location","signFlowSvc","$state"]}(),function(){"use strict";function t(t,e,o,i){var n=this;n.title="已办结项目详情",n.model={},n.flow={},n.model.signid=o.params.signid,n.flow.processInstanceId=o.params.processInstanceId,n.flow.hideFlowImg=!0,function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var o=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+o).addClass("active").addClass("in").show(500)}),i.initFlowData(n),e.endSignDetail(n)}()}angular.module("app").controller("signEndCtrl",t),t.$inject=["$location","signFlowSvc","$state","flowSvc"]}(),function(){"use strict";function t(t,e){function o(e,o){var i={method:"post",url:rootPath+"/sign/html/startNewFlow",params:{signid:o}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read(),common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function i(t){var e=common.kendoGridDataSource(rootPath+"/sign/html/pendingSign"),o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:30},{field:"projectname",title:"项目名称",width:200,filterable:!0},{field:"projectcode",title:"项目编号",width:200,filterable:!0},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(t){var e=!1;return t.folwState&&2==t.folwState&&(e=!0),common.format($("#columnBtns").html(),t.signid,t.taskId,t.processInstanceId,e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})}}}function n(t){"XMFZR_SP_GZFA1"==t.flow.curNode.activitiId?(t.businessTr=!0,t.XMFZR_SP_GZFA=!0,t.model.isreviewCompleted&&9==t.model.isreviewCompleted&&(t.show_workprogram=!0,$("#show_workprogram_a").click())):"XMFZR_SP_GZFA2"==t.flow.curNode.activitiId?(t.businessTr=!0,t.XMFZR_SP_GZFA=!0,t.model.isreviewACompleted&&9==t.model.isreviewACompleted&&(t.show_workprogram=!0,$("#show_workprogram_a").click())):"BZ_SP_GZAN1"==t.flow.curNode.activitiId||"FGLD_SP_GZFA1"==t.flow.curNode.activitiId?(t.show_workprogram=!0,$("#show_workprogram_a").click()):"BZ_SP_GZAN2"==t.flow.curNode.activitiId||"FGLD_SP_GZFA2"==t.flow.curNode.activitiId?(t.show_workprogram=!0,$("#show_workprogram_a").click()):"FW_SQ"==t.flow.curNode.activitiId?(t.businessTr=!0,t.FW_SQ=!0,t.model.isDispatchCompleted&&t.model.isDispatchCompleted>=0&&(t.show_dispatch=!0,$("#show_dispatch_a").click())):"BZ_SP_FW"==t.flow.curNode.activitiId||"FGLD_SP_FW"==t.flow.curNode.activitiId||"ZR_SP_FW"==t.flow.curNode.activitiId?(t.show_dispatch=!0,$("#show_dispatch_a").click()):"MFZR_GD"==t.flow.curNode.activitiId?(t.businessTr=!0,t.MFZR_GD=!0,t.model.filenum&&(t.show_filerecord=!0,$("#show_filerecord_a").click())):"AZFR_SP_GD"!=t.flow.curNode.activitiId&&"BMLD_QR_GD"!=t.flow.curNode.activitiId||(t.show_filerecord=!0,$("#show_filerecord_a").click())}function r(t){t.flow.businessMap={};var e=0;return"ZHB_SP_SW"==t.flow.curNode.activitiId?!!$("#viceDirector").val()&&(t.flow.businessMap.FGLD=$("#viceDirector").val(),!0):"FGLD_SP_SW"==t.flow.curNode.activitiId?($('.seleteTable input[selectType="main"]:checked').each(function(){t.flow.businessMap.hostdept=$(this).val(),e++}),0!=e&&($('.seleteTable input[selectType="assist"]:checked').each(function(){t.flow.businessMap.assistdept=$(this).val()}),!0)):"BM_FB1"==t.flow.curNode.activitiId||"BM_FB2"==t.flow.curNode.activitiId?($('.seleteTable input[selectType="main"]:checked').each(function(){t.flow.businessMap.M_USER_ID=$(this).val(),e++}),0!=e&&($('.seleteTable input[selectType="assist"]:checked').each(function(){t.flow.businessMap.A_USER_ID=$(this).val()}),!0)):"XMFZR_SP_GZFA1"==t.flow.curNode.activitiId?!(!t.model.isreviewCompleted||9!=t.model.isreviewCompleted):"XMFZR_SP_GZFA2"==t.flow.curNode.activitiId?!(!t.model.isreviewACompleted||9!=t.model.isreviewACompleted):"BZ_SP_GZAN1"==t.flow.curNode.activitiId||"FGLD_SP_GZFA1"==t.flow.curNode.activitiId?(t.flow.businessMap.M_WP_ID=t.mainwork.id,!0):"BZ_SP_GZAN2"==t.flow.curNode.activitiId||"FGLD_SP_GZFA2"==t.flow.curNode.activitiId?(t.flow.businessMap.A_WP_ID=t.assistwork.id,!0):"FW_SQ"==t.flow.curNode.activitiId?!(!t.model.isDispatchCompleted||9!=t.model.isDispatchCompleted):"BZ_SP_FW"==t.flow.curNode.activitiId||"FGLD_SP_FW"==t.flow.curNode.activitiId||"ZR_SP_FW"==t.flow.curNode.activitiId?(t.flow.businessMap.DIS_ID=t.dispatchDoc.id,!0):"MFZR_GD"!=t.flow.curNode.activitiId||!!t.model.filenum}function a(e,o){var i=1==o?"9":"0",n={method:"get",url:rootPath+"/workprogram/html/initWorkBySignId",params:{signId:e.model.signid,isMain:i}},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.work=t.data,$("#show_workprogram_a").click()}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}function c(e){var o={method:"get",url:rootPath+"/dispatch/html/initDispatchBySignId",params:{signId:e.model.signid}},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.dispatchDoc=t.data,$("#show_dispatch_a").click()}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function l(e){var o={method:"get",url:rootPath+"/fileRecord/html/initBySignId",params:{signId:e.model.signid}},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.fileRecord=t.data,$("#show_filerecord_a").click()}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function s(e){var o={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e.model.signid,queryAll:!0}},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model=t.data,e.model.workProgramDtoList&&(e.mainwork={},e.show_workprogram=!0,e.model.workProgramDtoList.length>0?(e.showAssistwork=!0,e.assistwork={},9==e.model.workProgramDtoList[0].isMain?(e.mainwork=e.model.workProgramDtoList[0],e.assistwork=e.model.workProgramDtoList[1]):(e.assistwork=e.model.workProgramDtoList[0],e.mainwork=e.model.workProgramDtoList[1])):e.mainwork=e.model.workProgramDtoList[0]),e.model.dispatchDocDto&&(e.show_dispatch=!0,e.dispatchDoc=e.model.dispatchDocDto),e.model.fileRecordDto&&(e.show_filerecord=!0,e.fileRecord=e.model.fileRecordDto)}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}return{startFlow:o,pendingSign:i,initBusinessParams:n,checkBusinessFill:r,getChargeWorkProgram:a,getChargeDispatch:c,getChargeFilerecord:l,endSignDetail:s}}angular.module("app").factory("signFlowSvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e,o,i,n){var r=this;r.title="项目流程处理",r.model={},r.flow={},r.work={},r.dispatchDoc={},r.fileRecord={},r.model.signid=o.params.signid,r.flow.taskId=o.params.taskId,r.flow.processInstanceId=o.params.processInstanceId,function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var o=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+o).addClass("active").addClass("in").show(500)}),i.initFlowData(r),e.initFlowPageData(r)}(),r.commitNextStep=function(){n.checkBusinessFill(r)?i.commit(r):common.alert({vm:r,msg:"请先完成相应的业务操作才能提交"})},r.commitBack=function(){i.rollBack(r)},r.deleteFlow=function(){common.confirm({vm:r,title:"",msg:"终止流程将无法恢复，确认挂起么？",fn:function(){$(".confirmDialog").modal("hide"),i.deleteFlow(r)}})},r.initDealUerByAcitiviId=function(){i.initDealUerByAcitiviId(r)},r.showBtByAcivitiId=function(t){return r.flow.curNodeAcivitiId==t},r.addWorkProgram=function(){o.go("workprogramEdit",{signid:r.model.signid})},r.addDisPatch=function(){o.go("dispatchEdit",{signid:r.model.signid})},r.addDoFile=function(){o.go("fileRecordEdit",{signid:r.model.signid})},r.checkBox=function(t,e,o){var i=t.target,n=i.checked,r=i.value;n?$('.seleteTable input[selectType="'+e+'"]').each(function(){var t=$(this).attr("id"),i=$(this).attr("value");t!=e+"_"+r?($("#"+o+"_"+i).removeAttr("disabled"),$(this).removeAttr("checked")):$("#"+o+"_"+r).attr("disabled","disabled")}):$("#"+o+"_"+r).removeAttr("disabled")}}angular.module("app").controller("signFlowDealCtrl",t),t.$inject=["$location","signSvc","$state","flowSvc","signFlowSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.model={},i.title="查看详情信息",i.model.signid=o.params.signid,e.initDetailData(i)}angular.module("app").controller("signDetailsCtrl",t),t.$inject=["$location","signSvc","$state"]}(),function(){"use strict";function t(t,e,o){function i(t){null==t.model.sugProDealOriginal&&(t.model.sugProDealCount=1),9==t.model.sugProDealOriginal&&(t.model.sugProDealCount=""),0==t.model.sugProDealOriginal&&(t.model.sugProDealCount=1)}function n(t){null==t.model.sugProDealCopy&&(t.model.sugProDealCount=1),9==t.model.sugProDealCopy&&(t.model.sugProDealCount=""),0==t.model.sugProDealCopy&&(t.model.sugProDealCount=1)}function r(t){null==t.model.sugFileDealOriginal&&(t.model.sugFileDealCount=1),9==t.model.sugFileDealOriginal&&(t.model.sugFileDealCount=""),0==t.model.sugFileDealOriginal&&(t.model.sugFileDealCount=1)}function a(t){null==t.model.sugFileDealCopy&&(t.model.sugFileDealCount=1),9==t.model.sugFileDealCopy&&(t.model.sugFileDealCount=""),0==t.model.sugFileDealCopy&&(t.model.sugFileDealCount=1)}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/fingByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"projectname",title:"项目名称",width:160,filterable:!1},{field:"projectcode",title:"收文编号",width:160,filterable:!1},{field:"designcompanyName",title:"项目单位",width:160,filterable:!1},{field:"reviewstage",title:"项目阶段",width:160,filterable:!1},{field:"projectcode",title:"项目代码",width:160,filterable:!1},{field:"receivedate",title:"收文时间",width:160,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"流程状态",width:160,filterable:!1,template:function(t){return t.folwState?1==t.folwState?'<span style="color:green;">进行中</span>':2==t.folwState?'<span style="color:orange;">已暂停</span>':8==t.folwState?'<span style="color:red;">强制结束</span>':9==t.folwState?'<span style="color:blue;">已完成</span>':void 0:"未发起"}},{field:"",title:"操作",width:180,template:function(t){var e=!1,o=!0,i=!0;return t.folwState&&t.folwState>0&&(e=!0,1==t.folwState&&(o=!1),2==t.folwState&&(i=!1)),common.format($("#columnBtns").html(),t.signid,t.folwState,t.signid,"vm.del('"+t.signid+"')",e,"vm.startNewFlow('"+t.signid+"')",e,"vm.stopFlow('"+t.signid+"')",o,"vm.restartFlow('"+t.signid+"')",i)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0}}function l(t){t.gridOptions.dataSource.read()}function s(o){if(common.initJqValidation(),$("form").valid()){var i={method:"post",url:rootPath+"/sign",data:o.model},n=function(t){common.requestSuccess({vm:o,response:t,fn:function(){common.alert({vm:o,msg:"操作成功,请继续填写报审登记表！",closeDialog:!0,fn:function(){e.go("fillSign",{signid:t.data.signid})}})}})};common.http({vm:o,$http:t,httpOptions:i,success:n})}}function d(e,o){var i={};i.deptId="main"==o?e.model.maindepetid:e.model.assistdeptid;var n={method:"post",url:rootPath+"/officeUser/findOfficeUserByDeptId",params:i},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){"main"==o?(e.mainOfficeList={},e.mainOfficeList=t.data):(e.assistOfficeList={},e.assistOfficeList=t.data)}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}function m(e){if(common.initJqValidation($("#sign_fill_form")),$("#sign_fill_form").valid()){var o={method:"put",url:rootPath+"/sign",data:e.model},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}}function u(e,o){e.isSubmit=!0;var i={method:"delete",url:rootPath+"/sign",data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function f(e){var o={method:"get",url:rootPath+"/sign/html/initFillPageData",params:{signid:e.model.signid}},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model=t.data.sign,e.deptlist=t.data.deptlist,t.data.mainOfficeList&&(e.mainOfficeList=t.data.mainOfficeList),t.data.assistOfficeList&&(e.assistOfficeList=t.data.assistOfficeList),e.builtcomlist=t.data.builtcomlist,e.designcomlist=t.data.designcomlist}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function p(e){var o={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e.model.signid}},i=function(t){
common.requestSuccess({vm:e,response:t,fn:function(){console.log(t.data),e.model=t.data}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function h(e){var i={method:"get",url:rootPath+"/sign/html/initFlowPageData",params:{signid:e.model.signid,queryAll:!0}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model=t.data,e.model.workProgramDtoList&&e.model.workProgramDtoList.length>0&&(e.show_workprogram=!0,e.model.workProgramDtoList.forEach(function(t,o){9==t.isMain?(e.showMainwork=!0,e.mainwork={},e.mainwork=t):0==t.isMain&&(e.showAssistwork=!0,e.assistwork={},e.assistwork=t)})),e.model.dispatchDocDto&&(e.show_dispatch=!0,e.dispatchDoc=e.model.dispatchDocDto),e.model.fileRecordDto&&(e.show_filerecord=!0,e.fileRecord=e.model.fileRecordDto),o.getFlowInfo(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}return{grid:c,querySign:l,createSign:s,initFillData:f,initDetailData:p,updateFillin:m,deleteSign:u,findOfficeUsersByDeptId:d,initFlowPageData:h,add:i,addCopy:n,sugFileDealOriginal:r,sugFileDealCopy:a}}angular.module("app").factory("signSvc",t),t.$inject=["$http","$state","flowSvc"]}(),function(){"use strict";function t(t,e){var o=this;o.title="用户列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteUser(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryUser=function(){e.queryUser(o)},function(){e.grid(o)}()}angular.module("app").controller("userCtrl",t),t.$inject=["$location","userSvc"]}(),function(){"use strict";function t(t,e,o){var i=this;i.title="添加用户",i.isuserExist=!1,i.id=o.params.id,i.id&&(i.isUpdate=!0,i.title="更新用户"),i.create=function(){e.createUser(i)},i.update=function(){e.updateUser(i)},function(){i.isUpdate?e.getUserById(i):e.initZtreeClient(i),e.getOrg(i)}()}angular.module("app").controller("userEditCtrl",t),t.$inject=["$location","userSvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var o=s(),i=$linq(o).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();e.model.roles=i;var n={method:"put",url:m,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}}function o(e,o){e.isSubmit=!0;var i={method:"delete",url:m,data:o},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o=s(),i=$linq(o).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();e.model.roles=i;var n={method:"post",url:m,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=u}})}})};common.http({vm:e,$http:t,httpOptions:n,success:r})}}function n(e){var o={method:"get",url:common.format(m+"/getOrg")},i=function(t){e.org={},e.org=t.data};common.http({vm:e,$http:t,httpOptions:o,success:i})}function r(e){var o={method:"post",url:f},i=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var o={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},i=$linq(t.data.value).select(function(t){return{id:t.id,name:t.roleName}}).toArray(),n={id:"",name:"角色集合",children:i};$.fn.zTree.init($("#zTree"),o,n),e.isUpdate&&d(e)}})};common.http({vm:e,$http:t,httpOptions:o,success:i})}function a(e){var o={method:"POST",url:common.format(m+"/fingByOData?$filter=id eq '{0}'",e.id)},i=function(t){e.model=t.data.value[0],e.isUpdate&&r(e)};common.http({vm:e,$http:t,httpOptions:o,success:i})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/fingByOData?$orderby=userSort",$("#usersform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),o=function(){var t=this.items(),e=this.pager.page()-1,o=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*o,i=$(this).find(".row-number");$(i).html(t)})},i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"loginName",title:"登录名",width:100,filterable:!1},{field:"displayName",title:"显示名",width:100,filterable:!1},{field:"userMPhone",title:"联系手机",width:120,filterable:!1},{field:"orgDto.name",title:"所属部门",width:100,filterable:!1},{field:"userIP",title:"登录IP",width:160,filterable:!1},{field:"lastLogin",title:"最后登录时间",width:160,filterable:!1},{field:"",title:"所属角色",width:160,filterable:!1,template:function(t){if(t.roles){for(var e="",o=0,i=t.roles.length;o<i;o++)e+=0==o?t.roles[o].roleName:", "+t.roles[o].roleName;return e}return" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:o,resizable:!0}}function l(t){t.gridOptions.dataSource.read()}function s(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function d(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),o=$linq(t.model.roles).select(function(t){return t.roleName}).toArray(),i=e.getNodesByParam("level",1,null),n=$linq(i).where(function(t){return $linq(o).contains(t.name)}).toArray(),r=0,a=n.length;r<a;r++)e.checkNode(n[r],!0,!0)}var m=rootPath+"/user",u="#/user",f=rootPath+"/role/fingByOData";rootPath;return{grid:c,getUserById:a,initZtreeClient:r,createUser:i,deleteUser:o,updateUser:e,getOrg:n,queryUser:l}}angular.module("app").factory("userSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,o){var i=this;i.work={},i.title="创建评审方案",i.startDateTime=new Date("2006/6/1 08:00"),i.endDateTime=new Date("2030/6/1 21:00"),i.work.signId=o.params.signid,i.isRoomBook=!1,i.isHavePre=!1,i.isHaveNext=!1,function(){e.initPage(i),e.findAllMeeting(i),e.findCompanys(i),e.waitProjects(i)}(),i.mergeAddWork=function(t){e.mergeAddWork(t)},i.reviewType=function(){if("合并评审"==i.work.isSigle);else;},i.mainIschecked=function(){i.isHideProject=!1},i.subIschecked=function(){i.isHideProject=!0},i.gotoProjcet=function(){e.gotoProjcet(i)},i.selectworkProject=function(){e.selectworkProject(i)},i.cancelworkProject=function(){e.cancelworkProject(i)},i.addTimeStage=function(){i.isRoomBook?$("#stageWindow").kendoWindow({width:"660px",height:"550px",title:"会议预定添加",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():i.work.id?o.go("room",{workProgramId:i.work.id}):common.alert({vm:i,msg:"请先保存，再选择评审会日期！"})},i.ministerSugges=function(t){e.ministerSugges(t)},i.saveRoom=function(){e.saveRoom(i)},i.gotoRoom=function(){window.parent.$("#stageWindow").data("kendoWindow").close(),i.work.id?o.go("room",{workProgramId:i.work.id}):common.alert({vm:i,msg:"请先保存！"})},i.nextBookRoom=function(){var t=0;i.RoomBookings.forEach(function(e,o){e.id==i.roombook.id&&(t=o)}),i.isHavePre=!0,t==i.RoomBookings.length-2?i.isHaveNext=!1:i.isHaveNext=!0,i.roombook=i.RoomBookings[t+1]},i.preBookRoom=function(){var t=0;i.RoomBookings.forEach(function(e,o){e.id==i.roombook.id&&(t=o)}),i.isHaveNext=!0,i.isHavePre=1!=t,i.roombook=i.RoomBookings[t-1]},i.onRoomClose=function(){window.parent.$("#stageWindow").data("kendoWindow").close()},i.queryRoom=function(){e.queryRoom(i)},i.findUsersByOrgId=function(t){e.findUsersByOrgId(i,t)},i.create=function(){e.createWP(i)},i.selectExpert=function(){e.selectExpert(i)},i.findReviewDept=function(){}}angular.module("app").controller("workprogramEditCtrl",t),t.$inject=["$location","workprogramSvc","$state"]}(),function(){"use strict";function t(t,e,o){function i(t){var o={method:"get",url:rootPath+"/workprogram/workAddDispa",params:{signId:t.dispatchDoc.signId,linkSignId:t.linkSignId}},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){window.parent.$("#stageWorkWindow").data("kendoWindow").close(),common.alert({vm:t,msg:"操作成功,请继续处理流程！!!",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}function n(t){var o={method:"post",url:rootPath+"/workprogram/selectedProject",params:{linkSignIds:t.linkSignId}},i=function(e){t.selectedSign=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i})}function r(t){var e=t.linkSignId,o=$("input[name='checkcancel']:checked");o&&($.each(o,function(t,o){e=0==e.lastIndexOf(o.value)?e.replace(o.value,""):e.replace(","+o.value,"")}),t.linkSignId=e,n(t),c(t))}function a(t){var e=t.linkSignId,o=$("input[name='checkwork']:checked"),i=[];o&&($.each(o,function(t,e){i.push(e.value)}),e?e+=","+i.join(","):e=i.join(","),t.linkSignId=e,n(t),c(t))}function c(t){var o={method:"post",url:common.format(w+"/waitProjects")},i=function(e){t.signs={},t.signs=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i})}function l(t){$("#stageWorkWindow").kendoWindow({width:"1200px",height:"630px",title:"合并评审",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),getSeleSignBysId(t),getsign(t)}function s(t){$("#ministerSug").kendoWindow({width:"700px",height:"400px",title:"部长处理意见",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function d(t){if(common.initJqValidation($("#stageForm")),$("#stageForm").valid()){if(t.roombook.workProgramId=t.work.id,t.roombook.stageOrg=t.work.reviewOrgName,t.roombook.stageProject="项目名称:"+t.work.projectName+":"+t.work.buildCompany+":"+t.work.reviewOrgName,t.roombook.beginTimeStr=$("#beginTime").val(),t.roombook.endTimeStr=$("#endTime").val(),$("#endTime").val()<$("#beginTime").val())return void $("#errorTime").html("开始时间不能大于结束时间!");t.roombook.beginTime=$("#rbDay").val()+" "+$("#beginTime").val()+":00",t.roombook.endTime=$("#rbDay").val()+" "+$("#endTime").val()+":00";var o={method:"post",url:rootPath+"/room/saveRoom",data:t.roombook},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){window.parent.$("#stageWindow").data("kendoWindow").close(),common.alert({vm:t,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:t,$http:e,httpOptions:o,success:i})}}function m(t){var o={method:"get",url:common.format(rootPath+"/room/meeting")},i=function(e){t.roombookings={},t.roombookings=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i})}function u(t){var o={method:"get",url:common.format(v+"/findCcompanys")},i=function(e){t.companys={},t.companys=e.data};common.http({vm:t,$http:e,httpOptions:o,success:i})}function f(t,o){var i={};"main"==o&&(i.orgId=t.work.reviewDept);var n={method:"get",url:rootPath+"/user/findUsersByOrgId",params:i},r=function(e){common.requestSuccess({vm:t,response:e,fn:function(){"main"==o&&(t.mainUserList={},t.mainUserList=e.data)}})};common.http({vm:t,$http:e,httpOptions:n,success:r})}function p(t){var i={method:"get",url:rootPath+"/workprogram/html/initWorkBySignId",params:{signId:t.work.signId}},n=function(e){common.requestSuccess({vm:t,response:e,fn:function(){null!=e.data&&""!=e.data&&(t.work=e.data,t.work.signId=o.params.signid,e.data.roomBookingDtos&&e.data.roomBookingDtos.length>0&&(t.isRoomBook=!0,t.RoomBookings={},t.RoomBookings=e.data.roomBookingDtos,t.roombook=t.RoomBookings[0],t.RoomBookings.length>1&&(t.isHaveNext=!0)))}})};common.http({vm:t,$http:e,httpOptions:i,success:n})}function h(t){if(common.initJqValidation($("#work_program_form")),$("#work_program_form").valid()){t.iscommit=!0;var o={method:"post",url:rootPath+"/workprogram/addWork",data:t.work},i=function(e){common.requestSuccess({vm:t,response:e,fn:function(){t.iscommit=!1,t.work.id=e.data.id,common.alert({vm:t,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:t,$http:e,httpOptions:o,success:i,onError:function(e){t.iscommit=!1}})}}function g(t){t.work.id&&""!=t.work.id?o.go("expertReviewEdit",{workProgramId:t.work.id}):common.alert({vm:t,msg:"请先保存，再继续执行操作！"})}var v=(rootPath,rootPath+"/company"),w=rootPath+"/workprogram";return{initPage:p,createWP:h,findCompanys:u,findUsersByOrgId:f,selectExpert:g,saveRoom:d,ministerSugges:s,findAllMeeting:m,gotoProjcet:l,waitProjects:c,selectedProject:n,selectworkProject:a,cancelworkProject:r,mergeAddWork:i}}angular.module("app").factory("workprogramSvc",t),t.$inject=["$rootScope","$http","$state"]}();