!function(){"use strict";angular.module("app",["ui.router","kendo.directives","angular-loading-bar","ngAnimate","ngFileSaver"]).filter("trust2Html",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).config(["cfpLoadingBarProvider",function(t){t.parentSelector="#loading-bar-container",t.spinnerTemplate='<div style="position:fixed;width:100%;height:100%;left:0;top:0; z-index:10001;background:rgba(0, 0, 0, 0.3);overflow: hidden;"><div style="position: absolute;top:30%; width: 400px;height:40px;left:50%;"><i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i>数据加载中...</div></div>'}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/welcome"),t.state("welcome",{url:"/welcome",templateUrl:rootPath+"/admin/welcome.html",controller:"adminWelComeCtrl",controllerAs:"vm"}).state("gtasks",{url:"/gtasks",templateUrl:rootPath+"/admin/gtasks.html",controller:"adminCtrl",controllerAs:"vm"}).state("agendaTasks",{url:"/agendaTasks",templateUrl:rootPath+"/admin/agendaTasks.html",controller:"adminAgendaCtrl",controllerAs:"vm"}).state("doingTasks",{url:"/doingTasks",templateUrl:rootPath+"/admin/doingTasks.html",controller:"adminDoTaskCtrl",controllerAs:"vm"}).state("flowDeal",{url:"/flowDeal/:businessKey/:processKey/:taskId/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowDeal/"+t.processKey+".html"},controller:"flowDealCtrl",controllerAs:"vm"}).state("flowDetail",{url:"/flowDetail/:businessKey/:processKey/:taskId/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowDetail/"+t.processKey+".html"},controller:"flowDetailCtrl",controllerAs:"vm"}).state("flowEnd",{url:"/flowEnd/:businessKey/:processKey/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowEnd/"+t.processKey+".html"},controller:"flowEndCtrl",controllerAs:"vm"}).state("addSupp",{url:"/addSupp/:businessId/:businessType",templateUrl:rootPath+"/addSuppLetter/edit.html",controller:"addSuppLetterCtrl",controllerAs:"vm"}).state("addSuppletterList",{url:"/addSuppletterList/:businessId",templateUrl:rootPath+"/addSuppLetter/list.html",controller:"addSuppLetterListCtrl",controllerAs:"vm"}).state("addSuppLetterEdit",{url:"/addSuppLetterEdit/:id",templateUrl:rootPath+"/addSuppLetter/editUpload.html",controller:"addSuppLetterEditCtrl",controllerAs:"vm"}).state("suppLetterView",{url:"/suppLetterView/:id",templateUrl:rootPath+"/addSuppLetter/view.html",controller:"suppLetterViewCtrl",controllerAs:"vm"}).state("suppletterList",{url:"/suppletterList",templateUrl:rootPath+"/addSuppLetter/suppLetterList.html",controller:"addSuppLetterQueryCtrl",controllerAs:"vm"}).state("querySuppLetterDetail",{url:"/querySuppLetterDetail/:id",templateUrl:rootPath+"/addSuppLetter/detail.html",controller:"addSuppLetterQueryEditCtrl",controllerAs:"vm"}).state("suppLetterApproveEdit",{url:"/suppLetterApproveEdit/:id",templateUrl:rootPath+"/addSuppLetter/suppLetterApproveEdit.html",controller:"addSuppLetterQueryEditCtrl",controllerAs:"vm"}).state("registerFile",{url:"/registerFile/:businessId/",templateUrl:rootPath+"/addRegisterFile/list.html",controller:"addRegisterFileCtrl",controllerAs:"vm"}).state("dtasks",{url:"/dtasks",templateUrl:rootPath+"/admin/dtasks.html",controller:"adminDoingCtrl",controllerAs:"vm"}).state("personDtasks",{url:"/personDtasks",templateUrl:rootPath+"/sign/personDtasks.html",controller:"adminPersonDoingCtrl",controllerAs:"vm"}).state("etasks",{url:"/etasks",templateUrl:rootPath+"/sign/etasks.html",controller:"adminEndCtrl",controllerAs:"vm"}).state("role",{url:"/role",templateUrl:rootPath+"/role/html/list.html",controller:"roleCtrl",controllerAs:"vm"}).state("roleEdit",{url:"/roleEdit/:id",templateUrl:rootPath+"/role/html/edit.html",controller:"roleEditCtrl",controllerAs:"vm"}).state("user",{url:"/user",templateUrl:rootPath+"/user/html/list.html",controller:"userCtrl",controllerAs:"vm"}).state("userEdit",{url:"/userEdit/:id",templateUrl:rootPath+"/user/html/edit.html",controller:"userEditCtrl",controllerAs:"vm"}).state("org",{url:"/org",templateUrl:rootPath+"/org/html/list.html",controller:"orgCtrl",controllerAs:"vm"}).state("orgEdit",{url:"/orgEdit/:id",templateUrl:rootPath+"/org/html/edit.html",controller:"orgEditCtrl",controllerAs:"vm"}).state("orgUser",{url:"/orgUser/:id",templateUrl:rootPath+"/org/html/orgUser.html",controller:"orgUserCtrl",controllerAs:"vm"}).state("sysdept",{url:"/sysdept",templateUrl:rootPath+"/sysdept/html/list.html",controller:"sysdeptCtrl",controllerAs:"vm"}).state("sysdeptEdit",{url:"/sysdeptEdit/:id",templateUrl:rootPath+"/sysdept/html/edit.html",controller:"sysdeptEditCtrl",controllerAs:"vm"}).state("sysdeptUser",{url:"/sysdeptUser/:id",templateUrl:rootPath+"/sysdept/html/sysdeptUser.html",controller:"sysdeptUserCtrl",controllerAs:"vm"}).state("log",{url:"/log",templateUrl:rootPath+"/log/html/list.html",controller:"logCtrl",controllerAs:"vm"}).state("config",{url:"/config",templateUrl:rootPath+"/sysConfig/html/list.html",controller:"sysConfigCtrl",controllerAs:"vm"}).state("upload",{url:"/upload/:uploadid",templateUrl:rootPath+"/upload/html/edit.html",controller:"uploadEditCtrl",controllerAs:"vm"}).state("meeting",{url:"/meeting",templateUrl:rootPath+"/meeting/html/list.html",controller:"meetingCtrl",controllerAs:"vm"}).state("meetingEdit",{url:"/meetingEdit/:id",templateUrl:rootPath+"/meeting/html/edit.html",controller:"meetingEditCtrl",controllerAs:"vm"}).state("room",{url:"/room/:businessId/:businessType",templateUrl:rootPath+"/room/html/roomlist.html",controller:"roomCtrl",controllerAs:"vm"}).state("roomCount",{url:"/roomCount/:id",templateUrl:rootPath+"/room/html/countlist.html",controller:"roomCountCtrl",controllerAs:"vm"}).state("company",{url:"/company",templateUrl:rootPath+"/company/html/list.html",controller:"companyCtrl",controllerAs:"vm"}).state("companyEdit",{url:"/companyEdit/:id",templateUrl:rootPath+"/company/html/edit.html",controller:"companyEditCtrl",controllerAs:"vm"}).state("accountPwd",{url:"/accountPwd",templateUrl:rootPath+"/account/html/changePwd.html",controller:"homeCtrl",controllerAs:"vm"}).state("demo",{url:"/demo",templateUrl:rootPath+"/demo/html/list.html",controller:"demoCtrl",controllerAs:"vm"}).state("dict",{url:"/dict",templateUrl:rootPath+"/dict/html/list.html",controller:"dictCtrl",controllerAs:"vm"}).state("dict.edit",{url:"/edit/:id",templateUrl:rootPath+"/dict/html/edit.html",controller:"dictEditCtrl",controllerAs:"vm"}).state("expert",{url:"/expert",templateUrl:rootPath+"/expert/html/queryAllList.html",controller:"expertCtrl",controllerAs:"vm"}).state("expertAudit",{url:"/expertAudit",templateUrl:rootPath+"/expert/html/audit.html",controller:"expertAuditCtrl",controllerAs:"vm"}).state("expertRepeat",{url:"/expertRepeat",templateUrl:rootPath+"/expert/html/repeat.html",controller:"expertRepeatCtrl",controllerAs:"vm"}).state("expertEdit",{url:"/expertEdit/:expertID",templateUrl:rootPath+"/expert/html/edit.html",controller:"expertEditCtrl",controllerAs:"vm"}).state("expertReviewEdit",{url:"/expertReview/:businessId/:minBusinessId/:businessType",templateUrl:rootPath+"/expertReview/html/selectExpert.html",controller:"expertSelectCtrl",controllerAs:"vm"}).state("expertScore",{url:"/expertScore",templateUrl:rootPath+"/expert/html/scoreList.html",controller:"expertScoreCtrl",controllerAs:"vm"}).state("expertSelectHis",{url:"/expertSelectHis",templateUrl:rootPath+"/expert/html/selectHisList.html",controller:"expertSelectHisCtrl",controllerAs:"vm"}).state("addSign",{url:"/addSign",templateUrl:rootPath+"/sign/html/add.html",controller:"signCreateCtrl",controllerAs:"vm"}).state("fillSign",{url:"/fillSign/:signid",cache:"false",templateUrl:rootPath+"/sign/html/fillin.html",controller:"signFillinCtrl",controllerAs:"vm"}).state("listSign",{url:"/listSign",templateUrl:rootPath+"/sign/html/list.html",controller:"signCtrl",controllerAs:"vm"}).state("signFlowDeal",{url:"/signFlowDeal/:signid/:taskId/:processInstanceId",templateUrl:rootPath+"/sign/html/flowDeal.html",controller:"signFlowDealCtrl",controllerAs:"vm"}).state("signFlowDetail",{url:"/signFlowDetail/:signid/:taskId/:processInstanceId",templateUrl:rootPath+"/sign/html/signFlowDetail.html",controller:"signFlowDetailCtrl",controllerAs:"vm"}).state("signDetails",{url:"/signDetails/:signid/:processInstanceId",templateUrl:rootPath+"/sign/html/signDetails.html",controller:"signDetailsCtrl",controllerAs:"vm"}).state("endSignDetail",{url:"/endSignDetail/:signid/:processInstanceId",templateUrl:rootPath+"/sign/html/signEndDetails.html",controller:"signEndCtrl",controllerAs:"vm"}).state("signList",{url:"/signList",templateUrl:rootPath+"/signView/html/signList.html",controller:"adminSignListCtrl",controllerAs:"vm"}).state("projectStopInfo",{url:"/projectStopInfo/:signId",templateUrl:rootPath+"/projectStop/html/projectStopInfo.html",controller:"projectStopInfoCtrl",controllerAs:"vm"}).state("selectHeader",{url:"/selectHeader",templateUrl:rootPath+"/sign/html/selectHeader.html",controller:"selectHeaderCtrl",controllerAs:"vm"}).state("signGetBack",{url:"/signGetBack",templateUrl:rootPath+"/sign/html/signGetBack.html",controller:"signGetBackCtrl",controllerAs:"vm"}).state("pauseProject",{url:"/pauseProject",templateUrl:rootPath+"/projectStop/html/pauseProjectList.html",controller:"pauseProjectCtrl",controllerAs:"vm"}).state("projectStopForm",{url:"/projectStopForm/:signId/:stopId",templateUrl:rootPath+"/projectStop/html/projectStopForm.html",controller:"projectStopFormCtrl",controllerAs:"vm"}).state("projectStopFormEdit",{url:"/projectStopFormEdit/:stopId",templateUrl:rootPath+"/projectStop/html/projectStopForm.html",controller:"projectStopFormEditCtrl",controllerAs:"vm"}).state("reserveAdd",{url:"/reserveAdd",templateUrl:rootPath+"/sign/html/reserveAdd.html",controller:"signReserveAddCtrl",controllerAs:"vm"}).state("reserveList",{url:"/reserveList",templateUrl:rootPath+"/sign/html/reserveList.html",controller:"signReserveCtrl",controllerAs:"vm"}).state("reserveEdit",{url:"/reserveEdit",templateUrl:rootPath+"/sign/html/reserveList.html",controller:"signReserveCtrl",controllerAs:"vm"}).state("workprogramEdit",{url:"/workprogramEdit/:signid",templateUrl:rootPath+"/workprogram/html/edit.html",controller:"workprogramEditCtrl",controllerAs:"vm"}).state("dispatchEdit",{url:"/dispatchEdit/:signid",templateUrl:rootPath+"/dispatch/html/edit.html",controller:"dispatchEditCtrl",controllerAs:"vm"}).state("fileRecordEdit",{url:"/fileRecordEdit/:signid",templateUrl:rootPath+"/fileRecord/html/edit.html",controller:"fileRecordEditCtrl",controllerAs:"vm"}).state("assistPlan",{url:"/assistPlan",templateUrl:rootPath+"/assistPlan/html/manager.html",controller:"assistPlanCtrl",controllerAs:"vm"}).state("officeUserList",{url:"/officeUserList",templateUrl:rootPath+"/officeUser/html/list.html",controller:"officeUserCtrl",controllerAs:"vm"}).state("officeUserEdit",{url:"/officeUserEdit/:officeID",templateUrl:rootPath+"/officeUser/html/edit.html",controller:"officeUserEditCtrl",controllerAs:"vm"}).state("listDept",{url:"/listDept",templateUrl:rootPath+"/dept/html/list.html",controller:"deptCtrl",controllerAs:"vm"}).state("deptEdit",{url:"/deptEdit/:deptId",templateUrl:rootPath+"/dept/html/edit.html",controller:"deptEditCtrl",controllerAs:"vm"}).state("deptOfficeUser",{url:"/deptOfficeUser/:deptId",templateUrl:rootPath+"/dept/html/listOfficeUser.html",controller:"deptOfficeUserCtrl",controllerAs:"vm"}).state("assistUnit",{url:"/assistUnit",templateUrl:rootPath+"/assistUnit/html/assistUnitList.html",controller:"assistUnitCtrl",controllerAs:"vm"}).state("assistUnitEdit",{url:"/assistUnitEdit/:id",templateUrl:rootPath+"/assistUnit/html/assistUnitEdit.html",controller:"assistUnitEditCtrl",controllerAs:"vm"}).state("quartz",{url:"/quartz",templateUrl:rootPath+"/quartz/html/list.html",controller:"quartzCtrl",controllerAs:"vm"}).state("workday",{url:"/workday",templateUrl:rootPath+"/workday/html/list.html",controller:"workdayCtrl",controllerAs:"vm"}).state("workdayEdit",{url:"/workdayEdit/:id",templateUrl:rootPath+"/workday/html/edit.html",controller:"workdayEditCtrl",controllerAs:"vm"}).state("annountment",{url:"/annountment",templateUrl:rootPath+"/annountment/html/list.html",controller:"annountmentCtrl",controllerAs:"vm"}).state("annountmentEdit",{url:"/annountmentEdit/:id",templateUrl:rootPath+"/annountment/html/edit.html",controller:"annountmentEditCtrl",controllerAs:"vm"}).state("annountmentDetail",{url:"/annountmentDetail/:id",templateUrl:rootPath+"/annountment/html/detail.html",controller:"annountmentDetailCtrl",controllerAs:"vm"}).state("annountmentYet",{url:"/annountmentYet",templateUrl:rootPath+"/annountment/html/yetList.html",controller:"annountmentYetCtrl",controllerAs:"vm"}).state("sharingPlatlform",{url:"/sharingPlatlform",templateUrl:rootPath+"/sharingPlatlform/html/list.html",controller:"sharingPlatlformCtrl",controllerAs:"vm"}).state("sharingPlatlformEdit",{url:"/sharingPlatlformEdit/:sharId",templateUrl:rootPath+"/sharingPlatlform/html/edit.html",controller:"sharingPlatlformEditCtrl",controllerAs:"vm"}).state("sharingDetil",{url:"/sharingDetil/:sharId",templateUrl:rootPath+"/sharingPlatlform/html/letterFlowDetail.html",controller:"sharingDetailCtrl",controllerAs:"vm"}).state("sharingPlatlformYet",{url:"/sharingPlatlformYet",templateUrl:rootPath+"/sharingPlatlform/html/yetList.html",controller:"sharingPlatlformYetCtrl",controllerAs:"vm"}).state("financialManager",{url:"/financialManager/:businessId",templateUrl:rootPath+"/financialManager/html/add.html",controller:"financialManagerCtrl",controllerAs:"vm"}).state("financialAssistManager",{url:"/financialAssistManager/:businessId",templateUrl:rootPath+"/financialManager/html/assistCostAdd.html",controller:"assistCostEditCtrl",controllerAs:"vm"}).state("assistCostlist",{url:"/assistCostlist/:costType",templateUrl:rootPath+"/financialManager/html/assistCostList.html",controller:"assistCostCountEditCtrl",controllerAs:"vm"}).state("assistCostCountList",{url:"/assistCostCountList",templateUrl:rootPath+"/financialManager/html/assistCostCount.html",controller:"assistCostCountListCtrl",controllerAs:"vm"}).state("financialManagerList",{url:"/financialManagerList/:costType",templateUrl:rootPath+"/financialManager/html/list.html",controller:"financialManagerEditCtrl",controllerAs:"vm"}).state("expertPaymentCountList",{url:"/expertPaymentCountList/:beginTime",templateUrl:rootPath+"/financialManager/html/expertPaymentCount.html",controller:"expertPaymentCountCtrl",controllerAs:"vm"}).state("expertPaymentDetailCountList",{url:"/expertPaymentDetailCountList/:beginTime",templateUrl:rootPath+"/financialManager/html/expertPaymentDetailCount.html",controller:"expertPaymentDetailCountCtrl",controllerAs:"vm"}).state("exportCountList",{url:"/exportCountList",templateUrl:rootPath+"/financialManager/html/expertCount.html",controller:"exportCountCtrl",controllerAs:"vm"}).state("expertRevCondCountList",{url:"/expertRevCondCountList",templateUrl:rootPath+"/signView/html/expertReviewCondCount.html",controller:"expertRevConCountCtrl",controllerAs:"vm"}).state("projectCostCountList",{url:"/projectCostCountList",templateUrl:rootPath+"/financialManager/html/projectCostCount.html",controller:"projectCostCountCtrl",controllerAs:"vm"}).state("proCostClassifyCountList",{url:"/proCostClassifyCountList",templateUrl:rootPath+"/financialManager/html/proCostClassifyCount.html",controller:"proCostClassifyCountCtrl",controllerAs:"vm"}).state("proReviewConCountList",{url:"/proReviewConCountList",templateUrl:rootPath+"/signView/html/proReviewConCount.html",controller:"proReviewConditionCtrl",controllerAs:"vm"}).state("monthlyNewsletterList",{url:"/monthlyNewsletterList",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyNewsletterList.html",controller:"monthlyNewsletterCtrl",controllerAs:"vm"}).state("monthlyEdit",{url:"/monthlyEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyNewsletterEdit.html",controller:"monthlyNewsletterEditCtrl",controllerAs:"vm"}).state("theMonthsList",{url:"/theMonthsList",templateUrl:rootPath+"/monthlyNewsletter/html/theMonthsList.html",controller:"yearMonthlyNewsletterCtrl",controllerAs:"vm"}).state("monthlyFindByMultiyear",{url:"/monthlyFindByMultiyear/:year",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearList.html",controller:"monthlyMultiyearCtrl",controllerAs:"vm"}).state("monthlyMultiyearEdit",{url:"/monthlyMultiyearEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearAdd.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("monthlyMultiyFileList",{url:"/monthlyMultiyFileList",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyFileList.html",controller:"monthlyMultiFileCtrl",controllerAs:"vm"}).state("monthlyMultiyearDetail",{url:"/monthlyMultiyearDetail/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearDetail.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("monthlyHistoryList",{url:"/monthlyHistoryList",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyHistoryList.html",controller:"monthlyHistoryCtrl",controllerAs:"vm"}).state("monthlyHistoryEdit",{url:"/monthlyHistoryEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyHistoryAdd.html",controller:"monthlyHistoryEditCtrl",controllerAs:"vm"}).state("approveWindow",{url:"/approveWindow/:signId",templateUrl:rootPath+"/reviewProjectAppraise/html/approveWindow.html",controller:"approveWindowCtrl",controllerAs:"vm"}).state("approveWindowEdit",{url:"/approveWindowEdit/:id",templateUrl:rootPath+"/reviewProjectAppraise/html/approveWindow.html",controller:"approveWindowEditCtrl",controllerAs:"vm"}).state("reviewProjectAppraiseList",{url:"/reviewProjectAppraiseList/:id",templateUrl:rootPath+"/signView/html/list.html",controller:"reviewProjectAppraiseCtrl",controllerAs:"vm"}).state("reviewProjectAppraiseEdit",{url:"/reviewProjectAppraiseEdit",templateUrl:rootPath+"/reviewProjectAppraise/html/edit.html",controller:"reviewProjectAppraiseEditCtrl",controllerAs:"vm"}).state("approveList",{url:"/approveList",templateUrl:rootPath+"/reviewProjectAppraise/html/approveList.html",controller:"approveListCtrl",controllerAs:"vm"}).state("libraryAdd",{url:"/libraryAdd/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryAdd.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("archivesLibraryList",{url:"/archivesLibraryList/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryList.html",controller:"archivesLibraryListCtrl",controllerAs:"vm"}).state("pluginfile",{url:"/pluginfile",templateUrl:rootPath+"/file/html/pluginfile.html",controller:"pluginfileCtrl",controllerAs:"vm"}).state("takeUser",{url:"/takeUser",templateUrl:rootPath+"/personalCenter/html/takeUser.html",controller:"takeUserCtrl",controllerAs:"vm"}).state("fileLibrary",{url:"/fileLibrary",templateUrl:rootPath+"/fileLibrary/html/fileLibrary.html",controller:"qualityCtrl",controllerAs:"vm"}).state("fileLibrary.fileList",{url:"/fileList/:parentId",templateUrl:rootPath+"/fileLibrary/html/fileList.html",controller:"qualityListCtrl",controllerAs:"vm"}).state("fileLibrary.fileEdit",{url:"/fileEdit/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/fileEdit.html",controller:"qualityEditCtrl",controllerAs:"vm"}).state("policyLibrary",{url:"/policyLibrary",templateUrl:rootPath+"/fileLibrary/html/policyLibrary.html",controller:"policyCtrl",controllerAs:"vm"}).state("policyLibrary.policyList",{url:"/policyList/:parentId",templateUrl:rootPath+"/fileLibrary/html/policyList.html",controller:"policyListCtrl",controllerAs:"vm"}).state("policyLibrary.policyEdit",{url:"/policyEdit/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/policyEdit.html",controller:"policyEditCtrl",controllerAs:"vm"}).state("bookBuyBusinessEdit",{url:"/bookBuyBusinessEdit/:businessId",templateUrl:rootPath+"/bookBuyBusiness/html/bookBuyBusinessEdit.html",controller:"bookBuyBusinessEditCtrl",controllerAs:"vm"}).state("myBookBuyBusiness",{url:"/myBookBuyBusiness",templateUrl:rootPath+"/bookBuyBusiness/html/bookBuyBusinessList.html",controller:"bookBuyBusinessCtrl",controllerAs:"vm"}).state("assertStorageBusinessEdit",{url:"/assertStorageBusinessEdit/:businessId",templateUrl:rootPath+"/assertStorageBusiness/html/assertStorageBusinessEdit.html",controller:"assertStorageBusinessEditCtrl",controllerAs:"vm"}).state("myAssertStorageBusiness",{url:"/myAssertStorageBusiness",templateUrl:rootPath+"/assertStorageBusiness/html/assertStorageBusinessList.html",controller:"assertStorageBusinessCtrl",controllerAs:"vm"}).state("assertApplyUse",{url:"/assertApplyUse",templateUrl:rootPath+"/userAssertDetail/html/userAssertDetailAdd.html",controller:"userAssertDetailAddCtrl",controllerAs:"vm"}).state("addTopic",{url:"/topicInfo/:id",templateUrl:rootPath+"/topicInfo/html/add.html",controller:"topicAddCtrl",controllerAs:"vm"}).state("myTopic",{url:"/myTopic",templateUrl:rootPath+"/topicInfo/html/myList.html",controller:"myTopicCtrl",controllerAs:"vm"}).state("header",{url:"/header",templateUrl:rootPath+"/header/html/list.html",controller:"headerCtrl",controllerAs:"vm"}).state("headerEdit",{url:"/headerEdit/:headerType",templateUrl:rootPath+"/header/html/selectHeader.html",controller:"headerEditCtrl",controllerAs:"vm"}).state("statisticalList",{url:"/statisticalList/:headerType",templateUrl:rootPath+"/header/html/statisticalList.html",controller:"statisticalListCtrl",controllerAs:"vm"}).state("statistical",{url:"/statistical",templateUrl:rootPath+"/statistical/html/list.html",controller:"statisticalCtrl",controllerAs:"vm"}).state("editWorkPlan",{url:"/editWorkPlan/:topicId",templateUrl:rootPath+"/workPlan/html/edit.html",controller:"workPlanEditCtrl",controllerAs:"vm"}).state("editFiling",{url:"/editFiling/:topicId",templateUrl:rootPath+"/filing/html/edit.html",controller:"filingEditCtrl",controllerAs:"vm"}).state("reviewFee",{url:"/reviewFee",templateUrl:rootPath+"/reviewFee/html/list.html",controller:"reviewFeeCtrl",controllerAs:"vm"}).state("signFlowDeal.fileList",{url:"/fileList/:id/:type",templateUrl:rootPath+"/file/html/rightList.html",controller:"fileListCtrl",controllerAs:"vm"}).state("signFlowDetail.fileList",{url:"/fileList/:id/:type",templateUrl:rootPath+"/file/html/rightList.html",controller:"fileListCtrl",controllerAs:"vm"}).state("endSignDetail.fileList",{url:"/fileList/:id/:type",templateUrl:rootPath+"/file/html/rightList.html",controller:"fileListCtrl",controllerAs:"vm"}).state("signDetails.fileList",{url:"/fileList/:id/:type",templateUrl:rootPath+"/file/html/rightList.html",controller:"fileListCtrl",controllerAs:"vm"}).state("flowDeal.fileList",{url:"/flowDeal/:id/:type",templateUrl:rootPath+"/file/html/rightList.html",controller:"fileListCtrl",controllerAs:"vm"}).state("signChart",{url:"/signChart",templateUrl:rootPath+"/signView/html/signChart.html",controller:"signChartCtrl",controllerAs:"vm"})}]).run(function(t,e,i,o,n){t.getTBHeadName=function(t,e,i){return!e||"9"!=e||"项目建议书"!=t&&"可行性研究报告"!=t?t?"项目概算"==t?"概算审核"+i:t+i:i:"评估论证"+i},t.$state=i,t.$stateParams=o,t.$on("$stateChangeSuccess",function(e,i,o,n,a){t.previousState_name=n.name,t.previousState_params=a,"signFlowDeal"!=n.name&&"flowDeal"!=n.name||(t.$flowUrl=n.name,t.$flowParams=a)}),t.back=function(){t.previousState_name?i.go(t.previousState_name,t.previousState_params):i.go("welcome")},t.backtoflow=function(){t.$flowUrl?i.go(t.$flowUrl,t.$flowParams):i.go("gtasks")},t.topSelectChange=function(t,e,i){if(void 0!=e)for(var o=0;o<e.length;o++)if(i&&"code"==i){if(e[o].dictCode==t)return e[o].dicts}else if(e[o].dictName==t)return e[o].dicts},t.initInputValue=function(t,e){return t.target.checked&&!e?1:e},t.range=function(t){if(t)return new Array(t)},t.previewFile=function(t,e){var i,o,a;"office"==e?(i=rootPath+"/file/editFile?sysFileId="+t,o="82%",a="830px"):"pdf"==e?(i=rootPath+"/contents/libs/pdfjs-dist/web/viewer.html?file="+rootPath+"/file/preview/"+t,o="82%",a="830px"):"image"==e&&(i=rootPath+"/file/preview/"+t,o="75%",a="auto"),i?($("#iframePreview").attr("src",i),$("#previewModal").kendoWindow({width:o,height:a,title:"",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):n.alert("该文件不支持在线预览")},kendo.culture("zh-CN"),common.getTaskCount({$http:e}),common.initDictData({$http:e,scope:t})})}(),function(){"use strict";var t=angular.module("app");t.directive("goBack",function(){return{restrict:"AE",template:'<a class="btn btn-sm btn-primary" href="javascript:void(0);" ng-click="back();"><span class="glyphicon glyphicon-chevron-left"></span>返回</a>'}}),t.directive("goBackFlow",function(){return{restrict:"AE",template:'<button class="btn btn-sm btn-danger" ng-click="backtoflow();"><span class="glyphicon glyphicon-chevron-left"></span>返回流程</button>'}}),t.directive("flowFileButton",function(){return{restrict:"AE",template:'<button class="btn btn-sm btn-primary" ng-click="vm.clickUploadBt();" id="upload_file_bt">上传附件</button> <button class="btn btn-sm btn-primary" ng-click="vm.clickDetailBt();" id="detail_file_bt">查看附件</button>'}})}(),function(){"use strict";function t(t,e,i){var o=this;o.title="登记补充资料",o.sign={},o.addRegisters=[],o.businessId=i.params.businessId,o.addRegisterFile=function(){o.addRegister={},o.addRegister.businessId=o.businessId,o.addRegister.id=common.uuid(),o.addRegisters.push(o.addRegister)},o.saveRegisterFile=function(){e.saveRegisterFile(o.addRegisters,function(e){e.flag||"ok"==e.reCode?(t.alert("操作成功"),o.addRegisters=e.reObj):t.alert(e.reMsg)})},o.deleteRegisterFile=function(){var i=$("#addRegistersTable input[name='addRegistersCheck']:checked");if(i.length<1)t.alert("请选择要删除的记录！");else{for(var n=[],a=0;a<i.length;a++)o.addRegisters.forEach(function(t,e){t.id&&i[a].value==t.id&&(n.push(i[a].value),o.addRegisters.splice(e,1))});n.length>0&&e.deleteByIds(n.join(","),function(e){t.alert("删除成功！")})}},o.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},function(){i.params.businessId&&e.initAddRegisterFile(i.params.businessId,function(t){t&&(o.addRegisters=t)})}()}angular.module("app").controller("addRegisterFileCtrl",t),t.$inject=["bsWin","addRegisterFileSvc","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加登记补充资料",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新登记补充资料"),o.create=function(){e.createAddRegisterFile(o)},o.update=function(){e.updateAddRegisterFile(o)},function(){o.isUpdate&&e.getAddRegisterFileById(o)}()}angular.module("app").controller("addRegisterFileEditCtrl",t),t.$inject=["$location","addRegisterFileSvc","$state"]}(),function(){"use strict";function t(t){function e(t,e){$("#addRegister").kendoWindow({width:"70%",height:"660px",title:"意见选择",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()}function i(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function o(e,i){var o={method:"post",url:rootPath+"/addRegisterFile/save",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/addRegisterFile/findByBusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"delete",url:r+"/deleteFile",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}var r=rootPath+"/addRegisterFile";return{initAddRegisterFile:n,saveRegisterFile:o,isUnsignedInteger:i,initRegisterWinDow:e,deleteByIds:a}}angular.module("app").factory("addRegisterFileSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.suppletter={},r.suppletter.businessId=o.params.businessId,r.suppletter.businessType=o.params.businessType,r.suppletter.id=o.params.id,r.title="拟补充资料函",r.businessFlag={isInitFileOption:!1},function(){e.initSuppLetter(r.suppletter.businessId,r.suppletter.businessType,function(t){r.suppletter=t,r.initFileUpload()})}(),r.initFileUpload=function(){r.suppletter.id||a.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.suppletter.id,mainId:r.suppletter.id,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().AADSUPP_FILE,sysBusiType:i.mainTypeValue().AADSUPP_FILE},i.initUploadOptions({inputId:"sysfileinput",vm:r})},r.saveAddSuppletter=function(){common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()?e.saveSuppLetter(r.suppletter,r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.suppletter=t.reObj,n.success("操作成功！")):n.error(t.reMsg)}):n.alert("表格填写不正确，请检查相应的必填项信息！")},r.startSignSupperFlow=function(){common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()?n.confirm({title:"询问提示",message:"确认已经完成填写，并且发起流程么？",onOk:function(){e.saveSuppLetter(r.suppletter,r.isCommit,function(t){r.isCommit=!1,t.flag||"ok"==t.reCode?(r.suppletter=t.reObj,e.startSignSupperFlow(r.suppletter.id,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！"):n.error(t.reMsg)})):n.error(t.reMsg)})}}):n.alert("表格填写不正确，请检查相应的必填项信息！")},r.addSuppContent=function(){if(r.suppletter.id){r.showsupp=!0;$("#addsuppletter").kendoWindow({width:"60%",height:"90%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),e.findByBusinessId(r)}else n.alert("请先保存业务数据")},r.del=function(t){common.confirm({vm:r,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteAddSuppLetter(r,t)}})},r.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:r,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");r.del(o)}}}angular.module("app").controller("addSuppLetterCtrl",t),t.$inject=["$location","addSuppLetterSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="添加登记补充资料",r.isuserExist=!1,r.id=o.params.id,r.suppletter={},r.suppletter.businessId=o.params.businessId,r.suppletter.businessType=o.params.businessType,r.suppletter.id=o.params.id,r.id&&(r.isUpdate=!0,r.title="更新登记补充资料"),r.businessFlag={isInitFileOption:!1},r.initFileUpload=function(){r.suppletter.id||a.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.suppletter.id,mainId:r.suppletter.id,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().AADSUPP_FILE,sysBusiType:i.mainTypeValue().AADSUPP_FILE},i.initUploadOptions({inputId:"sysfileinput",vm:r})},r.addSuppContent=function(){if(r.suppletter.id){r.showsupp=!0;$("#addsuppletter").kendoWindow({width:"60%",height:"90%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),e.findByBusinessId(r)}else n.alert("请先保存业务数据")},r.saveAddSuppletter=function(){common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()?e.saveSuppLetter(r.suppletter,r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.suppletter=t.reObj,n.success("操作成功！")):n.error(t.reMsg)}):n.alert("表格填写不正确，请检查相应的必填项信息！")},r.comeBack=function(){o.go("addSuppletterList",{businessId:r.suppletter.businessId})},r.update=function(){e.updateAddSuppLetter(r)},r.startSignSupperFlow=function(){common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()?n.confirm({title:"询问提示",message:"确认已经完成填写，并且发起流程么？",onOk:function(){e.saveSuppLetter(r.suppletter,r.isCommit,function(t){r.isCommit=!1,t.flag||"ok"==t.reCode?(r.suppletter=t.reObj,o.go("addSuppletterList",{businessId:r.suppletter.businessId}),e.startSignSupperFlow(r.suppletter.id,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！"):n.error(t.reMsg)})):n.error(t.reMsg)})}
}):n.alert("表格填写不正确，请检查相应的必填项信息！")},function(){e.getAddSuppLetterById(r.suppletter.id,function(t){r.suppletter=t,r.initFileUpload()})}()}angular.module("app").controller("addSuppLetterEditCtrl",t),t.$inject=["$location","addSuppLetterSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/addSuppLetter/startSignSupperFlow",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(t){d(t.businessKey,function(e){t.suppletter=e})}function n(e){var i={method:"post",url:rootPath+"/file/findByBusinessId",params:{businessId:e.suppletter.id}},o=function(t){e.sysFilelists=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e,i){var o={method:"post",url:rootPath+"/addSuppLetter/initSuppListDate",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:m+"/createFileNum",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i,o){var n={method:"post",url:rootPath+"/addSuppLetter/initSuppLetter",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function l(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e,i,o){i=!0;var n={method:"post",url:rootPath+"/addSuppLetter/saveSupp",data:e},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}function d(e,i){var o={method:"post",url:rootPath+"/addSuppLetter/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"orgName",title:"orgName",width:100,filterable:!0},{field:"userName",title:"userName",width:100,filterable:!0},{field:"suppLetterTime",title:"suppLetterTime",width:100,filterable:!0,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"disapDate",title:"disapDate",width:100,filterable:!0,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"secretLevel",title:"secretLevel",width:100,filterable:!0},{field:"mergencyLevel",title:"mergencyLevel",width:100,filterable:!0},{field:"filenum",title:"filenum",width:100,filterable:!0},{field:"title",title:"title",width:100,filterable:!0},{field:"dispaRange",title:"dispaRange",width:100,filterable:!0},{field:"suppleterSuggest",title:"suppleterSuggest",width:100,filterable:!0},{field:"meetingSuggest",title:"meetingSuggest",width:100,filterable:!0},{field:"leaderSuggest",title:"leaderSuggest",width:100,filterable:!0},{field:"printnum",title:"printnum",width:100,filterable:!0},{field:"signid",title:"signid",width:100,filterable:!0},{field:"fileSeq",title:"fileSeq",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var m=rootPath+"/addSuppLetter";return{initSuppLetter:s,saveSuppLetter:c,grid:u,deleteAddSuppLetter:l,getAddSuppLetterById:d,createFilenum:r,initSuppListDate:a,findByBusinessId:n,initFlowDeal:o,startSignSupperFlow:i}}angular.module("app").factory("addSuppLetterSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.suppletter={},n.suppletter.businessId=i.params.businessId,n.title="登记补充资料",function(){e.initSuppListDate(n.suppletter.businessId,function(t){n.suppletterlist=t})}(),n.getFilenum=function(t){e.createFilenum(t,function(t){t.flag||"ok"==t.reCode?(o.alert("操作成功！"),$.each(n.suppletterlist,function(e,i){i.id==t.reObj.id&&(i.filenum=t.reObj.filenum)})):o.alert(t.reMsg)})},n.findByIdAddSuppLetter=function(t){i.go("addSuppLetterEdit",{id:t})}}angular.module("app").controller("addSuppLetterListCtrl",t),t.$inject=["$location","addSuppLetterSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.suppletter={},n.id=i.params.id,n.title="拟补充资料函查询",n.isQuery=!0,function(){e.addQueryGrid(n)}(),n.quarySuppContent=function(){n.queryGridOptions.dataSource.read()},n.resetSuppContent=function(){var t=$("#supQueryForm").find("input,select");$.each(t,function(t,e){e.attr("selected",!1),e.value=""})}}angular.module("app").controller("addSuppLetterQueryCtrl",t),t.$inject=["$location","addSuppLetterQuerySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加登记补充资料",n.isuserExist=!1,n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="更新登记补充资料"),n.saveSuppletterApprove=function(){e.createaddSuppLetterQuery(n)},n.update=function(){e.updateaddSuppLetterQuery(n)},function(){e.getaddSuppLetterQueryById(n)}()}angular.module("app").controller("addSuppLetterQueryEditCtrl",t),t.$inject=["$location","addSuppLetterQuerySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/addSuppLetterQuery/initSuppListDate",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:u+"/createFileNum",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i,o){var n={method:"post",url:rootPath+"/addSuppLetterQuery/initSuppLetter",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:u,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e,i){e.isSubmit=!0;var o={method:"delete",url:u,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(i){var o={method:"post",url:rootPath+"/addSuppLetter/updateApprove",data:i.suppletter},n=function(t){e.success("操作成功！")};common.http({$http:t,httpOptions:o,success:n})}function l(e){var i={method:"post",url:rootPath+"/addSuppLetter/findById",params:{id:e.id}},o=function(t){e.suppletter=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"/addsuppListData",$("#supQueryForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:180,filterable:!1},{field:"orgName",title:"拟稿部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:100,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"filenum",title:"文件字号",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.queryGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"/addSuppApproveList"),schema:{data:"value",total:function(t){return t.count?$("#ADDSUPPLETTER_COUNT").html(t.count):$("#ADDSUPPLETTER_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"title",title:"文件标题",width:100,filterable:!1},{field:"orgName",title:"拟稿部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:100,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"filenum",title:"文件字号",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var u=rootPath+"/addSuppLetter";return{approveGrid:d,addQueryGrid:c,createaddSuppLetterQuery:s,deleteaddSuppLetterQuery:r,updateaddSuppLetterQuery:a,getaddSuppLetterQueryById:l,initSuppLetter:n,createFilenum:o,initSuppListDate:i}}angular.module("app").factory("addSuppLetterQuerySvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.isuserExist=!1,r.id=o.params.id,r.suppletter={},r.suppletter.id=o.params.id,r.id&&(r.isUpdate=!0,r.title="查看登记补充资料"),r.businessFlag={isInitFileOption:!1},r.initFileUpload=function(){r.suppletter.id||a.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.suppletter.id,mainId:r.suppletter.id,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().AADSUPP_FILE,sysBusiType:i.mainTypeValue().AADSUPP_FILE},i.initUploadOptions({inputId:"sysfileinput",vm:r})},r.addSuppContent=function(){if(r.suppletter.id){r.showsupp=!0;$("#addsuppletter").kendoWindow({width:"60%",height:"90%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),e.findByBusinessId(r)}else n.alert("请先保存业务数据")},r.saveAddSuppletter=function(){common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()?e.saveSuppLetter(r.suppletter,r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.suppletter=t.reObj,n.success("操作成功！")):n.error(t.reMsg)}):n.alert("表格填写不正确，请检查相应的必填项信息！")},r.comeBack=function(){o.go("addSuppletterList",{businessId:r.suppletter.businessId})},function(){e.getAddSuppLetterById(r.suppletter.id,function(t){r.suppletter=t,r.initFileUpload()})}()}angular.module("app").controller("suppLetterViewCtrl",t),t.$inject=["$location","addSuppLetterSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e){var i=this;i.title="待办任务",function(){e.agendaTaskGrid(i)}(),i.query=function(){i.gridOptions.dataSource.read()}}angular.module("app").controller("adminAgendaCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="待办项目",function(){e.gtasksGrid(i)}(),i.countWorkday=function(){e.countWorakday(i)}}angular.module("app").controller("adminCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="在办项目",n.model={},function(){n.showwin=!1,e.dtasksGrid(n)}(),n.pauseProject=function(t){o.findPausingProject(n,t,"")},n.Checked=function(){$("#fileNo").is(":checked")&&($("#file1").prop("checked",!1),$("#file2").prop("checked",!1))},n.Checked2=function(){$("#fileNo").prop("checked",!1)},n.commitProjectStop=function(){o.pauseProject(n)},n.closewin=function(){window.parent.$("#spwindow").data("kendoWindow").close()},n.querySign=function(){n.gridOptions.dataSource.read()},n.formReset=function(){n.model={}},n.startProject=function(t){common.confirm({vm:n,title:"",msg:"确认激活吗？",fn:function(){$(".confirmDialog").modal("hide"),i.activeFlow(n,t)}})}}angular.module("app").controller("adminDoingCtrl",t),t.$inject=["$location","adminSvc","flowSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t){var e=this;e.title="在办任务",function(){t.doingTaskGrid(e)}()}angular.module("app").controller("adminDoTaskCtrl",t),t.$inject=["adminSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="办结事项",function(){e.etasksGrid(i)}()}angular.module("app").controller("adminEndCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="个人经办项目",n.model={},function(){n.showwin=!1,e.personMainTasksGrid(n)}()}angular.module("app").controller("adminPersonAssistCtrl",t),t.$inject=["$location","adminSvc","flowSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="个人主办项目",function(){e.personMainTasksGrid(n)}(),n.querySign=function(){n.gridOptions.dataSource.read()},n.resetForm=function(){n.model={}},n.pauseProject=function(t){o.findPausingProject(n,t)},n.startProject=function(t){common.confirm({vm:n,title:"",msg:"确认激活吗？",fn:function(){$(".confirmDialog").modal("hide"),i.activeFlow(n,t)}})}}angular.module("app").controller("adminPersonDoingCtrl",t),t.$inject=["$location","adminSvc","flowSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="项目查询统计",r.currentAssociateSign={},r.signList={},r.headerList={},r.header="",r.project={},r.headerType="项目类型",r.fileName="项目统计报表",r.filters={},function(){e.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(r.orgDeptList=t.reObj)}),e.getSignList(r),e.statisticalGrid(r)}(),r.formReset=function(){var t=$("#searchform").find("input,select");$.each(t,function(t,e){$("input:checkbox").attr("checked",!1),e.value=""})},r.searchSignList=function(){r.signListOptions.dataSource.read(),r.filters=r.project},r.statistical=function(){var t=1;r.columns=[{field:"",title:"序号",width:50,filterable:!1,template:function(){return t++}}],n.findHeaderListSelected(r,function(t){r.selectedHeaderList=t;for(var e=0;e<r.selectedHeaderList.length;e++){var i=r.selectedHeaderList[e];r.columns.push({field:i.headerKey,title:i.headerName,width:140,filterable:!1})}$("#statisticalGrid").kendoGrid({dataSource:r.dataSource,filterable:common.kendoGridConfig().filterable,sortable:!0,selectable:"row",columns:r.columns}),$("#reportWindow").kendoWindow({width:"70%",height:"70%",title:"项目查询统计",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},r.excelExport=function(){var t=escape(encodeURIComponent(r.fileName));if(r.filters&&void 0!=r.filters)var e=JSON.stringify(r.filters),i=e.substring(1,e.length-1);window.open(rootPath+"/signView/excelExport?filterData="+escape(encodeURIComponent(i))+"&fileName="+t)},r.ProjectStopInfo=function(t){o.go("projectStopInfo",{signId:t})}}angular.module("app").controller("adminSignListCtrl",t),t.$inject=["signSvc","adminSvc","bsWin","$state","headerSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t,e,i){function o(t,e,i){var e=escape(encodeURIComponent(e));window.open(rootPath+"/signView/excelExport?filterData="+i+"&fileName="+e)}function n(t){var i={method:"post",url:rootPath+"/admin/initWelComePage"},o=function(e){void 0!=t&&"function"==typeof t&&t(e.data)};common.http({$http:e,httpOptions:i,success:o})}function a(t){var i={method:"get",url:rootPath+"/workday/countWorkday"},o=function(t){};common.http({vm:t,$http:e,httpOptions:i,success:o})}function r(t){var i={method:"get",url:rootPath+"/file/findByBusinessId",params:{businessId:t.anId}},o=function(e){t.file=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function s(t,e){window.open(rootPath+"/file/fileDownload?sysfileId="+e)}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/tasks"),schema:{data:"value",total:function(t){return t.count?$("#DO_SIGN_COUNT").html(t.count):$("#DO_SIGN_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",width:50,template:function(t){return t.signprocessState&&t.signprocessState>=5&&t.signprocessState<7?"<span class='row-number label label-primary'></span>":t.signprocessState&&8==t.signprocessState?"<span class='row-number label label-success'></span>":"<span class='row-number'></span>"}},{field:"",title:"项目名称",filterable:!1,width:"15%",template:function(t){return c(t)?'<a href="#/signFlowDetail/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>":'<a href="#/signFlowDeal/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>"}},{field:"reviewStage",title:"项目阶段",filterable:!1,width:"10%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"",title:"合并评审",width:"10%",filterable:!1,template:function(t){return t.reviewType?9==t.reviewType||"9"==t.reviewType?"合并评审[主项目]":"合并评审[次项目]":"否"}},{field:"",title:"合并项目",width:"10%",filterable:!1,template:function(t){if(t.reviewSignDtoList){var e="";return angular.forEach(t.reviewSignDtoList,function(t,i,o){i>0&&(e+=","),e+=t.projectname}),e}return""}},{field:"preSignDate",title:"预签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"signDate",title:"签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"剩余工作日",width:"10%",filterable:!1,template:function(t){return void 0!=t.surplusDays?t.surplusDays>0?t.surplusDays:0:""}},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"",title:"状态",width:"6%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"6%",template:function(t){return c(t)?common.format($("#detailBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId):common.format($("#columnBtns").html(),"signFlowDeal",t.businessKey,t.taskId,t.processInstanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function c(t){var e=2==t.processState;return e||!t.reviewType||0!=t.reviewType&&"0"!=t.reviewType||"SIGN_BMLD_SPW1"!=t.nodeDefineKey&&"SIGN_FGLD_SPW1"!=t.nodeDefineKey||(e=!0),e}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/endTasks"),schema:{data:"value",total:function(t){return t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"projectname",title:"项目名称",filterable:!1,width:180},{field:"builtcompanyname",title:"建设单位",width:150,filterable:!1},{field:"reviewstage",title:"评审阶段",width:80,filterable:!1},{field:"signdate",title:"签收日期",width:100,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"reviewdays",title:"评审天数",width:150,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.isAppraising,t.signid,"endSignDetail",t.signid,t.processInstanceId,t.mUserName)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/doingtasks",$("#searchform")),schema:{data:"value",total:function(t){return t.count},model:{id:"id"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",filterable:!1,width:"18%",template:function(t){return'<a href="#/signFlowDetail/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>"}},{field:"reviewStage",title:"项目阶段",filterable:!1,width:"10%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"preSignDate",title:"预签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"signDate",title:"签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"剩余工作日",width:"10%",filterable:!1,template:function(t){return void 0!=t.surplusDays?t.surplusDays>0?t.surplusDays:0:""}},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"",title:"流程状态",width:"10%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"10%",template:function(t){return common.format($("#columnBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function m(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/getSignList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchDate",title:"发文日期",width:160,filterable:!1},{field:"reviewdays",title:"评审天数",width:140,filterable:!1},{field:"",title:"剩余工作日",width:140,filterable:!1,template:function(t){return void 0!=t.surplusdays?t.surplusdays>=0?t.surplusdays:0:""}},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizeValue",title:"审定投资",width:140,filterable:!1},{field:"extraValue",title:"核减（增）投资",width:140,filterable:!1},{field:"extraRate",title:"核减率",width:140,filterable:!1},{field:"approveValue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchType",title:"发文类型",width:140,filterable:!1},{field:"fileDate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyname",title:"建设单位",width:140,filterable:!1},{field:"isassistproc",title:"是否协审",width:140,filterable:!1,template:function(t){return 9==t.isassistproc?"是":"否"}},{field:"daysafterdispatch",title:"发文后工作日",width:140,filterable:!1},{field:"",title:"操作",width:140,filterable:!1,template:function(t){return"2"==t.signState?common.format($("#columnBtns").html(),"vm.ProjectStopInfo('"+t.signid+"')"):""}}];t.signListOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function p(t){var i={method:"post",url:rootPath+"/sign/initSignList"},o=function(e){void 0!=t&&"function"==typeof t&&t(e.data)};common.http({$http:e,httpOptions:i,success:o})}function f(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/html/personMainTasks",$("#searchform")),schema:{data:"value",total:function(t){return t.count},model:{id:"id"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:15,sort:{field:"signdate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",width:50,template:function(t){return t.processState&&t.processState>=5&&t.processState<7?"<span class='row-number label label-primary'></span>":t.processState&&t.processState>=8?"<span class='row-number label label-success'></span>":"<span class='row-number'></span>"}},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:100,filterable:!1},{field:"signdate",title:"收文日期",width:150,filterable:!1},{field:"",title:"项目状态",width:80,filterable:!1,template:function(t){var e="";switch(t.signState){case"1":e="进行中";break;case"2":e="暂停";break;case"8":e="强制结束";break;case"9":e="已完成"}return e}},{field:"dispatchDate",title:"发文日期",width:100,filterable:!1},{field:"signdate",title:"项目签收时间",width:150,filterable:!1},{field:"surplusdays",title:"剩余工作日",width:100,filterable:!1},{field:"receivedate",title:"送来时间",width:100,filterable:!1},{field:"builtcompanyname",title:"建设单位",width:150,filterable:!1},{field:"",title:"操作",width:140,template:function(t){var e=!1,i=!0,o=!1;return"2"==t.signState?e=!0:"1"==t.signState&&(o=!0),9==t.signState&&angular.isUndefined(t.isAppraising)&&(i=!1),common.format($("#columnBtns").html(),"signDetails",t.signid,t.processInstanceId,"vm.pauseProject('"+t.signid+"')",o,"vm.startProject('"+t.signid+"')",e,t.signid,i)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}},t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function h(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/queryMyAgendaTask",$("#agendaTaskForm")),schema:{data:"value",total:function(t){return t.count?$("#DO_TASK_COUNT").html(t.count):$("#DO_TASK_COUNT").html(0),t.count},model:{id:"taskId"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createTime",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"instanceName",title:"流程名称",filterable:!1,width:"25%"},{field:"nodeName",title:"当前环节",width:"15%",filterable:!1},{field:"displayName",title:"处理人",width:"15%",filterable:!1},{field:"processName",title:"流程类别",width:"15%",filterable:!1},{field:"",title:"流程状态",width:"10%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"15%",template:function(t){return common.format($("#columnBtns").html(),t.businessKey,t.processKey,t.taskId,t.instanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function g(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/queryAgendaTask"),schema:{data:"value",total:function(t){return t.count},model:{id:"taskId"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createTime",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"instanceName",title:"流程名称",filterable:!1,width:"20%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"processName",title:"流程类别",width:"20%",filterable:!1},{field:"",title:"流程状态",width:"5%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"15%",template:function(t){return common.format($("#columnBtns").html(),t.businessKey,t.processKey,t.taskId,t.instanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})
}}}function v(t){t.dataSource=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/getSignList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}})}return{gtasksGrid:l,etasksGrid:d,dtasksGrid:u,doingTaskGrid:g,personMainTasksGrid:f,countWorakday:a,agendaTaskGrid:h,initFile:r,upload:s,getSignList:m,initSignList:p,initWelComePage:n,excelExport:o,statisticalGrid:v}}angular.module("app").factory("adminSvc",t),t.$inject=["$rootScope","$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="主页",function(){e.initWelComePage(function(t){t&&(t.proTaskList&&(i.tasksList=t.proTaskList),t.comTaskList&&(i.agendaTaskList=t.comTaskList),t.endTaskList&&(i.endTasksList=t.endTaskList),t.annountmentList&&(i.annountmentList=t.annountmentList))})}()}angular.module("app").controller("adminWelComeCtrl",t).filter("FormatStrDate",function(){return function(t){var e=new Date(t),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate();return e.getFullYear()+"/"+i+"/"+o}}),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="通知公告管理",function(){o.grid(a)}(),a.bathIssue=function(){o.updateIssueState(a,"9")},a.bathUnissue=function(){o.updateIssueState(a,"0")},a.del=function(t){i.confirm({title:"询问提示",message:"确认删除数据吗?",onOk:function(){o.deleteAnnountment(a,t)}})},a.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:a,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");a.del(o)}},a.detail=function(t){t&&e.go("annountmentDetail",{id:t})},a.queryAnnountment=function(){a.gridOptions.dataSource.read()},a.resetAnnountment=function(){var t=$("#annountmentform").find("input,select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("annountmentCtrl",t),t.$inject=["$location","$state","bsWin","annountmentSvc","sysfileSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="通知公告详情页",o.annountment={},o.annountment.anId=e.params.id,function(){i.findDetailById(o,o.annountment.anId)}(),o.post=function(t){i.findDetailById(o,t)},o.next=function(t){i.findDetailById(o,t)},o.alertwd=function(){$("section").addClass("cont-alert")},o.closed=function(){$("section").removeClass("cont-alert")},o.prints=function(){var t,e="<div  style=\"width: 80%;height:80%; text-align: center; margin: auto; font-family: 'Microsoft YaHei'\">"+$("#context-body").html()+"</div>",i=$(window).height(),o=$(window).width();t=window.open("","","width="+o+",height="+i),t.document.body.innerHTML=e,t.print()}}angular.module("app").controller("annountmentDetailCtrl",t),t.$inject=["$location","$state","annountmentSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="通知公告编辑",n.annountment={},n.annountment.anId=t.params.id,n.editor=void 0,n.businessFlag={isInitFileOption:!1},n.initFileUpload=function(){n.annountment.anId||o.$watch("vm.annountment.anId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.annountment.anId,mainId:n.annountment.anId,mainType:i.mainTypeValue().NOTICE},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.annountment.anId,function(t){n.sysFilelists=t})}})},function(){n.editor=new UE.ui.Editor,n.editor.render("editor"),n.annountment.anId?(n.isUpdate=!0,e.findAnnountmentById(n,function(t){n.annountment=t,n.initFileUpload(),n.editor.ready(function(){void 0!=n.annountment.anContent&&n.editor.setContent(n.annountment.anContent)})}),i.findByBusinessId(n.annountment.anId,function(t){n.sysFilelists=t})):n.initFileUpload()}(),n.create=function(){e.createAnnountment(n)},n.update=function(){e.updateAnnountment(n)}}angular.module("app").controller("annountmentEditCtrl",t),t.$inject=["$state","annountmentSvc","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:p+"/initAnOrg"},o=function(t){e.annountment.anOrg="",e.annountment.anOrg=t.data.substring(1,t.data.length-1)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e,i){var o={method:"post",url:p+"/findAnnountmentById",params:{anId:e.annountment.anId}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(i){if(i.annountment.anContent=i.editor.getContentTxt(),common.initJqValidation(),$("#form").valid()){i.isSubmit=!0;var o={method:"post",url:p,data:i.annountment},n=function(t){i.isSubmit=!1,i.annountment.anId=t.data.anId,e.alert("保存成功！")};common.http({$http:t,httpOptions:o,success:n,onError:function(){i.isSubmit=!1}})}}function r(i){i.isSubmit=!0,i.annountment.anContent=$("#froalaEditor").val();var o={method:"put",url:p,data:i.annountment},n=function(t){i.isSubmit=!1,e.alert("操作成功！")};common.http({$http:t,httpOptions:o,success:n,onError:function(){i.isSubmit=!1}})}function s(i,o){var n={method:"delete",url:p,data:o},a=function(t){i.gridOptions.dataSource.read(),e.alert("删除成功！")};common.http({$http:t,httpOptions:n,success:a})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/annountment/fingByCurUser",$("#annountmentform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"issue",dir:"asc"}]}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"anTitle",title:"标题",width:300,filterable:!1},{field:"issueDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:160,filterable:!1},{field:"issueUser",title:"发布人",width:100,filterable:!1},{field:"",title:"发布状态",width:100,template:function(t){return t.issue&&"9"==t.issue?"已发布":"未发布"}},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.detail('"+t.anId+"')",t.anId,"vm.del('"+t.anId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function c(e,i){var o=common.getKendoCheckId(".grid");if(0==o.length)common.alert({vm:e,msg:"请选择数据"});else{for(var n=[],a=0;a<o.length;a++)n.push(o[a].value);var r={method:"post",url:rootPath+"/annountment/updateIssueState",params:{ids:n.join(","),issueState:i}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),common.alert({vm:e,msg:"操作成功",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:r,success:s})}}function d(e,o){var n={method:"post",url:p+"/findAnnountmentById",params:{anId:o}},a=function(t){e.annountment=t.data,i.findByBusinessId(o,function(t){e.sysFilelists=t}),u(e,o),m(e,o)};common.http({vm:e,$http:t,httpOptions:n,success:a})}function u(e,i){var o={method:"get",url:rootPath+"/annountment/postArticle",params:{anId:i}},n=function(t){e.annountmentPost=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function m(e,i){var o={method:"get",url:rootPath+"/annountment/nextArticle",params:{anId:i}},n=function(t){e.annountmentNext=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}var p=rootPath+"/annountment";return{grid:l,createAnnountment:a,initAnOrg:o,findAnnountmentById:n,updateIssueState:c,updateAnnountment:r,deleteAnnountment:s,findDetailById:d,postArticle:u,nextArticle:m}}angular.module("app").factory("annountmentSvc",t),t.$inject=["$http","bsWin","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="通知公告列表",function(){o.grid(n)}(),n.detail=function(t){t&&e.go("annountmentDetail",{id:t})},n.findAnnountment=function(){n.gridOptions.dataSource.read()},n.resetAnnountment=function(){var t=$("#annountmentYetform").find("input,select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("annountmentYetCtrl",t),t.$inject=["$location","$state","$http","annountmentYetSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/annountment/findByIssue",$("#annountmentYetform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"createdDate",dir:"desc"}]}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"anTitle",title:"标题",width:300,filterable:!1},{field:"issueDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:160,filterable:!1},{field:"issueUser",title:"发布人",width:100,filterable:!1},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.detail('"+t.anId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}return{grid:e}}angular.module("app").factory("annountmentYetSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.title="项目档案借阅管理",o.id=i.params.id,function(){i.params.id&&t.initArchivesLibrary(i.params.id,function(t){o.model=t})}(),o.createLibrary=function(){common.initJqValidation(),$("form").valid()&&t.createArchivesLibrary(o.model,function(t){t.flag||"ok"==t.reCode?(o.model=t.reObj,e.alert("操作成功！")):e.error(t.reMsg)})},o.startFlow=function(){common.initJqValidation(),$("form").valid()&&t.createArchivesLibrary(o.model,function(n){n.flag||"ok"==n.reCode?(o.model=n.reObj,t.startFlow(o.model.id,function(t){t.flag||"ok"==t.reCode?e.alert("操作成功！",function(){i.go("archivesLibraryList")}):e.error(t.reMsg)})):e.error(n.reMsg)})},o.del=function(e){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),t.deleteArchivesLibrary(o,e)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}}}angular.module("app").controller("archivesLibraryCtrl",t),t.$inject=["archivesLibrarySvc","bsWin","$state"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="档案借阅管理",function(){e.grid(n)}(),n.search=function(){n.gridOptions.dataSource.read()},n.formReset=function(){$("#searchform")[0].reset()}}angular.module("app").controller("archivesLibraryListCtrl",t),t.$inject=["$location","archivesLibrarySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/archivesLibrary/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/archivesLibrary/startFlow",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t){i(t.businessKey,function(e){t.model=e})}function a(e){var i={method:"get",url:rootPath+"/archivesLibrary/findByArchivesUser"},o=function(t){e.userlist=t.data,console.log(e.userlist)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:d+"/saveCity",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"post",url:d+"/savaLibrary",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/archivesLibrary/findByOData",$("#searchform")),schema:{data:"value",total:function(t){return t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"readCompany",title:"项目单位",width:140,filterable:!1},{field:"readProjectName",title:"查阅项目",width:140,filterable:!1},{field:"readUsername",title:"借阅人",width:100,filterable:!1},{field:"readArchivesCode",title:"归档编号",width:100,filterable:!1},{field:"readDate",title:"借阅时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return t.processInstanceId?common.format($("#columnBtns").html(),"flowEnd/"+t.id,flowcommon.getFlowDefinedKey().FLOW_ARCHIVES,t.processInstanceId):""}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}var d=rootPath+"/archivesLibrary";return{initArchivesLibrary:i,startFlow:o,initFlowDeal:n,grid:c,createArchivesLibrary:l,createCityLibrary:r,getArchivesUserName:a,deleteArchivesLibrary:s}}angular.module("app").factory("archivesLibrarySvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.model={},s.filterModel={},s.filterLow={},s.title="协审计划管理",s.splitNumArr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],s.plan={},s.planList=new Array,s.showPlan={},s.assistSign=new Array,s.pickSign=new Array,s.pickMainSign=new Array,s.lowerSign=new Array,s.selectPlanId="",s.selectMainSignId="",s.initPickLowSign=!1,s.drawType="",s.plan.assistType="独立项目",function(){i.initPlanPage(s),i.initPlanGrid(s),$("#planInfo li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)})}(),s.filterSign=function(t){var e=!0;if(!angular.isUndefined(t)&&(angular.isUndefined(s.filterModel.filterFilecode)||-1==t.filecode.indexOf(s.filterModel.filterFilecode)&&(e=!1),e&&(angular.isUndefined(s.filterModel.filterProjectCode)||-1==t.projectcode.indexOf(s.filterModel.filterProjectCode)&&(e=!1)),e&&(angular.isUndefined(s.filterModel.filterProjectName)||-1==t.projectname.indexOf(s.filterModel.filterProjectName)&&(e=!1)),e&&(angular.isUndefined(s.filterModel.filterBuiltName)||(angular.isUndefined(t.builtcompanyName)&&(e=!1),e&&-1==t.builtcompanyName.indexOf(s.filterModel.filterBuiltName)&&(e=!1))),e))return t},s.filterLowSign=function(t){var e=!0;if(!angular.isUndefined(t)&&(angular.isUndefined(s.filterLow.filterFilecode)||-1==t.filecode.indexOf(s.filterLow.filterFilecode)&&(e=!1),e&&(angular.isUndefined(s.filterLow.filterProjectCode)||-1==t.projectcode.indexOf(s.filterLow.filterProjectCode)&&(e=!1)),e&&(angular.isUndefined(s.filterLow.filterProjectName)||-1==t.projectname.indexOf(s.filterLow.filterProjectName)&&(e=!1)),e&&(angular.isUndefined(s.filterLow.filterBuiltName)||(angular.isUndefined(t.builtcompanyName)&&(e=!1),e&&-1==t.builtcompanyName.indexOf(s.filterLow.filterBuiltName)&&(e=!1))),e))return t},s.initSplit=function(t){s.plan.assistType==t&&(angular.isUndefined(s.plan.spliNum)||(s.plan.spliNum=0))},s.affirmSign=function(){var t=$("input[name='selASTSign']:checked");t.length<1?a.alert("请选择要挑选的项目"):t.length>1?"合并项目"==s.plan.assistType?a.alert("合并项目要先挑选一个主项目，再挑选次项目！"):a.alert("独立项目，每次只能选择一个！"):(s.model.signId=t[0].value,s.model.assistType=s.plan.assistType,s.model.single="合并项目"!=s.plan.assistType,s.model.splitNum=s.plan.spliNum,s.model.id=s.selectPlanId,s.assistSign.forEach(function(t,e){t.signid==s.model.signId&&(s.model.projectName=t.projectname)}),s.model.isDrawed="0",s.model.assistPlanSignDtoList=s.showPlan.assistPlanSignDtoList,i.saveAssistPlan(s.model,s.isCommit,function(t){s.isCommit=!1,s.showPlan.id||s.gridOptions.dataSource.read(),s.showPlan=t.reObj,s.selectPlanId=s.showPlan.id,i.initPlanPage(s),"合并项目"==s.plan.assistType?s.showPickLowSign(s.model.signId):a.success("操作成功！")}))},s.cancelSign=function(){var t=$("input[name='checkASTSign']:checked");t.length<1?a.alert("请选择取消的项目"):common.confirm({vm:s,title:"",msg:"确认取消挑选项目吗?",fn:function(){$(".confirmDialog").modal("hide");for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.cancelPlanSign(s,e.join(","))}})},s.initSelPlan=function(){i.initSelPlan(s)},s.doDelete=function(){s.showPlan.id?a.confirm({title:"询问提示",message:"确认删除数据吗？删除数据不可恢复，请慎重！",onOk:function(){$(".confirmDialog").modal("hide"),i.deletePlan(s.showPlan.id,s.isCommit,function(t){s.isCommit=!1,i.initPlanPage(s),s.gridOptions.dataSource.read()})}}):a.alert("请选择要删除的协审计划包")},s.showPickLowSign=function(t){s.selectMainSignId=t,i.showPickLowSign(s),$("#lowerSignWin").kendoWindow({width:"1024px",height:"600px",title:"次项目信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.affirmLowerSign=function(){var t=$("input[name='selLowSign']:checked");if(t.length<1)common.alert({vm:s,msg:"请选择要挑选的次项目"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.saveLowPlanSign(s,e)}},s.cancelLowerSign=function(){var t=$("input[name='checkLowSign']:checked");if(t.length<1)a.alert("请选择要挑选的次项目");else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.cancelLowPlanSign(s,e.join(","))}},s.queryPlan=function(){i.queryPlan(s)};var l="";s.planId="",s.showPlanDetail=function(t){$("#planInfo").kendoWindow({width:"1024px",height:"600px",title:"协审项目清单",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),s.signNum=0,l=t,s.planId=t,i.getPlanSignByPlanId(s,t)},s.ministerOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.viceDirectorOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.directorOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.assistPlan={},s.savePlanSign=function(){i.savePlanSign(s),s.assistPlan.id=l,i.savePlan(s)},s.checked="option1",s.chooseAssistUnit=function(){s.number=0,s.drawType="","option1"==s.checked&&(s.drawType="1",s.number=s.assistPlanSign.length+1),"option2"==s.checked&&(s.drawType="0",s.number=s.assistPlanSign.length),i.chooseAssistUnit(s)},s.againChooleAssistUnit=function(){$("#againChooleAssistUnit").kendoWindow({title:"选择参加协审单位",width:"600px",height:"500px",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),i.getAllUnit(s),s.num=0,"0"==s.showPlan.drawType?s.num=s.assistPlanSign.length:s.num=s.assistPlanSign.length+1},s.saveAddChooleUnit=function(t){i.saveAddChooleUnit(s,t)},s.drawAssistUnit=function(){if(console.log(s.showPlan.drawType),void 0!=s.assistPlanSign&&s.assistPlanSign.length>0)if(s.assistPlanSign.forEach(function(t,e){t.assistUnit=null}),s.drawAssistUnits=s.unitList.slice(0),"1"==s.drawType?s.drawAssistUnits.length>s.assistPlanSign.length:s.drawAssistUnits.length>=s.assistPlanSign.length){for(var t=0,e=-1,i=0;i<s.drawAssistUnits.length;i++)if("9"==s.drawAssistUnits[i].isLastUnSelected){var o=Math.floor(Math.random()*s.assistPlanSign.length);e=o,s.assistPlanSign[o].assistUnit=s.drawAssistUnits[i],s.drawPlanSign=s.assistPlanSign[o],s.drawAssistUnits.splice(i,1)}s.drawPlanSign=s.assistPlanSign[t];var a=0;s.isStartDraw=!0,s.isDrawDone=!1,s.t=n(function(){s.drawPlanSign=s.assistPlanSign[t];var i=Math.floor(Math.random()*s.drawAssistUnits.length),o=s.drawAssistUnits[i];s.showAssitUnitName=o.unitName,++a%20==0&&(t!=e?s.assistPlanSign[t].assistUnit=o:t!=s.assistPlanSign.length-1&&(s.assistPlanSign[++t].assistUnit=o),t++,t==e&&e==s.assistPlanSign.length-1&&(n.cancel(s.t),s.isDrawDone=!0),t==s.assistPlanSign.length&&(n.cancel(s.t),s.isDrawDone=!0),s.drawAssistUnits.forEach(function(t,e){t.id==o.id&&s.drawAssistUnits.splice(e,1)}))},50)}else common.alert({vm:s,msg:"当前协审单位少于项目计划数目，不能抽签！请先到项目计划表中选择参加的协审单位后再进行抽签！"})},s.saveDrawAssistUnit=function(){i.saveDrawAssistUnit(s)}}angular.module("app").controller("assistPlanCtrl",t),t.$inject=["$location","$state","assistSvc","$http","$interval","bsWin","ideaSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="协审单位",i.resource={},function(){e.grid(i)}(),i.del=function(t){i.id=t,common.confirm({vm:i,title:"",msg:"确认要删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),i.resource={},e.deleteAssistUnit(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");0==t.length?common.alert({vm:i,msg:"请选择数据"}):common.confirm({vm:i,title:"",msg:"确认要删除数据吗？",fn:function(){$(".confirmDialog").modal("hide");for(var o=[],n=0;n<t.length;n++)o.push(t[n].value);var a=o.join(",");e.deleteAssistUnit(i,a)}})},i.queryAssistUnit=function(){e.queryAssistUnit(i)}}angular.module("app").controller("assistUnitCtrl",t),t.$inject=["$location","assistUnitSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()&&0==e.isUnitExist){var i={method:"post",url:s,data:e.assistUnit},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmint=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()&&0==e.isUnitExist){var i={method:"put",url:s,headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(e.assistUnit)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:s+"/getAssistUnitById",params:{id:e.id}},o=function(t){e.assistUnit=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){t.gridOptions.dataSource.read()}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/fingByOData",$("#assistUnitform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"},isUse:{},unitSort:{}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"unitSort",dir:"asc"}]}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1},{field:"unitName",title:"单位名称",width:"20%",filterable:!1},{field:"unitShortName",title:"简称",width:"8%",filterable:!1},{field:"principalName",title:"负责人",width:"8%",filterable:!1},{field:"principalPhone",title:"负责人电话",width:"10%",filterable:!1},{field:"contactName",title:"联系人",width:"8%",filterable:!1},{field:"contactTell",title:"联系人电话",width:"10%",filterable:!1},{field:"address",title:"企业地址",width:"20%",filterable:!0},{field:"isUse",title:"状态",width:"5%",filterable:!1,template:function(t){return t.isUse?"0"==t.isUse?"已停用":"1"==t.isUse?"在用":void 0:""}},{field:"",title:"操作",width:"8%",template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id,t.isUse)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/assistUnit",l="#/assistUnit";return{grid:r,deleteAssistUnit:i,createAssistUnit:e,updateAssistUnit:o,getAssistUnitById:n,queryAssistUnit:a}}angular.module("app").factory("assistUnitSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="新增协审单位",o.id=i.params.id,o.isUnitExist=!1,o.id&&(o.isUpdate=!0,o.title="更新协审单位"),o.create=function(){e.createAssistUnit(o)},o.update=function(){e.updateAssistUnit(o)},function(){o.isUpdate&&e.getAssistUnitById(o)}()}angular.module("app").controller("assistUnitEditCtrl",t),t.$inject=["$location","assistUnitSvc","$state"]}(),function(){"use strict";function t(t,e){function i(){return[{field:"rowNumber",title:"序号",width:50,template:"<span class='row-number'></span>"},{field:"planName",title:"协审计划名称",width:100,filterable:!1},{field:"reportTime",title:"报审时间",width:50,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"drawTime",title:"抽签时间",width:100,filterable:!1},{field:"createdBy",title:"创建人员",width:100,filterable:!1},{field:"createdDate",title:"记录生成时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:100,filterable:!1,template:function(t){return'<button class="btn btn-xs btn-primary"  ng-click="vm.showPlanDetail(\''+t.id+'\')"><span class="glyphicon glyphicon-edit"></span>详情</button>'}}]}function o(t){var e=common.kendoGridDataSource(rootPath+"/assistPlan/findByOData",$("#searchform")),o=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i(),dataBound:o,resizable:!0}}function n(e){var i={method:"get",url:rootPath+"/assistPlan/initPlanManager"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.planList=new Array,t.data.signList&&t.data.signList.length>0&&(e.assistSign=t.data.signList),t.data.planList&&t.data.planList.length>0&&(e.planList=t.data.planList,e.selectPlanId||(e.showPlan=t.data.planList[0],e.selectPlanId=e.showPlan.id),u(e))}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/assistPlan",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/assistPlan",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function s(e,i){var o={method:"get",url:rootPath+"/sign/findByPlanId",params:{planId:i}},n=function(t){$("#planName").val(e.selectPlanId),common.requestSuccess({vm:e,response:t,fn:function(){e.pickSign=t.data,e.pickMainSign=new Array,e.lowerSign=new Array,e.showPlan.assistPlanSignDtoList&&e.pickSign.forEach(function(t,i){e.showPlan.assistPlanSignDtoList.forEach(function(i,o){"9"==i.isMain&&i.signId==t.signid&&(t.assistType=i.assistType,e.pickMainSign.push(t))})}),1==e.initPickLowSign&&m(e)}})};common.http({vm:e,$http:t,httpOptions:o,success:n,onError:function(){e.isCommit=!1}})}function l(e,i){var o={method:"delete",url:rootPath+"/assistPlan/cancelPlanSign",params:{planId:e.selectPlanId,signIds:i}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:o,success:a,onError:function(){e.isCommit=!1}})}function c(e,i){var o=new Array;e.assistSign.forEach(function(t,n){for(var a=0,r=i.length;a<r;a++)if(t.signid==i[a]){var s={};s.signId=t.signid,s.projectName=t.projectname,s.assistType="合并项目",s.isMain="0",s.mainSignId=e.selectMainSignId,o.push(s)}}),e.model=e.showPlan,e.model.assistPlanSignDtoList=o,e.isCommit=!0;var a={method:"post",url:rootPath+"/assistPlan/saveLowPlanSign",data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.initPickLowSign=!0,n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:a,success:r,onError:function(){e.isCommit=!1}})}function d(e,i){e.isCommit=!0;var o={method:"delete",url:rootPath+"/assistPlan/cancelLowPlanSign",params:{planId:e.showPlan.id,signIds:i}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.initPickLowSign=!0,n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:o,success:a,onError:function(){e.isCommit=!1}})}function u(t){t.selectPlanId?(t.planList.forEach(function(e,i){e.id==t.selectPlanId&&(t.showPlan=e,t.drawType=t.showPlan.drawType)}),s(t,t.selectPlanId)):(t.showPlan={},t.pickSign=new Array,t.pickMainSign=new Array,t.lowerSign=new Array,t.selectMainSignId="",t.initPickLowSign=!1)}function m(t){t.lowerSign=new Array,t.pickSign.forEach(function(e,i){t.showPlan.assistPlanSignDtoList.forEach(function(i,o){"0"==i.isMain&&i.mainSignId==t.selectMainSignId&&i.signId==e.signid&&t.lowerSign.push(e)})})}function p(t){t.gridOptions.dataSource.read()}function f(e,i){e.reviewNum="";var o={method:"get",url:rootPath+"/assistPlanSign/getPlanSignByPlanId",params:{planId:i}},n=function(t){e.assistPlanSign=t.data,e.reviewNum=e.assistPlanSign.length,e.assistPlanSign.length>0&&(v(e,i),C(e))};common.http({vm:e,$http:t,httpOptions:o,success:n})}function h(e){e.assistPlan.ministerOpinion=$("#ministerOpinion").val(),e.assistPlan.viceDirectorOpinion=$("#viceDirectorOpinion").val(),e.assistPlan.directorOpinion=$("#directorOpinion").val();var i={method:"put",url:rootPath+"/assistPlanSign/savePlanSign",headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(e.assistPlanSign)},o=function(t){};common.http({vm:e,$http:t,httpOptions:i,success:o})}function g(e){var i={method:"put",url:rootPath+"/assistPlan",data:e.assistPlan},o=function(t){alert("保存成功！"),window.parent.$("#planInfo").data("kendoWindow").close()};common.http({vm:e,$http:t,httpOptions:i,success:o})}function v(e,i){var o={method:"get",url:rootPath+"/assistPlan/html/findById",params:{id:i}},n=function(t){e.assistPlan=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function w(e){var i={method:"get",url:rootPath+"/assistUnit/chooseAssistUnit",params:{planId:e.planId,number:e.number,drawType:e.drawType}},o=function(t){e.unitList=t.data,e.signNum=e.unitList.length,
e.isChoose=!0};common.http({vm:e,$http:t,httpOptions:i,success:o})}function b(e){var i={method:"post",url:rootPath+"/assistUnitUser/findByOData"},o=function(t){e.unitUserList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function y(e){var i={method:"post",url:rootPath+"/assistUnit/fingByOData"},o=function(t){e.allUnitList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function S(e){var i="",o=e.assistPlanSign.length;e.assistPlanSign.forEach(function(t,e){i+=t.id+"|"+t.assistUnit.id,e!=o-1&&(i+=",")});var n="";if(e.drawAssistUnits.length>0){var a=e.drawAssistUnits.length;e.drawAssistUnits.forEach(function(t,e){n+=t.id,e!=a-1&&(n+=",")})}e.isCommit=!0;var r={method:"put",url:rootPath+"/assistPlan/saveDrawAssistUnit",params:{planId:e.planId,drawAssitUnitIds:i,unSelectedIds:n}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.isCommited=!0,common.alert({closeDialog:!0,vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:r,success:s,onError:function(t){e.isCommit=!1}})}function k(e,i){if(e.unitList.length<e.num){var o=0;if(e.unitList.forEach(function(t){if(i.id==t.id)return o=-1,void common.alert({vm:e,msg:"该协审单位已被选中！"})}),-1!=o){var n={method:"post",url:rootPath+"/assistPlan/saveChooleUnit",params:{planId:e.showPlan.id,unitId:i.id}},a=function(t){common.alert({vm:e,msg:"添加成功！"})};common.http({vm:e,$http:t,httpOptions:n,success:a})}}else common.alert({vm:e,msg:"当前只能"+e.num+"家单位参与抽签"})}function C(e){var i={method:"get",url:rootPath+"/assistPlan/initAssistUnit",params:{planId:e.showPlan.id}},o=function(t){e.unitList=t.data,e.signNum=e.unitList.length,e.signNum>0&&(e.isChoose=!0)};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{initPlanPage:n,initPlanGrid:o,saveAssistPlan:a,deletePlan:r,findPlanSign:s,cancelPlanSign:l,saveLowPlanSign:c,cancelLowPlanSign:d,initSelPlan:u,showPickLowSign:m,queryPlan:p,getPlanSignByPlanId:f,savePlanSign:h,savePlan:g,initPlanByPlanId:v,chooseAssistUnit:w,saveDrawAssistUnit:S,getUnitUser:b,getAllUnit:y,saveAddChooleUnit:k,initAssistUnitByPlanId:C}}angular.module("app").factory("assistSvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="图书管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteBookBuy(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("bookBuyCtrl",t),t.$inject=["$location","bookBuySvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加图书管理信息",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新图书管理信息"),o.create=function(){e.createBookBuy(o)},o.update=function(){e.updateBookBuy(o)},function(){o.isUpdate&&e.getBookBuyById(o)}()}angular.module("app").controller("bookBuyEditCtrl",t),t.$inject=["$location","bookBuySvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:r,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:r,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:r,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=s}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/bookBuy/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(r),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"booksBarCode",title:"booksBarCode",width:100,filterable:!0},{field:"booksCode",title:"booksCode",width:100,filterable:!0},{field:"booksName",title:"booksName",width:100,filterable:!0},{field:"booksPrice",title:"booksPrice",width:100,filterable:!0},{field:"booksType",title:"booksType",width:100,filterable:!0},{field:"professionalType",title:"professionalType",width:100,filterable:!0},{field:"storePosition",title:"storePosition",width:100,filterable:!0},{field:"buyer",title:"buyer",width:100,filterable:!0},{field:"publishingCompany",title:"publishingCompany",width:100,filterable:!0},{field:"bookNo",title:"bookNo",width:100,filterable:!0},{field:"author",title:"author",width:100,filterable:!0},{field:"publishingTime",title:"publishingTime",width:100,filterable:!0},{field:"bookNumber",title:"bookNumber",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var r=rootPath+"/bookBuy",s="#/bookBuyList";return{grid:a,getBookBuyById:n,createBookBuy:o,deleteBookBuy:i,updateBookBuy:e}}angular.module("app").factory("bookBuySvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="图书采购申请业务信息",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteBookBuyBusiness(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}(),i.searchForm=function(){i.gridOptions.dataSource.read()},i.formReset=function(){i.searchModel={}}}angular.module("app").controller("bookBuyBusinessCtrl",t),t.$inject=["$location","bookBuyBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(t){if(r.conditions.length>0){return r.conditions.forEach(function(t,e){t.booksName=$("#booksName"+t.sort).val(),t.booksType=$("#booksType"+t.sort).val(),t.publishingCompany=$("#publishingCompany"+t.sort).val(),t.bookNo=$("#bookNo"+t.sort).val(),t.author=$("#author"+t.sort).val(),t.bookNumber=$("#bookNumber"+t.sort).val(),t.storeConfirm=$("#storeConfirm"+t.sort).val(),t.booksPrice=$("#booksPrice"+t.sort).val(),t.applyDept=r.model.applyDept,t.operator=r.model.operator,t.buyChannel=r.model.buyChannel,t.businessId=$("#businessId").val()}),!0}return!1}function a(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}var r=this;r.model={},r.conMaxIndex=0,r.conditions=new Array,r.title="添加图书采购申请业务信息",r.isuserExist=!1,r.businessId=i.params.businessId,r.showFlag={addBooksDeatail:!0,modBooksDetail:!0,bookBuyApplyTr:!1,bookBuyBzTr:!0,bookBuyFgzrTr:!0,bookBuyZrTr:!0,bookBuyYsrk:!0},r.businessId?(r.isUpdate=!0,r.showFlag.modBooksDetail=!0,r.showFlag.addBooksDeatail=!1,r.title="更新图书采购申请业务信息",$("#businessId").val(r.businessId)):(r.showFlag.modBooksDetail=!1,r.showFlag.addBooksDeatail=!0),r.create=function(){e.createBookBuyBusiness(r)},r.update=function(){e.updateBookBuyBusiness(r)},r.addCondition=function(){r.condition={},r.showFlag.addBooksDeatail?r.condition.sort=r.conMaxIndex+1:(r.conMaxIndex=r.conditions.length,r.condition.sort=r.conditions.length+1),r.conditions.push(r.condition),r.conMaxIndex++},r.removeCondition=function(){var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var e=[],i=0;i<t.length;i++)$.each(r.conditions,function(o,n){t[i].value==n.sort&&(n.id?e.push(n.id):r.conditions.splice(o,1))});e.length>0?expertConditionSvc.deleteSelConditions(e.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(o.success("操作成功！"),$.each(e,function(t,e){$.each(r.conditions,function(t,i){e==i.sort&&r.conditions.splice(t,1)})})):o.error(t.reMsg)}):o.success("操作成功！")}}):o.alert("请选择要删除的抽取条件！")},r.saveCondition=function(){n(!1)?e.saveBookBuyBusinessDetail(r.conditions,function(t){t.flag||"ok"==t.reCode?($("#businessId").val(t.reObj.businessId),o.success("保存成功！")):o.error(t.reMsg)}):o.error("请添加后再保存")},r.startFlow=function(){o.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){n(!1)?e.startFlow(r.conditions,r.isCommit,function(t){t.flag||"ok"==t.reCode?o.alert("保存成功！",function(){i.go("myBookBuyBusiness")}):o.alert(t.reMsg)}):o.error("请添加图书信息后再发起流程！")}})},r.checkBookNum=function(t){var e="bookNumber"+t;if(!a($("#"+e).val()))return void $("span[data-valmsg-for='"+e+"']").html("图书数量只能输入正整数！");$("span[data-valmsg-for='"+e+"']").html("")},r.checkPrice=function(t){var e=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/,i="booksPrice"+t,o="bookNumber"+t;if(!e.test($("#"+i).val()))return $("#"+i).val(""),void $("span[data-valmsg-for='"+i+"']").html("价格只能输入数字！");$("span[data-valmsg-for='"+i+"']").html("");var n=$("#"+i).val(),a=$("#"+o).val();$("#total"+t).val(parseFloat(n)*a)},function(){r.isUpdate&&e.getBookBuyBusinessById(r,function(t){r.model=t,r.conditions=r.model.bookBuyList;for(var e=0;e<r.conditions.length;e++)r.conditions[e].sort=e+1})}()}angular.module("app").controller("bookBuyBusinessEditCtrl",t),t.$inject=["$location","bookBuyBusinessSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:c,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){common.initJqValidation();$("form").valid();{e.isSubmit=!0;var i={method:"post",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){var o={method:"post",url:rootPath+"/bookBuyBusiness/saveBooksDetailList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/bookBuyBusiness/startFlow",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"get",url:rootPath+"/bookBuyBusiness/html/findById",params:{id:e.businessKey}},o=function(t){e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(e,i){var o={method:"get",url:rootPath+"/bookBuyBusiness/html/findById",params:{id:e.businessId}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/bookBuyBusiness/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"businessName",title:"业务流程名称",width:"20%",filterable:!1},{field:"buyChannel",title:"购买渠道",width:"15%",filterable:!1},{field:"createdDate",title:"创建日期",width:"15%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:140,template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.businessId,e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var c=rootPath+"/bookBuyBusiness",d="#/bookBuyBusinessList";return{grid:l,getBookBuyBusinessById:s,createBookBuyBusiness:o,deleteBookBuyBusiness:i,updateBookBuyBusiness:e,saveBookBuyBusinessDetail:n,startFlow:a,initFlowDeal:r}}angular.module("app").factory("bookBuyBusinessSvc",t),t.$inject=["$http"]}(),function(){"use strict";var t=angular.module("app"),e="template/dialog/alert.html";t.factory("bsWin",["$rootScope","$injector","$templateCache","bsWinConfig",function(t,i,o,n){function a(e){e.msg&&(e.message=e.msg);var i=angular.extend({},n,e),o={winId:c++,scope:t.$new()};return r(o,i),i.onOk&&(o.scope.ok=function(){if(i.onOk&&0==i.onOk.apply(this))return!1;o.el.modal("hide")}),i.onCancel&&(o.scope.onCancel=function(){if(i.onCancel&&0==i.onCancel.apply(this))return!1;o.el.modal("hide")}),o.el=s(o.scope,i.templateUrl).on("hidden.bs.modal",function(t){if(i.onClose&&0==i.onClose.apply(this,t))return!1;l(o)}).modal("show"),o}function r(t,e){t.scope.title=e.title,t.scope.message=e.message,t.scope.winId=t.winId,t.scope.type=e.type,t.scope.extraData=e.extraData,t.scope.options={onClose:e.onClose}}function s(t,e){var n=i.get("$compile"),a=n(o.get(e))(t);return $(a).appendTo("body")}function l(t){t.scope.$destroy(),t.el.unbind(),t.el.remove(),t.el=null,t=null}var c=0;return{success:function(t,e){return this.alert({message:t,type:"success",onClose:e})},warning:function(t,e){return this.alert({message:t,type:"warning",onClose:e})},error:function(t,e){return this.alert({message:t,type:"error",onClose:e})},alert:function(t,i,o){if(!angular.isObject(t)){var n;!i||angular.isFunction(i)?(o=i,i=t):n=t,t={message:i,onClose:o||function(){}},n&&(t.title=n)}return t.templateUrl=e,a(t)},confirm:function(t,e,i,o,n){if(!angular.isObject(t)){var r;!e||angular.isFunction(e)?(n=o||function(){},o=i||function(){},i=e||function(){},e=t):r=t,t={message:e,onOk:i,onClose:o,onCancel:n},r&&(t.title=r)}return t.templateUrl="template/dialog/confirm.html",a(t)},relogin:function(t){var e=this,o={message:t,onOk:function(){var t=this;return i.get("$http")({method:"POST",url:common.loginUrl,params:t.scope.model}).then(function(i){var o=i.data;"SUCCESS"==o.status?e.success(o.message||"登錄成功！",function(){t.el.modal("hide")}):e.error(o.message)}),!1}};return o.templateUrl="template/dialog/relogin.html",a(o)}}}]),t.constant("bsWinConfig",{title:"提示窗口",message:"",type:"info",timeout:0,templateUrl:e,onOk:null,onClose:function(t){}}),t.run(["$templateCache",function(t){t.put(e,'<div class="alertDialog modal fade" tabindex="-1" role="dialog">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title || \'消息提醒\'}}</h4>                        </div>                        <div class="modal-body text-{{type==\'error\'? \'danger\' : type}}">                            <p class="alertDialogMessage">                                <i class="fa fa-{{type == \'success\' ? \'check\' : (type == \'error\' ? \'ban\' : type)}}" aria-hidden="true"></i>                                 {{message}}                            </p>                        </div>                        <div class="modal-footer">                            <button type="button"  class="btn btn-info" data-dismiss="modal">关闭</button>                        </div>                    </div>                </div>            </div>'),t.put("template/dialog/confirm.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: 10000;">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title||\'提示\'}}</h4>                        </div>                        <div class="modal-body text-primary"><p><i class="fa fa-question-circle" aria-hidden="true"></i> {{message}}</p></div>                        <div class="modal-footer">                            <button type="button" ng-click="ok()" class="btn btn-info" >确认</button>                            <button type="button" ng-click="onCancel()" class="btn btn-info" data-dismiss="modal">取消</button>                        </div>                    </div>                </div>            </div>'),t.put("template/dialog/relogin.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">登录窗口</h4>                        </div>                        <div class="modal-body text-primary">                            <p><i class="fa fa-warning" aria-hidden="true"></i> {{message}}</p>                            <div><span ng-show="vm.message" class="errors" ng-bind="vm.message"></span></div>                            <div><span data-valmsg-for="loginName" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="用户名" maxlength="100" name="loginName" id="loginName" ng-model="model.loginName" data-val="true" data-val-required="用户名必填">                                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>                            </div>                            <div><span data-valmsg-for="password" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="password" class="form-control" placeholder="密码" maxlength="100" name="password" id="password" ng-model="model.password" data-val="true" data-val-required="密码必填">                                <span class="glyphicon glyphicon-lock form-control-feedback"></span>                            </div>                        </div>                        <div class="modal-footer">                            <div class="pull-right col-sm-12">                                <button type="button" ng-click="ok()"  class="btn btn-primary btn-block btn-flat l-icon">登 录</button>                            </div>                        </div>                    </div>                </div>            </div>')}])}(),function(){"use strict";function t(t,e,i){var o=new Blob([t],{type:"application/"+i}),n=URL.createObjectURL(o),a=$("<a><span class='forExcel'>下载</span></a>").attr("href",n).attr("download",e);$("body").append(a),$(".forExcel").click(),a.remove()}function e(t){t?(t.removeData("validator"),t.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(t)):($("form").removeData("validator"),$("form").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse("form"))}function i(t){var e=function(e){C.alert({vm:t.vm,msg:e,fn:function(){t.vm.isSubmit=!1,$(".alertDialog").modal("hide")}})};if(t.response.status>400)e("发生错误！");else{var i=t.response.data;i&&555==i.status?e(i.message):t.fn&&t.fn(i)}}function o(){for(var t=arguments[0],e=1;e<arguments.length;e++){var i=new RegExp("\\{"+(e-1)+"\\}","gm");t=t.replace(i,arguments[e])}return t}function n(t){var e=t.toString().replace(/[^0-9]/g,"");return parseInt(e,10)}function a(t){return isNaN(parseFloat(t,10))?0:parseFloat(t,10)}function r(){return $(window).height()-180}function s(t){t.vm.alertDialogMessage=t.msg,t.vm.alertDialogFn=function(){t.closeDialog&&1==t.closeDialog&&($(".alertDialog").modal("hide"),$(".modal-backdrop").remove()),t.fn?t.fn():$(".alertDialog").modal("hide")},$(".alertDialog").modal({backdrop:"static",keyboard:!1})}function l(t){t.vm.dialogConfirmTitle=t.title,t.vm.dialogConfirmMessage=t.msg,$(".confirmDialog").modal({backdrop:"static"}),t.vm.dialogConfirmSubmit=t.fn,t.cancel?t.vm.dialogConfirmCancel=t.cancel:t.vm.dialogConfirmCancel=function(){$(".confirmDialog").modal("hide")}}function c(t,e){null==e&&(e=""),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=i.exec(window.location.href);return null==o?e:o[1]}function d(t,e){return new kendo.data.DataSource({type:"odata",transport:u().transport(t,e),schema:u().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}})}function u(){return{filterable:{extra:!1,operators:{string:{contains:"包含",eq:"等于"},number:{eq:"等于",neq:"不等于",gt:"大于",lt:"小于"},date:{gt:"大于",lt:"小于"}}},pageable:{pageSize:10,previousNext:!0,buttonCount:5,refresh:!0,pageSizes:!0},schema:function(t){return{data:"value",total:function(t){return t.count},model:t}},transport:function(t,e,i){return{read:{url:t,dataType:"json",type:"post",beforeSend:function(t){t.setRequestHeader("Token",C.getToken())},data:function(){if(e){var t=common.buildOdataFilter(e);return t?i&&i.filter?{$filter:t+" and "+i.filter}:{$filter:t}:i&&i.filter?{$filter:i.filter}:{}}return{}}}}},noRecordMessage:{template:"暂时没有数据."}}}function m(t){var e=$(t).find("tr td:nth-child(1)").find("input:checked"),i=[];return e.each(function(){var t=$(this).attr("relId");i.push({name:"id",value:t})}),i}function p(t){t.headers={Token:C.getToken()},t.$http(t.httpOptions).then(t.success,function(e){t.onError&&t.onError(e)})}function f(){return{get:function(t,e){var i=this.getAll(t);return i?i[e]:null},getAll:function(t){var e=encodeURIComponent(t)+"=",i=document.cookie.indexOf(e),o=null,n={};if(i>-1){var a=document.cookie.indexOf(";",i);if(-1==a&&(a=document.cookie.length),o=document.cookie.substring(i+e.length,a),o.length>0){for(var r=o.split("&"),s=0,l=r.length;s<l;s++){var c=r[s].split("=");n[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return n}}return null},set:function(t,e,i,o,n,a,r){var s=this.getAll(t)||{};s[e]=i,this.setAll(t,s,o,n,a,r)},setAll:function(t,e,i,o,n,a){var r=encodeURIComponent(t)+"=",s=new Array;for(var l in e)l.length>0&&e.hasOwnProperty(l)&&s.push(encodeURIComponent(l)+"="+encodeURIComponent(e[l]));s.length>0?(r+=s.join("&"),i instanceof Date&&(r+=";expires="+i.toGMTString()),o&&(r+=";path="+o),n&&(r+=";domain="+n),a&&(r+=";secure")):r+=";expires="+new Date(0).toGMTString(),document.cookie=r},unset:function(t,e,i,o,n){var a=this.getAll(t);a&&(delete a[e],this.setAll(t,a,null,i,o,n))},unsetAll:function(t,e,i,o){this.setAll(t,null,new Date(0),e,i,o)}}}function h(){var t=f().getAll("data");return null!=t?t.token:""}function g(t){return t.error=function(t){401==t.status&&(location.href=window.rootPath+"/home/login")},t}function v(t){var e=/^(?:checkbox|radio)$/i,i=/^(?:submit|button|image|reset|file)$/i,o=/^(?:input|select|textarea|keygen)/i;return $(t).map(function(){var t=jQuery.prop(this,"elements");return t?jQuery.makeArray(t):this}).filter(function(){var t=this.type;return this.value&&this.name&&!$(this).is(":disabled")&&o.test(this.nodeName)&&!i.test(t)&&(this.checked||!e.test(t))}).map(function(t,e){var i=$(this),o=i.val();if(!o)return!1;"Integer"!=(i.attr("data-type")||"String")&&(o="'"+o+"'");var n=i.attr("operator")||"eq",a=i.attr("data-role")||"";return"datepicker"==a?o="date"+o:"datetimepicker"==a&&(o="datetime"+o),"like"==n?"substringof("+o+", "+e.name+")":e.name+" "+n+" "+o}).get().join(" and ")}function w(t){if(k){t.scope.dictMetaData=k;var e={};b(e,t.scope.dictMetaData),t.scope.DICT=e}else t.$http({method:"get",url:rootPath+"/dict/dictItems"}).then(function(e){t.scope.dictMetaData=e.data;var i={};b(i,e.data),t.scope.DICT=i},function(t){alert("初始化数据字典失败")})}function b(t,e,i){if(e&&0!=e.length)if(i)for(var o=0;o<e.length;o++){var n=e[o];if(n.parentId&&n.parentId==i){t.dicts||(t.dicts=new Array);var a={};a.dictId=n.dictId,a.dictName=n.dictName,a.dictCode=n.dictCode,a.dictKey=n.dictKey,a.dictSort=n.dictSort,t.dicts.push(a),b(a,e,n.dictId)}}else for(var o=0;o<e.length;o++){var n=e[o];n.parentId||(t[n.dictCode]={},t[n.dictCode].dictId=n.dictId,t[n.dictCode].dictCode=n.dictCode,t[n.dictCode].dictName=n.dictName,t[n.dictCode].dictKey=n.dictKey,t[n.dictCode].dictSort=n.dictSort,b(t[n.dictCode],e,n.dictId))}}function y(t){t.$http({method:"get",url:rootPath+"/admin/myCountInfo"}).then(function(t){t.data.DO_SIGN_COUNT&&$("#DO_SIGN_COUNT").html(t.data.DO_SIGN_COUNT),t.data.DO_TASK_COUNT&&$("#DO_TASK_COUNT").html(t.data.DO_TASK_COUNT)})}function S(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}).toUpperCase()}var k,C={initJqValidation:e,requestSuccess:i,format:o,blockNonNumber:n,floatNumberInput:a,adminContentHeight:r,alert:s,confirm:l,getQuerystring:c,kendoGridConfig:u,getKendoCheckId:m,cookie:f,getToken:h,http:p,gridDataSource:g,buildOdataFilter:v,initDictData:w,kendoGridDataSource:d,getTaskCount:y,uuid:S,downloadReport:t,initDictItems:function(t){k=t}};window.common=C}(),function(){"use strict";function t(t,i){return{request:function(t){return t.headers.Token=common.getToken(),t.headers["X-Requested-With"]="XMLHttpRequest",t},responseError:function(o){return o.config.headers.commonHttp||e(i,o.status,o.data),t.reject(o)}}}function e(t,e,i){switch(e){case 500:t.error("系统内部错误");break;case 401:t.warning("登录信息失效或您没有权限,请重新登录!");break;case 403:t.warning("无权限执行此操作");break;case 404:t.error("未找到相应的操作");break;case 408:t.warning("请求超时");break;case 412:t.warning(i.message||"操作失败");break;case 499:t.warning(i.message||"您的账号已在别的地方登录，请确认密码是否被修改！");break;default:t.error("发生错误,系统已记录,我们会尽快处理！")}}var i=angular.module("app");i.factory("commonHttpInterceptor",["$injector","bsWin",t]),i.config(["$httpProvider",function(e){e.interceptors.push(t)}]),jQuery&&jQuery(document).ajaxSend(function(t,e,i){e.setRequestHeader("Token",common.getToken())}).ajaxError(function(t,i,o,n){var a=angular.element("body"),r=a.scope(),s=a.injector().get("bsWin"),l=angular.isString(i.responseText)?JSON.parse(i.responseText||"{}"):i.responseText;r.$apply(function(){e(s,i.status,l||{})})})}(),function(){"use strict";function t(t,e){function i(i,o){i.ideaContent="",$("#ideaWindow").kendoWindow({width:"70%",height:"660px",title:"意见选择",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),i.ideas||t({method:"post",url:rootPath+"/idea/findMyIdea"}).then(function(t){i.ideas=t.data}),i.deleteCommonIdea=function(){var o=$("#commonIdeaTable input[type='checkbox']:checked");if(o.length<1)e.alert("请选择要删除的意见！");else{for(var n=[],a=0;a<o.length;a++)o[a].value&&n.push(o[a].value),$.each(i.ideas,function(t,e){t==o[a].name&&i.ideas.splice(t,1)});if(n.length>0){var r=n.join(",");t({method:"delete",url:rootPath+"/idea",params:{ideas:r}}).then(function(o){e.alert("删除成功！",function(){t({method:"post",url:rootPath+"/idea/findMyIdea"}).then(function(t){i.ideas=t.data})})})}}},i.addCorrentIdea=function(t){i.ideaContent+=t},i.addCommonIdea=function(){i.ideas||(i.ideas=[]),i.newIdea={},i.newIdea.ideaType="1",i.ideas.push(i.newIdea)},i.saveCommonIdea=function(){if(0==i.ideas.length)return void e.alert("请编辑你要保存的意见信息！");t({method:"post",url:rootPath+"/idea",headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(i.ideas)}).then(function(t){t.data.flag||"ok"==t.data.reCode?(i.ideas=t.data.reObj,e.alert("添加成功！")):e.alert(t.data.reMsg)})},i.saveCurrentIdea=function(){var t=$("#"+o.targetId);t.val(t.val()+i.ideaContent),window.parent.$("#ideaWindow").data("kendoWindow").close(),t.focus()}}function o(e){var i={method:"post",url:rootPath+"/idea/findMyIdea"},o=function(t){e.ideas=t.data};common.http({$http:t,httpOptions:i,success:o})}return{initIdeaData:i,initIdea:o}}angular.module("app").factory("ideaSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="单位列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletecompany(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryConpany=function(){e.queryConpany(i)},function(){e.grid(i)}()}angular.module("app").controller("companyCtrl",t),t.$inject=["$location","companySvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="新增单位",o.iscompanyExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新单位"),o.create=function(){e.createcompany(o)},o.update=function(){e.updatecompany(o)},function(){o.isUpdate&&e.getcompanyById(o)}()}angular.module("app").controller("companyEditCtrl",t),t.$inject=["$location","companySvc","$state"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#form")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{
field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"coName",title:"单位名称",width:220,filterable:!1},{field:"coPhone",title:"单位电话",width:100,filterable:!1},{field:"coPC",title:"邮编",width:100,filterable:!1},{field:"coAddress",title:"地址",width:160,filterable:!1},{field:"coType",title:"单位类型",width:160,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function o(t){t.gridOptions.dataSource.read()}function n(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0;var i={method:"post",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function a(e){var i={method:"get",url:l+"/html/findByIdCompany",params:{id:e.id}},o=function(t){e.model=t.data,console.log(e.model)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function s(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}var l=rootPath+"/company",c="#/company";rootPath;return{grid:i,createcompany:n,getcompanyById:a,updatecompany:r,deletecompany:s,queryConpany:o}}angular.module("app").factory("companySvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="处室管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteDept(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryDept=function(){e.queryDept(i)},function(){e.grid(i)}()}angular.module("app").controller("deptCtrl",t),t.$inject=["$location","deptSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="编辑处室",o.isuserExist=!1,o.deptId=i.params.deptId,o.deptId&&(o.isUpdate=!0,o.title="更新处室"),o.create=function(){e.createDept(o)},o.update=function(){e.updateDept(o)},function(){o.isUpdate&&e.getDeptById(o)}()}angular.module("app").controller("deptEditCtrl",t),t.$inject=["$location","deptSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function o(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function a(e){var i={method:"get",url:rootPath+"/dept/html/findById",params:{deptId:e.deptId}},o=function(t){t.data.offices&&(e.offices={},e.offiecs=t.data.offices),e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/fingByOData",$("#formDept")),schema:common.kendoGridConfig().schema({id:"deptId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.deptId)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"deptName",title:"处室名称",width:100,filterable:!1},{field:"deptUserName",title:"联系人",width:100,filterable:!1},{field:"address",title:"地址",width:100,filterable:!1},{field:"deptType",title:"类型",width:100,filterable:!1},{field:"",title:"状态",width:100,filterable:!1,template:function(t){return t.status?5==t.status?"正常":7==t.status?"已删除":void 0:" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.deptId+"')",t.deptId,t.deptId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var s=rootPath+"/dept",l="#/listDept";return{grid:r,getDeptById:a,createDept:n,deleteDept:o,updateDept:i,queryDept:e}}angular.module("app").factory("deptSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="办事处人员列表",n.id=e.params.deptId,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.deptOfficeGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.addOfficeUser=function(t){o.addOfficeUser(n,t)},n.remove=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),o.deletedeptOfficeUser(n,t)}})},n.removes=function(){var t=common.getKendoCheckId(".deptOfficeGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.remove(o)}},function(){o.grid(n),o.deptOfficeGrid(n)}()}angular.module("app").controller("deptOfficeUserCtrl",t),t.$inject=["$location","$state","deptSvc","deptOfficeUserSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/dept/addOfficeUser",params:{deptId:e.id,officeId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.deptOfficeGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function i(e){var i={method:"get",url:common.format(c+"/getDepts")},o=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:rootPath+"/dept/deleteOfficeUsers",params:{deptId:e.id,officeId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e){var i={method:"get",url:rootPath+"/dept/html/findById",params:{officeID:e.officeID}},o=function(t){t.data.dept&&(e.depts={}),e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#allUserGridBtns").html(),"vm.addOfficeUser('"+t.officeID+"')",t.officeID)}}];t.deptOfficeGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var c=rootPath+"/dept",d="#/deptList",u=rootPath+"/dept/getDeptOfficeUsers",m=rootPath+"/dept/NotInoDeptfficeUsers";return{grid:l,getdeptById:r,createdept:a,deletedeptOfficeUser:n,updatedept:o,getDepts:i,deptOfficeGrid:s,addOfficeUser:e}}angular.module("app").factory("deptOfficeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="字典",o.model={},function(){t.initDictTree(function(t){function e(t,e,o){i.go("dict.edit",{id:o.id})}var n,a={callback:{onClick:e},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},r=$linq(t.value).select(function(t){var e=null;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();n=$.fn.zTree.init($("#zTree"),a,r),o.dictsTree=n})}(),o.del=function(n){e.confirm({title:"询问提示",message:"删除字典将会连下级字典一起删除，确认删除数据吗？",onOk:function(){t.deleteDict(n,o.isSubmit,function(t){o.isSubmit=!1,t.flag||"ok"==t.reCode?e.alert("消息提示","操作成功！",function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),i.go("dict",{},{reload:!0})}):e.alert(t.reMsg)})}})},o.dels=function(){var t=o.dictsTree.getSelectedNodes();t&&t.length>0?o.del(t[0].id):e.alert("请选择要删除的数据！")}}angular.module("app").controller("dictCtrl",t),t.$inject=["dictSvc","bsWin","$state"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="增加字典",n.model={},n.id=o.params.id,n.id&&(n.isUpdate=!0,n.title="编辑字典"),n.model.dictSort=0,function(){n.isUpdate?i.getDictById(n.id,function(t){t.flag||"ok"==t.reCode?(n.model=t.reObj,i.getTreeData(function(t){if(n.treeData={},n.treeData=t.value,n.isUpdate&&n.treeData&&n.model.parentId)for(var e=0;e<n.treeData.length;e++)if(n.treeData[e].dictId==n.model.parentId){n.model.parentDictName=n.treeData[e].dictName;break}})):e.alert(t.reMsg)}):(n.model.dictCode="",i.initpZtreeClient(function(t){var e={check:{enable:!0,chkStyle:"radio",radioType:"all"},callback:{},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},i=$linq(t.value).select(function(t){var e;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();n.zpTree=$.fn.zTree.init($("#pzTree"),e,i)}))}(),n.createDict=function(){if(common.initJqValidation(),$("form").valid()){var t=n.zpTree.getCheckedNodes(!0);t&&t.length>0&&(n.model.parentId=t[0].id),i.createDict(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?($(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.alert("系统提示","操作成功！",function(){o.go("dict",{},{reload:!0})})):e.alert(t.reMsg)})}else e.alert("数据填写正确，请检查修改后再提交")},n.updateDict=function(){common.initJqValidation(),$("form").valid()?i.updateDict(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?($(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.alert("系统提示","操作成功！",function(){o.go("dict.edit",{id:n.model.dictId},{reload:!0})})):e.alert(t.reMsg)}):e.alert("数据填写正确，请检查修改后再提交")},n.dictTypeChange=function(){n.model.dictType&&(n.model.dictKey="")},n.apply=function(){t.$apply()}}angular.module("app").controller("dictEditCtrl",t),t.$inject=["$scope","bsWin","dictSvc","$state"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:common.format(u+"?dictCode={0}","DICT_SEX")},o=function(t){};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function a(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e,i,o){i=!0;var n={method:"post",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function s(e,i,o){i=!0;var n={method:"put",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function l(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function c(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function d(e,i){var o={method:"post",url:rootPath+"/dict/fingById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}var u=(rootPath,rootPath+"/dict/dictNameData");return{initDictTree:l,createDict:r,getDictById:d,updateDict:s,deleteDict:a,initpZtreeClient:c,getTreeData:n,getdictItems:o}}angular.module("app").factory("dictSvc",t),t.$inject=["$http","$state","$location"]}(),function(){"dispatch strict";function t(t,e,i,o,n,a){var r=this;r.title="项目发文编辑",r.sign={},r.searchSign={},r.dispatchDoc={},r.dispatchDoc.signId=i.params.signid,r.dispatchDoc.id="",r.showFlag={buttSysFile:!1,isReveiwDS:!1},r.busiFlag={isMerge:!1,isMain:!1},function(){t.initDispatchData(r)}(),r.watchIsRelated=function(){n.$watch("vm.dispatchDoc.isRelated",function(t,e){0!=t&&"0"!=t||9!=e&&"9"!=e||1!=r.sign.isAssociate?0!=e&&"0"!=e||9!=t&&"9"!=t||r.sign.isAssociate&&0!=r.sign.isAssociate||o.confirm({title:"询问提示",message:"您要进行项目关联么？",onOk:function(){r.searchAssociateSign||(r.searchAssociateSign={signid:r.sign.signid,projectname:r.sign.projectname}),a.getAssociateSign(r.searchAssociateSign,function(t){r.currentAssociateSign=r.sign,r.associateSignList=[],t&&(r.associateSignList=t),$("#associateWindow").kendoWindow({width:"80%",height:"620px",title:"项目关联",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},onCancel:function(){r.dispatchDoc.isRelated=0}}):o.confirm({title:"询问提示",message:"该项目已经进行了关联，您要解除关联么？",onOk:function(){$(".confirmDialog").modal("hide"),a.saveAssociateSign(i.params.signid,null,function(){o.alert("项目解除关联成功"),window.location.reload()})},onCancel:function(){r.dispatchDoc.isRelated=9},onClose:function(){r.dispatchDoc.isRelated=9}})})},r.associateQuerySign=function(){a.getAssociateSign(r.searchAssociateSign,function(t){r.associateSignList=[],t&&(r.associateSignList=t)})},r.saveAssociateSign=function(t){if(r.sign.signid==t)return void o.alert("不能关联自身项目");a.saveAssociateSign(r.sign.signid,t,function(){t&&(r.sign.isAssociate=1),o.alert(void 0!=t?"项目关联成功":"项目解除关联成功",function(){window.parent.$("#associateWindow").data("kendoWindow").close()})})},r.initFileUpload=function(){r.dispatchDoc.id||n.$watch("vm.dispatchDoc.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.dispatchDoc.id,mainId:r.dispatchDoc.signId,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().DISPATCH,sysBusiType:e.mainTypeValue().DISPATCH},e.initUploadOptions({inputId:"sysfileinput",vm:r})},r.sigleProject=function(){"1"==r.dispatchDoc.dispatchWay?r.busiFlag.isMerge&&r.busiFlag.isMain&&o.confirm({title:"询问提示",message:"该项目已经设为合并发文，并且已经有关联项目，如果现在要取消合并发文，以前的关联信息将被删除，您确定要取消合并发文么?",onOk:function(){$(".confirmDialog").modal("hide"),t.deleteAllMerge(r.dispatchDoc.signId,function(t){(t.flag||"ok"==t.reCode)&&(r.dispatchDoc.isMainProject="0",r.busiFlag.isMerge=!1,r.busiFlag.isMain=!1),o.alert(t.reMsg)})},onClose:function(){},onCancel:function(){r.dispatchDoc.dispatchWay="2",$(".confirmDialog").modal("hide")}}):"2"==r.dispatchDoc.dispatchWay&&(r.busiFlag.isMerge||(r.busiFlag.isMerge=!0,r.busiFlag.isMain="9"==r.dispatchDoc.isMainProject))},r.create=function(){common.initJqValidation($("#dispatch_form")),$("#dispatch_form").valid()?t.saveDispatch(r):o.alert("页面未填报完整或者为正确，请检查！")},r.count=function(){var t=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/;if(!t.test(r.dispatchDoc.declareValue))return r.dispatchDoc.declareValue=0,void $("span[data-valmsg-for='declareValue']").html("金额只能输入数字！");if(!t.test(r.dispatchDoc.authorizeValue))return r.dispatchDoc.authorizeValue=0,void $("span[data-valmsg-for='authorizeValue']").html("金额只能输入数字！");$("span[data-valmsg-for='declareValue']").html(""),$("span[data-valmsg-for='authorizeValue']").html("");var e=(parseFloat(r.dispatchDoc.declareValue)-parseFloat(r.dispatchDoc.authorizeValue)).toFixed(2),i=parseFloat(e/r.dispatchDoc.declareValue*1e4/100).toFixed(2);r.dispatchDoc.extraRate=i,r.dispatchDoc.extraValue=e},r.gotoMergePage=function(){r.busiFlag.isMain="9"==r.dispatchDoc.isMainProject,9!=r.dispatchDoc.isMainProject||r.dispatchDoc.id?(t.initMergeInfo(r,r.dispatchDoc.signId),$("#mergeSign").kendoWindow({width:"75%",height:"700px",title:"合并发文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):o.alert("请先保存！")},r.chooseSign=function(){var e=$("input[name='mergeSign']:checked");if(0==e.length)o.alert("请选择要合并发文的项目！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.chooseProject(r.dispatchDoc.signId,i.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(r,r.dispatchDoc.signId),o.alert(e.reMsg)})}},r.cancelSign=function(){var e=$("input[name='cancelMergeSignid']:checked");if(e.length<1)o.alert("请选择要取消合并发文的项目！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.cancelProject(r.dispatchDoc.signId,i.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(r,r.dispatchDoc.signId),o.alert(e.reMsg)})}},r.onClose=function(){window.parent.$("#mwindow").data("kendoWindow").close()},r.filterSign=function(t){var e=!0;if(r.searchSign.projectname&&-1==t.projectname.indexOf(r.searchSign.projectname)&&(e=!1),r.searchSign.reviewstage&&t.reviewstage!=r.searchSign.reviewstage&&(e=!1),e)return t},r.formReset=function(){r.searchSign={}}}angular.module("app").controller("dispatchEditCtrl",t),t.$inject=["dispatchSvc","sysfileSvc","$state","bsWin","$scope","signSvc"]}(),function(){"dispatch strict";function t(t,e,i,o){function n(t,e){u(e,function(e){t.unMergeSign=[],t.unMergeSign=e}),d(e,function(e){t.mergeSign=[],t.mergeSign=e})}function a(t){t.busiFlag.signleToMerge=!1;var o={method:"get",url:rootPath+"/dispatch/initData",params:{signid:t.dispatchDoc.signId}},n=function(e){var o=e.data;t.sign=o.sign,t.dispatchDoc=o.dispatch,t.dispatchDoc.signId=i.params.signid,t.dispatchDoc.dispatchWay&&2==t.dispatchDoc.dispatchWay&&(t.busiFlag.isMerge=!0),t.dispatchDoc.isMainProject&&9==t.dispatchDoc.isMainProject&&(t.busiFlag.isMain=!0),t.associateDispatchs=o.associateDispatchs,t.proofread=o.mainUserList,2==t.dispatchDoc.dispatchWay&&0==t.dispatchDoc.isMainProject&&(t.showFlag.isReveiwDS=!0),t.initFileUpload(),t.watchIsRelated()};common.http({vm:t,$http:e,httpOptions:o,success:n})}function r(t){t.isCommit=!0;var i={method:"post",url:rootPath+"/dispatch",data:t.dispatchDoc},n=function(e){t.isCommit=!1,(e.data.flag||"ok"==e.data.reCode)&&(t.dispatchDoc.dispatchWay&&2==t.dispatchDoc.dispatchWay&&(t.busiFlag.isMerge=!0),t.dispatchDoc.isMainProject&&9==t.dispatchDoc.isMainProject&&(t.busiFlag.isMain=!0),t.dispatchDoc.id||(t.dispatchDoc.id=e.data.reObj.id)),o.alert(e.data.reMsg)};common.http({$http:e,httpOptions:i,success:n,onError:function(){t.isCommit=!1}})}function s(t,i,o){var n={method:"post",url:rootPath+"/signView/mergeSign",params:{signId:t,mergeIds:i,mergeType:"2"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:e,httpOptions:n,success:a})}function l(t,i,o){var n={signId:t,mergeType:"2"};i&&(n.cancelIds=i);var a={method:"post",url:rootPath+"/signView/cancelMergeSign",params:n},r=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:e,httpOptions:a,success:r})}function c(t,i){var o={method:"post",url:rootPath+"/signView/deleteAllMerge",params:{signId:t,mergeType:"2"}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}function d(t,i){var o={method:"post",url:rootPath+"/signView/getMergeDISSign",params:{signId:t}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}function u(t,i){var o={method:"post",url:rootPath+"/signView/unMergeDISSign",params:{signId:t}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}return{initDispatchData:a,saveDispatch:r,initMergeInfo:n,unMergeDISSign:u,getMergeDISSign:d,chooseProject:s,cancelProject:l,deleteAllMerge:c}}angular.module("app").factory("dispatchSvc",t),t.$inject=["sysfileSvc","$http","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/expertOffer",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(i){if(common.initJqValidation($("#expert_offer_form")),$("#expert_offer_form").valid()){i.expertOffer.expertId=i.model.expertID;var o={method:"put",url:rootPath+"/expertOffer",data:i.expertOffer},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){e.getExpertById(i),common.alert({vm:i,msg:"操作成功"})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}}return{saveOffer:i,updateOffer:o}}angular.module("app").factory("expertOfferSvc",t),t.$inject=["$http","expertSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="专家审核",function(){e.auditGrid(i)}(),i.searchAudit=function(){e.searchAudit(i)},i.auditToOfficial=function(){e.auditTo(i,2)},i.auditToAlternative=function(){e.auditTo(i,3)},i.auditToStop=function(){e.auditTo(i,4)},i.auditToRemove=function(){e.auditTo(i,5)},i.officialToAudit=function(){e.toAudit(i,2)},i.alternativeToAudit=function(){e.toAudit(i,3)},i.stopToAudit=function(){e.toAudit(i,4)},i.temoveToAudit=function(){e.toAudit(i,5)},i.findExportDetail=function(t){e.getExpertById(t,function(t){i.model=t,$("#auditExportDetail").kendoWindow({width:"80%",height:"auto",title:"专家详细信息",visible:!1,modal:!0,open:function(){$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+i.model.expertID+"&t="+Math.random())},closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})}}angular.module("app").controller("expertAuditCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e,i){var o=this;o.data={},o.title="专家列表",o.expertId="",o.headerType="专家类型",o.fileName="专家信息",o.expert={},function(){e.grid(o)}(),o.search=function(){e.searchMuti(o)},o.searchAudit=function(){e.searchMAudit(o)},o.formReset=function(){e.formReset(o)},o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpert(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.findExportDetail=function(t){e.getExpertById(t,function(t){o.model=t,$("#queryExportDetail").kendoWindow({width:"80%",height:"auto",title:"专家详细信息",visible:!1,modal:!0,open:function(){$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+o.model.expertID+"&t="+Math.random())},closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},o.exportToExcel=function(){e.exportToExcel(o)}}angular.module("app").controller("expertCtrl",t),t.$inject=["$location","expertSvc","$state"]}(),function(){"expert strict";function t(t,e,i,o,n,a,r,s){function l(t){var e={language:"zh",allowedPreviewTypes:["image"],allowedFileExtensions:["jpg","png","gif"],maxFileSize:2e3,showRemove:!1,uploadUrl:rootPath+"/expert/uploadPhoto",uploadExtraData:{expertId:t.model.expertID}};$("#expertphotofile").fileinput(e).on("filebatchselected",function(t,e){}).on("fileuploaded",function(e,i){$("#expertPhotoSrc").removeAttr("src"),$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+t.model.expertID+"&t="+Math.random())})}var c=this;c.model={},c.data={},c.title="专家信息编辑",c.isuserExist=!1,c.expertID=r.params.expertID,c.showSS=!0,c.showSC=!1,c.showWS=!0,c.showWC=!1,c.MW=!1,c.MS=!1,function(){c.expertID&&o.getExpertById(c.expertID,function(t){c.model=t,c.showSS=!1,c.showSC=!0,c.showWS=!1,c.showWC=!0,l(c),$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+c.model.expertID+"&t="+Math.random())})}(),c.selReviewProject=function(){c.model.expertID&&$("#reviewProject").kendoWindow({width:"75%",height:"600px",title:"评审项目列表",visible:!1,open:function(){c.isLoading=!0,o.reviewProjectGrid(c.model.expertID,function(t){c.isLoading=!1,t&&t.length>0?(c.reviewProjectList=t,c.noData=!1):c.noData=!0})},modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},c.queryDetail=function(t,e){$("#reviewProject").data("kendoWindow").close(),r.go("signDetails",{signid:t,processInstanceId:e})},c.showUploadWin=function(){c.model.expertID?$("#uploadWin").kendoWindow({width:"660px",height:"360px",title:"上传头像",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():common.alert({vm:c,msg:"先保存数据在执行操作！"})},c.saveEP=function(){common.initJqValidation(),$("form").valid()?(c.isSubmit=!0,c.model.birthDay=$("#birthDay").val(),c.model.graduateDate=$("#graduateDate").val(),o.saveExpert(c.model,c.isSubmit,function(e){c.isSubmit=!1,e.flag||"ok"==e.reCode?(c.model.expertID=e.reObj.expertID,c.model.expertNo=e.reObj.expertNo,t.success("保存成功！")):t.error(e.reMsg)})):t.alert("专家信息没有填写完整")},c.gotoWPage=function(){c.model.expertID?$("#wrwindow").kendoWindow({width:"680px",height:"420px",title:"工作简历",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},c.saveWorks=function(){common.initJqValidation($("#workForm")),$("#workForm").valid()&&(c.work.expertID||(c.work.expertID=c.model.expertID),i.saveWork(c.work,function(e){e.flag||"ok"==e.reCode?(c.work.weID?$.each(c.model.workDtoList,function(t,i){i.weID==c.work.weID&&(i=e.reObj)}):(c.model.workDtoList||(c.model.workDtoList=[]),c.model.workDtoList.push(e.reObj)),t.success(e.reMsg,function(){c.work={},c.onWClose()})):t.error(e.reMsg)}))},c.updateWork=function(){var e=$("input[name='checkwr']:checked");if(e.length<1)t.alert("请选择要更改的项目经历信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(c.model.workDtoList,function(t,e){e.weID==i&&(c.work=e)}),c.gotoWPage()}},c.deleteWork=function(){var e=$("input[name='checkwr']:checked");if(e.length<1)t.alert("请选择要删除的工作简历");else{var o=[];$.each(e,function(t,e){o.push(e.value)}),i.deleteWork(o.join(","),function(){$.each(o,function(t,e){$.each(c.model.workDtoList,function(t,i){i&&i.weID==e&&c.model.workDtoList.splice(t,1)})}),t.alert("操作成功！")})}},c.onWClose=function(){window.parent.$("#wrwindow").data("kendoWindow").close()},c.gotoJPage=function(){c.model.expertID?$("#pjwindow").kendoWindow({width:"690px",height:"330px",title:"添加项目经验",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},c.saveProject=function(){common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()&&(c.project.expertID||(c.project.expertID=c.model.expertID),c.project.projectbeginTime=$("#projectbeginTime").val(),c.project.projectendTime=$("#projectendTime").val(),e.saveProject(c.project,function(e){e.flag||"ok"==e.reCode?(c.project.peID?$.each(c.model.projectDtoList,function(t,i){i.peID==c.project.peID&&(i=e.reObj)}):(c.model.projectDtoList||(c.model.projectDtoList=[]),c.model.projectDtoList.push(e.reObj)),t.success(e.reMsg,function(){c.project={},c.onPClose()})):t.error(e.reMsg)}))},c.updateProjectPage=function(){var e=$("input[name='checkpj']:checked");if(e.length<1)t.alert("请选择要更改的项目经历信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(c.model.projectDtoList,function(t,e){e.peID==i&&(c.project=e)}),c.gotoJPage()}},c.delertProject=function(){common.initJqValidation();var i=$("input[name='checkpj']:checked");if(i.length<1)t.alert("请选择要删除的操作对象!");else{var o=[];$.each(i,function(t,e){o.push(e.value)}),e.delertProject(o.join(","),function(){$.each(o,function(t,e){$.each(c.model.projectDtoList,function(t,i){i&&i.peID==e&&c.model.projectDtoList.splice(t,1)})}),t.alert("操作成功！")})}},c.onPClose=function(){window.parent.$("#pjwindow").data("kendoWindow").close()},c.gotoExpertType=function(){c.model.expertID?$("#addExpertType").kendoWindow({width:"680px",height:"400px",title:"专家类型",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},c.onETlose=function(){a.cleanValue(),window.parent.$("#addExpertType").data("kendoWindow").close()},c.saveExpertType=function(){common.initJqValidation($("#expertTypeForm")),$("#expertTypeForm").valid()&&(c.expertType.expertID||(c.expertType.expertID=c.model.expertID),a.saveExpertType(c.expertType,function(e){e.flag||"ok"==e.reCode?(c.expertType.id?$.each(c.model.expertTypeDtoList,function(t,i){i.id==c.expertType.id&&(i=e.reObj)
}):(c.model.expertTypeDtoList||(c.model.expertTypeDtoList=[]),c.model.expertTypeDtoList.push(e.reObj)),t.success(e.reMsg,function(){c.expertType={},c.onETlose()})):t.error(e.reMsg)}))},c.updateProjectType=function(){var e=$("input[name='checkEType']:checked");if(e.length<1)t.alert("请选择要更改的专业信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(c.model.expertTypeDtoList,function(t,e){e.id==i&&(c.expertType=e)}),c.expertType.majobSmallDicts=s.topSelectChange(c.expertType.maJorBig,s.DICT.MAJOR.dicts),c.gotoExpertType()}},c.delertProjectType=function(){var e=$("input[name='checkEType']:checked");if(e.length<1)t.alert("请选择删除的专家类别信息！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),a.deleteExpertType(i.join(","),function(){$.each(i,function(t,e){$.each(c.model.expertTypeDtoList,function(t,i){i&&i.id==e&&c.model.expertTypeDtoList.splice(t,1)})}),t.alert("操作成功！")})}},c.gotoOfferPage=function(){c.model.expertID?$("#ep_offer_div").kendoWindow({width:"820px",height:"600px",title:"专家聘书",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("先保存专家信息！")},c.saveOffer=function(){common.initJqValidation($("#expert_offer_form")),$("#expert_offer_form").valid()&&(c.expertOffer.expertId=c.model.expertID,n.saveOffer(c.expertOffer,function(e){e.flag||"ok"==e.reCode?(c.expertOffer.id?$.each(c.model.expertOfferDtoList,function(t,i){i.id==c.expertOffer.id&&(i=e.reObj)}):(c.model.expertOfferDtoList||(c.model.expertOfferDtoList=[]),c.model.expertOfferDtoList.push(e.reObj)),t.success(e.reMsg,function(){c.expertOffer={},c.onETlose()})):t.error(e.reMsg)}))},c.closeOffer=function(){window.parent.$("#ep_offer_div").data("kendoWindow").close()},c.showOffer=function(){var e=$("input[name='checkps']:checked");if(e.length<1)t.alert("请选择要查看的聘书信息！");else if(e.length>1)t.alert("每次只能查看一条记录！");else{var i=e.val();$.each(c.model.expertOfferDtoList,function(t,e){if(e.id==i)return void(c.expertOffer=e)}),c.showProjectOffer=!0,c.gotoOfferPage()}},c.chooseMW=function(){c.MW=!0,c.showWS=!0,c.showWC=!1},c.cancelMW=function(){c.showWS=!1,c.showWC=!0},c.sureMW=function(){c.majorWork?(c.model.majorWork=c.majorWork,c.showWS=!1,c.showWC=!0):common.alert({vm:c,msg:"您未选择专业，请选择！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})},c.chooseMS=function(){c.MS=!0,c.showSS=!0,c.showSC=!1},c.cancelMS=function(){c.showSS=!1,c.showSC=!0},c.sureMS=function(){c.majorStudy?(c.model.majorStudy=c.majorStudy,c.showSS=!1,c.showSC=!0):common.alert({vm:c,msg:"您未选择专业，请选择！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})},c.queryDetail=function(t,e){$("#reviewProject").data("kendoWindow").close(),r.go("signDetails",{signid:t,processInstanceId:e})}}angular.module("app").controller("expertEditCtrl",t),t.$inject=["bsWin","projectExpeSvc","workExpeSvc","expertSvc","expertOfferSvc","expertTypeSvc","$state","$rootScope"]}(),function(){"use strict";function t(t,e){var i=this;!function(){e.repeatGrid(i)}(),i.findExportDetail=function(t){e.getExpertById(t,function(t){i.model=t,$("#reExportDetail").kendoWindow({width:"80%",height:"auto",title:"专家详细信息",visible:!1,modal:!0,open:function(){$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+i.model.expertID+"&t="+Math.random())},closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})}}angular.module("app").controller("expertRepeatCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e){function i(){o.isSubmit=!0,o.noData=!1,e.expertScoreHis(o.selectHis,function(t){o.isSubmit=!1,o.expScoreList=t,console.log(o.expScoreList),o.expScoreList&&0!=o.expScoreList.length||(o.noData=!0)})}var o=this;o.data={},o.title="专家评分统计",o.selectHis={},o.selectHis.beginTime=(new Date).yearAgo(1),o.selectHis.endTime=(new Date).Format("yyyy-MM-dd"),o.expScoreList=[],i(),o.search=function(){i()},o.formReset=function(){o.selectHis={}}}angular.module("app").controller("expertScoreCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e){function i(){o.isSubmit=!0,o.noData=!1,e.expertSelectHis(o.selectHis,function(t){o.isSubmit=!1,o.expSelectList=t,t&&0!=t.length||(o.noData=!0)})}var o=this;o.title="专家抽取统计",o.selectHis={},o.selectHis.beginTime=(new Date).yearAgo(1),o.selectHis.endTime=(new Date).Format("yyyy-MM-dd"),o.expSelectList=[],i(),o.search=function(){i()},o.formReset=function(){o.selectHis={}}}angular.module("app").controller("expertSelectHisCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e,i){function o(t){$("#searchform")[0].reset(),t.gridOptions.dataSource.read()}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:S,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(t){t.gridOptions.dataSource.read()}function r(e,i,o){i=!0;var n={method:"post",url:rootPath+"/expert",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function s(e,i){var o={method:"post",url:S+"/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(t){var e=common.kendoGridDataSource(rootPath+"/expert/findByOData",$("#searchform")),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c(),dataBound:i,resizable:!0}}function c(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,template:"<span class='row-number'></span>",filterable:!1},{field:"name",title:"姓名",width:"7%",filterable:!1,template:function(t){return"<a  ng-click=\"vm.findExportDetail('"+t.expertID+"')\">"+t.name+"</a>"}},{field:"comPany",title:"工作单位",width:"18%",filterable:!1},{field:"phone",title:"办公电话",width:"15%",filterable:!1},{field:"userPhone",title:"手机号码",width:"13%",filterable:!1},{field:"job",title:"职位",width:"15%",filterable:!1},{field:"post",title:"职称",width:"10%",filterable:!1},{field:"expertSort",title:"专家类型",width:"10%",filterable:!1},{field:"",title:"操作",width:"8%",template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.expertID+"')",t.expertID)}}]}function d(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:60,filterable:!1,template:function(t){return"<a  ng-click=\"vm.findExportDetail('"+t.expertID+"')\">"+t.name+"</a>"}},{field:"degRee",title:"学位",width:50,filterable:!1},{field:"post",title:"职称",width:70,filterable:!1},{field:"applyDate",title:"录入时间",width:70,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"compositeScore",title:"专家星级",width:70,filterable:!1},{field:"comPany",title:"工作单位",width:120,filterable:!1}]}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '1' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:25,sort:{field:"createdDate",dir:"desc"}}),i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '2' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),o=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '3' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '4' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),a=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '5' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),r=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions1={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:d(),dataBound:r,resizable:!0},t.gridOptions2={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:d(),dataBound:r,resizable:!0},t.gridOptions3={dataSource:common.gridDataSource(o),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:d(),dataBound:r,resizable:!0},t.gridOptions4={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:d(),dataBound:r,resizable:!0},t.gridOptions5={dataSource:common.gridDataSource(a),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:d(),dataBound:r,resizable:!0}}function m(t){t.gridOptions1.dataSource.read(),t.gridOptions2.dataSource.read(),t.gridOptions3.dataSource.read(),t.gridOptions4.dataSource.read(),t.gridOptions5.dataSource.read()}function p(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findRepeatByOData"),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0}),i=function(){var t=this.items();$(t).each(function(t){$(this).find(".row-number").html(t+1)})};t.repeatGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:c(),dataBound:i,resizable:!0}}function f(t,e){var i=common.getKendoCheckId("#grid"+e);if(0==i.length)common.alert({vm:t,msg:"请选择数据"});else{for(var o=[],n=0;n<i.length;n++)o.push(i[n].value);g(t,o.join(","),1)}}function h(t,e){var i=common.getKendoCheckId("#grid1");if(0==i.length)common.alert({vm:t,msg:"请选择数据"});else{for(var o=[],n=0;n<i.length;n++)o.push(i[n].value);g(t,o.join(","),e)}}function g(e,i,o){e.isSubmit=!0;var n={method:"post",url:S+"/updateAudit",params:{ids:i,flag:o}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions1.dataSource.read(),e.gridOptions2.dataSource.read(),e.gridOptions3.dataSource.read(),e.gridOptions4.dataSource.read(),e.gridOptions5.dataSource.read(),common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}function v(t){var e=escape(encodeURIComponent(t.fileName));if(t.expert&&void 0!=t.expert)var i=JSON.stringify(t.expert),o=i.substring(1,i.length-1);window.open(rootPath+"/expert/exportToExcel?filterData="+escape(encodeURIComponent(o))+"&fileName="+e)}function w(e,i){var o={method:"post",url:rootPath+"/expert/expertSelectHis",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function b(e,i){var o={method:"post",url:rootPath+"/expert/expertScoreHis",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function y(e,i){var o={method:"post",url:rootPath+"/expert/reviewProject",params:{expertId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}var S=rootPath+"/expert";return{grid:l,auditGrid:u,getExpertById:s,saveExpert:r,deleteExpert:n,searchMuti:a,searchAudit:m,repeatGrid:p,updateAudit:g,toAudit:f,auditTo:h,formReset:o,exportToExcel:v,expertSelectHis:w,expertScoreHis:b,reviewProjectGrid:y}}angular.module("app").factory("expertSvc",t),t.$inject=["$http","FileSaver","Blob"]}(),function(){"expertType strict";function t(t,e,i,o){function n(){var t=$("#addExpertType").find("input");$.each(t,function(t,e){e.value=""})}function a(e){var i={method:"GET",url:rootPath+"/expertType/getExpertType?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.expertTypeList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var o={method:"get",url:rootPath+"/expertType/getExpertTypeById",params:{expertTypeId:e.expertTypeId}},n=function(t){e.expertType=t.data,e.expertType.majobSmallDicts=i.topSelectChange(e.expertType.maJorBig,i.DICT.MAJOR.dicts)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"post",url:rootPath+"/expertType",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(i){if(common.initJqValidation($("#expertTypeForm")),$("#expertTypeForm").valid()){i.expertType.expertID=i.expertID;var o={method:"put",url:rootPath+"/expertType",data:i.expertType},a=function(t){common.requestSuccess({vm:i,response:t,fn:function(){window.parent.$("#addExpertType").data("kendoWindow").close(),e.getExpertById(i),n(),common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:i,$http:t,httpOptions:o,success:a})}}function c(e,i){var o={method:"delete",url:rootPath+"/expertType",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{cleanValue:n,getExpertType:a,getExpertTypeById:r,saveUpdate:l,deleteExpertType:c,saveExpertType:s}}angular.module("app").factory("expertTypeSvc",t),t.$inject=["$http","expertSvc","$rootScope","bsWin"]}(),function(){"projectExpe strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/dict/getAllDictByCode",params:{dictCode:"PROJECTTYPE"}},o=function(t){e.projectTypes=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(e,i){var o={method:"delete",url:rootPath+"/projectExpe/deleteProject",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e){var i={method:"get",url:common.format(rootPath+"/projectExpe/getProject?$filter=peID eq '{0}'",e.peID)},o=function(t){e.project={},e.project.projectName=t.data[0].projectName,e.project.projectType=t.data[0].projectType,e.project.projectbeginTime=t.data[0].projectbeginTime,e.project.projectendTime=t.data[0].projectendTime,e.isUpdate};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){if(common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()){e.isSubmit=!0,e.project.peID=e.peID,e.project.expertID=e.expertID,e.project.projectbeginTime=$("#projectbeginTime").val(),e.project.projectendTime=$("#projectendTime").val();var i={method:"put",url:rootPath+"/projectExpe/updateProject",data:e.project},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#pjwindow").data("kendoWindow").close(),a(e),common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})}}common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"GET",url:rootPath+"/projectExpe/getProject?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.projectList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=$("input[name='checkpj']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.peID=e.val(),o(t),t.expertID=t.model.expertID,gotoJPage(t))}function s(e,i){var o={method:"post",url:rootPath+"/projectExpe/saveExpe",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{getProject:a,saveProject:s,updateProject:n,updateProjectPage:r,getProjectById:o,delertProject:i,initProjectType:e}}angular.module("app").factory("projectExpeSvc",t),t.$inject=["$http"]}(),function(){"workExpe strict";function t(t,e){function i(e){var i={method:"GET",url:rootPath+"/workExpe/getWork?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.workList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e,i){var o={method:"delete",url:rootPath+"/workExpe/deleteWork",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t){var e=$("input[name='checkwr']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.weID=e.val(),a(t),gotoWPage(t),t.expertID=t.model.expertID)}function a(e){var i={method:"get",url:common.format(rootPath+"/workExpe/getWork?$filter=weID eq '{0}'",e.weID)},o=function(t){e.work={},e.work.companyName=t.data[0].companyName,e.work.workJob=t.data[0].workJob,e.work.beginTime=t.data[0].beginTime,e.work.endTime=t.data[0].endTime};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:rootPath+"/workExpe/saveWorkExpe",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e){if(common.initJqValidation(),$("form").valid()){e.work.weID=e.weID,e.work.expertID=e.expertID,e.work.beginTime=$("#beginTime").val(),e.work.endTime=$("#endTime").val();var o={method:"put",url:rootPath+"/workExpe/updateWork",data:e.work},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#wrwindow").data("kendoWindow").close(),i(e),cleanValue(),common.alert({vm:e,msg:"操作成功",fn:function(){e.showWorkHistory=!0,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}}return{saveWork:r,updateWork:s,deleteWork:o,updateWorkPage:n,getWorkById:a,getWork:i}}angular.module("app").factory("workExpeSvc",t),t.$inject=["$http","expertSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="专家列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpertReview(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.initExpertGrid(i),e.getReviewList(i)}()}angular.module("app").controller("expertReviewCtrl",t),t.$inject=["$location","expertReviewSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加附件",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新附件"),o.create=function(){e.createExpertReview(o)},o.update=function(){e.updateExpertReview(o)},function(){o.isUpdate&&e.getExpertReviewById(o)}()}angular.module("app").controller("expertReviewEditCtrl",t),t.$inject=["$location","expertReviewSvc","$state"]}(),function(){"use strict";function t(t,e,i,o,n){function a(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function r(){if(s.expertReview.expertSelConditionDtoList.length>0){var t=!0;return s.expertReview.expertSelConditionDtoList.forEach(function(e,i){s.expertReview.id&&(e.expertReviewDto={},e.expertReviewDto.id=s.expertReview.id),e.officialNum&&a(e.officialNum)||($("#errorsOfficialNum"+e.id).html("必填，且为数字"),t=!1),e.alternativeNum&&a(e.alternativeNum)||($("#errorsAlternativeNum"+e.id).html("必填，且为数字"),t=!1),t&&($("#errorsOfficialNum"+e.id).html(""),$("#errorsAlternativeNum"+e.id).html(""))}),t}return!1}var s=this;s.title="选择专家",s.conMaxIndex=0,s.customCondition=new Array,s.expertReview={},s.confirmEPList=[],s.matchEPMap={},s.selectIds=[],s.autoSelectedEPList=[],s.businessId=o.params.businessId,s.minBusinessId=o.params.minBusinessId,s.businessType=o.params.businessType;o.params.expertID;s.findExportDetail=function(t){i.getExpertById(t,function(t){s.model=t,$("#selectExportDetail").kendoWindow({width:"80%",height:"auto",title:"专家详细信息",visible:!1,modal:!0,open:function(){$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+s.model.expertID+"&t="+Math.random())},closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},s.reFleshSelEPInfo=function(t){$.each(t,function(t,e){s.confirmEPList.push(e),s.selectIds.push(e.expertDto.expertID)}),s.excludeIds=s.selectIds.join(",")},s.reFleshAfterRemove=function(t){$.each(t,function(t,e){$.each(s.confirmEPList,function(t,i){i&&e==i.id&&s.confirmEPList.splice(t,1)})})},s.reFleshJoinState=function(t,e){$.each(t,function(t,i){$.each(s.confirmEPList,function(t,o){i==o.id&&(o.isJoin=e)})})},s.reFleshConfirmState=function(t,e){$.each(t,function(t,i){$.each(s.confirmEPList,function(t,o){i==o.id&&(o.isConfrim=e)})})},s.updateSelectedIndex=function(t){t?$.each(s.expertReview.expertSelConditionDtoList,function(e,i){i.id==t&&(i.selectIndex=i.selectIndex?i.selectIndex+1:1)}):$.each(s.expertReview.expertSelConditionDtoList,function(t,e){e.selectIndex=e.selectIndex?e.selectIndex+1:1})},s.init=function(e,i){t.initReview(e,i,function(t){s.expertReview=t,!angular.isUndefined(s.expertReview.expertSelectedDtoList)&&angular.isArray(s.expertReview.expertSelectedDtoList)&&($.each(s.expertReview.expertSelectedDtoList,function(t,e){s.selectIds.push(e.expertDto.expertID),s.confirmEPList.push(e)}),s.selectIds.length>0?s.excludeIds=s.selectIds.join(","):s.excludeIds="")})},function(){t.initExpertGrid(s),s.init(s.businessId,s.minBusinessId)}(),s.showSelfExpertGrid=function(){s.selfExpertOptions.dataSource.read(),$("#selfExpertDiv").kendoWindow({width:"80%",height:"680px",title:"自选评审专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.saveSelfExpert=function(){var e=common.getKendoCheckId("#selfExpertGrid");0==e.length?n.alert("请先选择专家！"):e.length>1?n.alert("自选专家最多只能选择一个！"):t.saveSelfExpert(s.businessId,s.minBusinessId,s.businessType,e[0].value,s.expertReview.id,s.isCommit,function(t){t.flag||"ok"==t.reCode?(s.expertReview.id||(s.expertReview.id=t.idCode),s.reFleshSelEPInfo(t.reObj),n.success("操作成功！",function(){window.parent.$("#selfExpertDiv").data("kendoWindow").close()})):n.error(t.reMsg)})},s.delertSelfExpert=function(){var e=$("input[name='seletedEp']:checked");e.length<1?n.alert("请选择要删除的专家"):n.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],o=0;o<e.length;o++)i.push(e[o].value);t.delSelectedExpert(s.expertReview.id,i.join(","),s.isCommit,function(t){t.flag||"ok"==t.reCode?(s.reFleshAfterRemove(i),n.success("操作成功！")):n.error(t.reMsg)})}})},s.querySelfExpert=function(){s.selfExpertOptions.dataSource.read()},s.showOutExpertGrid=function(){s.outExpertOptions.dataSource.read(),$("#outExpertDiv").kendoWindow({width:"70%",height:"680px",title:"自选新专家、市外、境外专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.delertOutSelfExpert=function(){var e=$("input[name='seletedOutEp']:checked");e.length<1?n.alert("请选择要删除的专家"):n.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],o=0;o<e.length;o++)i.push(e[o].value);t.delSelectedExpert(s.expertReview.id,i.join(","),s.isCommit,function(t){t.flag||"ok"==t.reCode?(s.reFleshAfterRemove(i),n.success("操作成功！")):n.error(t.reMsg)})}})},s.saveOutExpert=function(){var e=common.getKendoCheckId("#outExpertGrid");if(0==e.length)n.alert("请先选择专家！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.saveOutExpert(s.businessId,s.minBusinessId,s.businessType,i.join(","),s.expertReview.id,s.isCommit,function(t){t.flag||"ok"==t.reCode?(s.expertReview.id||(s.expertReview.id=t.idCode),s.reFleshSelEPInfo(t.reObj),n.success("操作成功！",function(){window.parent.$("#outExpertDiv").data("kendoWindow").close()})):n.error(t.reMsg)})}},s.queryOutExpert=function(){s.outExpertOptions.dataSource.read()},s.countMatchExperts=function(e){if(s.expertReview.id){var i={};s.expertReview.expertSelConditionDtoList.forEach(function(t,o){t.id==e&&(i=t)}),t.countMatchExperts(i,s.minBusinessId,s.expertReview.id,function(t){s.matchEPMap[e]=t,$("#expertCount"+e).html(t.length)})}else n.alert("请保存整体抽取方案再计算")},s.showMatchExperts=function(t){s.matchExpertList=[],s.matchExpertList=s.matchEPMap[t],$("#matchExpertDiv").kendoWindow({width:"70%",height:"600px",title:"统计专家信息列表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.checkIntegerValue=function(t,i,o){return e.isUnsignedInteger(t)?($("#errorsOfficialNum"+o).html(""),$("#errorsAlternativeNum"+o).html(""),t):($("#errorsOfficialNum"+o).html("只能填写数字"),void $("#errorsAlternativeNum"+o).html("只能填写数字"))},s.addCondition=function(){9==s.expertReview.state||"9"==s.expertReview.state?n.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):(s.expertReview.expertSelConditionDtoList||(s.expertReview.expertSelConditionDtoList=[]),s.condition={},s.condition.id=common.uuid(),s.condition.businessId=s.minBusinessId,s.condition.selectType="1",s.expertReview.expertSelConditionDtoList.push(s.condition))},s.removeCondition=function(){if(9==s.expertReview.state||"9"==s.expertReview.state)n.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！");else{var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?n.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],o=0;o<t.length;o++)$.each(s.expertReview.expertSelConditionDtoList,function(e,n){t[o].value==n.id&&i.push(n.id)});i.length>0?e.deleteSelConditions(i.join(","),s.isCommit,function(t){t.flag||"ok"==t.reCode?(n.success("操作成功！"),$.each(i,function(t,e){$.each(s.expertReview.expertSelConditionDtoList,function(t,i){e==i.id&&s.expertReview.expertSelConditionDtoList.splice(t,1)})})):n.error(t.reMsg)}):n.success("操作成功！")}}):n.alert("请选择要删除的抽取条件！")}},s.saveCondition=function(){9==s.expertReview.state||"9"==s.expertReview.state?n.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):r()?e.saveCondition(s.businessId,s.minBusinessId,s.businessType,s.expertReview.id,s.expertReview.expertSelConditionDtoList,function(t){t.flag||"ok"==t.reCode?(s.expertReview.expertSelConditionDtoList=t.reObj,s.expertReview.id||(s.expertReview.id=s.expertReview.expertSelConditionDtoList[0].expertReviewId),n.success("保存成功！")):n.error(t.reMsg)}):n.alert("专家抽取条件设置不完整！")},s.startAutoExpertWin=function(){return s.expertReview.id?9==s.expertReview.state||"9"==s.expertReview.state?void n.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):void(r()?e.saveCondition(s.businessId,s.minBusinessId,s.businessType,s.expertReview.id,s.expertReview.expertSelConditionDtoList,function(e){e.flag||"ok"==e.reCode?(s.expertReview.expertSelConditionDtoList=e.reObj,s.expertReview.id||(s.expertReview.id=s.expertReview.expertSelConditionDtoList[0].expertReviewId),t.queryAutoExpert(s.expertReview.expertSelConditionDtoList,s.minBusinessId,s.expertReview.id,function(e){e.flag||"ok"==e.reCode?(s.reFleshSelEPInfo(e.reObj.autoEPList),s.autoSelectedEPList=[],s.autoSelectedEPList=e.reObj.autoEPList,s.expertReview.state="9",s.showAutoExpertWin(),t.validateAutoExpert(e.reObj.allEPList,s)):n.error(e.reMsg)})):n.error(e.reMsg)}):n.alert("专家抽取条件设置不完整！")):void n.alert("请先进行整体！")},s.showAutoExpertWin=function(){$("#aotuExpertDiv").kendoWindow({width:"90%",height:"700px",title:"专家抽取",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.showAutoMatchResultWin=function(){$("#aotuMatchResultDiv").kendoWindow({width:"90%",height:"700px",title:"专家抽取结果",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.repeatAutoExpert=function(e){var i=[];if($.each(s.expertReview.expertSelConditionDtoList,function(t,o){o.id==e&&i.push(o)}),i[0].selectIndex>3)return void n.alert("该条件已经进行了3次抽取，不能再继续抽取！");t.queryAutoExpert(i,s.minBusinessId,s.expertReview.id,function(i){i.flag||"ok"==i.reCode?(s.reFleshSelEPInfo(i.reObj.autoEPList),s.expertReview.state="9",s.autoSelectedEPList=[],s.autoSelectedEPList=i.reObj.autoEPList,s.updateSelectedIndex(e),s.showAutoExpertWin(),t.validateAutoExpert(i.reObj.allEPList,s)):n.error(i.reMsg)})},s.affirmAutoExpert=function(){var e=$("#allAutoEPTable input[name='autoEPCheck']:checked");if(e.length<1)return void n.alert("请选择要确认的抽取专家！");for(var i=[],o=0;o<e.length;o++)i.push(e[o].value);t.affirmAutoExpert(s.minBusinessId,s.businessType,i.join(","),"9",function(t){t.flag||"ok"==t.reCode?(s.reFleshConfirmState(i,"9"),s.checkAutoOfficeExpert=!1,s.checkAutoAntiExpert=!1,n.success(t.reMsg)):n.error(t.reMsg)})},s.affirmJoinExpert=function(){$("#confirmJoinExpert").kendoWindow({width:"960px",height:"600px",title:"参加评审会专家确认",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.updateToJoin=function(){var e=$("#notJoinExpertTable input[name='notJoinExpert']:checked");if(e.length<1)n.alert("请选择要改为参加会议的专家");else{for(var i=[],o=0;o<e.length;o++)i.push(e[o].value);t.updateJoinState(s.minBusinessId,s.businessType,i.join(","),"9",s.isCommit,function(t){n.success("操作成功！"),s.reFleshJoinState(i,"9")})}},s.updateToNotJoin=function(){var e=$("#joinExpertTable input[name='joinExpert']:checked");if(e.length<1)n.alert("请选择未参加会议的专家");else{for(var i=[],o=0;o<e.length;o++)i.push(e[o].value);t.updateJoinState(s.minBusinessId,s.businessType,i.join(","),"0",s.isCommit,function(t){n.success("操作成功！"),s.reFleshJoinState(i,"0")})}}}angular.module("app").controller("expertSelectCtrl",t),t.$inject=["expertReviewSvc","expertConditionSvc","expertSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i,o){var n={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:e,minBusinessId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function o(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:100,filterable:!1,template:function(t){
return"<a  ng-click=\"vm.findExportDetail('"+t.expertID+"')\">"+t.name+"</a>"}},{field:"degRee",title:"学位",width:100,filterable:!1},{field:"sex",title:"性别",width:50,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!1},{field:"degRee",title:"职务",width:100,filterable:!1},{field:"expertSort",title:"专家类别",width:100,filterable:!1}]}function n(t){var e=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#selfSelExpertForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.selfExpertOptions={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o(),dataBound:e,resizable:!0};var n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#outSelExpertForm"),{filter:"state eq '3'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.outExpertOptions={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o(),dataBound:e,resizable:!0}}function a(e,i,o,n,a,r,s){r=!0;var l={method:"post",url:rootPath+"/expertReview/saveExpertReview",params:{businessId:e,minBusinessId:i,businessType:o,reviewId:angular.isUndefined(a)?"":a,expertIds:n,selectType:"2"}},c=function(t){r=!1,void 0!=s&&"function"==typeof s&&s(t.data)};common.http({$http:t,httpOptions:l,success:c,onError:function(t){r=!1}})}function r(e,i,o,n,a,r,s){r=!0;var l={method:"post",url:rootPath+"/expertReview/saveExpertReview",params:{businessId:e,minBusinessId:i,businessType:o,reviewId:angular.isUndefined(a)?"":a,expertIds:n,selectType:"3"}},c=function(t){r=!1,void 0!=s&&"function"==typeof s&&s(t.data)};common.http({$http:t,httpOptions:l,success:c,onError:function(t){r=!1}})}function s(e,i,o,n){var a={method:"post",url:rootPath+"/expert/countReviewExpert",data:e,params:{minBusinessId:i,reviewId:o}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r})}function l(e){var i={method:"get",url:rootPath+"/expertReview/html/getReviewList"},o=function(t){e.reviewList=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o,onError:function(t){e.isCommit=!1}})}function c(e,i,o,n){var a={method:"post",url:rootPath+"/expert/autoExpertReview",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e),params:{minBusinessId:i,reviewId:o}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r})}function d(t,i){var o=0,n=i.autoSelectedEPList.length,a=0,r=e(function(){if(0==n)e.cancel(r);else{var s=Math.floor(Math.random()*t.length);i.showAutoExpertName=t[s].name,o++,o%10==0&&(i.autoSelectedEPList[a].show=!0,i.autoSelectedEPList[a].official=!0,i.autoSelectedEPList[a+1].show=!0,i.autoSelectedEPList[a+1].official=!1,a+=2,n-=2)}},200)}function u(e,i,o,n,a,r){a=!0;var s={method:"post",url:rootPath+"/expertReview/updateJoinState",params:{minBusinessId:e,businessType:i,expertSelId:o,state:n}},l=function(t){void 0!=r&&"function"==typeof r&&r(t.data)};common.http({$http:t,httpOptions:s,success:l,onError:function(t){a=!1}})}function m(e,i,o,n,a){var r={method:"post",url:rootPath+"/expertReview/affirmAutoExpert",params:{minBusinessId:e,businessType:i,expertSelId:o,state:n}},s=function(t){void 0!=a&&"function"==typeof a&&a(t.data)};common.http({$http:t,httpOptions:r,success:s,onError:function(t){}})}function p(e,i,o,n){o=!0;var a={method:"delete",url:rootPath+"/expertSelected",params:{reviewId:e,id:i,deleteAll:!1}},r=function(t){o=!1,void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r,onError:function(t){o=!1}})}function f(e,i){var o={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n,onError:function(t){}})}function h(e,i){var o={method:"put",url:rootPath+"/expertSelected",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function g(e,i,o){if(!w(e))return void bsWin.alert("应纳税额计算错误,保存失败！");i=!0;var n={method:"post",url:rootPath+"/expertReview/saveExpertReviewCostSingle",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function v(e,i,o){var n=rootPath+"/expertReview/getExpertReviewCost?expertIds={0}&month={1}",a={method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:common.format(n,e,i)},r=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:a,success:r})}function w(t){var e=!0;return void 0!=t&&t.length>0&&t.forEach(function(t,i){if(void 0==t.payDate)return t.errorMsg="请选择发放日期",void(e=!1);t.errorMsg="";var o=void 0==t.reviewCost?0:t.reviewCost,n=void 0==t.reviewTaxes?0:t.reviewTaxes,a=void 0==t.totalCost?0:t.totalCost;if(void 0!=t.expertSelectedDtoList&&t.expertSelectedDtoList.length>0){var r=0,s=0,l=0;if(t.expertSelectedDtoList.forEach(function(t,i){var o=void 0==t.reviewCost?0:t.reviewCost,n=void 0==t.reviewTaxes?0:t.reviewTaxes,a=void 0==t.totalCost?0:t.totalCost;if((parseFloat(o)+parseFloat(n)).toFixed(2)!=parseFloat(a).toFixed(2))return void(e=!1);r=parseFloat(r)+parseFloat(o),s=parseFloat(s)+parseFloat(n),l=parseFloat(l)+parseFloat(a)}),parseFloat(r).toFixed(2)!=parseFloat(o).toFixed(2))return void(e=!1);if(parseFloat(s).toFixed(2)!=parseFloat(n).toFixed(2))return void(e=!1);if(parseFloat(l).toFixed(2)!=parseFloat(a).toFixed(2))return void(e=!1)}}),e}return{initExpertGrid:n,saveSelfExpert:a,saveOutExpert:r,countMatchExperts:s,getReviewList:l,initReview:i,delSelectedExpert:p,queryAutoExpert:c,validateAutoExpert:d,affirmAutoExpert:m,updateJoinState:u,findByBusinessId:f,saveMark:h,savePayment:g,countTaxes:v}}angular.module("app").factory("expertReviewSvc",t),t.$inject=["$http","$interval"]}(),function(){"use strict";function t(t){function e(e,i,o,n,a,r){var s={method:"post",url:rootPath+"/expertSelCondition/saveConditionList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(a),params:{businessId:e,minBusinessId:i,reviewId:n,businessType:o}},l=function(t){void 0!=r&&"function"==typeof r&&r(t.data)};common.http({$http:t,httpOptions:s,success:l})}function i(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function o(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/expertSelCondition",params:{ids:e}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}return{saveCondition:e,deleteSelConditions:o,isUnsignedInteger:i}}angular.module("app").factory("expertConditionSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(e,i){var o={method:"get",url:rootPath+"/fileLibrary/getFileUrlById",params:{fileId:i}},n=function(t){e.fileUrl=t.data.fileUrl,e.title=t.data.fileUrl,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(t){t.gridOptions.dataSource.read()}function r(e,i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteRootDirectory",params:{parentFileId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteFile",params:{fileId:i}},n=function(t){e.gridOptions.dataSource.read()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"put",url:rootPath+"/fileLibrary/updateFile",data:e.fileLibrary},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.addFolderWindow()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function d(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.fileUrl=e.fileLibrary.fileUrl,e.fileName=e.fileLibrary.fileName,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function u(e,i){if(common.initJqValidation(),$("form").valid()){var o={method:"post",url:rootPath+"/fileLibrary/saveFile",data:e.fileLibrary},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}}function m(e,i){var o={method:"get",url:rootPath+"/fileLibrary/initFileFolder",params:{fileType:e.fileLibrary.fileType}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function p(e,i){var o={method:"post",url:rootPath+"/fileLibrary/addFileFolder",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function f(e,i){if(void 0!=e.fileName){var o={method:"post",url:rootPath+"/fileLibrary/addFileFolder",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}else common.alert({vm:vm,msg:"文件名不能为空",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function h(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/fileLibrary/initFileList?fileId="+t.parentId,$("#"+t.formId)),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"issue",dir:"asc"}]}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"fileName",title:"文件名",width:100,filterable:!1},{field:"",title:"附件",width:300,filterable:!1,template:function(t){if(t.sysFileDtoList.length>0){for(var e="",i=0,o=t.sysFileDtoList.length;i<o;i++)e+="<li>"+t.sysFileDtoList[i].showName+"</li>";return e}return""}},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.fileId+"')","vm.update('"+t.fileId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}return{saveRootFolder:p,saveChildFolder:f,initFileFolder:m,initFileList:h,saveFile:u,findFileById:d,updateFile:l,deleteFile:s,deleteRootDirectory:r,folderById:c,queryUser:a,getFileUrlById:n}}angular.module("app").factory("fileLibrarySvc",t),t.$inject=["$http","$state","$location","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.parentId=e.params.parentId,a.fileId=e.params.fileId,a.fileLibrary={},a.fileLibrary.fileType="POLICY",function(){o.initFileFolder(a,function(t){function i(t,i,o){e.go("policyLibrary.policyList",{parentId:o.id})}function o(t,e,i){var o=$.fn.zTree.getZTreeObj("zTree"),i=o.getSelectedNodes();console.log(i),a.onRemove(i.id)}function n(t,e){if("FOLDER"==e.fileNature){var i=$("#"+e.tId+"_span");if(e.editNameFlag||$("#addBtn_"+e.tId).length>0)return;var o="<span class='button add' id='addBtn_"+e.tId+"' title='添加子节点' onfocus='this.blur();'></span>";i.after(o);var n=$("#addBtn_"+e.tId);n&&n.bind("click",function(){$.fn.zTree.getZTreeObj("zTree"),a.addFolderWindow(e.id)})}}function r(t,e){$("#addBtn_"+e.tId).unbind().remove()}var s,l={check:{enable:!0,chkStyle:"radio",chkboxType:{Y:"",N:""}},edit:{enable:!0,showRenameBtn:!1,showRemoveBtn:!1,showAddBtn:!0,removeTitle:"删除节点"},view:{addHoverDom:n,removeHoverDom:r,dblClickExpand:!0},callback:{onClick:i,beforeRemove:o},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},c=$linq(t).select(function(t){var e=null;return t.parentFileId&&(e=t.parentFileId),{id:t.fileId,name:t.fileName,pId:e,fileNature:t.fileNature}}).toArray();s=$.fn.zTree.init($("#zTree"),l,c),a.folderTree=s})}(),a.addFolderWindow=function(t){a.fileLibrary={},a.fileLibrary.fileType="POLICY",void 0!=t&&(a.fileLibrary.parentFileId=t),$("#addRootFolder").kendoWindow({width:"500px",height:"300px",title:"新建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},a.saveRootFolder=function(){void 0!=a.fileLibrary.fileName?o.saveRootFolder(a.fileLibrary,function(t){t.flag||"ok"==t.reCode?n.alert("保存成功！",function(){window.parent.$("#addRootFolder").data("kendoWindow").close(),e.go("policyLibrary",{},{reload:!0})}):n.error(t.reMsg)}):n.alert("文件名不能为空!")},a.deleteFolder=function(){var t=$.fn.zTree.getZTreeObj("zTree"),i=t.getCheckedNodes();if(void 0!=i&&i.length>0){var a=i[0].id;n.confirm("删除的文件将无法恢复，确认删除？",function(){o.deleteRootDirectory(a,function(t){t.flag||"ok"==t.reCode?(n.success("操作成功！"),e.go("policyLibrary",{},{reload:!0})):n.error(t.reMsg)})})}}}angular.module("app").controller("policyCtrl",t),t.$inject=["$scope","$state","$location","fileLibrarySvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.parentId=t.params.parentId,a.fileLibrary={},a.fileLibrary.parentFileId=a.parentId,a.fileLibrary.fileType="POLICY",a.fileId=t.params.fileId,a.fileUrl="",a.fileName="",a.businessFlag={isInitFileOption:!1},a.initFileUpload=function(){a.fileId||o.$watch("vm.fileId",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.fileId,mainId:"",mainType:i.mainTypeValue().POLICYLIBRARY,sysBusiType:a.fileUrl.substring(a.fileUrl.lastIndexOf(i.mainTypeValue().POLICYLIBRARY),a.fileUrl.lastIndexOf(a.fileName))},i.initUploadOptions({inputId:"sysfileinput",vm:a,uploadSuccess:function(){i.findByBusinessId(a.fileId,function(t){a.sysFilelists=t})}})},function(){a.fileId&&(a.isUpdate=!0,e.findFileById(a,a.fileId),i.findByBusinessId(a.fileId,function(t){a.sysFilelists=t})),a.parentId&&(e.getFileUrlById(a,a.parentId),e.initFileList(a))}(),a.createFile=function(){e.saveFile(a,function(t){t.flag||"ok"==t.reCode?n.alert("保存成功！",function(){a.fileId=t.reObj.fileId,a.initFileUpload()}):n.error(t.reMsg)})},a.updateFile=function(){e.updateFile(a,function(t){t.flag||"ok"==t.reCode?(n.alert("更新成功！"),a.initFileUpload()):n.error(t.reMsg)})}}angular.module("app").controller("policyEditCtrl",t),t.$inject=["$state","fileLibrarySvc","sysfileSvc","$scope","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this;o.parentId=t.params.parentId,o.fileLibrary={},o.fileLibrary.parentFileId=o.parentId,o.fileLibrary.fileType="POLICY",o.formId="policyForm",function(){e.initFileList(o)}(),o.addFile=function(){t.go("policyLibrary.policyEdit",{parentId:o.parentId,fileId:""})},o.update=function(e){t.go("policyLibrary.policyEdit",{parentId:o.parentId,fileId:e})},o.del=function(t){i.confirm("删除的数据将无法恢复，确认删除？",function(){e.deleteFile(o,t)})},o.queryPolicy=function(){console.log(24654),e.queryUser(o)},o.resetPolicy=function(){console.log(4546);var t=$("#policyForm").find("input");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("policyListCtrl",t),t.$inject=["$state","fileLibrarySvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.parentId=e.params.parentId,a.fileLibrary={},a.fileLibrary.fileType="QUALITY",function(){o.initFileFolder(a,function(t){function i(t,i,o){e.go("fileLibrary.fileList",{parentId:o.id})}function o(t,e,i){a.onRemove(i.id)}function n(t,e){if("FOLDER"==e.fileNature){var i=$("#"+e.tId+"_span");if(e.editNameFlag||$("#addBtn_"+e.tId).length>0)return;var o="<span class='button add' id='addBtn_"+e.tId+"' title='添加子节点' onfocus='this.blur();'></span>";i.after(o);var n=$("#addBtn_"+e.tId);n&&n.bind("click",function(){$.fn.zTree.getZTreeObj("zTree"),a.addFolderWindow(e.id)})}}function r(t,e){$("#addBtn_"+e.tId).unbind().remove()}var s={check:{enable:!0,chkStyle:"radio",chkboxType:{Y:"",N:""}},edit:{enable:!0,showRenameBtn:!1,showRemoveBtn:!1,showAddBtn:!0,removeTitle:"删除节点"},view:{addHoverDom:n,removeHoverDom:r,dblClickExpand:!0},callback:{onClick:i,beforeRemove:o},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},l=$linq(t).select(function(t){var e={id:t.fileId,name:t.fileName,pId:t.parentFileId,fileNature:t.fileNature};return"FOLDER"==t.fileNature&&(e.icon=rootPath+"/contents/libs/zTree/css/zTreeStyle/img/diy/7.png"),e}).toArray();$.fn.zTree.init($("#zTree"),s,l)})}(),a.addFolderWindow=function(t){a.fileLibrary={},a.fileLibrary.fileType="QUALITY",void 0!=t&&(a.fileLibrary.parentFileId=t),$("#addRootFolder").kendoWindow({width:"600px",height:"300px",title:"创建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},a.saveRootFolder=function(){void 0!=a.fileLibrary.fileName?o.saveRootFolder(a.fileLibrary,function(i){i.flag||"ok"==i.reCode?t.alert("保存成功！",function(){window.parent.$("#addRootFolder").data("kendoWindow").close(),e.go("fileLibrary",{},{reload:!0})}):t.error(i.reMsg)}):t.alert("文件名不能为空!")},n.onRemove=function(e){console.log(3245),t.confirm("删除的文件将无法恢复，确认删除？",function(){o.deleteRootDirectory(e,function(e){return e.flag||"ok"==e.reCode?(t.success("操作成功！"),!0):(t.error(e.reMsg),!1)})})},a.deleteFolder=function(){var i=$.fn.zTree.getZTreeObj("zTree"),n=i.getCheckedNodes();if(void 0!=n&&n.length>0){var a=n[0].id;t.confirm("删除的文件将无法恢复，确认删除？",function(){o.deleteRootDirectory(a,function(i){i.flag||"ok"==i.reCode?(t.success("操作成功！"),e.go("fileLibrary",{},{reload:!0})):t.error(i.reMsg)})})}}}angular.module("app").controller("qualityCtrl",t),t.$inject=["bsWin","$state","$location","fileLibrarySvc","$scope"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.parentId=t.params.parentId,a.fileLibrary={},a.fileLibrary.parentFileId=a.parentId,a.fileLibrary.fileType="QUALITY",a.fileId=t.params.fileId,a.fileUrl="",a.fileName="",a.businessFlag={isInitFileOption:!1},a.initFileUpload=function(){a.fileId||o.$watch("vm.fileId",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.fileId,mainId:"",mainType:i.mainTypeValue().FILELIBRARY,sysBusiType:a.fileUrl.substring(a.fileUrl.lastIndexOf(i.mainTypeValue().FILELIBRARY),a.fileUrl.lastIndexOf(a.fileName))},i.initUploadOptions({inputId:"sysfileinput",vm:a,uploadSuccess:function(){i.findByBusinessId(a.fileId,function(t){a.sysFilelists=t})}})},function(){a.fileId&&(a.isUpdate=!0,e.findFileById(a,a.fileId),i.findByBusinessId(a.fileId,function(t){a.sysFilelists=t})),a.parentId&&(e.getFileUrlById(a,a.parentId),e.initFileList(a))}(),a.createFile=function(){e.saveFile(a,function(t){t.flag||"ok"==t.reCode?n.alert("保存成功！",function(){a.fileId=t.reObj.fileId,a.initFileUpload()}):n.error(t.reMsg)})},a.updateFile=function(){e.updateFile(a,function(t){t.flag||"ok"==t.reCode?n.alert("更新成功！",function(){a.initFileUpload()}):n.error(t.reMsg)})}}angular.module("app").controller("qualityEditCtrl",t),t.$inject=["$state","fileLibrarySvc","sysfileSvc","$scope","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.parentId=t.params.parentId,a.fileLibrary={},a.fileLibrary.parentFileId=a.parentId,a.fileLibrary.fileType="QUALITY",a.formId="fileForm",function(){e.initFileList(a)}(),a.addFile=function(){t.go("fileLibrary.fileEdit",{parentId:a.parentId,fileId:""})},a.update=function(e){t.go("fileLibrary.fileEdit",{parentId:a.parentId,fileId:e})},a.del=function(t){n.confirm("删除的数据将无法恢复，确认删除？",function(){e.deleteFile(a,t)})},a.queryUser=function(){e.queryUser(a)},a.resetUser=function(){var t=$("#fileForm").find("input");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("qualityListCtrl",t),t.$inject=["$state","fileLibrarySvc","sysfileSvc","$scope","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目归档编辑",a.fileRecord={},a.fileRecord.signId=e.params.signid,a.fileRecord.fileRecordId="",a.signId=e.params.signid,a.initFileUpload=function(){a.fileRecord.fileRecordId||n.$watch("vm.fileRecord.fileRecordId",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.fileRecord.fileRecordId,mainId:a.signId,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().DOFILE,sysBusiType:i.mainTypeValue().DOFILE},i.initUploadOptions({inputId:"sysfileinput",vm:a})},function(){t.initFileRecordData(a)}(),a.create=function(){t.saveFileRecord(a)}}angular.module("app").controller("fileRecordEditCtrl",t),t.$inject=["fileRecordSvc","$state","sysfileSvc","bsWin","$scope"]}(),function(){"use strict";function t(t,e){function i(t){var i={method:"get",url:rootPath+"/fileRecord/initFillPage",params:{signId:t.fileRecord.signId}},o=function(e){null!=e.data&&""!=e.data&&(t.fileRecord=e.data.file_record,t.fileRecord.signId=t.signId,t.signUserList=e.data.sign_user_List,t.initFileUpload())};common.http({vm:t,$http:e,httpOptions:i,success:o})}function o(i){if(common.initJqValidation($("#fileRecord_form")),$("#fileRecord_form").valid()){i.signUserList.forEach(function(t,e){i.fileRecord.signUserid==t.id&&(i.fileRecord.signUserName=t.displayName)}),i.isCommit=!0;var o={method:"post",url:rootPath+"/fileRecord",data:i.fileRecord},n=function(e){i.isCommit=!1,e.data.flag||"ok"==e.data.reCode?(i.fileRecord=e.data.reObj,i.fileRecord.signId=i.signId,t.success("操作成功！")):t.error(e.data.reMsg)};common.http({$http:e,httpOptions:o,success:n,onError:function(t){i.isCommit=!1}})}}return{initFileRecordData:i,saveFileRecord:o}}angular.module("app").factory("fileRecordSvc",t),t.$inject=["bsWin","$http"]}(),function(){"use strict";function t(t,e,i){function o(t){var e={};if(void 0!=t.flow){var i=t.flow.processInstanceId;(angular.isUndefined(t.flow.hideFlowImg)||0==t.flow.hideFlowImg)&&(t.picture=rootPath+"/flow/processInstance/img/"+i),e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/processInstance/history/"+i),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0})}var o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"nodeName",title:"环节名称",width:120,filterable:!1},{field:"displayName",title:"处理人",width:80,filterable:!1},{field:"startTime",title:"开始时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endTime",title:"结束时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"durationStr",title:"处理时长",width:120,filterable:!1},{field:"message",title:"处理信息",width:300,filterable:!1}];t.historygrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0,dataBound:function(){var e=this.items();$(e).each(function(i){i==e.length-1&&c(t),$(this).find(".row-number").html(i+1)})}}}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/processInstance/history/"+t.instanceId),schema:common.kendoGridConfig().schema({id:"hctId"}),rowNumber:!0,headerCenter:!0}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:40},{field:"nodeName",title:"环节名称",width:120,filterable:!1},{field:"displayName",title:"处理人",width:80,filterable:!1},{field:"startTime",title:"开始时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endTime",title:"结束时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"durationStr",title:"处理时长",width:120,filterable:!1},{field:"message",title:"处理信息",width:300,filterable:!1}];t.historygrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items();$(t).each(function(t){$(this).find(".row-number").html(t+1)})}}}function a(e,i,o){var n={method:"post",url:rootPath+"/flow/processInstance/flowNodeInfo",params:{taskId:e,processInstanceId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function r(e,i,o){if(common.initJqValidation($("#flow_form")),$("#flow_form").valid()){e=!0;var n={method:"post",url:rootPath+"/flow/commit",data:i},a=function(t){e=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){e=!1}})}}function s(e,i,o){i=!0;var n={method:"post",url:rootPath+"/flow/rollbacklast",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}function l(e){var i={method:"post",url:rootPath+"/flow/rollbacklast",data:e.flow},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function c(t){t.backNode=[];for(var e=t.historygrid.dataSource.data(),i=e.length,o=0;o<i;o++)e[o].assignee&&e[o].endTime&&t.backNode.push({activitiId:e[o].activityId,activitiName:e[o].activityName,assignee:e[o].assignee})}function d(e,i){var o={method:"post",url:rootPath+"/flow/suspend/"+i,data:e.projectStop},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?e.isCommit=!1:(window.parent.$("#spwindow").data("kendoWindow").close(),e.gridOptions.dataSource.read())}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n,onError:function(){e.isCommit=!1}})}function u(e,i){e.isCommit=!0;var o={method:"post",url:rootPath+"/flow/active/"+i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?e.isCommit=!1:e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n,onError:function(){e.isCommit=!1}})}function m(e){if(null==e.flow.dealOption||""==e.flow.dealOption)return void common.alert({vm:e,msg:"请填写处理信息！"});var i={method:"post",url:rootPath+"/flow/deleteFLow",data:e.flow},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{initFlowData:o,getFlowInfo:a,commit:r,rollBackToLast:s,rollBack:l,initBackNode:c,suspendFlow:d,activeFlow:u,deleteFlow:m,historyData:n}}angular.module("app").factory("flowSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s,l,c,d,u,m,p,f){function h(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var g=this;g.title="待办任务处理",g.businessKey=o.params.businessKey,g.processKey=o.params.processKey,g.taskId=o.params.taskId,g.instanceId=o.params.instanceId,g.currentFlow,g.showFlag={businessNext:!1,businessTr:!1,tabSysFile:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),g.picture=rootPath+"/flow/processInstance/img/"+g.instanceId,r.historyData(g),r.getFlowInfo(g.taskId,g.instanceId,function(t){if(g.flow=t,g.currentFlow=t,g.flow.end)g.showFlag.nodeNext=!1;else switch(g.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:a.initFlowNode(g.flow,g.showFlag,g)}}),g.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:a.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:c.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:s.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().PROJECT_STOP_FLOW:d.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().FLOW_ARCHIVES:u.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().FLOW_APPRAISE_REPORT:m.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().FLOW_SUPP_LETTER:p.initFlowDeal(g);break;case flowcommon.getFlowDefinedKey().MONTHLY_BULLETIN_FLOW:f.initFlowDeal(g)}i.findByMianId(g.businessKey,function(e){e&&e.length>0&&(g.showFlag.tabSysFile=!0,g.sysFileList=e,g.urlType="flowDeal",i.initZtreeClient(g,t))}),e.initIdea(g)}(),g.initFileUpload=function(t,e,o){g.sysFile={businessId:g.businessKey,mainId:g.businessKey,mainType:t,sysfileType:e,sysBusiType:o},i.initUploadOptions({inputId:"sysfileinput",vm:g})},g.commonDownloadSysFile=function(t){i.downloadFile(t)},g.ideaEdit=function(t){angular.isObject(t)||(t={}),e.initIdeaData(g,t)},g.selectedIdea=function(){g.flow.dealOption=g.chooseIdea},g.commitFlow=function(){if(g.flow.isSuspended)return void n.error("该流程目前为暂停状态，不能进行流转操作！");r.commit(g.isCommit,g.flow,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！",function(){o.go("agendaTasks")}):n.alert(t.reMsg)})},g.backFlow=function(){common.initJqValidation($("#flow_form")),$("#flow_form").valid()&&n.confirm({title:"询问提示",message:"确认回退吗？",onOk:function(){r.rollBackToLast(g.flow,g.isCommit,function(t){g.isCommit=!1,t.flag||"ok"==t.reCode?n.alert("回退成功！",function(){o.go("agendaTasks")}):n.alert(t.reMsg)})}})},g.editSelectExpert=function(t){g.scoreExpert={},$.each(g.model.expertReviewDto.expertSelectedDtoList,function(e,i){if(i.id==t)return void(g.scoreExpert=i)}),$("#star").raty({score:function(){return $(this).attr("data-num",angular.isUndefined(g.scoreExpert.score)?0:g.scoreExpert.score),$(this).attr("data-num")},starOn:"../contents/libs/raty/lib/images/star-on.png",starOff:"../contents/libs/raty/lib/images/star-off.png",starHalf:"../contents/libs/raty/lib/images/star-half.png",readOnly:!1,halfShow:!0,size:34,click:function(t,e){g.scoreExpert.score=t}}),$("#score_win").kendoWindow({width:"820px",height:"365px",title:"编辑-专家星级",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},g.closeEditMark=function(){window.parent.$("#score_win").data("kendoWindow").close()},g.saveMark=function(){common.initJqValidation($("#expert_score_form")),$("#expert_score_form").valid()?l.saveMark(g.scoreExpert,function(){n.success("保存成功！",function(){g.closeEditMark()})}):n.alert("请填写评分和评分内容！")},g.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void n.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void n.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void n.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var e,i=t.expertSelectedDtoList.length,o="";$.each(t.expertSelectedDtoList,function(t,e){o+="'"+e.id+"'",t!=i-1&&(o+=",")});var a=t.payDate;e=a.substring(0,a.lastIndexOf("-")),l.countTaxes(o,e,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,o){var n=o.EXPERTID,a=o.id,r=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==n&&t.ESID!=a&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),r=parseFloat(r)+t.REVIEWCOST)}),o.reviewCost=void 0==o.reviewCost?0:o.reviewCost;var s=r+parseFloat(o.reviewCost);o.reviewTaxes=h(s).toFixed(2),o.totalCost=(parseFloat(o.reviewCost)+parseFloat(o.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(o.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(o.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)})})}}},
g.closeEditPay=function(){window.parent.$("#payment").data("kendoWindow").close()},g.savePayment=function(t){common.initJqValidation($("#payform")),$("#payform").valid()?l.savePayment(t,g.isCommit,function(t){t.flag||"ok"==t.reCode?n.alert("操作成功！",function(){g.isCommit=!1}):n.alert(t.reMsg)}):n.alert("请正确填写专家评审费信息！")},g.updateFlow=function(){common.initJqValidation(),$("form").valid()?f.updatemonthlyMultiyear(g.suppletter,function(t){t.flag||"ok"==t.reCode?g.commitFlow():n.error(t.reMsg)}):n.alert("缺少部分没有填写，请仔细检查")}}angular.module("app").controller("flowDealCtrl",t),t.$inject=["$scope","ideaSvc","sysfileSvc","$state","bsWin","topicSvc","flowSvc","bookBuyBusinessSvc","expertReviewSvc","assertStorageBusinessSvc","pauseProjectSvc","archivesLibrarySvc","reviewProjectAppraiseSvc","addSuppLetterSvc","monthlyMultiyearSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s,l,c,d){var u=this;u.title="在办任务详情页",u.businessKey=e.params.businessKey,u.processKey=e.params.processKey,u.taskId=e.params.taskId,u.instanceId=e.params.instanceId,u.showFlag={businessNext:!1,businessTr:!1,tabSysFile:!1,buttBack:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),u.picture=rootPath+"/flow/processInstance/img/"+u.instanceId,o.historyData(u),u.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:i.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:a.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:r.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().PROJECT_STOP_FLOW:s.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_ARCHIVES:l.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_APPRAISE_REPORT:c.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_SUPP_LETTER:d.initFlowDeal(u)}n.findByMianId(u.businessKey,function(e){e&&e.length>0&&(u.showFlag.tabSysFile=!0,u.sysFileList=e,u.urlType="flowDetail",n.initZtreeClient(u,t))})}()}angular.module("app").controller("flowDetailCtrl",t),t.$inject=["$scope","$state","topicSvc","flowSvc","sysfileSvc","bookBuyBusinessSvc","assertStorageBusinessSvc","pauseProjectSvc","archivesLibrarySvc","reviewProjectAppraiseSvc","addSuppLetterSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s,l,c,d){var u=this;u.title="待办任务处理",u.businessKey=e.params.businessKey,u.processKey=e.params.processKey,u.instanceId=e.params.instanceId,u.showFlag={businessNext:!1,businessTr:!1,tabSysFile:!1,buttBack:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),o.historyData(u),u.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:i.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:a.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:r.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().PROJECT_STOP_FLOW:s.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_ARCHIVES:l.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_APPRAISE_REPORT:c.initFlowDeal(u);break;case flowcommon.getFlowDefinedKey().FLOW_SUPP_LETTER:d.initFlowDeal(u)}n.findByMianId(u.businessKey,function(e){e&&e.length>0&&(u.showFlag.tabSysFile=!0,u.sysFileList=e,u.urlType="flowEnd",n.initZtreeClient(u,t))})}()}angular.module("app").controller("flowEndCtrl",t),t.$inject=["$scope","$state","topicSvc","flowSvc","sysfileSvc","bookBuyBusinessSvc","assertStorageBusinessSvc","pauseProjectSvc","archivesLibrarySvc","reviewProjectAppraiseSvc","addSuppLetterSvc"]}(),function(){"use strict";var t={SIGN_ZR:"SIGN_ZR",SIGN_QS:"SIGN_QS",SIGN_ZHB:"SIGN_ZHB",SIGN_FGLD_FB:"SIGN_FGLD_FB",SIGN_BMFB1:"SIGN_BMFB1",SIGN_BMFB2:"SIGN_BMFB2",SIGN_BMFB3:"SIGN_BMFB3",SIGN_BMFB4:"SIGN_BMFB4",SIGN_XMFZR1:"SIGN_XMFZR1",SIGN_XMFZR2:"SIGN_XMFZR2",SIGN_XMFZR3:"SIGN_XMFZR3",SIGN_XMFZR4:"SIGN_XMFZR4",SIGN_BMLD_SPW1:"SIGN_BMLD_SPW1",SIGN_BMLD_SPW2:"SIGN_BMLD_SPW2",SIGN_BMLD_SPW3:"SIGN_BMLD_SPW3",SIGN_BMLD_SPW4:"SIGN_BMLD_SPW4",SIGN_FGLD_SPW1:"SIGN_FGLD_SPW1",SIGN_FGLD_SPW2:"SIGN_FGLD_SPW2",SIGN_FGLD_SPW3:"SIGN_FGLD_SPW3",SIGN_FGLD_SPW4:"SIGN_FGLD_SPW4",SIGN_FW:"SIGN_FW",SIGN_QRFW:"SIGN_QRFW",SIGN_BMLD_QRFW_XB:"SIGN_BMLD_QRFW_XB",SIGN_BMLD_QRFW:"SIGN_BMLD_QRFW",SIGN_FGLD_QRFW_XB:"SIGN_FGLD_QRFW_XB",SIGN_FGLD_QRFW:"SIGN_FGLD_QRFW",SIGN_ZR_QRFW:"SIGN_ZR_QRFW",SIGN_FWBH:"SIGN_FWBH",SIGN_CWBL:"SIGN_CWBL",SIGN_GD:"SIGN_GD",SIGN_DSFZR_QRGD:"SIGN_DSFZR_QRGD",SIGN_QRGD:"SIGN_QRGD"},e={TOPIC_JHTC:"TOPIC_JHTC",TOPIC_BZSH_JH:"TOPIC_BZSH_JH",TOPIC_FGLD_JH:"TOPIC_FGLD_JH",TOPIC_ZRSH_JH:"TOPIC_ZRSH_JH",TOPIC_BFGW:"TOPIC_BFGW",TOPIC_LXDW:"TOPIC_LXDW",TOPIC_QDHT:"TOPIC_QDHT",TOPIC_YJSS:"TOPIC_YJSS",TOPIC_NBCS:"TOPIC_NBCS",TOPIC_GZFA:"TOPIC_GZFA",TOPIC_BZSH_FA:"TOPIC_BZSH_FA",TOPIC_FGLD_FA:"TOPIC_FGLD_FA",TOPIC_ZRSH_FA:"TOPIC_ZRSH_FA",TOPIC_CGJD:"TOPIC_CGJD",TOPIC_KTBG:"TOPIC_KTBG",TOPIC_BZSH_BG:"TOPIC_BZSH_BG",TOPIC_FGLD_BG:"TOPIC_FGLD_BG",TOPIC_ZRSH_BG:"TOPIC_ZRSH_BG",TOPIC_KTJT:"TOPIC_KTJT",TOPIC_BZSH_JT:"TOPIC_BZSH_JT",TOPIC_FGLD_JT:"TOPIC_FGLD_JT",TOPIC_ZRSH_JT:"TOPIC_ZRSH_JT",TOPIC_YFZL:"TOPIC_YFZL",TOPIC_ZLGD:"TOPIC_ZLGD"},i={BOOK_LEADER_CGQQ:"BOOK_LEADER_CGQQ",BOOK_BZSP:"BOOK_BZSP",BOOK_FGFZRSP:"BOOK_FGFZRSP",BOOK_ZXZRSP:"BOOK_ZXZRSP",BOOK_YSRK:"BOOK_YSRK"},o={FINAL_SIGN_FLOW:"FINAL_SIGN_FLOW",TOPIC_FLOW:"TOPIC_FLOW",BOOKS_BUY_FLOW:"BOOKS_BUY_FLOW",ASSERT_STORAGE_FLOW:"ASSERT_STORAGE_FLOW",PROJECT_STOP_FLOW:"PROJECT_STOP_FLOW",FLOW_ARCHIVES:"FLOW_ARCHIVES",FLOW_APPRAISE_REPORT:"FLOW_APPRAISE_REPORT",FLOW_SUPP_LETTER:"FLOW_SUPP_LETTER",MONTHLY_BULLETIN_FLOW:"MONTHLY_BULLETIN_FLOW"},n={getFlowDefinedKey:function(){return o},getSignFlowNode:function(){return t},getTopicFlowNode:function(){return e},getBooksBuyFlowNode:function(){return i},getAssertStorageFlowNode:function(){return i}};window.flowcommon=n}(),function(){"use strict";function t(t,e,i,o,n,a){function r(){"REVIEW"==s.costType&&(n.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(s.orgDeptList=t.reObj)}),t.initfinancial(s,function(t){s.stageCountList=t})),"ASSIST"==s.costType&&a.findSingAssistCostList(s.signAssistCost,function(t){s.signAssistCostList=t})}var s=this;s.sign={},s.financial={},s.model={},s.signAssistCost={},s.isuserExist=!1,s.id=e.params.id,s.financial.businessId=e.params.businessId,s.costType=e.params.costType,"REVIEW"==s.costType&&(s.title="评审费统计管理",s.titleName="专家评审费",s.windowName="专家评审费录入"),"ASSIST"==s.costType&&(s.title="协审费统计管理",s.titleName="专家协审费",s.windowName="专家协审费录入"),s.addCostWindow=function(e){s.signAssistCostCounList={},s.expertSelectedDtoList={},s.signAssistCost={},"REVIEW"==s.costType&&(t.sumFinancial(s,e.businessId),s.businessId=e.businessId,s.projectName=e.projectname),"ASSIST"==s.costType&&(s.businessId=e.signId,s.projectName=e.projectName),t.initFinancialProject(s.businessId,function(t){s.financial={},s.financial.businessId=s.businessId,s.financial.projectName=s.projectName,s.financial.paymentData=t.financialDto.paymentData,o.initReview(s.financial.businessId,"",function(t){s.expertReview=t,s.reviewTitle=t.reviewTitle,s.payDate=t.payDate,s.expertSelectedDtoList=t.expertSelectedDtoList,s.expertSelectedDtoList&&s.expertSelectedDtoList.length>0&&(s.showReviewCost=!0)}),s.signAssistCost.signId=s.businessId,a.findSingAssistCostCount(s.signAssistCost,function(t){s.signAssistCostCounList=t,s.signAssistCostCounList&&s.signAssistCostCounList.length>0&&(s.showAssistCost=!0)}),s.financials=t.financiallist,s.countCost(),$("#addCostWindow").kendoWindow({width:"70%",height:"600px;",title:s.windowName,visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},s.costExportExcel=function(){var e=s.reviewTitle+"("+s.payDate+")";t.exportExcel(s,s.financial.businessId,e)},s.countCost=function(){var t=0;s.financials&&s.financials.length>0&&angular.forEach(s.financials,function(e,i){e.charge&&(t+=e.charge)}),$("#financialCount").html(t)},s.changeName=function(t,e){if(s.financials.length>0)for(var o=0;o<s.financials.length-1;o++)o!=t&&void 0!=s.financials[o].chargeName&&s.financials[o].chargeName==e&&(i.alert("该费用已经录入，不能重复录入！"),s.financials[t]={})},s.addFinancial=function(){var t={};t.chargeType="8",t.businessId=s.financial.businessId,t.projectName=s.financial.projectName,t.paymentData=s.financial.paymentData,s.financials||(s.financials=[]),s.financials.push(t)},s.saveFinancial=function(){common.initJqValidation($("#fnFrom")),$("#fnFrom").valid()?t.savefinancial(s.financials,function(t){t.flag||"ok"==t.reCode?(s.financials=t.reObj,i.success(t.reMsg),$("#addCostWindow").data("kendoWindow").close()):i.error(t.reMsg)}):i.error("费用信息填写不正确！")},s.deleteFinancial=function(){var e=$("#financialsTable input[name='financialsCheck']:checked");if(e.length<1)common.alert({vm:s,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<e.length;o++){s.financials.forEach(function(t,n){e[o].value!=t.id&&void 0!=t.id||s.financials.splice(n,1),i.push(e[o].value)});var n=i.join(",");t.deleteFinancialManager(n,function(t){})}},s.queryUser=function(){r()},s.resetQuery=function(){s.financial={}},r()}angular.module("app").controller("addCostCtrl",t),t.$inject=["financialManagerSvc","$state","bsWin","expertReviewSvc","adminSvc","assistCostCountSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(n,a,r,s){n.financial={},void 0==r.businessId&&(void 0==r.signid?r.businessId=r.signId:r.businessId=r.signid),r.projectname||(r.projectname=r.projectName),"REVIEW"==a?(n.windowName="项目评审费录入",n.financial.businessType="SIGN"):"ASSIST"==a&&(n.windowName="项目协审费录入",n.financial.businessType="SIGN"),n.financial.businessId=r.businessId,n.financial.projectName=r.projectname,n.costExportExcel=function(){var t=n.expertReview.reviewTitle+"("+n.expertReview.payDate+")";e.exportExcel(n,n.financial.businessId,t)},n.countCost=function(){var t=0;n.financials&&n.financials.length>0&&angular.forEach(n.financials,function(e,i){e.charge&&(t+=e.charge)}),$("#financialCount").html(t)},n.changeName=function(e,i){if(n.financials.length>0)for(var o=0;o<n.financials.length-1;o++)o!=e&&void 0!=n.financials[o].chargeName&&n.financials[o].chargeName==i&&(t.alert("该费用已经录入，不能重复录入！"),n.financials[e]={})},n.addFinancial=function(){var t={};t.chargeType="8",t.businessId=n.financial.businessId,t.projectName=n.financial.projectName,t.paymentData=n.financial.paymentData,n.financials||(n.financials=[]),n.financials.push(t)},n.saveFinancial=function(){common.initJqValidation($("#fnFrom")),$("#fnFrom").valid()?e.savefinancial(n.financials,function(e){e.flag||"ok"==e.reCode?(n.financials=e.reObj,t.success(e.reMsg),$("#"+s).data("kendoWindow").close()):t.error(e.reMsg)}):t.error("费用信息填写不正确！")},n.deleteFinancial=function(){var i=$("#financialsTable input[name='financialsCheck']:checked");if(i.length<1)t.alert("请选择要删除的记录！");else for(var o=[],a=0;a<i.length;a++){n.financials.forEach(function(t,e){i[a].value!=t.id&&void 0!=t.id||n.financials.splice(e,1),o.push(i[a].value)});var r=o.join(",");e.deleteFinancialManager(r,function(t){})}},$("#"+s).kendoWindow({width:"70%",height:"560",title:n.windowName,visible:!1,modal:!0,closable:!0,open:function(){e.initFinancialProject(n.financial,function(t){n.financials=t.financiallist,n.financials&&n.financials.length>0&&(n.countCost(),n.financial.paymentData=n.financials[0].paymentData),i.initReview(n.financial.businessId,"",function(t){n.expertReview=t}),"ASSIST"==a&&(n.searchCost={},n.searchCost.signId=n.financial.businessId,o.findSingAssistCostCount(n.searchCost,function(t){n.signAssistCostCounList=t}))})},close:function(){n.financial={},n.expertReview={},n.financials={},n.signAssistCostCounList={}},refresh:function(){alert(2)},actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()}return{initAddCost:n}}angular.module("app").factory("addCostSvc",t),t.$inject=["bsWin","financialManagerSvc","expertReviewSvc","assistCostCountSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="协审费录入",n.financials=new Array,n.financial={},n.financial.businessId=i.params.signid,function(){e.initAssistProject(n.financial.businessId,function(t){n.model=t.financialDto,n.financials=t.financiallist,n.countCost()})}(),n.countCost=function(){if(n.financials&&n.financials.length>0){var t=0;angular.forEach(n.financials,function(e,i){e.charge&&(t+=e.charge)}),$("#financialCount").html(t)}},n.addFinancial=function(){var t={};t.chargeType="8",t.businessId=n.model.businessId,t.projectName=n.model.projectName,t.paymentData=n.model.paymentData,n.financials||(n.financials=[]),n.financials.push(t)},n.saveFinancial=function(){e.savefinancial(n.financials,function(e){e.flag||"ok"==e.reCode?(n.financials=e.reObj,n.model.paymentData||(n.model.paymentData=n.financials[0].paymentData),n.countCost(),t.success(e.reMsg)):t.error(e.reMsg)})},n.deleteFinancial=function(){var i=$("#financialsTable input[name='financialsCheck']:checked");if(i.length<1)common.alert({vm:n,msg:"请选择要删除的记录！"});else{for(var o=[],a=0;a<i.length;a++)n.financials.forEach(function(t,e){void 0!=t.id&&i[a].value!=t.id||n.financials.splice(e,1),i[a].value&&o.push(i[a].value)});if(o.length>0){var r=o.join(",");e.deleteFinancialManager(r,function(e){n.countCost(),t.alert("操作成功！！")})}}}}angular.module("app").controller("assistCostEditCtrl",t),t.$inject=["bsWin","financialManagerSvc","$state","expertReviewSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(){a.isSubmit=!0,a.nodata=!1,e.findSingAssistCostList(a.signAssistCost,function(t){a.isSubmit=!1,a.signAssistCostList=t,a.signAssistCostList&&0!=a.signAssistCostList.length||(a.nodata=!0)})}var a=this;a.title="协审费录入",a.signAssistCost={},a.signAssistCost.beginTime=(new Date).halfYearAgo(),a.signAssistCost.endTime=(new Date).Format("yyyy-MM-dd"),a.costType=o.params.costType,a.financials=[],n(),a.queryAssistCost=function(){n()},a.assistCostReset=function(){a.signAssistCost={}},a.addCostWindow=function(t,e){i.initAddCost(a,a.costType,t,e)}}angular.module("app").controller("assistCostCountEditCtrl",t),t.$inject=["bsWin","assistCostCountSvc","addCostSvc","$state"]}(),function(){"use strict";function t(t,e,i){function o(){n.isSubmit=!0,n.nodata=!1,t.findSingAssistCostCount(n.signAssistCost,function(t){n.isSubmit=!1,n.signAssistCostCounList=t,n.signAssistCostCounList&&0!=n.signAssistCostCounList.length||(n.nodata=!0)})}var n=this;n.signAssistCost={},n.signAssistCost.beginTime=(new Date).halfYearAgo(),n.signAssistCost.endTime=(new Date).Format("yyyy-MM-dd"),o(),n.queryAssistCost=function(){o()},n.assistCostReset=function(){n.signAssistCost={}}}angular.module("app").controller("assistCostCountListCtrl",t),t.$inject=["assistCostCountSvc","$state","addCostSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/financialManager/findSingAssistCostCount",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:rootPath+"/financialManager/findSingAssistCostList",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(t,e,i){var i=escape(encodeURIComponent(i));window.open(rootPath+"/financialManager/exportExcel?fileName="+i+"&businessId="+e)}function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(e,i){var o={method:"post",url:rootPath+"/financialManager/initfinancial",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e){var i={method:"get",url:rootPath+"/financialManager/html/sumfinancial",params:{businessId:e.financial.businessId}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e,i){var o={method:"post",url:rootPath+"/financialManager",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"delete",url:d,data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertSelected/assistCostList",$("#searchform")),schema:{data:"value",model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"projectname",title:"项目名称",width:100,filterable:!1},{field:"builtcompanyname",title:"协审单位",width:100,filterable:!1},{field:"principal",title:"项目负责人",width:100,filterable:!1},{field:"signNum",title:"协审登记号",width:100,filterable:!1},{field:"totalCost",title:"计划协审费用",width:120,filterable:!1},{field:"totalCost",title:"实付协审费用",width:120,filterable:!1},{field:"payDate",title:"付款日期",width:100,filterable:!1},{field:"declareValue",title:"申报金额",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),"vm.addCost('"+t.businessId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}var d=rootPath+"/financialManager";return{grid:c,deleteassistCostCount:l,saveAssistCost:s,sumAssistCount:r,initAssistlProject:a,isUnsignedInteger:n,assistExportExcel:o,findSingAssistCostCount:e,findSingAssistCostList:i}}angular.module("app").factory("assistCostCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="专家费统计管理",n.financials=new Array,n.searchModel={},n.searchModel.beginTime=(new Date).halfYearAgo(),n.searchModel.endTime=(new Date).Format("yyyy-MM-dd"),n.model={},n.sign={},n.financial={},n.financial.signid=i.params.signid,n.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},n.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=n.financial.signid;n.financial={},n.financial.chargeType="评审项目",n.financial.signid=i,n.financial.projectName=t,n.financial.paymentData=e,n.financials.push(n.financial),n.i++},n.saveFinancial=function(){e.savefinancial(n)},n.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){n.financials.forEach(function(e,a){t[o].value!=e.id&&void 0!=e.id||n.financials.splice(a,1),i.push(t[o].value)});var a=i.join(",");e.deleteexportCount(n,a)}},n.searchForm=function(){n.gridOptions.dataSource.read()},n.excelExport=function(){n.fileName="专家评审费明细",n.exportData=$("#statisticalGrid").data("kendoGrid")._data,e.excelExport(n,n.exportData,n.fileName)},n.formReset=function(){n.searchModel={}},function(){e.grid(n)}()}angular.module("app").controller("exportCountCtrl",t),t.$inject=["$location","exportCountSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function i(e){var i={method:"get",url:rootPath+"/exportCount/initfinancial",params:{signid:e.financial.signid}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){var i={method:"get",url:rootPath+"/exportCount/html/sumfinancial",params:{signId:e.financial.signid}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:rootPath+"/exportCount",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){a()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(){window.location.reload()}function r(e,i){e.isSubmit=!0;var o={method:"delete",url:c,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,a()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i,o){var n=window.encodeURIComponent(window.encodeURIComponent(o)),a={fileName:n},r=rootPath+"/expertSelected/expertDetailExport";if($("#searchform")){var s=common.buildOdataFilter($("#searchform"));s&&(a.$filter=s)}var l={method:"post",url:r,traditional:!0,dataType:"json",responseType:"arraybuffer",params:a},c=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:l,success:c})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertSelected/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expertDto.name",title:"姓名",width:"8%",filterable:!1},{field:"expertDto.idCard",title:"身份证号",width:"15%",filterable:!1},{field:"expertDto.openingBank",title:"开户行",width:"10%",filterable:!1},{field:"expertDto.bankAccount",title:"银行账号",width:"10%",filterable:!1},{field:"reviewCost",title:"评审费",width:"8%",filterable:!1},{field:"reviewTaxes",title:"应缴税",width:"8%",filterable:!1},{field:"expertReviewDto.reviewTitle",title:"项目名称",width:"20%",filterable:!1},{field:"expertReviewDto.reviewDate",title:"评审时间",width:"8%",filterable:!1},{field:"expertReviewDto.reviewDate",title:"函评时间",width:"8%",filterable:!1},{field:"principal",title:"负责人",width:"5%",filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var c=rootPath+"/exportCount";return{grid:l,deleteexportCount:r,savefinancial:n,sumFinancial:o,initFinancialProject:i,isUnsignedInteger:e,excelExport:s}}angular.module("app").factory("exportCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t){var e="",i=0;if(t.length>0){for(var o=0;o<t.length;o++)if(i++,e+="<tr id='option"+i+"'>",e+="<td colspan='5'>",2==t[o].name.length?e+="<span style='margin-left: 6.5%;'><strong>"+t[o].name+"</strong></span>":e+="<span style='margin-left: 5%;'><strong>"+t[o].name+"</strong></span>",e+="<span style='margin-left: 8%;'></span><strong>"+t[o].expertNo+"</strong></span>",e+="<span style='margin-left: 65%;'></span><strong>合计:</strong></span>",e+="<span style='margin-left: 4%;'></span><strong>"+t[o].monthTotal+"</strong></span>",e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewcost,e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewtaxes,e+="</td>",e+="</tr>",t[o].expertCostDetailCountDtoList.length>0){for(var n=0;n<t[o].expertCostDetailCountDtoList.length;n++){i++;var a="";a+="<tr id='option"+i+"'>",a+="<td class='text-center' colspan='2'>",a+=t[o].expertCostDetailCountDtoList[n].reviewTitle,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewType,a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewcost,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewtaxes,a+="</td>",a+="</tr>"}e+=a}$("#expertCostHead").after(e)}}var a=this;a.title="专家缴税统计管理",a.model={},a.financials=new Array,a.sign={},a.financial={},a.financial.signid=i.params.signid,a.model.beginTime=i.params.beginTime,a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=a.financial.signid;a.financial={},a.financial.chargeType="评审项目",a.financial.signid=i,a.financial.projectName=t,a.financial.paymentData=e,a.financials.push(a.financial),a.i++},a.saveFinancial=function(){e.savefinancial(a)},a.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){a.financials.forEach(function(e,n){t[o].value!=e.id&&void 0!=e.id||a.financials.splice(n,1),i.push(t[o].value)});var n=i.join(",");e.deleteexpertPaymentCount(a,n)}},a.countExpertCostDetail=function(){e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo;for(var e=$("#expertCostTable tr").length,i=1;i<e;i++)$("#option"+i).remove();n(a.expertCostTotalInfo)})},a.countExpertCost=function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo})},a.getExpertCoustDetail=function(){i.go("expertPaymentDetailCountList",{beginTime:a.model.beginTime})},a.excelExport=function(){a.fileName="专家评审费统计报表"+a.model.beginTime,e.excelExport(a,a.expertCostTotalInfo,a.fileName)},function(){if(""==a.model.beginTime){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1;o=o<10?"0"+o:o,a.model.beginTime=i.toString()+"-"+o.toString(),a.year=i,a.month=o}else{var n=a.model.beginTime.split("-");a.year=n[0],a.month=n[1]}e.expertCostTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo})}()}angular.module("app").controller("expertPaymentCountCtrl",t),t.$inject=["$location","expertPaymentCountSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/expertCostTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:rootPath+"/expertSelected/expertCostDetailTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i,o){var n=window.encodeURIComponent(window.encodeURIComponent(o)),a={method:"post",url:rootPath+"/expertSelected/excelExport",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",responseType:"arraybuffer",data:angular.toJson(i),params:{fileName:n}},r=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:a,success:r})}function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(e){var i={method:"get",url:rootPath+"/expertPaymentCount/initfinancial",params:{signid:e.financial.signid}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"get",url:rootPath+"/expertPaymentCount/html/sumfinancial",params:{signId:e.financial.signid}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){var i={method:"post",url:rootPath+"/expertPaymentCount",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){l()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(){window.location.reload()}function c(e,i){e.isSubmit=!0;var o={method:"delete",url:u,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,l()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertReview/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expretCount",title:"姓名",width:100,filterable:!1},{field:"expretCount",title:"身份证号",width:100,filterable:!1},{field:"expretCount",title:"开户行",width:80,filterable:!1},{field:"expretCount",title:"银行账号",width:120,filterable:!1},{field:"reviewCost",title:"评审费（元）",width:160,filterable:!1},{field:"reviewTaxes",title:"应缴税",width:120,filterable:!1},{field:"reviewTitle",title:"项目名称",width:160,filterable:!1},{field:"reviewDate",title:"评审时间",width:160,filterable:!1},{field:"reviewDate",title:"函评时间",width:120,filterable:!1},{field:"reviewDate",title:"负责人",width:120,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var u=rootPath+"/expertPaymentCount";return{grid:d,deleteexpertPaymentCount:c,savefinancial:s,sumFinancial:r,initFinancialProject:a,isUnsignedInteger:n,expertCostTotal:e,expertCostDetailTotal:i,excelExport:o}}angular.module("app").factory("expertPaymentCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t){var e="",i=0;if(t.length>0){for(var o=0;o<t.length;o++)if(i++,e+="<tr id='option"+i+"'>",e+="<td colspan='5'>",2==t[o].name.length?e+="<span style='margin-left: 6.5%;'><strong>"+t[o].name+"</strong></span>":e+="<span style='margin-left: 5%;'><strong>"+t[o].name+"</strong></span>",e+="<span style='margin-left: 8%;'></span><strong>"+t[o].expertNo+"</strong></span>",e+="<span style='margin-left: 58%;'></span><strong>合计:</strong></span>",e+="<span style='margin-left: 4%;'></span><strong>"+t[o].monthTotal+"</strong></span>",e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewcost,e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewtaxes,e+="</td>",e+="</tr>",t[o].expertCostDetailCountDtoList.length>0)for(var n=0;n<t[o].expertCostDetailCountDtoList.length;n++){i++;var a=""
;a+="<tr id='option"+i+"'>",a+="<td class='text-center' colspan='2'>",a+=t[o].expertCostDetailCountDtoList[n].reviewTitle,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewType,a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewcost,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewtaxes,a+="</td>",a+="</tr>",e+=a}$("#expertCostHead").after(e)}}var a=this;a.title="专家缴税统计管理",a.model={},a.financials=new Array,a.sign={},a.financial={},a.financial.signid=i.params.signid,a.model.beginTime=i.params.beginTime,a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.getExpertCoust=function(){i.go("expertPaymentCountList",{beginTime:a.model.beginTime})},a.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=a.financial.signid;a.financial={},a.financial.chargeType="评审项目",a.financial.signid=i,a.financial.projectName=t,a.financial.paymentData=e,a.financials.push(a.financial),a.i++},a.saveFinancial=function(){e.savefinancial(a)},a.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){a.financials.forEach(function(e,n){t[o].value!=e.id&&void 0!=e.id||a.financials.splice(n,1),i.push(t[o].value)});var n=i.join(",");e.deleteexpertPaymentCount(a,n)}},a.countExpertCostDetail=function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo;for(var e=$("#expertCostTable tr").length,i=1;i<e;i++)$("#option"+i).remove();n(a.expertCostTotalInfo)})},function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo,n(a.expertCostTotalInfo)})}()}angular.module("app").controller("expertPaymentDetailCountCtrl",t),t.$inject=["$location","expertPaymentCountSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o,n){function a(){var t=new Date,e=t.getFullYear();return c(new Date(e,l(),1))}function r(){var t=new Date,e=t.getFullYear(),i=l()+2;return c(new Date(e,i,s(i)))}function s(t){var e=new Date,i=e.getYear(),o=new Date(i,t,1);return(new Date(i,t+1,1)-o)/864e5}function l(){var t=new Date,e=t.getMonth(),i=0;return e<3&&(i=0),2<e&&e<6&&(i=3),5<e&&e<9&&(i=6),e>8&&(i=9),i}function c(t){var e=t.getFullYear(),i=t.getMonth()+1,o=t.getDate();return i<10&&(i="0"+i),o<10&&(o="0"+o),e.toString()+"-"+i.toString()+"-"+o.toString()}var d=this;d.title="专家评审基本情况统计",d.model={},d.expertRevConCount=function(){if(3==d.model.reportType&&(void 0==d.model.beginTime||""==d.model.beginTime||void 0==d.model.endTime||""==d.model.endTime))return void n.alert("会议起止时间不能为空");e.expertRevConCount(d,function(t){1==d.model.reportType?d.expertReviewConDtoList=t.reObj.expertReviewConDtoList:2==d.model.reportType?d.expertRevConSimDtoList=t.reObj.expertRevConSimDtoList:3==d.model.reportType&&(d.expertRevConCompDtoList=t.reObj.expertRevConCompDtoList)})},d.dropSlelectedCount=function(){if(1==d.model.reportType||2==d.model.reportType){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1,n=t.getDate();o=o<10?"0"+o:o,d.model.beginTime=i.toString()+"-01-01",d.model.endTime=i.toString()+"-"+o.toString()+"-"+n}else 3==d.model.reportType&&(d.model.beginTime=a(),d.model.endTime=r());e.expertRevConCount(d,function(t){1==d.model.reportType?d.expertReviewConDtoList=t.reObj.expertReviewConDtoList:2==d.model.reportType?d.expertRevConSimDtoList=t.reObj.expertRevConSimDtoList:3==d.model.reportType&&(d.expertRevConCompDtoList=t.reObj.expertRevConCompDtoList)})},d.formReset=function(){var t=d.model.reportType;d.model={},d.model.reportType=t},function(){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1,n=t.getDate();o=o<10?"0"+o:o,d.model.beginTime=i.toString()+"-01-01",d.model.endTime=i.toString()+"-"+o.toString()+"-"+n,d.model.reportType=1,e.expertRevConCount(d,function(t){d.expertReviewConDtoList=t.reObj.expertReviewConDtoList})}()}angular.module("app").controller("expertRevConCountCtrl",t),t.$inject=["$location","expertRevConCountSvc","$state","$http","bsWin"]}(),function(){"use strict";function t(t){function e(e,i){if(1==e.model.reportType)var o={method:"post",url:rootPath+"/expertSelected/expertReviewCondDetailCount",data:e.model};else if(2==e.model.reportType)var o={method:"post",url:rootPath+"/expertSelected/expertReviewCondCount",data:e.model};else if(3==e.model.reportType)var o={method:"post",url:rootPath+"/expertSelected/expertReviewCompliCount",data:e.model};var n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{expertRevConCount:e}}angular.module("app").factory("expertRevConCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="评审费录入",a.financials=new Array,a.financial={},a.financial.businessId=i.params.businessId,function(){e.initFinancialProject(a.financial.businessId,function(t){a.model=t.financialDto,a.financials=t.financiallist,a.countCost()})}(),a.countCost=function(){if(a.financials&&a.financials.length>0){var t=0;angular.forEach(a.financials,function(e,i){e.charge&&(t+=e.charge)}),$("#financialCount").html(t)}},a.findStageCostTable=function(){n.initReview(a.financial.businessId,"",function(t){a.expertReview=t,a.reviewTitle=t.reviewTitle,a.payDate=t.payDate,a.expertSelectedDtoList=t.expertSelectedDtoList,$("#stageCostWindow").kendoWindow({width:"70%",height:"600px",title:"评审费用统计表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},a.exportExcel=function(){var t=a.reviewTitle+"("+a.payDate+")";e.exportExcel(a,a.financial.businessId,t)},a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.addFinancial=function(){var t={};t.chargeType="9",t.businessId=a.model.businessId,t.projectName=a.model.projectName,t.paymentData=a.model.paymentData,a.financials||(a.financials=[]),a.financials.push(t)},a.saveFinancial=function(){e.savefinancial(a.financials,function(e){e.flag||"ok"==e.reCode?(a.financials=e.reObj,a.model.paymentData||(a.model.paymentData=a.financials[0].paymentData),a.countCost(),t.success(e.reMsg)):t.error(e.reMsg)})},a.deleteFinancial=function(){var i=$("#financialsTable input[name='financialsCheck']:checked");if(i.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else{for(var o=[],n=0;n<i.length;n++)a.financials.forEach(function(t,e){void 0!=t.id&&i[n].value!=t.id||a.financials.splice(e,1),i[n].value&&o.push(i[n].value)});if(o.length>0){var r=o.join(",");e.deleteFinancialManager(r,function(e){a.countCost(),t.alert("操作成功！！")})}}}}angular.module("app").controller("financialManagerCtrl",t),t.$inject=["bsWin","financialManagerSvc","$state","$http","expertReviewSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s){function l(){e.initfinancial(c.model,function(t){c.stageCountList=t}),r.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(c.orgDeptList=t.reObj)})}var c=this;c.title="评审费录入",c.sign={},c.financial={},c.model={},c.model.beginTime=(new Date).halfYearAgo(),c.model.endTime=(new Date).Format("yyyy-MM-dd"),c.isuserExist=!1,c.id=i.params.id,c.financial.businessId=i.params.businessId,c.costType=i.params.costType,c.id&&(c.isUpdate=!0,c.title="评审费统计管理"),c.businessFlag={expertReviews:[]},l(),c.showCostWindow=function(t,e){s.initAddCost(c,c.costType,t,e)},c.queryFinancl=function(){l()},c.resetQuery=function(){c.model={}}}angular.module("app").controller("financialManagerEditCtrl",t),t.$inject=["$location","financialManagerSvc","$state","signSvc","bsWin","expertReviewSvc","adminSvc","addCostSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/findProjectReviewCost",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(t,e,i){var i=escape(encodeURIComponent(i));window.open(rootPath+"/financialManager/exportExcel?fileName="+i+"&businessId="+e)}function o(e){var i={method:"post",url:rootPath+"/financialManager/findByOData"},o=function(t){e.stageCountList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(e,i){var o={method:"post",url:rootPath+"/financialManager/initfinancial",params:{businessId:e.businessId,businessType:e.businessType}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:rootPath+"/financialManager/initfinancial",params:{businessId:e,businessType:"SIGN"}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"get",url:rootPath+"/financialManager/html/sumfinancial",params:{businessId:i}},n=function(t){$("#financialCount").html(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"post",url:rootPath+"/financialManager",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"delete",url:rootPath+"/financialManager",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertSelected/findProjectReviewCost",$("#searchform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"",title:"",width:30,template:function(t){if("4"==t.isLightUp)return $("#span4").html();switch(t.processState){case 9:return $("#span5").html();case 4:case 5:return $("#span2").html();case 7:case 8:return $("#span3").html();default:return $("#span1").html()}}},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:140,filterable:!1},{field:"builtcompanyname",title:"建设单位",width:180,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"principal",title:"项目负责人",width:120,filterable:!1},{field:"totalCost",title:"计划专家费用",width:160,filterable:!1,template:function(t){return"<button ng-click='vm.reviewCostWindow('"+t.businessId+"') '>"+t.totalCost+"</button>"}},{field:"signdate",title:"签收日期",width:120,filterable:!1,format:"{0: yyyy-MM-dd}"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}rootPath;return{grid:d,deleteFinancialManager:c,savefinancial:l,sumFinancial:s,initFinancialProject:a,initAssistProject:r,isUnsignedInteger:n,stageCostCountList:o,exportExcel:i,initfinancial:e}}angular.module("app").factory("financialManagerSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目评审费分类统计",a.model={},a.projectCostCountList=function(){o.go("projectCostCountList")},a.initFinancial=function(t){var e=o.href("financialManager",{businessId:t});window.open(e,"_blank")},a.proCostClassifyCount=function(){e.projectCostClassifyCout(a,function(t){a.proReviewClassifyDetailDtoList=t.reObj.proReviewClassifyDetailDtoList,a.proReviewClassifyCountDtoList=t.reObj.proReviewClassifyCountDtoList})},a.formReset=function(){a.model={}},function(){i.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(a.orgDeptList=t.reObj)}),e.projectCostClassifyCout(a,function(t){a.proReviewClassifyDetailDtoList=t.reObj.proReviewClassifyDetailDtoList,a.proReviewClassifyCountDtoList=t.reObj.proReviewClassifyCountDtoList})}()}angular.module("app").controller("proCostClassifyCountCtrl",t),t.$inject=["$location","projectCostCountSvc","adminSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="项目评审费统计",r.model={},r.model.beginTime=(new Date).halfYearAgo(),r.model.endTime=(new Date).Format("yyyy-MM-dd"),r.proCostClassifyCountList=function(){o.go("proCostClassifyCountList")},r.proCostCount=function(){e.projectCostTotal(r,function(t){r.projectReviewCostDtoList=t.reObj.projectReviewCostDtoList})},r.queyCostWindow=function(t){a.initReview(t.businessId,"",function(t){r.titleName="专家评审费",r.expertReview=t,r.reviewTitle=t.reviewTitle,r.payDate=t.payDate,r.businessId=r.expertReview.businessId,r.expertSelectedDtoList=t.expertSelectedDtoList,r.expertSelectedDtoList&&r.expertSelectedDtoList.length>0&&(r.showReviewCost=!0)}),$("#expertCostWindow").kendoWindow({width:"70%",height:"600px;",title:r.windowName,visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},r.costExportExcel=function(){var t=r.reviewTitle+"("+r.payDate+")";e.exportExcel(r,r.businessId,t)},r.formReset=function(){r.model={}},function(){i.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(r.orgDeptList=t.reObj)}),e.projectCostTotal(r,function(t){r.projectReviewCostDtoList=t.reObj.projectReviewCostDtoList})}()}angular.module("app").controller("projectCostCountCtrl",t),t.$inject=["$location","projectCostCountSvc","adminSvc","$state","$http","expertReviewSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/projectCostTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:rootPath+"/expertSelected/proCostClassifyTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i,o){var n={method:"post",url:rootPath+"/expertSelected/excelExport",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",responseType:"arraybuffer",data:angular.toJson(i),params:{fileName:o}},a=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:n,success:a})}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertReview/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expretCount",title:"姓名",width:100,filterable:!1},{field:"expretCount",title:"身份证号",width:100,filterable:!1},{field:"expretCount",title:"开户行",width:80,filterable:!1},{field:"expretCount",title:"银行账号",width:120,filterable:!1},{field:"reviewCost",title:"评审费（元）",width:160,filterable:!1},{field:"reviewTaxes",title:"应缴税",width:120,filterable:!1},{field:"reviewTitle",title:"项目名称",width:160,filterable:!1},{field:"reviewDate",title:"评审时间",width:160,filterable:!1},{field:"reviewDate",title:"函评时间",width:120,filterable:!1},{field:"reviewDate",title:"负责人",width:120,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function a(t,e,i){var i=escape(encodeURIComponent(i));window.open(rootPath+"/financialManager/costExportExcel?fileName="+i+"&businessId="+e)}rootPath;return{grid:n,projectCostTotal:e,projectCostClassifyCout:i,excelExport:o,exportExcel:a}}angular.module("app").factory("projectCostCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t,e){var i,o,n;try{i=t.toString().split(".")[1].length}catch(t){i=0}try{o=e.toString().split(".")[1].length}catch(t){o=0}return n=Math.pow(10,Math.max(i,o)),(t*n+e*n)/n}function a(){r.total.projectcount=0,r.total.declarevalue=0,r.total.authorizevalue=0,r.total.ljhj=0,r.total.hjl=0,r.protReviewConditionList.forEach(function(t,e){void 0!=t.proCount&&(r.total.projectcount+=t.proCount),void 0!=t.declareValue&&(r.total.declarevalue=n(r.total.declarevalue,t.declareValue)),void 0!=t.authorizeValue&&(r.total.authorizevalue=n(r.total.authorizevalue,t.authorizeValue)),void 0!=t.ljhj&&(r.total.ljhj=n(r.total.ljhj,t.ljhj))}),r.total.hjl=Math.round(r.total.ljhj/r.total.declarevalue*1e4)/1e4*100}var r=this;r.title="项目评审情况统计",r.model={},r.total={},r.proReviewConCount=function(){if(console.log(r.model),null!=r.model.beginTime&&""!=r.model.beginTime){var t=r.model.beginTime.split("-");r.year=t[0],r.begMonth=t[1],"0"==r.begMonth.charAt(0)&&(r.begMonth=r.begMonth.charAt(1))}if(null!=r.model.endTime&&""!=r.model.endTime){var t=r.model.endTime.split("-");r.year=t[0],r.endMonth=t[1],"0"==r.endMonth.charAt(0)&&(r.endMonth=r.endMonth.charAt(1))}e.proReviewConCount(r,function(t){r.protReviewConditionList=t.reObj.protReviewConditionList,a()})},r.formReset=function(){r.model={}},function(){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1,n=t.getDate();o=o<10?"0"+o:o,r.model.beginTime=i.toString()+"-01",r.model.endTime=i.toString()+"-"+o.toString(),r.year=i,r.begMonth="1",r.endMonth=o,r.begDay="31",r.endDay=n,e.proReviewConCount(r,function(t){r.protReviewConditionList=t.reObj.protReviewConditionList,a()})}()}angular.module("app").controller("proReviewConditionCtrl",t),t.$inject=["$location","proReviewConditionSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/proReviewConditionCount",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{proReviewConCount:e}}angular.module("app").factory("proReviewConditionSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.header={},i.id="",i.create=function(e){e&&(i.header.id=e,i.isUpdate=!0,t.getHeaderById(i,e)),i.header={},$("#addHeaderWindow").kendoWindow({width:"500px",height:"300px",title:"新建表字段",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},i.save=function(){t.createHeader(i)},i.queryUser=function(){i.gridOptions.dataSource.read()},i.del=function(e){t.deleteHeader(i,e)},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.update=function(){t.updateHeader(i)},function(){t.headerGrid(i)}()}angular.module("app").controller("headerCtrl",t),t.$inject=["headerSvc","bsWin"]}(),function(){"use strict";function t(t,e){function i(i){common.initJqValidation();$("form").valid();if(void 0!=i.header.headerKey&&void 0!=i.header.headerName&&void 0!=i.header.headerType){var o={method:"put",url:rootPath+"/header/updateHeader",data:i.header},n=function(t){t.data.flag||"ok"==t.data.reCode?(e.success("修改成功!"),window.parent.$("#addHeaderWindow").data("kendoWindow").close(),i.gridOptions.dataSource.read()):e.error(t.data.reMsg)};common.http({vm:i,$http:t,httpOptions:o,success:n})}}function o(i,o){var n={method:"delete",url:rootPath+"/header",params:{id:o}},a=function(t){e.success("删除成功！"),i.gridOptions.dataSource.read()};common.http({vm:i,$http:t,httpOptions:n,success:a})}function n(e,i){var o={method:"get",url:rootPath+"/header/getHeaderById",params:{id:i}},n=function(t){e.header=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"post",url:rootPath+"/header/findHeaderListSelected",params:{headerType:e.headerType}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"put",url:rootPath+"/header/updateSelectedHeader",params:{idStr:i}},n=function(t){};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"put",url:rootPath+"/header/updateCancelHeader",params:{idStr:i}},n=function(t){};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(i){common.initJqValidation();$("form").valid();if(void 0!=i.header.headerKey&&void 0!=i.header.headerName&&void 0!=i.header.headerType){var o={method:"post",url:rootPath+"/header/createHeader",data:i.header},n=function(t){t.data.flag||"ok"==t.data.reCode?(e.success("操作成功！"),window.parent.$("#addHeaderWindow").data("kendoWindow").close(),i.gridOptions.dataSource.read()):e.error(t.data.reMsg)};common.http({vm:i,$http:t,httpOptions:o,success:n})}}function c(e){var i={method:"post",url:rootPath+"/header/findHeaderListNoSelected",params:{headerType:e.headerType}},o=function(t){e.allHeaderList=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/header/findAllHeader",$("#headerForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"headerName",title:"列名",width:100,filterable:!1},{field:"headerKey",title:"key值",width:100,filterable:!1},{field:"headerType",title:"类型",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')","vm.create('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{headerGrid:d,createHeader:l,findHeaderListNoSelected:c,updateSelectedHeader:r,updateCancelHeader:s,findHeaderListSelected:a,deleteHeader:o,getHeaderById:n,updateHeader:i}}angular.module("app").factory("headerSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.selectedHeaderList=[],i.selectList={},i.headerType=e.params.headerType,i.allChecked=function(){var t=$("#selectHeaderForm").find("input");$.each(t,function(t,e){e.checked=!0})},i.allCancel=function(){var t=$("#selectHeaderForm").find("input");$.each(t,function(t,e){e.checked=!1})},i.addHeader=function(){for(var e=[],o=0;o<i.allHeaderList.length;o++){var n=i.allHeaderList[o];n.checkbox&&(e.push(n.id),i.selectedHeaderList.push(n),i.allHeaderList.splice(o,1),o=0,n.checkbox=!1)}var a=e.join(",");t.updateSelectedHeader(i,a)},i.cancelHeader=function(){for(var e=[],o=0;o<i.selectedHeaderList.length;o++){var n=i.selectedHeaderList[o];n.checkbox&&(e.push(n.id),i.allHeaderList.push(n),i.selectedHeaderList.splice(o,1),o=0,n.checkbox=!1)}var a=e.join(",");t.updateCancelHeader(i,a)},i.changeType=function(){t.findHeaderListNoSelected(i),i.selectedHeaderList=[]},function(){t.findHeaderListNoSelected(i),t.findHeaderListSelected(i,function(t){i.selectedHeaderList=t,i.header=!0})}()}angular.module("app").controller("headerEditCtrl",t),t.$inject=["headerSvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="",i.changePwd=function(){e.changePwd(i)}}angular.module("app").controller("homeCtrl",t),t.$inject=["$location","homeSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"put",url:i,data:e.model.password},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}}var i=rootPath+"/account/password";return{changePwd:e}}angular.module("app").factory("homeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="日志列表",function(){e.grid(i)}()}angular.module("app").controller("logCtrl",t),t.$inject=["$location","logSvc"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(o+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"id",title:"ID",width:80,filterable:!1},{field:"level",title:"级别",width:100,filterable:!0},{field:"message",title:"日志内容",filterable:!1},{field:"userId",title:"操作者",width:150,filterable:!0},{field:"createdDate",title:"操作时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var o=rootPath+"/log";rootPath;return{grid:i}}angular.module("app").factory("logSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="会议室列表",i.model={},i.del=function(o){t.confirm({title:"询问提示",message:"确认删除数据吗？",onOk:function(){e.deleteMeeting(o,i.isSubmit,function(e){i.isSubmit=!1,e.flag||"ok"==e.reCode?t.alert("消息提示","操作成功！",function(){i.gridOptions.dataSource.read()}):t.alert(e.reMsg)})}})},i.used=function(o){i.model.id=o,i.model.mrStatus="1",e.roomUseState(i.model,function(e){t.alert("操作成功！",function(){i.gridOptions.dataSource.read()})})},i.stoped=function(o){t.confirm({title:"询问提示",message:"确认停用么？",onOk:function(){i.model.id=o,i.model.mrStatus="2",e.roomUseState(i.model,function(e){t.alert("操作成功！",function(){i.gridOptions.dataSource.read()})})}})},i.dels=function(){var e=common.getKendoCheckId(".grid");if(0==e.length)t.alert("请选择数据");else{for(var o=[],n=0;n<e.length;n++)o.push(e[n].value);var a=o.join(",");i.del(a)}},i.queryMeeting=function(){i.gridOptions.dataSource.read()},function(){e.grid(i)}()}angular.module("app").controller("meetingCtrl",t),t.$inject=["bsWin","meetingSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加会议室",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新会议室"),o.create=function(){common.initJqValidation(),$("form").valid()?e.createMeeting(o.model,o.isSubmit,function(e){e.flag||"ok"==e.reCode?t.alert("消息提示","操作成功！",function(){location.href="#/meeting"}):t.alert(e.reMsg)}):t.alert("信息没填写正确！")},o.update=function(){common.initJqValidation(),$("form").valid()?(o.model.id=o.id,e.updateMeeting(o.model,o.isSubmit,function(e){e.flag||"ok"==e.reCode?t.alert("操作成功"):t.alert(e.reMsg)})):t.alert("信息没填写正确！")},function(){o.isUpdate&&e.getMeetingById(o)}()}angular.module("app").controller("meetingEditCtrl",t),t.$inject=["bsWin","meetingSvc","$state"]}(),function(){"use strict";function t(t){function e(e,i,o){i=!0;var n={method:"put",url:l,data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function i(e,i,o){i=!0;var n={method:"delete",url:l,params:{id:e}},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function o(e,i){var o={method:"put",url:l+"/roomUseState",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i,o){i=!0;var n={method:"post",url:l,data:e},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}function a(e){var i={method:"get",url:l+"/html/findByIdMeeting",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#meetingFrom")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"num",title:"编号",width:"8%",filterable:!1},{field:"mrName",title:"会议室名称",width:"25%",filterable:!1},{field:"mrType",title:"类型",width:"10%",filterable:!1},{field:"addr",title:"会议室地点",width:"25%",filterable:!1},{field:"capacity",title:"容量",width:"10%",filterable:!1},{field:"",title:"状态",width:"8%",template:function(t){return"2"==t.mrStatus?"停用":"正常"}},{field:"",title:"操作",width:"14%",template:function(t){var e=!1;return e="2"==t.mrStatus,common.format($("#columnBtns").html(),"vm.stoped('"+t.id+"')",e,"vm.used('"+t.id+"')",e,t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function s(e){var i={method:"post",url:rootPath+"/meeting/findAll"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}var l=rootPath+"/meeting";return{grid:r,getMeetingById:a,createMeeting:n,deleteMeeting:i,updateMeeting:e,roomUseState:o,findAllMeeting:s}}angular.module("app").factory("meetingSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="待办事项",n.addregister={},n.model={},n.model.signid=i.params.signid,function(){n.showPrint=!1,e.grid(n)}(),n.print=function(){signcommon.registerFilePrint(n,{$http:o})},n.findbySuppleDate=function(t){}}angular.module("app").controller("registerFileCtrl",t),t.$inject=["$location","registerFileSvc","$state","$http"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridinlineConfig().transport(t,{readUrl:o+"/findByOData",updateUrl:o+"/update",destroyUrl:o+"/delete",createUrl:o+"/create/"+t.model.signid},{filter:"signid eq '"+t.model.signid+"'"}),
schema:common.kendoGridConfig().schema({id:"id",fields:{fileName:{validation:{required:!0},type:"String"},totalNum:{type:"number",validation:{required:!0,min:1}},isHasOriginfile:{type:"boolean"},isHasCopyfile:{type:"boolean"},suppleDeclare:{type:"string"},suppleDate:{type:"date"},createdDate:{type:"date"},modifiedDate:{type:"date"}}}),batch:!0,pageSize:10,serverPaging:!0,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},n=[{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"fileName",title:"资料名称",width:"120px",filterable:!1},{field:"totalNum",title:"份数",width:"120px",filterable:!1},{field:"isHasOriginfile",title:"原件",width:"120px",filterable:!1,template:function(t){return t.isHasOriginfile?"是":"否"}},{field:"isHasCopyfile",title:"复印件",width:"120px",filterable:!1,template:function(t){return t.isHasCopyfile?"是":"否"}},{field:"suppleDeclare",title:"补充说明",width:"120px",filterable:!1},{field:"suppleDate",title:"补充日期",width:"120px",format:"{0:yyyy-MM-dd}",filterable:!1},{command:["destroy"],title:"&nbsp;",width:"250px"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridinlineConfig().filterable,pageable:common.kendoGridinlineConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:n,toolbar:["create","save","cancel"],dataBound:i,editable:!0,navigatable:!0,resizable:!0}}var o=rootPath+"/addRegisterFile";return{grid:i}}angular.module("app").factory("registerFileSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.showsupp=!1,n.title="拟补资料函",n.suppletter={},n.model={},n.model.signid=i.params.signid,n.suppletter.id=i.params.id,n.addSuppContent=function(){n.showsupp=!0,$("#addsuppContent").kendoWindow({width:"50%",height:"80%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()}}angular.module("app").controller("suppletterCtrls",t),t.$inject=["$location","suppletterSvc","$state","$http"]}(),function(){"use strict";function t(t,e){return{}}angular.module("app").factory("suppletterSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="月报简报历史数据管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletemonthlyHistory(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.monthlyHistoryGrid(i),e.deleteGridOptions(i)}()}angular.module("app").controller("monthlyHistoryCtrl",t),t.$inject=["$location","monthlyHistorySvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加月报简报历史数据",n.isuserExist=!1,n.id=i.params.id,n.monthly={},n.id&&(n.isUpdate=!0,n.title="更新月报简报"),n.createHistory=function(){common.initJqValidation(),$("form").valid()?e.createmonthlyHistory(n.monthly,function(t){t.flag||"ok"==t.reCode?(n.monthly=t.reObj,o.alert("操作成功！")):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},n.updateMonthly=function(){e.updatemonthlyHistory(n)},function(){n.isUpdate&&e.getmonthlyHistoryById(n)}()}angular.module("app").controller("monthlyHistoryEditCtrl",t),t.$inject=["$location","monthlyHistorySvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.monthly.id=e.id;var i={method:"put",url:l+"/monthlyEdit",data:e.monthly},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var n={method:"delete",url:l+"/deleteHistory",data:i},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),o()}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}function o(){window.location.reload()}function n(e,i){var o={method:"post",url:l+"/savaHistory",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e){var i={method:"get",url:rootPath+"/monthlyNewsletter/html/findById",params:{id:e.id}},o=function(t){e.monthly=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/mothlyHistoryList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"startDay",title:"开始时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"startDay",title:"结束时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"stageMunber",title:"已评审项目数",width:120,filterable:!1},{field:"declarationSum",title:"报审总投资",width:100,filterable:!1},{field:"assessorSum",title:"审核总投资",width:100,filterable:!1},{field:"authorizedUser",title:"录入人",width:100,filterable:!1},{field:"authorizedTime",title:"录入时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id,"vm.del('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/deleteHistoryList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"startDay",title:"开始时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"startDay",title:"结束时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"stageMunber",title:"已评审项目数",width:120,filterable:!1},{field:"declarationSum",title:"报审总投资",width:100,filterable:!1},{field:"assessorSum",title:"审核总投资",width:100,filterable:!1},{field:"authorizedUser",title:"录入人",width:100,filterable:!1},{field:"authorizedTime",title:"录入时间",width:100,filterable:!1}];t.deleteGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}var l=rootPath+"/monthlyNewsletter";return{monthlyHistoryGrid:r,deleteGridOptions:s,createmonthlyHistory:n,deletemonthlyHistory:i,getmonthlyHistoryById:a,updatemonthlyHistory:e}}angular.module("app").factory("monthlyHistorySvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="月报简报查询",function(){e.monthlyMultiyearGrid(n)}(),n.addSuppQuery=function(){n.multiyearGrid.dataSource.read()},n.resetAddSupp=function(){var t=$("#form_monthly").find("input,select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("monthlyMultiFileCtrl",t),t.$inject=["$location","monthlyMultiyearSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="年度月报简报",n.suppletter={},n.suppletter.monthLetterYearName=i.params.year,function(){e.monthlyYearGrid(n),e.findAllOrg(n)}(),n.addSuppQuery=function(){e.addSuppQuery(n)},n.resetAddSupp=function(){var t=$("#form_monthly").find("input,select");$.each(t,function(t,e){e.value=""})},n.del=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletemonthlyMultiyear(n,t)}})},n.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.del(o)}}}angular.module("app").controller("monthlyMultiyearCtrl",t),t.$inject=["$location","monthlyMultiyearSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="添加月报简报稿纸",a.isuserExist=!1,a.isSubmit=!0,a.suppletter={},a.id=i.params.id,a.type=i.params.type,a.suppletter.id=i.params.id,a.id&&(a.isUpdate=!0,a.isflow=!0,a.title="更新月报简报稿纸"),a.businessFlag={isInitFileOption:!1},function(){a.isUpdate?t.getmonthlyMultiyearById(a.id,function(t){a.suppletter=t,a.initFileUpload()}):t.initMonthlyMultiyear(function(t){a.suppletter=t,a.initFileUpload()})}(),a.initFileUpload=function(){a.suppletter.id||n.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.suppletter.id,mainId:a.suppletter.id,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().MONTH_FILE,sysBusiType:e.mainTypeValue().MONTH_FILE},e.initUploadOptions({inputId:"sysfileinput",vm:a})},a.saveAddSuppletter=function(){common.initJqValidation(),$("form").valid()?(a.suppletter.fileType="2",t.createmonthlyMultiyear(a.suppletter,function(t){t.flag||"ok"==t.reCode?(a.suppletter=t.reObj,a.id=t.reObj.id,o.alert("操作成功！")):o.error(t.reMsg)})):o.alert("缺少部分没有填写，请仔细检查")},a.updateAddSuppletter=function(){common.initJqValidation(),$("form").valid()?t.updatemonthlyMultiyear(a.suppletter,function(t){console.log(t),t.flag||"ok"==t.reCode?o.alert("操作成功！"):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},a.startNewFlow=function(e){o.confirm({title:"询问提示",message:"确认已经完成填写，并且发起流程么？",onOk:function(){$(".confirmDialog").modal("hide"),e?t.updatemonthlyMultiyear(a.suppletter,function(i){i.flag||"ok"==i.reCode?t.startFlow(e,function(t){t.flag||"ok"==t.reCode?o.success("操作成功！",function(){location.href="#/theMonthsList"}):o.error(t.reMsg)}):o.error(i.reMsg)}):(a.suppletter.fileType="2",t.createmonthlyMultiyear(a.suppletter,function(e){e.flag||"ok"==e.reCode?(a.suppletter=e.reObj,a.id=e.reObj.id,t.startFlow(a.id,function(t){t.flag||"ok"==t.reCode?o.success("操作成功！",function(){location.href="#/theMonthsList"}):o.error(t.reMsg)})):o.error(e.reMsg)}))}})}}angular.module("app").controller("monthlyMultiyearEditCtrl",t),t.$inject=["monthlyMultiyearSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e){function i(e){var i={method:"get",url:common.format(h+"/findAllUsers")},o=function(t){e.userlist={},e.userlist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){var i={method:"get",url:common.format(h+"/getOrg")},o=function(t){e.orglist={},e.orglist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){t.monthlyYearGrid.dataSource.read()}function a(e){var i={method:"post",url:f+"/initMonthlyMultiyear"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:f+"/saveMonthlyMultiyear",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){e.isSubmit=!0;var o={method:"delete",url:f+"/deleteMutiyear",data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"post",url:f+"/saveMonthlyMultiyear",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"post",url:rootPath+"/addSuppLetter/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/addSuppLetter/monthlyMultiyearList",$("#form_monthly"),{filter:"monthLetterYearName lt '"+t.suppletter.monthLetterYearName+"'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items();$(t).each(function(){var t=$(this).index()+1,e=$(this).find(".row-number");$(e).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:180,filterable:!1,template:function(t){return'<a href="#/monthlyMultiyearEdit/'+t.id+'" >'+t.title+"</a>"}},{field:"orgName",title:"拟办部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:120,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1},{field:"secretLevel",title:"秘密等级",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){var e=!0;return(angular.isUndefined(t.processInstanceId)||""==t.processInstanceId)&&(e=!1),common.format($("#columnBtns").html(),t.id,e,t.id)}}];t.monthlyYearGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/addSuppLetter/monthlyMultiyearList",$("#form"),{filter:"fileType eq '2'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:"30%",filterable:!1,template:function(t){return'<a href="#/monthlyMultiyearEdit/'+t.id+'" >'+t.title+"</a>"}},{field:"orgName",title:"拟办部门",width:"10%",filterable:!1},{field:"userName",title:"拟稿人",width:"10%",filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:"10%",filterable:!1},{field:"secretLevel",title:"秘密等级",width:"10%",filterable:!1},{field:"",title:"操作",width:80,template:function(t){return common.format($("#columnBtns").html(),t.id,t.appoveStatus)}}];t.multiyearGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function m(e,i){var o={method:"post",url:rootPath+"/monthlyNewsletter/startFlow",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function p(t){c(t.businessKey,function(e){t.suppletter=e})}var f=rootPath+"/monthlyNewsletter",h=rootPath+"/user";return{createmonthlyMultiyear:l,initMonthlyMultiyear:a,monthlyMultiyearGrid:u,monthlyYearGrid:d,getmonthlyMultiyearById:c,updatemonthlyMultiyear:r,addSuppQuery:n,findAllOrg:o,findAllUser:i,deletemonthlyMultiyear:s,startFlow:m,initFlowDeal:p}}angular.module("app").factory("monthlyMultiyearSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="月报简报列表",function(){e.monthlyNewsletterGrid(i),e.monthlyDeleteGrid(i)}(),i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteMonthlyNewsletter(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}}}angular.module("app").controller("monthlyNewsletterCtrl",t),t.$inject=["$location","monthlyNewsletterSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加月报简报",n.isuserExist=!1,n.id=i.params.id,n.monthly={},n.id&&(n.isUpdate=!0,n.title="更新月报简报"),n.selectMonthly=function(){n.monthly.endTheMonths=n.monthly.theMonths,n.monthly.staerTheMonths="1"},n.reportYear=function(){var t=n.monthly.reportMultiyear;n.monthly.startMoultiyear=t,n.monthly.endMoultiyear=t},n.startMonthly=function(){parseInt(n.monthly.endTheMonths)<parseInt(n.monthly.staerTheMonths)&&(o.alert("开始月份不能大于结束月份"),n.monthly.staerTheMonths=" ")},n.createMothlyNewsletter=function(){common.initJqValidation(),$("#form").valid()?e.createMonthlyNewsletter(n.monthly,function(t){t.flag||"ok"==t.reCode?(n.monthly=t.reObj,o.alert("操作成功！")):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},n.updateMonthly=function(){e.updateMonthlyNewsletter(n)},n.createMonthReport=function(){e.createMonthReport(n)},function(){n.isUpdate&&e.getMonthlyNewsletterById(n)}()}angular.module("app").controller("monthlyNewsletterEditCtrl",t),t.$inject=["$location","monthlyNewsletterSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.monthly.id=e.id;var i={method:"put",url:d+"/monthlyEdit",data:e.monthly},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var n={method:"delete",url:d+"/deleteMonthlyData",data:i},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),o()}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}function o(){window.location.reload()}function n(e,i){var o={method:"post",url:d+"/savaMonthlyNewsletter",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e){var i={method:"post",url:rootPath+"/monthlyNewsletter/createMonthReport",data:e.monthly},o=function(t){if(null!=e.monthly.theMonths)var i=e.monthly.theMonths+"月月报.doc";else var o=new Date,n=o.getMonth()+1,i=n+"月报简报.doc";common.downloadReport(t.data,i,"msword")};common.http({$http:t,httpOptions:i,success:o})}function r(e){var i={method:"get",url:rootPath+"/monthlyNewsletter/html/findById",params:{id:e.id}},o=function(t){e.monthly=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/findByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"reportMultiyear",title:"报告年度",width:100,filterable:!1},{field:"theMonths",title:"报告月份",width:100,filterable:!1},{field:"remark",title:"报告说明",width:100,filterable:!1},{field:"authorizedUser",title:"编制人",width:100,filterable:!1},{field:"authorizedTime",title:"编制时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.id,"vm.del('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/deleteMonthlyList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"reportMultiyear",title:"报告年度",width:100,filterable:!1},{field:"theMonths",title:"报告月份",width:100,filterable:!1},{field:"remark",title:"报告说明",width:100,filterable:!1},{field:"authorizedUser",title:"编制人",width:100,filterable:!1},{field:"authorizedTime",title:"编制时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"}];t.monthlyDeleteGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/monthlyNewsletter/getMonthlyList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),sort:{field:"createdDate",dir:"asc"}}),i=function(){var t=this.items();$(t).each(function(){var t=$(this).index()+1,e=$(this).find(".row-number");$(e).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"monthlyNewsletterName",title:"名称",width:"30%",filterable:!1,template:function(t){return'<a href="#/monthlyFindByMultiyear/'+t.reportMultiyear+'" >'+t.monthlyNewsletterName+"</a>"}},{field:"reportMultiyear",title:"年份",width:"15%",filterable:!1},{field:"remark",title:"备注",width:"40%",filterable:!1},{field:"authorizedTime",title:"添加时间",width:"15%",filterable:!1}];t.theMonthGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}var d=rootPath+"/monthlyNewsletter";return{monthlyNewsletterGrid:s,monthlyDeleteGrid:l,theMonthGrid:c,createMonthlyNewsletter:n,updateMonthlyNewsletter:e,deleteMonthlyNewsletter:i,getMonthlyNewsletterById:r,createMonthReport:a}}angular.module("app").factory("monthlyNewsletterSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="年度月报简报列表",function(){e.theMonthGrid(i)}()}angular.module("app").controller("yearMonthlyNewsletterCtrl",t),t.$inject=["$location","monthlyNewsletterSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="处室人员管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOfficeUser(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryOffice=function(){e.queryOffice(i)},function(){e.grid(i)}()}angular.module("app").controller("officeUserCtrl",t),t.$inject=["$location","officeUserSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加人员",o.isuserExist=!1,o.officeID=i.params.officeID,o.officeID&&(o.isUpdate=!0,o.title="更新人员"),o.create=function(){e.createOfficeUser(o)},o.update=function(){e.updateOfficeUser(o)},function(){o.isUpdate&&e.getOfficeUserById(o),e.getDepts(o)}()}angular.module("app").controller("officeUserEditCtrl",t),t.$inject=["$location","officeUserSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function i(e){var i={method:"get",url:common.format(l+"/getDepts")},o=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e){var i={method:"get",url:rootPath+"/officeUser/html/findById",params:{officeID:e.officeID}},o=function(t){t.data.dept,e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#formOffice")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"deptName",title:"所在办事处",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeEmail",title:"邮件",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var l=rootPath+"/officeUser",c="#/officeUserList";return{grid:s,getOfficeUserById:r,createOfficeUser:a,deleteOfficeUser:n,updateOfficeUser:o,getDepts:i,queryOffice:e}}angular.module("app").factory("officeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目暂停审批",function(){e.grid(a),n.initIdea(a)}(),a.pauseProjectWindow=function(t,i){e.pauseProjectWindow(a,t,i)},a.commitProjectStop=function(){e.updateProjectStop(a)},a.closewin=function(){window.parent.$("#spwindow").data("kendoWindow").close()},a.selectMinisterIdea=function(){a.projectStop.directorIdeaContent+=a.directorIdea},a.selectDirectorIdea=function(){a.projectStop.leaderIdeaContent+=a.leaderIdea}}angular.module("app").controller("pauseProjectCtrl",t),t.$inject=["$location","pauseProjectSvc","$state","adminSvc","ideaSvc"]}(),function(){"use strict";function t(t,e,i){function o(e,i){var o={method:"post",url:rootPath+"/projectStop/getListInfo",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(o,n){var a={method:"get",url:rootPath+"/projectStop/findPausingProject",params:{signId:n}},r=function(t){""!=t.data?i.success("该项目暂停申请正在处理"):e.go("projectStopForm",{signId:n,stopId:""})};common.http({vm:o,$http:t,httpOptions:a,success:r})}function a(e,i){var o={method:"post",url:rootPath+"/projectStop/initProjectBySignId",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:rootPath+"/projectStop/savePauseProject",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(t){l(t.businessKey,function(e){t.model=e,t.sign=t.model.signDispaWork})}function l(e,i){var o={method:"post",url:rootPath+"/projectStop/getProjectStopByStopId",params:{stopId:e}},n=function(t){if(void 0!=i&&"function"==typeof i)return i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(o){if(common.initJqValidation(),$("#form").valid()){var n={method:"post",url:rootPath+"/projectStop/updateProjectStop",data:o.projectStop},a=function(t){i.success("操作成功"),e.go("pauseProject")};common.http({vm:o,$http:t,httpOptions:n,success:a})}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/projectStop/findByOData"),schema:{data:"value",total:function(t){return t.count?$("#PAUSE_COUNT").html(t.count):$("#PAUSE_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"",title:"项目名称",width:200,filterable:!1,template:function(t){return t.sign.projectname}},{field:"",title:"评审阶段",width:100,filterable:!1,template:function(t){return t.sign.reviewstage}},{field:"createdDate",title:"申请日期",width:100,format:"{0:yyyy-MM-dd}",filterable:!1},{field:"",title:"操作",width:100,filterable:!1,template:function(t){return common.format($("#columnBtns").html(),t.sign.signid,t.stopid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}return{initProject:a,pauseProject:r,initFlowDeal:s,grid:d,getProjectStopByStopId:l,updateProjectStop:c,findPausingProject:n,getListInfo:o}}angular.module("app").factory("pauseProjectSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this;o.sign={};var n=t.params.signId;o.projectStop={},o.projectStop.signid=n,function(){
e.initProject(n,function(t){o.sign=t,"可行性研究报告"==o.sign.reviewstage||"项目概算"==o.sign.reviewstage?o.sign.countUsedWorkday=15-o.sign.surplusdays:o.sign.countUsedWorkday=12-o.sign.surplusdays})}(),o.Checked=function(t,e){var i=t.target,n=i.checked;e?o.noFile=9!=n&&"9"!=n:o.noFile&&(o.projectStop.isSupplementMaterial=0,o.projectStop.isPuaseApprove=0)},o.commitProjectStop=function(){common.initJqValidation(),$("#form").valid()?(o.projectStop.processName="《"+o.sign.projectname+"》暂停申请",o.projectStop.userDays||(o.projectStop.userDays=o.sign.countUsedWorkday),e.pauseProject(o.projectStop,function(e){e.flag||"ok"==e.reCode?i.alert("操作成功！",function(){t.go("personDtasks")}):i.alert(e.reMsg)})):i.alert("项目暂停表填写不符合要求！")},o.selectMinisterIdea=function(){o.projectStop.directorIdeaContent+=o.directorIdea},o.selectDirectorIdea=function(){o.projectStop.leaderIdeaContent+=o.leaderIdea}}angular.module("app").controller("projectStopFormCtrl",t),t.$inject=["$state","pauseProjectSvc","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this;o.stopId=t.params.stopId,function(){e.getProjectStopByStopId(o.stopId,function(t){o.projectStop=t,o.sign=o.projectStop.signDispaWork,"可行性研究报告"==o.sign.reviewstage||"项目概算"==o.sign.reviewstage?o.sign.countUsedWorkday=15-o.sign.surplusdays:o.sign.countUsedWorkday=12-o.sign.surplusdays})}(),o.saveProjectStop=function(){common.initJqValidation(),$("#form").valid()?e.pauseProject(o.projectStop,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！"):i.alert(t.reMsg)}):i.alert("项目暂停表填写不符合要求！")}}angular.module("app").controller("projectStopFormEditCtrl",t),t.$inject=["$state","pauseProjectSvc","bsWin"]}(),function(){"use strict";function t(t,e){var i=this,o=t.params.signId;i.sign={},function(){e.initProject(o,function(t){i.sign=t,"可行性研究报告"==i.sign.reviewstage||"项目概算"==i.sign.reviewstage?i.sign.countUsedWorkday=15-i.sign.surplusdays:i.sign.countUsedWorkday=12-i.sign.surplusdays}),e.getListInfo(o,function(t){i.projectStopList=t})}()}angular.module("app").controller("projectStopInfoCtrl",t),t.$inject=["$state","pauseProjectSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="部门列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOrg(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryOrg=function(){e.queryOrg(i)},function(){e.grid(i)}()}angular.module("app").controller("orgCtrl",t),t.$inject=["$location","orgSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.title="新增部门",n.isorgExist=!1,n.model.id=i.params.id,n.model.id&&(n.isUpdate=!0,n.title="更新部门"),function(){e.initRoleUsers(function(t){n.orgMLeaderUsers=t.DIRECTOR,n.orgSLeaderUser=t.VICE_DIRECTOR,n.OrgDirectorUsers=t.DEPT_LEADER}),n.isUpdate&&e.getOrgById(n.model.id,function(t){n.model=t})}(),n.create=function(){common.initJqValidation(),$("form").valid()?($.each(n.OrgDirectorUsers,function(t,e){e.id==n.model.orgDirector&&(n.model.orgDirectorName=e.displayName)}),$.each(n.orgMLeaderUsers,function(t,e){e.id==n.model.orgMLeader&&(n.model.orgMLeaderName=e.displayName)}),$.each(n.orgSLeaderUser,function(t,e){e.id==n.model.orgSLeader&&(n.model.orgSLeaderName=e.displayName)}),e.createOrg(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?(n.model.id||(n.model.id=t.idCode),o.success("操作成功！")):o.error(t.reMsg)})):o.alert("信息填写不完整或者填写不正确，请检查改正之后再保存！")},n.update=function(){common.initJqValidation(),$("form").valid()?($.each(n.OrgDirectorUsers,function(t,e){e.id==n.model.orgDirector&&(n.model.orgDirectorName=e.displayName)}),$.each(n.orgMLeaderUsers,function(t,e){e.id==n.model.orgMLeader&&(n.model.orgMLeaderName=e.displayName)}),$.each(n.orgSLeaderUser,function(t,e){e.id==n.model.orgSLeader&&(n.model.orgSLeaderName=e.displayName)}),e.updateOrg(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?o.success("操作成功！"):o.error(t.reMsg)})):o.alert("信息填写不完整或者填写不正确，请检查改正之后再保存！")}}angular.module("app").controller("orgEditCtrl",t),t.$inject=["$location","orgSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(t){t.gridOptions.dataSource.read()}function o(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/fingByOData",$("#orgForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"sort",dir:"asc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"name",title:"部门名称",width:130,filterable:!1},{field:"orgFunction",title:"职能",width:130,filterable:!1},{field:"orgDirectorName",title:"部门负责人",width:100,filterable:!1},{field:"orgSLeaderName",title:"分管领导",width:100,filterable:!1},{field:"orgPhone",title:"电话",width:130,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function n(e,i,o){i=!0;var n={method:"post",url:d,data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function a(e){var i={method:"get",url:common.format(d+"/getCompany")},o=function(t){e.company={},e.company=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:rootPath+"/org/getOrgById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i,o){i=!0;var n={method:"put",url:rootPath+"/org",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function l(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e){var i={method:"post",url:rootPath+"/user/initRoleUsers"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}var d=rootPath+"/org";rootPath;return{grid:o,createOrg:n,getOrgById:r,updateOrg:s,deleteOrg:l,getCompany:a,initRoleUsers:c,queryOrg:i}}angular.module("app").factory("orgSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.id=e.params.id,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.orgUserGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.add=function(t){o.add(n,t)},n.remove=function(t){o.remove(n,t)},n.removes=function(){var t=common.getKendoCheckId(".orgUserGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.remove(o)}},function(){o.orgUserGrid(n),o.allUserGrid(n)}()}angular.module("app").controller("orgUserCtrl",t),t.$inject=["$location","$state","orgSvc","orgUserSvc"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"delete",url:rootPath+"/org/deleteUsers",params:{orgId:e.id,userId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/org/addUsers",params:{orgId:e.id,userId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.orgUserGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(r+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"loginName",title:"登录名",width:200,filterable:!0},{field:"displayName",title:"显示名",width:200,filterable:!0},{field:"remark",title:"描述",filterable:!1},{field:"",title:"操作",width:80,template:function(t){return common.format($("#allUserGridBtns").html(),"vm.add('"+t.id+"')")}}];t.orgUserGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!1,serverFiltering:!1,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"loginName",title:"登录名",width:200,filterable:!1},{field:"displayName",title:"显示名",width:200,filterable:!1},{field:"remark",title:"描述",filterable:!1},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var r=rootPath+"/org/userNotIn",s=rootPath+"/org/users";return{orgUserGrid:a,allUserGrid:n,add:o,remove:i}}angular.module("app").factory("orgUserSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="个人代办",function(){e.getUser(i)}(),i.cancelTakeUser=function(){""==i.takeUser||null==i.takeUser?common.confirm({vm:i,title:"",msg:"暂无代办人！？",fn:function(){$(".confirmDialog").modal("hide")}}):common.confirm({vm:i,title:"",msg:"确认取消该代办人？",fn:function(){$(".confirmDialog").modal("hide"),e.cancelTakeUser(i)}})},i.showChooseTakeUser=function(){$("#chooseTakeUserWindow").kendoWindow({width:"500px",height:"300px",title:"选择代办人",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),e.initAllUser(i)},i.saveTakeUser=function(){e.saveTakeUser(i)}}angular.module("app").controller("takeUserCtrl",t),t.$inject=["$location","takeUserSvc"]}(),function(){"use strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/user/getAllUserDisplayName"},o=function(t){e.users=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(e){if(common.initJqValidation(),$("#form").valid()){var i={method:"post",url:rootPath+"/user/saveTakeUser",params:{takeUserId:e.takeUserId}},n=function(t){e.chooseTakeUser=!1,common.confirm({vm:e,title:"",msg:"保存成功！",fn:function(){$(".confirmDialog").modal("hide"),window.parent.$("#chooseTakeUserWindow").data("kendoWindow").close(),o(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}}function o(e){var i={method:"get",url:rootPath+"/user/getUserByLoginName"},o=function(t){e.takeUser=t.data.displayName};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"get",url:rootPath+"/user/cancelTakeUser"},n=function(t){o(e)};common.http({vm:e,$http:t,httpOptions:i,success:n})}return{initAllUser:e,saveTakeUser:i,getUser:o,cancelTakeUser:n}}angular.module("app").factory("takeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="定时器配置",function(){e.grid(i)}(),i.addQuartz=function(){i.quartz={},$("#quartz_edit_div").kendoWindow({width:"680px",height:"400px",title:"定时器编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},i.edit=function(t){$("#quartz_edit_div").kendoWindow({width:"600px",height:"400px",title:"定时器修改",visible:!1,modal:!0,open:function(){e.getQuartzById(t,function(t){i.quartz=t})},closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},i.colseQuartz=function(){window.parent.$("#quartz_edit_div").data("kendoWindow").close()},i.saveQuartz=function(){common.initJqValidation($("#quartz_form")),$("#quartz_form").valid()&&(i.isSubmit=!0,e.saveQuartz(i.quartz,function(e){e.flag||"ok"==e.reCode?t.alert("操作成功！",function(){i.colseQuartz(),i.gridOptions.dataSource.read()}):t.alert(e.reMsg)}))},i.execute=function(o){e.quartzExecute(o,function(e){e.flag||"ok"==e.reCode?t.alert("操作成功！",function(){i.gridOptions.dataSource.read()}):t.alert(e.reMsg)})},i.stop=function(o){e.quartzStop(o,function(e){e.flag||"ok"==e.reCode?t.alert("操作成功！",function(){i.gridOptions.dataSource.read()}):t.alert(e.reMsg)})},i.del=function(o){t.confirm("确认删除？删除数据无法恢复，请谨慎操作！",function(){e.deleteQuartz(o,function(e){e.flag||"ok"==e.reCode?t.alert("操作成功！",function(){i.gridOptions.dataSource.read()}):t.alert(e.reMsg)})})}}angular.module("app").controller("quartzCtrl",t),t.$inject=["bsWin","quartzSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"put",url:s+"/quartzExecute",params:{quartzId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:s+"/quartzStop",params:{quartzId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"delete",url:s,params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/quartz",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"post",url:rootPath+"/quartz/html/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/quartz/findByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"quartzName",title:"定时器名称",width:"10%",filterable:!1},{field:"className",title:"类名",width:"35%",filterable:!1},{field:"cronExpression",title:"表达式",width:"8%",filterable:!1},{field:"",title:"状态",width:"8%",filterable:!1,template:function(t){return t.curState?"9"==t.curState?"<span class='label label-success'>正在执行</span>":"0"==t.curState?"<span class='label label-warning'>已暂停</span>":void 0:""}},{field:"descInfo",title:"描述",width:"20%",filterable:!1},{field:"",title:"操作",width:"10%",template:function(t){var e=!1;return 9==t.curState&&(e=!0),common.format($("#columnBtns").html(),"vm.edit('"+t.id+"')","vm.execute('"+t.id+"')",!e,"vm.stop('"+t.id+"')",e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var s=rootPath+"/quartz";return{grid:r,getQuartzById:a,saveQuartz:n,deleteQuartz:o,quartzExecute:e,quartzStop:i}}angular.module("app").factory("quartzSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var a=this;a.title="项目列表",a.reviewFee={},function(){t.projectGrid(a)}(),a.query=function(){a.gridOptions.dataSource.read()},a.dealWindow=function(e){t.findExpertReview(a,e,function(t){a.expertReview=t,$("#payFromWindow").kendoWindow({width:"70%",height:"600px",title:"专家评审费发放",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},a.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void i.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void i.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void i.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var o,a=t.expertSelectedDtoList.length,r="";$.each(t.expertSelectedDtoList,function(t,e){r+="'"+e.id+"'",t!=a-1&&(r+=",")});var s=t.payDate;o=s.substring(0,s.lastIndexOf("-")),e.countTaxes(r,o,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,o){var a=o.EXPERTID,r=o.id,s=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==a&&t.ESID!=r&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),s=parseFloat(s)+t.REVIEWCOST)}),o.reviewCost=void 0==o.reviewCost?0:o.reviewCost;var l=s+parseFloat(o.reviewCost);o.reviewTaxes=n(l).toFixed(2),o.totalCost=(parseFloat(o.reviewCost)+parseFloat(o.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(o.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(o.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)})})}}},a.savePayment=function(t){common.initJqValidation($("#payform")),$("#payform").valid()?e.savePayment(t,a.isCommit,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！",function(){a.isCommit=!1,window.parent.$("#payFromWindow").data("kendoWindow").close(),a.gridOptions.dataSource.read()}):i.alert(t.reMsg)}):i.alert("请正确填写专家评审费信息！")},a.detail=function(t,e){"SIGN"==e.trim()&&o.go("signDetails",{signid:t}),"TOPIC"==e.trim()&&o.go("flowDetail",{businessKey:t})}}angular.module("app").controller("reviewFeeCtrl",t),t.$inject=["reviewFeeSvc","expertReviewSvc","bsWin","$state"]}(),function(){"use strict";function t(t){function e(e,i,o){var n={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:i,minBusinessId:""}},a=function(t){void 0==o&&"function"!=typeof o||o(t.data)};common.http({vm:e,$http:t,httpOptions:n,success:a})}function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewFee/findReviewFee",$("#reviewFeeForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"reviewTitle",title:"评审费标题",width:"40%",filterable:!1},{field:"",title:"评审费类型",width:"20%",filterable:!1,template:function(t){return"SIGN"==t.businessType.trim()?"项目评审费":"TOPIC"==t.businessType.trim()?"课题评审费":""}},{field:"reviewDate",title:"评审日期",width:"15%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"操作",width:"20%",template:function(t){return common.format($("#columnBtns").html(),"vm.dealWindow('"+t.businessId+"')","vm.detail('"+t.businessId+"','"+t.businessType+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{projectGrid:i,findExpertReview:e}}angular.module("app").factory("reviewFeeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){var e=this;e.approve=!0,e.idea=!1,e.appraise={},function(){t.approveListGrid(e)}()}angular.module("app").controller("approveListCtrl",t),t.$inject=["reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e,i){var o=this,n=t.params.signId;o.model={},function(){e.initBySignId(n,function(t){o.model=t})}(),o.commitApprove=function(){common.initJqValidation(),$("#form").valid()?e.saveApply(o.model,function(n){n.flag||"ok"==n.reCode?(o.model=n.reObj,e.startFlow(o.model.id,function(e){(e.flag||"ok"==e.reCode)&&i.success("操作成功！",function(){t.go("personDtasks")})})):i.alert(n.reMsg)}):i.alert("优秀评审报告填报表单未填写正确！")}}angular.module("app").controller("approveWindowCtrl",t),t.$inject=["$state","reviewProjectAppraiseSvc","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this,n=t.params.id;o.model={},o.addApprove=function(){e.saveApply(o.model,function(){i.alert("操作成功")})},function(){e.getAppraiseById(n,function(t){o.model=t})}()}angular.module("app").controller("approveWindowEditCtrl",t),t.$inject=["$state","reviewProjectAppraiseSvc","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="优秀评审报告列表",function(){e.appraisingProjectGrid(i)}()}angular.module("app").controller("reviewProjectAppraiseCtrl",t),t.$inject=["$location","reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e,i){function o(t){r(t.businessKey,function(e){t.model=e})}function n(e,i){var o={method:"post",url:rootPath+"/reviewProjectAppraise/startFlow",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"post",url:rootPath+"/reviewProjectAppraise/initBySignId",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:rootPath+"/reviewProjectAppraise/getAppraiseById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(t){$("#appraiseWindow").kendoWindow({width:"800px",height:"400px",title:"评审报告评优申请",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function l(e,i){var o={method:"post",url:rootPath+"/reviewProjectAppraise/saveApply",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewProjectAppraise/findAppraisingProject"),schema:common.kendoGridConfig().schema({id:"id",fields:{}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchtype",title:"发文日期",width:160,filterable:!1},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizevalue",title:"审定投资",width:140,filterable:!1},{field:"extravalue",title:"核减（增）投资",width:140,filterable:!1},{field:"extrarate",title:"核减率",width:140,filterable:!1},{field:"approvevalue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchtype",title:"发文类型",width:140,filterable:!1},{field:"ffiledate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyName",title:"建设单位",width:140,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewProjectAppraise/getAppraiseReport"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectName+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectName+"</a>"}},{field:"appraiseReportName",title:"评审报告名称",width:160,filterable:!1},{field:"proposerName",title:"申请人",width:160,filterable:!1},{field:"proposerTime",title:"申请时间",width:160,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid,t.projectname,t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}return{initBySignId:a,appraisingProjectGrid:c,appraiseWindow:s,saveApply:l,approveListGrid:d,getAppraiseById:r,startFlow:n,initFlowDeal:o}}angular.module("app").factory("reviewProjectAppraiseSvc",t),t.$inject=["$http","bsWin","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="角色列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteRole(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("roleCtrl",t),t.$inject=["$location","roleSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加角色",o.isRoleExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新角色"),o.create=function(){e.createRole(o)},o.update=function(){e.updateRole(o)},o.checkRole=function(){e.checkRole(o)},function(){o.isUpdate?e.getRoleById(o):e.initZtreeClient(o)}()}angular.module("app").controller("roleEditCtrl",t),t.$inject=["$location","roleSvc","$state"]}(),function(){"use strict";function t(t,e){function i(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function o(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),i=$linq(t.model.resources).select(function(t){return t.path}).toArray(),o=e.getNodesByParam("level",1,null),n=$linq(o).where(function(t){return $linq(i).contains(t.path)}).toArray(),a=0,r=n.length;a<r;a++)e.checkNode(n[a],!0,!0)}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"roleName",title:"角色名称",width:200,filterable:!1},{field:"remark",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function a(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0;var o=i(),n=$linq(o).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n;var a={method:"post",url:u,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=m}})}})};common.http({vm:e,$http:t,httpOptions:a,success:r})}}function r(t){}function s(e){var i={method:"post",url:rootPath+"/role/findById",params:{roleId:e.id}},o=function(t){e.model=t.data,e.isUpdate&&d(e)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0,e.model.id=e.id;var o=i(),n=$linq(o).where(function(t){return!0}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n;var a={method:"put",url:u,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:a,success:r})}}function c(e,i){e.isSubmit=!0;var o={method:"delete",url:u,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function d(e){var i={method:"get",url:p},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var i={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},n=t.data;$.fn.zTree.init($("#zTree"),i,n),e.isUpdate&&o(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}var u=rootPath+"/role",m="#/role",p=rootPath+"/sys/resource";return{grid:n,createRole:a,checkRole:r,getRoleById:s,updateRole:l,deleteRole:c,initZtreeClient:d}}angular.module("app").factory("roleSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="预定会议统计列表",i.queryRoomCount=function(){e.queryRoomCount(i)},i.ResetRoomCount=function(){e.cleanValue()},function(){e.grid(i),e.roomList(i),e.findAllUsers(i),t.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(i.orgDeptList=t.reObj)})}()}angular.module("app").controller("roomCountCtrl",t),t.$inject=["adminSvc","roomCountSvc"]}(),function(){"use strict";function t(t,e){function i(){var t=$("#roomCountform").find("input,select");$.each(t,function(t,e){e.value=""})}function o(t){t.gridOptions.dataSource.read()}function n(e){var i={method:"get",url:common.format(l+"/findAllUsers")},o=function(t){e.userlist={},e.userlist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"get",
url:common.format(s+"/meeting")},o=function(t){e.roomlists={},e.roomlists=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/fingByOData",$("#roomCountform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"rbName",title:"会议名称",width:"30%",filterable:!1},{field:"addressName",title:"会议地点",width:"20%",filterable:!1},{field:"rbDay",title:"会议日期",width:"10%",filterable:!1},{field:"beginTimeStr",title:"会议开始时间",width:"10%",filterable:!1},{field:"endTimeStr",title:"会议结束时间",type:"date",width:"10%",filterable:!1},{field:"dueToPeople",title:"会议预定人",width:"10%",filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var s=(rootPath,rootPath+"/room"),l=rootPath+"/user",l=rootPath+"/user";return{grid:r,queryRoomCount:o,roomList:a,cleanValue:i,findAllUsers:n}}angular.module("app").factory("roomCountSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="会议室预定列表",o.initSuccess=!1,o.model={businessId:i.params.businessId,businessType:i.params.businessType},o.startDateTime=new Date("2005/6/1 08:00"),o.endDateTime=new Date("2030/6/1 21:00"),o.currentDate="",o.reportName="会议室安排表",o.search={},o.loadScheduler=!1,function(){e.showMeeting(o,function(t){e.initScheduler(o),o.meetings={},o.meetings=t,o.meetings&&o.meetings.length>0&&(o.search.mrID=o.meetings[0].id,o.findMeeting()),e.initDefaultValue(o.model.businessId,o.model.businessType,function(t){o.model=t,o.model.mrID=o.search.mrID})})}(),o.reQueryDate=function(t){var e,i,n=t.date,a=n.getDay();0==a?(e=n.Days(-6),i=n.Format("yyyy-MM-dd")):1==a?(e=n.Format("yyyy-MM-dd"),i=n.Days(6)):(e=n.Days(-(a-1)),i=n.Days(7-a)),o.search.beginTimeStr=e,o.search.endTimeStr=i,o.findMeeting()},o.findMeeting=function(){e.queryBookRoom(o.search,function(t){e.setSCDataSource(o,t),o.model.mrID=o.search.mrID})},o.exportThisWeekStage=function(){o.currentDate=$(".k-sm-date-format").html(),o.rbType="0",o.reportName="本周评审会会议安排表",e.exportThisWeekStage(o)},o.exportThisWeek=function(){o.currentDate=$(".k-sm-date-format").html(),o.rbType="1",o.reportName="本周全部会议安排表",e.exportThisWeekStage(o)},o.exportNextWeek=function(){var t=$(".k-sm-date-format").html(),i=t.split("-")[0].split("/"),n=i[0],a=2==i[1].length?i[1]:"0"+i[1],r=i[2].length>=2?i[2].substr(0,2):"0"+i[2].substr(0,1),s=new Date(a+"/"+r+"/"+n),l=new Date(a+"/"+r+"/"+n);s.setDate(s.getDate()+8-s.getDay()),l.setDate(l.getDate()+15-l.getDay());var c=new Date(s),d=new Date(l);o.currentDate=c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate()+"-"+d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate(),o.rbType="1",o.reportName="下周全部会议安排表",e.exportThisWeekStage(o)},o.exportNextWeekStage=function(){var t=$(".k-sm-date-format").html(),i=t.split("-")[0].split("/"),n=i[0],a=2==i[1].length?i[1]:"0"+i[1],r=i[2].length>=2?i[2].substr(0,2):"0"+i[2].substr(0,1),s=new Date(a+"/"+r+"/"+n),l=new Date(a+"/"+r+"/"+n);s.setDate(s.getDate()+8-s.getDay()),l.setDate(l.getDate()+15-l.getDay());var c=new Date(s),d=new Date(l);o.currentDate=c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate()+"-"+d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate(),o.rbType="0",o.reportName="下周评审会会议安排表",e.exportThisWeekStage(o)}}angular.module("app").controller("roomCtrl",t),t.$inject=["bsWin","roomSvc","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加会议室预定",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新会议室"),function(){o.isUpdate&&e.getroomById(o)}()}angular.module("app").controller("roomEditCtrl",t),t.$inject=["$location","roomSvc","$state"]}(),function(){"use strict";function t(t,e){function i(t){$("#scheduler").kendoScheduler({date:new Date,startTime:new Date("2005/6/1 08:00"),endTime:new Date("2030/6/1 21:00"),height:600,views:[{type:"week",selected:!0,allDaySlot:!1}],editable:{destroy:!1,template:$("#customEditorTemplate").html()},navigate:function(e){t.reQueryDate(e)},edit:function(t){},save:function(e){a(e.event,function(){t.findMeeting()})},eventTemplate:$("#event-template").html(),timezone:"Etc/UTC",footer:!1});var e=$("#scheduler").data("kendoScheduler"),i=e._model.formattedShortDate,o=i.split("-");t.search.beginTimeStr=new Date(o[0].trim()).Format("yyyy-MM-dd"),t.search.endTimeStr=new Date(o[1].trim()).Format("yyyy-MM-dd")}function o(e,i){var o={method:"post",url:rootPath+"/room/queryBookInfo",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t,e){var i=$("#scheduler").data("kendoScheduler"),o=new kendo.data.SchedulerDataSource({data:e,schema:{model:{id:"bookId",fields:{bookId:{from:"id"},title:{from:"addressName",defaultValue:"会议室"},start:{type:"date",from:"beginTime"},end:{type:"date",from:"endTime"},rbDay:{type:"date",from:"rbDay"},businessId:{from:"businessId",defaultValue:t.model.businessId},businessType:{from:"businessType",defaultValue:t.model.businessType},rbName:{from:"rbName",defaultValue:t.model.rbName},stageOrgName:{from:"stageOrgName",defaultValue:t.model.stageOrgName},host:{from:"host",defaultValue:t.model.host},dueToPeople:{from:"dueToPeople",defaultValue:t.model.dueToPeople},mrID:{from:"mrID",defaultValue:t.model.mrID},content:{from:"content",defaultValue:t.model.content},remark:{from:"remark",defaultValue:t.model.remark}}}}});i.setDataSource(o)}function a(i,o){var n=i;if(n.rbName&&n.dueToPeople&&n.rbDay&&n.start&&n.end&&n.content){n.id=n.bookId;var a=n.start.Format("yyyy-MM-dd hh:mm:ss");n.beginTime=a;var r=n.end.Format("yyyy-MM-dd hh:mm:ss");n.endTime=r;var s={method:"post",url:rootPath+"/room/addRoom",data:n},l=function(t){t.data.flag||"ok"==t.data.reCode?e.alert("操作成功"):e.alert(t.data.reMsg),void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:s,success:l})}else e.alert("会议信息填写不正确！请填写完整再提交！")}function r(e,i){var o={method:"get",url:rootPath+"/room/meeting"},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i,o){var n={method:"post",url:rootPath+"/room/initDefaultValue",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function l(t){var e=escape(encodeURIComponent(t.reportName));window.open(u+"/exportThisWeekStage?currentDate="+t.currentDate+"&rbType="+t.rbType+"&mrId="+t.mrID+"&fileName="+e)}function c(e){var i={method:"get",url:u+"/exportThisWeekStage",params:{currentDate:e.currentDate}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function d(){window.open(u+"/exportWeek")}var u=rootPath+"/room";return{initScheduler:i,queryBookRoom:o,setSCDataSource:n,showMeeting:r,exportThisWeekStage:l,exportNextWeekStage:c,exportThisWeek:d,initDefaultValue:s,saveBookRoom:a}}angular.module("app").factory("roomSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="资料共享详情页",n.model={},n.model.sharId=e.params.sharId,n.downloadSysFile=function(t){o.downloadSysfile(t)},function(){o.getSharingDetailById(n,n.model.sharId),i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})}()}angular.module("app").controller("sharingDetailCtrl",t),t.$inject=["$location","$state","sysfileSvc","sharingPlatlformSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="共享资料管理",function(){o.grid(n)}(),n.del=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),o.deleteSharingPlatlform(n,t)}})},n.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:n,msg:"请选择要删除的数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.del(o)}},n.bathPublish=function(){o.updatePublish(n,!0)},n.bathDown=function(){o.updatePublish(n,!1)},n.querySharing=function(){n.gridOptions.dataSource.read()}}angular.module("app").controller("sharingPlatlformCtrl",t),t.$inject=["$location","$state","$http","sharingPlatlformSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="新增共享资料",n.model={},n.businessFlag={isUpdate:!1,isLoadModel:!1,isLoadOrgUser:!1},n.model.sharId=e.params.sharId,n.model.sharId&&(n.businessFlag.isUpdate=!0,n.title="更改共享资料"),n.initFileUpload=function(){n.model.sharId||o.$watch("vm.model.sharId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.model.sharId,mainId:n.model.sharId,mainType:i.mainTypeValue().SHARE},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})}})},function(){n.model.sharId?(t.getSharingPlatlformById(n),i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})):n.initFileUpload(),t.initOrgAndUser(n)}(),n.resetSharing=function(){var t=$("#formSharing").find("input,select");$.each(t,function(t,e){e.value=""})},n.create=function(){t.createSharingPlatlform(n)},n.checkBox=function(t){var e=t.target,i=e.checked,o=e.value;i?$('input[tit="'+o+'"]').each(function(){$(this).attr("disabled","disabled"),$(this).removeAttr("checked")}):$('input[tit="'+o+'"]').each(function(){$(this).removeAttr("disabled")})}}angular.module("app").controller("sharingPlatlformEditCtrl",t),t.$inject=["sharingPlatlformSvc","$state","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e){function i(t){!t.businessFlag.isLoadOrgUser||!t.businessFlag.isLoadModel||t.model.isNoPermission&&"9"==t.model.isNoPermission||t.shareOrgList&&t.shareOrgList.length>0&&(t.model.privilegeDtoList&&t.model.privilegeDtoList.length>0&&t.shareOrgList.forEach(function(e,i){t.model.privilegeDtoList.forEach(function(t,i){1==t.businessType||"1"==t.businessType?t.businessId==e.id&&(e.isChecked=!0,e.userDtos.forEach(function(t,e){t.isDisabled=!0})):2!=t.businessType&&"2"!=t.businessType||e.userDtos.forEach(function(e,i){t.businessId==e.id&&(e.isChecked=!0)})})}),t.noOrgUsetList&&t.noOrgUsetList.length>0&&t.noOrgUsetList.forEach(function(e,i){t.model.privilegeDtoList.forEach(function(t,i){2!=t.businessType&&"2"!=t.businessType||t.businessId!=e.id||(e.isChecked=!0)})}),t.businessFlag.isInitSeled=!0)}function o(e){var o={method:"post",url:rootPath+"/sharingPlatlform/initOrgAndUser"},n=function(t){e.shareOrgList=t.data.orgDtoList,e.noOrgUsetList=t.data.noOrgUserList,e.businessFlag.isLoadOrgUser=!0,i(e)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"get",url:d+"/html/sharingDeatilById",params:{id:i}},n=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(i,o){i.isSubmit=!0;var n={method:"delete",url:d+"/sharingDelete",data:o},a=function(t){i.isSubmit=!1,i.gridOptions.dataSource.read(),e.alert("操作成功")};common.http({vm:i,$http:t,httpOptions:n,success:a})}function r(i){if($("form").valid()){if(i.isSubmit=!0,9!=i.model.isNoPermission){i.model.privilegeDtoList=[];var o=$("input[name='shareOrg']:checked");if(o.length>0)for(var n=0;n<o.length;n++){var a={};a.businessId=o[n].value,a.businessType="1",i.model.privilegeDtoList.push(a)}var r=$("input[name='shareUser']:not(:disabled):checked");if(r.length>0)for(var n=0;n<r.length;n++){var s={};s.businessId=r[n].value,s.businessType="2",i.model.privilegeDtoList.push(s)}}var l={method:"post",url:rootPath+"/sharingPlatlform/saveSharing",data:i.model},c=function(t){i.isSubmit=!1,i.model.sharId=t.data.sharId,e.alert("操作成功")};common.http({$http:t,httpOptions:l,success:c,onError:function(){i.isSubmit=!1}})}}function s(e){var o={method:"get",url:d+"/html/findById",params:{id:e.model.sharId}},n=function(t){e.model=t.data,e.businessFlag.isLoadModel=!0,i(e)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/findByCurUser",$("#formSharing")),schema:common.kendoGridConfig().schema({id:"sharId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.sharId)},filterable:!1,width:30,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"theme",title:"主题",width:180,filterable:!1},{field:"publishUsername",title:"发布人",width:120,filterable:!1},{field:"publishDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:180,filterable:!1},{field:"isPublish",title:"发布状态",width:100,template:function(t){return t.isPublish&&9==t.isPublish?"已发布":"未发布"}},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),t.sharId,t.sharId,"vm.del('"+t.sharId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function c(e,i){var o=common.getKendoCheckId(".grid");if(0==o.length)common.alert({vm:e,msg:"请选择要批量发布的数据"});else{for(var n=[],a=0;a<o.length;a++)n.push(o[a].value);var r={method:"post",url:rootPath+"/sharingPlatlform/updatePublish",params:{ids:n.join(","),status:1==i?"9":"0"}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),common.alert({vm:e,msg:"操作成功",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:r,success:s})}}var d=rootPath+"/sharingPlatlform";return{grid:l,getSharingPlatlformById:s,createSharingPlatlform:r,deleteSharingPlatlform:a,getSharingDetailById:n,initOrgAndUser:o,initSeleObj:i,updatePublish:c}}angular.module("app").factory("sharingPlatlformSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="共享管理",n.model={},function(){o.grid(n)}(),n.findSharing=function(){n.gridOptions.dataSource.read()},n.resetShared=function(){var t=$("#formSharingPub").find("select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("sharingPlatlformYetCtrl",t),t.$inject=["$location","$state","$http","sharingPlatlformYetSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sharingPlatlform/findByReception",$("#formSharingPub")),schema:common.kendoGridConfig().schema({id:"sharId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.sharId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"theme",title:"共享主题",width:180,filterable:!0},{field:"publishUsername",title:"发布人",width:100,filterable:!0},{field:"publishDate",title:"发布时间",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.sharId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{grid:e}}angular.module("app").factory("sharingPlatlformYetSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.title="新增收文",n.create=function(){common.initJqValidation(),$("form").valid()&&e.createSign(n.model,function(t){t.flag||"ok"==t.reCode?t.reObj.processInstanceId?o.alert("操作成功！"):o.success("操作成功，请继续填写项目审核登记表",function(){i.go("fillSign",{signid:t.reObj.signid},{reload:!0})}):o.error(t.reMsg)})}}angular.module("app").controller("signCreateCtrl",t),t.$inject=["$location","signSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;!function(){t.signGrid(a)}(),a.querySign=function(){a.gridOptions.dataSource.read()},a.check=function(){a.isAssociate=a.ischeck?9:0},a.del=function(e){n.confirm({title:"询问提示",message:"确认删除该条项目数据吗？删除数据不可恢复，请慎重！",onOk:function(){$(".confirmDialog").modal("hide"),t.deleteSign(e,function(t){t.flag||"ok"==t.reCode?n.alert("删除成功！",function(){a.gridOptions.dataSource.read()}):n.alert(t.reMsg)})}})},a.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:a,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");a.del(o)}},a.startNewFlow=function(t){n.confirm({title:"询问提示",message:"确认已经完成填写，并且发起流程么？",onOk:function(){$(".confirmDialog").modal("hide"),o.startFlow(t,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！",function(){a.gridOptions.dataSource.read()}):n.error(t.reMsg)})}})},a.realSign=function(e){n.confirm({title:"询问提示",message:"确认正式签收了么？",onOk:function(){$(".confirmDialog").modal("hide"),t.realSign(e,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！",function(){a.gridOptions.dataSource.read()}):n.error(t.reMsg)})}})}}angular.module("app").controller("signCtrl",t),t.$inject=["signSvc","$state","flowSvc","signFlowSvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.model={},r.title="填写报审登记表",r.model.signid=i.params.signid,r.flowDeal=!1,r.busiObj={},function(){t.initFillData(r.model.signid,function(t){r.model=t.reObj.sign,r.deptlist=t.reObj.deptlist,t.reObj.mainOfficeList&&(r.mainOfficeList=t.reObj.mainOfficeList),t.reObj.assistOfficeList&&(r.assistOfficeList=t.reObj.assistOfficeList),r.companyList=t.reObj.companyList,r.busiObj.leaderList=t.reObj.leaderList,r.sysFile={businessId:r.model.signid,mainId:r.model.signid,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().FILLSIGN,sysBusiType:e.mainTypeValue().FILLSIGN},e.initUploadOptions({inputId:"sysfileinput",vm:r})})}(),r.checkOrgType=function(t){var e=t.target,i=e.checked,o=e.value;i&&(r.model.leaderName=signcommon.getDefaultLeader(o),$.each(r.busiObj.leaderList,function(t,e){e.mngOrgType==o&&(r.model.leaderId=e.id,r.model.leaderName=e.displayName,r.model.comprehensivehandlesug="请"+e.displayName.substring(0,1)+"主任阅示。")}),o==signcommon.getBusinessType().GX?r.model.leaderhandlesug="请（概算一部         概算二部）组织评审。":r.model.leaderhandlesug="请（评估一部         评估二部         评估一部信息化组）组织评审。",r.model.leaderId||n.alert("选择的默认办理部门没有合适的分管领导，请先设置分管领导角色用户！"))},r.startNewFlow=function(){common.initJqValidation($("#sign_fill_form")),$("#sign_fill_form").valid()?(r.isSubmit=!0,n.confirm({title:"询问提示",message:"确定发起流程么，请确保填写的信息已经保存正确！",onOk:function(){$(".confirmDialog").modal("hide"),t.updateFillin(r.model,function(t){var e={method:"post",url:rootPath+"/sign/startNewFlow",params:{signid:r.model.signid}},a=function(t){r.isSubmit=!1,"ok"==t.data.reCode?n.success("操作成功！",function(){i.go("gtasks")}):n.error(t.data.reMsg)};common.http({$http:o,httpOptions:e,success:a})})}})):n.alert("项目填报内容不完整或者填报信息不正确，请检查之后再提交！")},r.signPreview=function(t){var e=$(".well").parents("body"),i=e.find(".main-sidebar"),o=e.find(".main-header"),n=e.find(".content-wrapper");i.hide(),o.hide(),$(".toolbar").hide(),$(".well input").each(function(){var t=$(this).attr("type");"text"==t&&$(this).before('<span class="printmesge" data="text" style="white-space : nowrap;">'+$(this).val()+"</span>"),"checkbox"==t&&($(this).is(":checked")?$(this).before('<span class="printmesge" data="text">有</span>'):$(this).before('<span class="printmesge" data="text">无</span>'))}),$(".printmesge").show(),$(".well input[type=text]").hide(),$(".well input[type=checkbox]").hide(),$(".well button").hide(),n.find("td div select").hide(),n.find("td div span").css("margin","0"),$(".well").addClass("printbody"),$(".well .table-bordered").addClass("tableBOX"),n.find("input").addClass("noborder"),n.addClass("nomargin"),window.print(),i.show(),o.show(),$(".toolbar").show(),$(".printmesge").hide(),$(".well input[type=text]").show(),$(".well input[type=checkbox]").show(),$(".well button").show(),n.find("td div select").show(),n.find("td div span").css("margin-left","100px"),$(".well").removeClass("printbody"),$(".well .table-bordered").removeClass("tableBOX"),$("[data=text]").remove(),n.find("input").removeClass("noborder"),n.removeClass("nomargin")},r.updateFillin=function(){common.initJqValidation($("#sign_fill_form")),$("#sign_fill_form").valid()?(r.isSubmit=!0,r.model.leaderhandlesug=$("#leaderhandlesug").val(),t.updateFillin(r.model,function(t){r.isSubmit=!1,n.alert("操作成功！")})):n.alert("项目填报内容不完整或者填报信息不正确，请检查之后再提交！")},r.findOfficeUsersByDeptName=function(e){var i={};"main"==e?i.maindeptName=r.model.maindeptName:i.assistdeptName=r.model.assistdeptName,t.findOfficeUsersByDeptName(i,function(t){"main"==e?(r.mainOfficeList={},r.mainOfficeList=t):(r.assistOfficeList={},r.assistOfficeList=t)})}}angular.module("app").controller("signFillinCtrl",t),t.$inject=["signSvc","sysfileSvc","$state","$http","bsWin","$scope"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="已办结项目详情",r.model={},r.flow={},r.model.signid=i.params.signid,r.flow.processInstanceId=i.params.processInstanceId,r.flow.hideFlowImg=!0,r.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},r.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500),r.model.showDiv=i}),o.initFlowData(r),e.initFlowPageData(r.model.signid,function(t){r.model=t;var e=$("#myTab .active"),i=$("a",e);r.model.showDiv=i.attr("for-div"),r.model.dispatchDocDto&&(r.showFlag.tabDispatch=!0,r.dispatchDoc=r.model.dispatchDocDto),r.model.fileRecordDto&&(r.showFlag.tabFilerecord=!0,r.fileRecord=r.model.fileRecordDto),r.model.processState>1&&(r.showFlag.tabWorkProgram=!0),r.model.suppLetterDtoList&&(r.showSupperIndex=0)}),t.findByMianId(r.model.signid,function(e){e&&e.length>0&&(r.showFlag.tabSysFile=!0,r.sysFileList=e,t.initZtreeClient(r,n))})}(),r.commonDownloadSysFile=function(e){t.downloadFile(e)},r.commonEditSysFile=function(t){$("#editSysFileWindow").kendoWindow({width:"80%",title:"在线编辑",content:rootPath+"/file/editFile?sysFileId="+t})},r.printpage=function(t){a.templatePrint(t.target,r.model)}}angular.module("app").controller("signEndCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc","$scope","templatePrintSvc"]}(),function(){"use strict";function t(t,e,i){function o(e,i){var o={method:"post",url:rootPath+"/sign/startNewFlow",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t){switch(t.flow.curNode.activitiId){case flowcommon.getSignFlowNode().SIGN_QS:t.showFlag.businessTr=!0,t.showFlag.nodeSign=!0;break;case flowcommon.getSignFlowNode().SIGN_ZHB:t.showFlag.buttBack=!0,t.showFlag.businessNext=!0,t.showFlag.nodeSelViceMgr=!0,t.flow.businessMap&&(t.viceDirectors=t.flow.businessMap.viceDirectors);break;case flowcommon.getSignFlowNode().SIGN_FGLD_FB:t.showFlag.buttBack=!0,t.showFlag.businessNext=!0,t.showFlag.nodeSelOrgs=!0,t.flow.businessMap&&(t.orgs=t.flow.businessMap.orgs);break;case flowcommon.getSignFlowNode().SIGN_BMFB1:t.businessFlag.isMainBranch=!0;case flowcommon.getSignFlowNode().SIGN_BMFB2:case flowcommon.getSignFlowNode().SIGN_BMFB3:case flowcommon.getSignFlowNode().SIGN_BMFB4:t.showFlag.businessNext=!0,t.showFlag.nodeSelPrincipal=!0,t.flow.businessMap&&t.flow.businessMap.users&&(t.users=t.flow.businessMap.users,t.users.forEach(function(t,e){t.isSelected=!1}));break;case flowcommon.getSignFlowNode().SIGN_XMFZR1:t.businessFlag.isMainBranch=!0,t.businessFlag.curBranchId="1",t.showFlag.isMainPrinUser=!0;case flowcommon.getSignFlowNode().SIGN_XMFZR2:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="2");case flowcommon.getSignFlowNode().SIGN_XMFZR3:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="3");case flowcommon.getSignFlowNode().SIGN_XMFZR4:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="4"),t.showFlag.businessTr=!0,t.showFlag.nodeWorkProgram=!0,t.businessFlag.isFinishWP=t.flow.businessMap.isFinishWP,t.model.processState>=2&&t.model.workProgramDtoList&&($.each(t.model.workProgramDtoList,function(e,i){i.branchId==t.businessFlag.curBranchId&&(t.businessFlag.editEPReviewId=i.expertReviewId)}),t.businessFlag.editExpertSC=!0,t.showFlag.tabWorkProgram=!0,$("#show_workprogram_a").click());break;case flowcommon.getSignFlowNode().SIGN_BMLD_SPW1:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW2:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW3:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW4:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW1:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW2:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW3:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW4:t.showFlag.buttBack=!0,t.showFlag.tabWorkProgram=!0,$("#show_workprogram_a").click();break;case flowcommon.getSignFlowNode().SIGN_FW:t.showFlag.businessTr=!0,t.showFlag.nodeDispatch=!0,t.showFlag.isMainPrinUser=!0,t.showFlag.expertEdit=!0,t.flow.businessMap.prilUserList&&(t.businessFlag.principalUsers=t.flow.businessMap.prilUserList,t.showFlag.businessNext=!0),t.model.processState>=4&&(t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click());break;case flowcommon.getSignFlowNode().SIGN_QRFW:case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW_XB:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW_XB:t.watchPassDis(),t.showFlag.buttBack=!1,t.showFlag.businessTr=!0,t.showFlag.nodeConfirmDis=!0,t.businessFlag.passDis="9",t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click();break;case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW:case flowcommon.getSignFlowNode().SIGN_ZR_QRFW:t.showFlag.buttBack=!0,t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click();break;case flowcommon.getSignFlowNode().SIGN_FWBH:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click(),t.showFlag.businessTr=!0,t.showFlag.nodeCreateDisNum=!0,t.showFlag.isMainPrinUser=!0;break;case flowcommon.getSignFlowNode().SIGN_CWBL:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.businessTr=!0,t.showFlag.financialCode=!0;break;case flowcommon.getSignFlowNode().SIGN_GD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.isMainPrinUser=!0,t.flow.businessMap.checkFileUser&&(t.showFlag.businessNext=!0),t.showFlag.businessTr=!0,t.showFlag.nodeFileRecord=!0,t.model.processState>6&&(t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click());break;case flowcommon.getSignFlowNode().SIGN_DSFZR_QRGD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click(),t.showFlag.buttBack=!0;break;case flowcommon.getSignFlowNode().SIGN_QRGD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click(),t.showFlag.buttBack=!0,t.showFlag.nodeNext=!1}}function a(t){t.flow.businessMap||(t.flow.businessMap={});var e={};switch(e.resultTag=!0,t.flow.curNode.activitiId){case flowcommon.getSignFlowNode().SIGN_ZHB:$("#viceDirector").val()?t.flow.businessMap.FGLD=$("#viceDirector").val():e.resultTag=!1;break;case flowcommon.getSignFlowNode().SIGN_FGLD_FB:if(e.resultTag=!1,$('.seleteTable input[selectType="main"]:checked').each(function(){t.flow.businessMap.MAIN_ORG=$(this).val(),e.resultTag=!0}),e.resultTag){var i=[];$('.seleteTable input[selectType="assist"]:checked').each(function(){i.push($(this).val())}),i.length>3?(e.resultTag=!1,e.resultMsg="协办部门最多只能选择3个！"):t.flow.businessMap.ASSIST_ORG=i.join(",")}else e.resultMsg="主办部门不为空！";break;case flowcommon.getSignFlowNode().SIGN_BMFB1:if(!t.model.isassistflow||9!=t.model.isassistflow&&"9"!=t.model.isassistflow){var o=$("#selPrincipalMainUser").val();if(!o){e.resultTag=!1,e.resultMsg="必须要选择一个第一负责人！";break}e.resultTag=!0,t.flow.businessMap.M_USER_ID=o;var n=[];$('#principalAssistUser input[selectType="assistUser"]:checked').each(function(){n.push($(this).val())}),n.length>0&&(t.flow.businessMap.A_USER_ID=n.join(","))}else t.businessFlag.principalUsers&&0!=t.businessFlag.principalUsers.length?(e.resultTag=!1,$.each(t.businessFlag.principalUsers,function(t,i){"9"!=i.isMainUser&&9!=i.isMainUser||(e.resultTag=!0)}),e.resultTag||(e.resultMsg="必须要选择一个第一负责人！")):(e.resultTag=!1,e.resultMsg="请先选择项目负责人！"),e.resultTag&&(t.flow.businessMap.PRINCIPAL=t.businessFlag.principalUsers);break;case flowcommon.getSignFlowNode().SIGN_BMFB2:case flowcommon.getSignFlowNode().SIGN_BMFB3:case flowcommon.getSignFlowNode().SIGN_BMFB4:if(!t.model.isassistflow||9!=t.model.isassistflow&&"9"!=t.model.isassistflow){var n=[];$('#principalAssistUser input[selectType="assistUser"]:checked').each(function(){n.push($(this).val())}),n.length>0?t.flow.businessMap.A_USER_ID=n.join(","):(e.resultTag=!1,e.resultMsg="必须要选择负责人！")}else t.businessFlag.principalUsers&&0!=t.businessFlag.principalUsers.length||(e.resultTag=!1,e.resultMsg="请先选择项目负责人！"),e.resultTag&&(t.flow.businessMap.PRINCIPAL=t.businessFlag.principalUsers);break;case flowcommon.getSignFlowNode().SIGN_XMFZR1:case flowcommon.getSignFlowNode().SIGN_XMFZR2:case flowcommon.getSignFlowNode().SIGN_XMFZR3:case flowcommon.getSignFlowNode().SIGN_XMFZR4:9==t.businessFlag.isNeedWP&&0==t.businessFlag.isFinishWP&&(e.resultTag=!1,e.resultMsg="您还没有完成工作方案，不能进行下一步操作！"),t.flow.businessMap.IS_NEED_WP=t.businessFlag.isNeedWP;break;case flowcommon.getSignFlowNode().SIGN_BMLD_SPW1:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW2:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW3:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW4:break;case flowcommon.getSignFlowNode().SIGN_FGLD_SPW1:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW2:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW3:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW4:break;case flowcommon.getSignFlowNode().SIGN_FW:t.model.processState<4&&(e.resultTag=!1,e.resultMsg="您还没完成发文操作，不能进行下一步操作！"),t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_QRFW:case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW_XB:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW_XB:"9"==t.businessFlag.passDis||9==t.businessFlag.passDis?t.flow.businessMap.AGREE="9":t.flow.businessMap.AGREE="0",t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW:case flowcommon.getSignFlowNode().SIGN_ZR_QRFW:case flowcommon.getSignFlowNode().SIGN_FWBH:t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_CWBL:break;case flowcommon.getSignFlowNode().SIGN_GD:
t.model.processState<7&&(e.resultTag=!1,e.resultMsg="您还没完成归档操作，不能进行下一步操作！");break;case flowcommon.getSignFlowNode().SIGN_DSFZR_QRGD:case flowcommon.getSignFlowNode().SIGN_QRGD:t.flow.businessMap.GD_ID=t.fileRecord.fileRecordId}return e}function r(e){var i={method:"get",url:rootPath+"/dispatch/html/initDispatchBySignId",params:{signId:e.model.signid}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.dispatchDoc=t.data,$("#show_dispatch_a").click()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){var i={method:"get",url:rootPath+"/fileRecord/html/initBySignId",params:{signId:e.model.signid}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.fileRecord=t.data,$("#show_filerecord_a").click()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e){var i={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e.model.signid,queryAll:!0}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model=t.data,e.model.workProgramDtoList&&e.model.workProgramDtoList.length>0&&(e.show_workprogram=!0,e.model.workProgramDtoList.forEach(function(t,i){9==t.isMain?(e.showMainwork=!0,e.mainwork={},e.mainwork=t):0==t.isMain&&(e.showAssistwork=!0,e.assistwork={},e.assistwork=t)})),e.model.dispatchDocDto&&(e.show_dispatch=!0,e.dispatchDoc=e.model.dispatchDocDto),e.model.fileRecordDto&&(e.show_filerecord=!0,e.fileRecord=e.model.fileRecordDto)}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{startFlow:o,initBusinessParams:n,checkBusinessFill:a,getChargeDispatch:r,getChargeFilerecord:s,endSignDetail:l}}angular.module("app").factory("signFlowSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s,l,c,d,u,m,p,f){function h(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var g=this;g.title="项目流程处理",g.model={},g.flow={},g.mainwork={},g.assistwork={},g.dispatchDoc={},g.fileRecord={},g.expertReview={},g.work={},g.showFlag={businessTr:!1,businessDis:!1,businessNext:!1,nodeNext:!0,nodeSelViceMgr:!1,nodeSelOrgs:!1,nodeSelPrincipal:!1,isMainBranch:!1,nodeSign:!1,nodeWorkProgram:!1,nodeDispatch:!1,nodeConfirmDis:!1,nodeCreateDisNum:!1,nodeFileRecord:!1,nodeXSWorkProgram:!1,tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,buttBack:!1,expertRemark:!1,expertpayment:!1,expertEdit:!1,isMainPrinUser:!1},g.businessFlag={isLoadSign:!1,isLoadFlow:!1,isGotoDis:!1,isMakeDisNum:!1,principalUsers:[],isSelMainPriUser:!1,editExpertSC:!1,expertScore:{},isNeedWP:9,isMainBranch:!1,isFinishWP:!1,passDis:!1,curBranchId:"",editEPReviewId:""},g.model.signid=o.params.signid,g.work.id=o.params.id,g.flow.taskId=o.params.taskId,g.flow.processInstanceId=o.params.processInstanceId,g.signId=g.model.signid,function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500),g.model.showDiv=i}),e.initFlowPageData(g.model.signid,function(t){g.model=t;var e=$("#myTab .active"),i=$("a",e);g.model.showDiv=i.attr("for-div"),g.model.dispatchDocDto&&(g.showFlag.tabDispatch=!0,g.dispatchDoc=g.model.dispatchDocDto,2==g.dispatchDoc.dispatchWay&&0==g.dispatchDoc.isMainProject||g.dispatchDoc.fileNum?g.businessFlag.isCreateDisFileNum=!0:g.showFlag.buttDisFileNum=!0),g.model.fileRecordDto&&(g.showFlag.tabFilerecord=!0,g.fileRecord=g.model.fileRecordDto),g.businessFlag.isLoadSign=!0,g.businessFlag.isLoadSign&&g.businessFlag.isLoadFlow&&a.initBusinessParams(g),g.model.suppLetterDtoList&&(g.showSupperIndex=0)}),n.getFlowInfo(g.flow.taskId,g.flow.processInstanceId,function(t){g.flow=t,g.flow.end&&(g.showFlag.nodeNext=!1),g.businessFlag.isLoadFlow=!0,g.businessFlag.isLoadSign&&g.businessFlag.isLoadFlow&&a.initBusinessParams(g)}),n.initFlowData(g),t.findByMianId(g.model.signid,function(e){e&&e.length>0&&(g.showFlag.tabSysFile=!0,g.sysFileList=e,t.initZtreeClient(g,c))}),r.initIdea(g)}(),g.ideaEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(g,t)},g.selectedIdea=function(){g.flow.dealOption=g.chooseIdea},g.editSelectExpert=function(t){g.scoreExpert={},$.each(g.model.expertReviewDto.expertSelectedDtoList,function(e,i){if(i.id==t)return void(g.scoreExpert=i)}),$("#star").raty({score:function(){return $(this).attr("data-num",angular.isUndefined(g.scoreExpert.score)?0:g.scoreExpert.score),$(this).attr("data-num")},starOn:"../contents/libs/raty/lib/images/star-on.png",starOff:"../contents/libs/raty/lib/images/star-off.png",starHalf:"../contents/libs/raty/lib/images/star-half.png",readOnly:!1,halfShow:!0,size:34,click:function(t,e){g.scoreExpert.score=t}}),$("#score_win").kendoWindow({width:"820px",height:"365px",title:"编辑-专家星级",visible:!1,modal:!0,closable:!0,actions:["Close"]}).data("kendoWindow").center().open()},g.closeEditMark=function(){window.parent.$("#score_win").data("kendoWindow").close()},g.saveMark=function(){common.initJqValidation($("#expert_score_form")),$("#expert_score_form").valid()?l.saveMark(g.scoreExpert,function(){d.success("保存成功！",function(){g.closeEditMark()})}):d.alert("请填写评分和评分内容！")},g.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void d.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void d.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void d.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var e,i=t.expertSelectedDtoList.length,o="";$.each(t.expertSelectedDtoList,function(t,e){o+="'"+e.id+"'",t!=i-1&&(o+=",")});var n=t.payDate;e=n.substring(0,n.lastIndexOf("-")),l.countTaxes(o,e,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,o){if(!("9"!=o.isConfrim&&9!=o.isConfrim||"9"!=o.isJoin&&9!=o.isJoin)){var n=o.EXPERTID,a=o.id,r=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==n&&t.ESID!=a&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),r=parseFloat(r)+t.REVIEWCOST)}),o.reviewCost=void 0==o.reviewCost?0:o.reviewCost;var s=r+parseFloat(o.reviewCost);o.reviewTaxes=h(s).toFixed(2),o.totalCost=(parseFloat(o.reviewCost)+parseFloat(o.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(o.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(o.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)}})})}}},g.closeEditPay=function(){window.parent.$("#payment").data("kendoWindow").close()},g.savePayment=function(t){common.initJqValidation($("#payform")),$("#payform").valid()?t.reviewCost?l.savePayment(t,g.isCommit,function(t){t.flag||"ok"==t.reCode?d.alert("操作成功！",function(){g.isCommit=!1}):d.alert(t.reMsg)}):d.alert("请计算税率，再保存！"):d.alert("请正确填写专家评审费信息！")},g.commitNextStep=function(){if(g.flow.isSuspended)return void d.error("该流程目前为暂停状态，不能进行流转操作！");var t=a.checkBusinessFill(g);t.resultTag?n.commit(g.isCommit,g.flow,function(t){t.flag||"ok"==t.reCode?d.success("操作成功！",function(){o.go("gtasks")}):d.alert(t.reMsg)}):d.alert(t.resultMsg)},g.commitBack=function(){common.initJqValidation($("#flow_form")),$("#flow_form").valid()&&d.confirm({title:"询问提示",message:"确认回退吗？",onOk:function(){n.rollBackToLast(g.flow,g.isCommit,function(t){t.flag||"ok"==t.reCode?(g.isCommit=!1,d.alert("回退成功！",function(){o.go("gtasks")})):d.alert(t.reMsg)})}})},g.deleteFlow=function(){d.confirm({title:"询问提示",message:"终止流程将无法恢复，确认删除么？？",onOk:function(){$(".confirmDialog").modal("hide"),n.deleteFlow(g)}})},g.editSign=function(){o.go("fillSign",{signid:g.model.signid})},g.addWorkProgram=function(){o.go("workprogramEdit",{signid:g.model.signid})},g.addSuppLetter=function(){o.go("addSupp",{businessId:g.model.signid,businessType:"SIGN"})},g.addSuppLetterList=function(){o.go("addSuppletterList",{businessId:g.model.signid})},g.addRegisterFile=function(){o.go("registerFile",{businessId:g.model.signid})},g.addBaseWP=function(){o.go("workprogramBaseEdit",{signid:g.model.signid})},g.addDisPatch=function(){g.model.isAssociate&&0!=g.model.isAssociate||signcommon.getReviewStage().STAGE_STUDY!=g.model.reviewstage&&signcommon.getReviewStage().STAGE_BUDGET!=g.model.reviewstage?o.go("dispatchEdit",{signid:g.model.signid}):d.confirm({title:"询问提示",message:"该项目还没进行项目关联，是否需要进行关联设置？",onOk:function(){g.searchAssociateSign||(g.searchAssociateSign={signid:g.model.signid,projectname:g.model.projectname}),e.getAssociateSign(g.searchAssociateSign,function(t){g.associateSignList=[],t&&(g.associateSignList=t),$("#associateWindow").kendoWindow({width:"75%",height:"650px",title:"项目关联",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},onCancel:function(){o.go("dispatchEdit",{signid:g.model.signid})}})},g.associateQuerySign=function(){e.getAssociateSign(g.searchAssociateSign,function(t){g.associateSignList=[],t&&(g.associateSignList=t)})},g.saveAssociateSign=function(t){if(g.model.signid==t)return void d.alert("不能关联自身项目");e.saveAssociateSign(g.model.signid,t,function(){t&&(g.model.isAssociate=1),d.alert(void 0!=t?"项目关联成功":"项目解除关联成功"),window.parent.$("#associateWindow").data("kendoWindow").close()})},g.addFinancialApply=function(t){"9"==g.model.isassistflow||9==g.model.isassistflow?g.costType="ASSIST":g.costType="REVIEW",p.initAddCost(g,g.costType,g.model,t)},g.addDoFile=function(){o.go("fileRecordEdit",{signid:g.model.signid})},g.addRegisterFileRecord=function(){g.fileRecord.fileRecordId?o.go("registerFile",{signid:g.fileRecord.fileRecordId}):d.alert("请保存归档再操作！")},g.mainOrg=function(t){var e=t.target,i=e.checked,o=e.value;i?$('.seleteTable input[selectType="main"]').each(function(){var t=$(this).attr("value");t!=o?($(this).removeAttr("checked"),$("#assist_"+t).removeAttr("disabled")):($("#assist_"+o).removeAttr("checked"),$("#assist_"+o).attr("disabled","disabled"))}):$("#assist_"+o).removeAttr("disabled"),g.initOption()},g.initOption=function(){var t=[];$('.seleteTable input[selectType="main"]:checked').each(function(){t.push($(this).attr("tit"))}),$('.seleteTable input[selectType="assist"]:checked').each(function(){t.push($(this).attr("tit"))}),t.length>0&&(g.flow.dealOption="请（"+t.join("，")+"）组织评审")},g.checkPrincipal=function(){var t=$("#selPrincipalMainUser").val();t&&$('#principalAssistUser input[selectType="assistUser"]').each(function(){$(this).attr("value")==t?($(this).removeAttr("checked"),$(this).attr("disabled","disabled")):$(this).removeAttr("disabled")}),g.initUserOption()},g.initUserOption=function(){var t=$("#selPrincipalMainUser").val(),e=!1,i="请（";t&&$.each(g.users,function(o,n){n.id==t&&(i+=n.displayName,e=!0)});var o=[];$('#p_assistUser input[selectType="assistUser"]:checked').each(function(){o.push($(this).attr("tit"))}),o.length>0&&(e&&(i+=", "),i+=o.join(", ")),i+=" )组织办理。",g.flow.dealOption=i},g.checkBoxSingle=function(t,e){var i=t.target,o=i.checked,n=i.value;o?$('.seleteTable input[selectType="'+e+'"]').each(function(){var t=$(this).attr("id"),i=$(this).attr("value");t!=e+"_"+n?($("#"+disabletype+"_"+i).removeAttr("disabled"),$(this).removeAttr("checked")):$("#"+disabletype+"_"+n).attr("disabled","disabled")}):$("#"+disabletype+"_"+n).removeAttr("disabled")},g.checkBoxSingle=function(t,e){var i=t.target,o=i.checked,n=i.value;o&&$('#xs_table input[selectType="'+e+'"]').each(function(){$(this).attr("id");$(this).attr("value")!=n&&$(this).removeAttr("checked")})},g.addPriUser=function(){var t=$("#xs_bmfb input[name='unSelPriUser']:checked");if(t.length<1)d.alert("请选择负责人");else{if(g.businessFlag.isMainBranch){if(9==g.isMainPriUser&&t.length>1)return void d.alert("总负责人只能选一个");if(0==g.businessFlag.isSelMainPriUser&&(angular.isUndefined(g.isMainPriUser)||0==g.isMainPriUser))return void d.alert("请先选择总负责人");if(1==g.businessFlag.isSelMainPriUser&&9==g.isMainPriUser)return void d.alert("你已经选择了一个总负责人，不能再次选择负责人！")}if(g.businessFlag.principalUsers&&g.businessFlag.principalUsers.length+t.length>3)return void d.alert("最多只能选择3个负责人，请重新选择！");for(var e=0;e<t.length;e++){var i={};i.userId=t[e].value,i.userType=$("#userType").val(),9==g.isMainPriUser?(g.businessFlag.isSelMainPriUser=!0,i.isMainUser=9,g.isMainPriUser):i.isMainUser=0,g.users.forEach(function(o,n){o.id==t[e].value&&(o.isSelected=!0,i.userId=o.id,i.userName=o.displayName)}),g.businessFlag.principalUsers.push(i),g.initDealUserName(g.businessFlag.principalUsers)}}},g.delPriUser=function(){var t=$("#xs_bmfb input[name='selPriUser']:checked");if(t.length<1)d.alert("请选择取消的负责人");else{for(var e=0;e<t.length;e++)g.users.forEach(function(i,o){i.id==t[e].value&&(i.isSelected=!1)}),g.businessFlag.principalUsers.forEach(function(i,o){i.userId==t[e].value&&(9==i.isMainUser&&(g.businessFlag.isSelMainPriUser=!1),g.businessFlag.principalUsers.splice(o,1))});g.initDealUserName(g.businessFlag.principalUsers)}},g.initDealUserName=function(t){if(t&&t.length>0){var e="请（";angular.forEach(t,function(t,i){i>0&&(e+=","),e+=t.userName}),e+=" )组织办理。",g.flow.dealOption=e}else g.flow.dealOption=""},g.checkNeedWP=function(t){var i=t.target,o=i.checked;o?g.businessFlag.isNeedWP=9:g.businessFlag.isFinishWP?d.confirm({title:"询问提示",message:"不做工作方案系统将会删除工作方案数据，确认不做工作方案么？",onOk:function(){$(".confirmDialog").modal("hide"),g.businessFlag.isNeedWP=0,e.removeWP(g)},onClose:function(){i.checked=!o,g.businessFlag.isNeedWP=9}}):g.businessFlag.isNeedWP=0},g.meetingDoc=function(){common.confirm({vm:g,title:"",msg:"如果之前已经生成会前准备材料，则本次生成的文档会覆盖之前产生的文档，确定执行操作么？",fn:function(){$(".confirmDialog").modal("hide"),e.meetingDoc(g,function(e){e.flag||"ok"==e.reCode?(d.success("操作成功"),t.findByMianId(g.model.signid,function(e){(e||e.length>0)&&(g.showFlag.tabSysFile=!0,g.sysFileList=e,t.initZtreeClient(g,c))})):d.error(e.reMsg)})}})},g.commonDownloadSysFile=function(e){t.downloadFile(e)},g.createDispatchFileNum=function(){e.createDispatchFileNum(g.model.signid,g.dispatchDoc.id,function(t){(t.flag||"ok"==t.reCode)&&(g.dispatchDoc.fileNum=t.reObj),d.alert(t.reMsg)})},g.dispatchTemplate=function(){e.createDispatchTemplate(g)},g.watchPassDis=function(){c.$watch("vm.businessFlag.passDis",function(t,e){g.flow.dealOption=9==t?"通过":"不通过"})},g.affirmJoinExpert=function(){g.model.expertReviewDto&&g.model.expertReviewDto.expertSelectedDtoList?(g.confirmEPList=g.model.expertReviewDto.expertSelectedDtoList,$("#confirmJoinExpert").kendoWindow({width:"75%",height:"600px",title:"参加评审会专家确认",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):d.alert("该项目没有评审专家！")},g.updateToJoin=function(){var t=$("#notJoinExpertTable input[name='notJoinExpert']:checked");if(t.length<1)d.alert("请选择要改为参加会议的专家");else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);l.updateJoinState("","",e.join(","),"9",g.isCommit,function(t){d.success("操作成功！"),g.reFleshJoinState(e,"9")})}},g.updateToNotJoin=function(){var t=$("#joinExpertTable input[name='joinExpert']:checked");if(t.length<1)d.alert("请选择未参加会议的专家");else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);l.updateJoinState("","",e.join(","),"0",g.isCommit,function(t){d.success("操作成功！"),g.reFleshJoinState(e,"0")})}},g.reFleshJoinState=function(t,e){$.each(t,function(t,i){$.each(g.confirmEPList,function(t,o){i==o.id&&(o.isJoin=e)})})},g.printpage=function(t){var e=$(t.target).parent().attr("id");console.log(e)}}angular.module("app").controller("signFlowDealCtrl",t),t.$inject=["sysfileSvc","signSvc","workprogramSvc","$state","flowSvc","signFlowSvc","ideaSvc","addRegisterFileSvc","expertReviewSvc","$scope","bsWin","financialManagerSvc","assistCostCountSvc","addCostSvc","templatePrintSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.title="项目流程信息",s.model={},s.flow={},s.work={},s.dispatchDoc={},s.fileRecord={},s.model.signid=i.params.signid,s.flow.taskId=i.params.taskId,s.flow.processInstanceId=i.params.processInstanceId,s.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},s.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500),s.model.showDiv=i}),o.initFlowData(s),e.initFlowPageData(s.model.signid,function(t){s.model=t;var e=$("#myTab .active"),i=$("a",e);s.model.showDiv=i.attr("for-div"),s.model.dispatchDocDto&&(s.showFlag.tabDispatch=!0,s.dispatchDoc=s.model.dispatchDocDto,2==s.dispatchDoc.dispatchWay&&0==s.dispatchDoc.isMainProject||s.dispatchDoc.fileNum?s.businessFlag.isCreateDisFileNum=!0:s.showFlag.buttDisFileNum=!0),s.model.fileRecordDto&&(s.showFlag.tabFilerecord=!0,s.fileRecord=s.model.fileRecordDto),s.model.processState>1&&(s.showFlag.tabWorkProgram=!0),s.model.suppLetterDtoList&&(s.showSupperIndex=0)}),t.findByMianId(s.model.signid,function(e){e&&e.length>0&&(s.showFlag.tabSysFile=!0,s.sysFileList=e,t.initZtreeClient(s,a))})}(),s.commonDownloadSysFile=function(e){t.downloadFile(e)},s.printpage=function(t){r.templatePrint(t.target,s.model)}}angular.module("app").controller("signFlowDetailCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc","signFlowSvc","$scope","templatePrintSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.title="新增预签收收文",n.reserveAdd=function(){e.reserveAdd(n.model,function(t){t.flag||"ok"==t.reCode?o.success("操作成功，请继续填写项目审核登记表",function(){i.go("fillSign",{signid:t.reObj.signid},{reload:!0})}):o.error(t.reMsg)})}}angular.module("app").controller("signReserveAddCtrl",t),t.$inject=["$location","reserveSignSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.title="预签收列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteReserveSign(o,t)}})},function(){e.grid(o)}()}angular.module("app").controller("signReserveCtrl",t),t.$inject=["$location","reserveSignSvc","$state"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/sign/html/reserveAddPost",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){e.isSubmit=!0;var o={method:"delete",url:r+"/deleteReserve",params:{signid:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e){var i={method:"get",url:r+"/html/findByIdsign",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(r+"/reserveListSign",$("#reserveFrom")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:160,filterable:!1},{field:"projectcode",title:"收文编号",width:120,filterable:!1},{field:"designcompanyName",title:"项目单位",width:150,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"projectcode",title:"项目代码",width:120,filterable:!1},{field:"receivedate",title:"收文时间",width:160,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.ispresign?0==t.ispresign?'<span style="color:green;">预签收</span>':void 0:" "}},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),t.signid,"vm.del('"+t.signid+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var r=rootPath+"/sign";return{grid:a,getsignById:n,reserveAdd:i,deleteReserveSign:o}}angular.module("app").factory("reserveSignSvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.model={},r.flow={},r.model.signid=i.params.signid,r.flow.processInstanceId=i.params.processInstanceId,r.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},r.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500),r.model.showDiv=i}),i.params.processInstanceId&&o.initFlowData(r),e.initFlowPageData(r.model.signid,function(t){r.model=t;var e=$("#myTab .active"),i=$("a",e);r.model.showDiv=i.attr("for-div"),r.model.dispatchDocDto&&(r.showFlag.tabDispatch=!0,r.dispatchDoc=r.model.dispatchDocDto),r.model.fileRecordDto&&(r.showFlag.tabFilerecord=!0,r.fileRecord=r.model.fileRecordDto),r.model.processState>1&&(r.showFlag.tabWorkProgram=!0),r.model.suppLetterDtoList&&(r.showSupperIndex=0)}),t.findByMianId(r.model.signid,function(e){e&&e.length>0&&(r.showFlag.tabSysFile=!0,r.sysFileList=e,t.initZtreeClient(r,n))})}(),r.printpage=function(t){a.templatePrint(t.target,r.model)}}angular.module("app").controller("signDetailsCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc","$scope","templatePrintSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(e){var i={method:"post",url:rootPath+"/dispatch/createDispatchTemplate",params:{signId:e.model.signid}},o=function(t){};common.http({$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/findBySignUser",$("#searchform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:120,filterable:!1},{field:"filecode",title:"收文编号",width:80,filterable:!1},{field:"designcompanyName",title:"项目单位",width:100,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"projectcode",title:"项目代码",width:80,filterable:!1},{field:"signdate",title:"签收日期",width:100,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.signState?0==t.signState?'<span style="color:red">预签收</span>':1==t.signState?'<span style="color:green;">进行中</span>':2==t.signState?'<span style="color:orange;">已暂停</span>':8==t.signState?'<span style="color:red;">强制结束</span>':9==t.signState?'<span style="color:blue;">已完成</span>':5==t.signState?"未发起":"":"未发起"}},{field:"",title:"操作",width:180,template:function(t){var e=angular.isString(t.processInstanceId),i=!(!t.issign||9!=t.issign);return common.format($("#columnBtns").html(),t.signid,e,t.signid+"/"+t.processInstanceId,"vm.del('"+t.signid+"')",e,"vm.startNewFlow('"+t.signid+"')",e,"vm.realSign('"+t.signid+"')",i)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function r(e,i){var o={method:"post",url:rootPath+"/sign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"post",url:rootPath+"/officeUser/findOfficeUsersByDeptName",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"put",url:rootPath+"/sign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"delete",url:rootPath+"/sign",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(e,i){var o={method:"post",url:rootPath+"/sign/html/initFillPageData",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function u(e,i){var o={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function m(e,i){var o={method:"get",url:rootPath+"/sign/initFlowPageData",params:{signid:e,queryAll:!0}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function p(e){var o={method:"delete",url:rootPath+"/workprogram/deleteBySignId",params:{signId:e.model.signid}},n=function(t){e.isSubmit=!1,t.data.flag||"ok"==t.data.reCode?(e.businessFlag.isFinishWP=!1,i.success("操作成功！")):i.error(t.data.reMsg)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function f(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/fingByOData",$("#searchAssociateform"),{filter:"isAssociate eq 0"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"projectname",title:"项目名称",width:160,filterable:!1},{field:"projectcode",title:"收文编号",width:140,filterable:!1},{field:"designcompanyName",title:"项目单位",width:200,filterable:!1},{field:"reviewstage",title:"项目阶段",width:160,filterable:!1},{field:"projectcode",title:"项目代码",width:140,filterable:!1}];t.associateGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function h(e,i){var o={method:"post",url:rootPath+"/sign/findAssociateSign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function g(e,i,o){i="undefined"==i?null:i;var n={method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:rootPath+"/sign/associate",data:$.param({signId:e,associateId:i},!0)},a=function(t){void 0!=o&&"function"==typeof o&&o()};common.http({$http:t,httpOptions:n,success:a})}function v(e,i){var o={method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:rootPath+"/sign/associate?signId="+i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){if(void 0!=t.data){e.associateSign=t.data;for(var i=t.data,o="",n=i.length-1;n>=0;n--){var a=i[n],r=a.signdate||"";o+='<div class="intro-list"><div class="intro-list-left">项目阶段：'+a.reviewstage+"<br/>签收时间："+r+'</div><div class="intro-list-right"><span></span><div class="intro-list-content">名称：<span style="color:red;">'+a.projectname+'</span><br/>送件人：<span style="color:red;">'+a.sendusersign+"</span><br/></div></div></div>"}$("#introFlow").html(o);$("#myStep").step({animate:!0,initStep:1,speed:1e3})}}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function w(e,i){var o={method:"get",url:rootPath+"/workprogram/createMeetingDoc",params:{signId:e.model.signid}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function b(e,i,o){var n={method:"post",url:rootPath+"/dispatch/createFileNum",params:{signId:e,dispatchId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function y(e,i){var o={method:"post",url:rootPath+"/sign/realSign",params:{signid:i}},n=function(t){void 0!=callBack&&"function"==typeof callBack&&callBack(t.data)};common.http({$http:t,httpOptions:o,success:n})}function S(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/fingByGetBack",$("#signBackform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"projectName",title:"项目名称",width:"25%",filterable:!1},{field:"nodeName",title:"当前环节",width:"10",filterable:!1},{field:"displayName",title:"处理人",width:"10",filterable:!1},{field:"",title:"合并评审",width:"15%",filterable:!1,template:function(t){return t.reviewType?9==t.reviewType||"9"==t.reviewType?"合并评审[主项目]":"合并评审[次项目]":"否"}},{field:"reviewStage",title:"项目阶段",width:"15%",filterable:!1},{field:"signDate",title:"签收时间",width:"10%",filterable:!1},{field:"",title:"操作",width:"10%",template:function(t){return common.format($("#columnBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId,"vm.getBack")}}];t.signGetBackGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}function k(e,i,o){var n={method:"post",url:rootPath+"/sign/getBack",params:{taskId:e,businessKey:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}return{signGrid:a,createSign:r,initFillData:d,initDetailData:u,updateFillin:l,deleteSign:c,findOfficeUsersByDeptName:s,initFlowPageData:m,removeWP:p,associateGrid:f,getAssociateSign:h,saveAssociateSign:g,initAssociateSigns:v,meetingDoc:w,createDispatchFileNum:b,realSign:y,createDispatchTemplate:n,signGetBackGrid:S,getBack:k}}angular.module("app").factory("signSvc",t),t.$inject=["$http","$state","bsWin","sysfileSvc"]}(),function(){"use strict";function t(t,e){function i(){t.getDate(function(i){var n=i.replace(/-/g,"/");o.startTime=new Date(Date.parse(n.substring(1,n.length-1))).toISOString().slice(0,10),t.findByTime(o,function(t){if(t.flag||"ok"==t.reCode){var i=t.reObj;if(void 0!=i&&i.length>0){for(var n=0;n<i.length;n++)$.each(i[n],function(t,e){o.reviewStage.push(t),o.appalyinvestment.push(e[0]),o.authorizeValue.push(e[1]),o.projectCount.push(e[2])});o.resultData.push(o.appalyinvestment,o.authorizeValue),o.gotoHistogram()}}else e.error(t.reMsg)})})}var o=this;o.startDateTime=new Date("2006/6/1 08:00"),o.endDateTime=new Date("2030/6/1 21:00"),o.startTime="",o.endTime=(new Date).toISOString().slice(0,10),o.chartType="histogram",o.reviewStage=[],o.appalyinvestment=[],o.authorizeValue=[],o.sz=[],o.fj=[],o.xx=[],o.sb=[],o.qt=[],o.series=[],o.resultData=[],o.projectCount=[],o.tooltipFormater=[],o.capital=["申报金额","审定金额"],o.projectType=["市政工程","房建工程","信息工程","设备采购","其他"],o.stage=["3000万以下","3000万-1亿","1亿-10亿","10亿以上"],
o.review=["项目概算","项目建议书","进口设备","资金申请报告","设备清单（进口）","设备清单（国产）","可行性研究报告","其他"],o.resetChart=function(){o.reviewStage=[],o.appalyinvestment=[],o.authorizeValue=[],o.sz=[],o.fj=[],o.xx=[],o.sb=[],o.qt=[],o.series=[],o.resultData=[],o.projectCount=[],o.tooltipFormater=[];var t=$("input[type='radio']:checked").val();"lineChart"==t?o.gotoLineChart():"histogram"==t?i():"pie"==t&&o.gotoPie()},o.gotoHistogram=function(){o.showHistogram=!0,o.showLineChart=!1,o.showPie=!1;for(var t=0;t<o.capital.length;t++)o.series.push({name:o.capital[t],type:"bar",data:o.resultData[t],barWidth:30,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return t.value}}}}});o.initHistogram()},o.gotoLineChart=function(){o.showHistogram=!1,o.showPie=!1,o.showLineChart=!0,t.findByTypeAndReview(o,function(t){if(t.flag||"ok"==t.reCode){var i=t.reObj;if(void 0!=i&&i.length>0){for(var n=0;n<i.length;n++)$.each(i[n],function(t,e){o.reviewStage.push(t),o.sz.push(e[0]),o.fj.push(e[1]),o.xx.push(e[2]),o.sb.push(e[3]),o.qt.push(e[4])});o.resultData.push(o.sz,o.fj,o.xx,o.sb,o.qt);for(var n=0;n<o.projectType.length;n++)o.series.push({name:o.projectType[n],type:"line",data:o.resultData[n],itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{fontWeight:"normal",fontSize:15},formatter:function(t){return t.value}}}}})}o.initLineChart()}else e.error(t.reMsg)})},o.gotoPie=function(){o.showHistogram=!1,o.showLineChart=!1,o.showPie=!0,t.pieData(o,function(t){if(t.flag||"ok"==t.reCode){var i=t.reObj;if(console.log(235),console.log(i),void 0!=i&&null!=i){if(void 0!=i[1]&&i[1].length>0)for(var n=0;n<i[1].length;n++)o.series.push({value:i[1][n],name:o.stage[n],label:{normal:{formatter:" {b} : {c}%",textStyle:{fontWeight:"normal",fontSize:15}}}}),o.tooltipFormater.push({seriesName:"项目数",totalName:"项目总数",totalValue:i[2],name:o.stage[n],pidName:"占百分比",data:i[0][n],value:i[1][n]});o.initPie()}else e.error("该时间段没有数据！")}else e.error(t.reMsg)})},o.initHistogram=function(){var t=echarts.init(document.getElementById("histogram")),e={title:{text:"申报金额与审定金额统计情况",subtext:"按评审阶段划分",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#283b56"}}},legend:{orient:"vertical",left:"left",data:o.capital},toolbox:{show:!0,x:"1000",feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},grid:{left:"13%",right:"10%",bottom:"10%",containLabel:!0},xAxis:{type:"category",name:"评审阶段",data:o.review,axisTick:{alignWithLabel:!0},axisLabel:{interval:0,rotate:35,margin:2,textStyle:{fontWeight:"bolder",color:"#295645"}}},yAxis:{type:"value",name:"金额（亿元）",interval:5},series:o.series,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.5)"}}};t.setOption(e)},o.initLineChart=function(){var t=echarts.init(document.getElementById("lineChart")),e={title:{text:"评审项目类别统计情况",subtext:"按评审阶段划分",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/> {b} : {c}"},grid:{left:"13%",right:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"left",data:o.projectType},xAxis:{type:"category",name:"评审阶段",splitLine:{show:!1},data:o.review,axisLabel:{interval:0,rotate:35,margin:2,textStyle:{fontWeight:"bolder",color:"#295645"}}},yAxis:{type:"value",name:"项目个数"},series:o.series,lineStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.5)"}}};t.setOption(e)},o.initPie=function(){var t=echarts.init(document.getElementById("pie")),e={title:{text:"评审项目比例情况",subtext:"按申报金额范围划分",x:"center"},tooltip:{trigger:"item",width:150,formatter:function(t){for(var e=0;e<o.tooltipFormater.length;e++)if(o.tooltipFormater[e].name==t.name)return t.name+"<br/>"+o.tooltipFormater[e].seriesName+" : "+o.tooltipFormater[e].data+"<br/>"+o.tooltipFormater[e].totalName+" : "+o.tooltipFormater[e].totalValue+"<br/>"+o.tooltipFormater[e].pidName+" : "+o.tooltipFormater[e].value+"%"}},grid:{left:"10%",right:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"left",data:o.stage},series:[{type:"pie",radius:"30%",center:["50%","50%"],selectMode:"single",data:o.series,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.5)"}}}]};t.setOption(e)},i()}angular.module("app").controller("signChartCtrl",t),t.$inject=["signChartSvc","bsWin"]}(),function(){"use strict";function t(t){function e(e){var i={method:"post",url:rootPath+"/signView/getDate"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({httpOptions:i,$http:t,success:o})}function i(e,i){var o={method:"post",url:rootPath+"/signView/findByTime",params:{startTime:e.startTime,endTime:e.endTime}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,httpOptions:o,$http:t,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/signView/pieDate",params:{startTime:e.startTime,endTime:e.endTime}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,httpOptions:o,$http:t,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/signView/findByTypeAndReview",params:{startTime:e.startTime,endTime:e.endTime}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,httpOptions:o,$http:t,success:n})}return{findByTime:i,pieData:o,findByTypeAndReview:n,getDate:e}}angular.module("app").factory("signChartSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.getBack=function(e,i){o.confirm({title:"询问提示",message:"确认取回吗？",onOk:function(){t.getBack(e,i,function(t){t.flag||"ok"==t.reCode?o.alert("取回项目成功",function(){n.signGetBackGrid.dataSource.read();var t=parseInt($("#DO_SIGN_COUNT").html());$("#DO_SIGN_COUNT").html(t+1)}):o.alert(t.reMsg)})}})},function(){t.signGetBackGrid(n)}()}angular.module("app").controller("signGetBackCtrl",t),t.$inject=["signSvc","flowSvc","signFlowSvc","bsWin"]}(),function(){"use strict";function t(){return n}function e(t){var e="";switch(t){case n.PD:e=a.ZHANG_YF;break;case n.GD:e=a.LI_J}return e}function i(t){var e="";switch(t){case n.PD:e="请张主任阅示。";break;case n.GD:e="请李主任阅示。"}return e}function o(){return r}var n={PX:"PX",GX:"GX"},a={ZHANG_YF:"张一帆",LI_J:"李军"},r={godispatch:"godispatch",principaluser:"principaluser",seconduser:"seconduser"},s={getBusinessType:t,getDefaultLeader:e,getDefaultZHBYJ:i,getFlowParams:o,getReviewStage:function(){return{STAGE_SUG:"项目建议书",STAGE_STUDY:"可行性研究报告",STAGE_BUDGET:"项目概算",APPLY_REPORT:"资金申请报告",OTHERS:"其它",DEVICE_BILL_HOMELAND:"设备清单（国产）",DEVICE_BILL_IMPORT:"设备清单（进口）",IMPORT_DEVICE:"进口设备"}}};window.signcommon=s}(),function(){"use strict";function t(t,e,i){function o(){e.queryList(n)}var n=this;n.model={},n.title="系统配置",o(),n.addConfig=function(){n.model={},n.model.isShow="9",$("#configdiv").kendoWindow({width:"70%px",height:"500px",title:"参数编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},n.closeWin=function(){window.parent.$("#configdiv").data("kendoWindow").close(),o()},n.doCommit=function(){common.initJqValidation(),$("#configForm").valid()&&e.saveConfig(n,function(t){t.flag||"ok"==t.reCode?(i.success("操作成功！"),window.parent.$("#configdiv").data("kendoWindow").close(),o()):i.error(t.reMsg)})},n.editConfig=function(t){n.configList.forEach(function(e,i){e.id==t&&(n.model=e)}),$("#configdiv").kendoWindow({width:"700px",height:"440px",title:"参数编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}}angular.module("app").controller("sysConfigCtrl",t),t.$inject=["$location","sysConfigSvc","bsWin"]}(),function(){"use strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/sysConfig/queryList"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.configList=new Array,e.configList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(i,o){var n={method:"delete",url:rootPath+"/sysConfig",params:{id:o}},a=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),i.isSubmit=!1,e(i)}})}})};common.http({vm:i,$http:t,httpOptions:n,success:a})}function o(e,i){var o={method:"post",url:rootPath+"/sysConfig",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}return{queryList:e,deleteConfig:i,saveConfig:o}}angular.module("app").factory("sysConfigSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){var e=this;e.model={},e.title="部门小组列表",function(){t.listGrid(e.gridOptions)}()}angular.module("app").controller("sysdeptCtrl",t),t.$inject=["sysdeptSvc"]}(),function(){"use strict";function t(t){var e=this;e.model={},e.title="部门小组编辑",e.model.id=$state.params.id,e.model.id&&(e.isUpdate=!0,e.title="更新部门"),function(){e.isUpdate&&t.findById(e.model.id,function(t){e.model=t})}()}angular.module("app").controller("sysdeptEditCtrl",t),t.$inject=["sysdeptSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sysdept/fingByOData",$("#sysDeptForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"name",title:"小组名称",width:160,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];common.gridDataSource(e),common.kendoGridConfig().filterable,common.kendoGridConfig().pageable,common.kendoGridConfig().noRecordMessage}function i(e,i){var o={method:"post",url:rootPath+"/sysdept/getSysDeptById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{listGrid:e,findById:i}}angular.module("app").factory("sysdeptSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.model.signid=i.params.id,o.model.type=i.params.type,o.commonDownloadSysFile=function(t){e.downloadFile(t)},function(){e.queryFile(o.model.signid,o.model.type,function(t){t&&t.length>0&&(o.sysFileList=t)})}()}angular.module("app").controller("fileListCtrl",t),t.$inject=["$location","sysfileSvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="系统安装包列表",function(){e.queryPluginfile(i)}()}angular.module("app").controller("pluginfileCtrl",t),t.$inject=["$location","sysfileSvc"]}(),function(){"use strict";function t(t,e,i){function o(){}function n(){return{SIGN:"项目附件",FILLSIGN:"审批登记",HUMAN:"人事附件",BOOKS:"图书附件",NOTICE:"通知公告",SHARE:"资料共享",MEETTINGROOM:"会议室预定",WORKPROGRAM:"工作方案",DISPATCH:"发文",DOFILE:"归档",MEETING:"会前准备材料",SUPPLEMENT:"补充函",STAGEMEETING:"评审会会议",FILELIBRARY:"质量管理文件库",POLICYLIBRARY:"政策标准库",TOPIC:"课题附件",TOPIC_PLAN:"课题计划书",TOPIC_WORKPLAN:"课题工作方案",TOPIC_FILING:"课题归档",MONTH_FILE:"月报简报",AADSUPP_FILE:"拟补充资料函"}}function a(t){window.open(rootPath+"/file/fileDownload?sysfileId="+t)}function r(e,i){var o={method:"post",url:rootPath+"/file/findByBusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"post",url:rootPath+"/file/findByMainId",params:{mainId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(e,i,o){var n={method:"post",url:rootPath+"/file/queryFile",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},data:$.param({mainId:e,sysBusiType:i})},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function c(e,i){var o={method:"delete",url:rootPath+"/file/deleteSysFile",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(t){t.vm.initUploadOptionSuccess=!1;var i={width:"70%",height:"460px",uploadBt:"upload_file_bt",detailBt:"detail_file_bt",inputId:"sysfileinput",mainType:"没有归类附件",sysBusiType:"",showBusiType:!0};if(!t.vm.sysFile)return void e.alert("初始化附件控件失败，请先定义附件对象！");if(t.sysBusiType&&(i.sysBusiType=t.sysBusiType),t.width&&(i.width=t.width),t.height&&(i.height=t.height),angular.isUndefined(t.vm.sysFile.showBusiType)&&(t.vm.sysFile.showBusiType=i.showBusiType),t.vm.downloadSysFile=function(t){a(t)},t.vm.delSysFile=function(i){c(i,function(){e.alert("删除成功！"),$.each(t.vm.sysFilelists,function(e,o){o.sysFileId==i&&t.vm.sysFilelists.splice(e,1)})})},t.vm.clickUploadBt=function(){t.vm.sysFile.businessId?$("#commonUploadWindow").kendoWindow({width:i.width,height:i.height,title:"附件上传",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():e.alert("请先保存业务数据！")},t.vm.clickDetailBt=function(){if(!t.vm.sysFile.businessId)return void e.alert("请先保存业务数据！");r(t.vm.sysFile.businessId,function(e){t.vm.sysFilelists=[],t.vm.sysFilelists=e,$("#commonQueryWindow").kendoWindow({width:"800px",height:"500px",title:"附件上传列表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},t.vm.sysFile.businessId){var o={language:"zh",allowedPreviewTypes:["image"],allowedFileExtensions:["sql","exe","lnk"],maxFileSize:5e3,showRemove:!1,uploadUrl:rootPath+"/file/fileUpload",uploadExtraData:function(e,o){var n={};return n.businessId=t.vm.sysFile.businessId,n.mainId=t.vm.sysFile.mainId,n.mainType=t.vm.sysFile.mainType||i.mainType,n.sysfileType=t.vm.sysFile.sysfileType,n.sysBusiType=t.vm.sysFile.sysBusiType||i.sysBusiType,n}},n=0;$("#"+t.inputId||i.inputId).fileinput(o).on("filebatchselected",function(t,e){n=e.length}).on("fileuploaded",function(e,i,a,r){o.sysBusiType=t.vm.sysFile.sysBusiType,n==r+1&&void 0!=t.uploadSuccess&&"function"==typeof t.uploadSuccess&&t.uploadSuccess(e,i,a,r)}),t.vm.initUploadOptionSuccess=!0}}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/file/getPluginFile"),schema:common.kendoGridConfig().schema(),serverPaging:!1,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"fileName",title:"名称",filterable:!1},{field:"fileLength",title:"大小",width:160,filterable:!1},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),rootPath+"/"+t.relativePath)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function m(t,e){var i,o={check:{chkboxType:{Y:"ps",N:"ps"},enable:!1},callback:{onClick:p}},n=t.sysFileList;t.zNodes=[];for(var a=0;a<n.length;a++){var r=n[a].sysBusiType,s=new Object;s.id=n[a].mainId,s.name=r;for(var l=[],c=0;c<n.length;)if(n[c].sysBusiType==r){var d=new Object;d.name=n[c].showName,d.id=n[c].mainId,d.sysFileId=n[c].sysFileId,l.push(d),n.splice(c,1),a=-1}else c++;s.children=l,t.zNodes.push(s)}e.$watch("vm.zNodes",function(e,n){setTimeout(function(){i=$.fn.zTree.init($("#zTree"),o,t.zNodes)},500)},!0)}function p(t,e,o){if(0==o.check_Child_State){var n=window.location.hash,a=[];a=n.split("/"),0==o.check_Child_State&&i.go(a[1]+".fileList",{id:o.id,type:o.name})}}return{initUploadOptions:d,delSysFile:c,downloadFile:a,queryPluginfile:u,findByMianId:s,findByBusinessId:r,mainTypeValue:n,previewFile:o,initZtreeClient:m,queryFile:l}}angular.module("app").factory("sysfileSvc",t),t.$inject=["$http","bsWin","$state"]}(),function(){"use strict";function t(t,e,i){function o(t,e){n.model=e,"expert_score"==n.model.showDiv||"expert_payment"==n.model.showDiv||"suppLetter_list"==n.model.showDiv||"registerFile_list"==n.model.showDiv?($("#"+n.model.showDiv).hide(),$("#"+n.model.showDiv+"_templ").show(),$(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").addClass("print-hide"),$(t).addClass("print-hide"),$(".content-wrapper").addClass("print-content"),print(),$("#"+n.model.showDiv).show(),$("#"+n.model.showDiv+"_templ").hide(),$(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").removeClass("print-hide"),$(t).removeClass("print-hide"),$(".content-wrapper").removeClass("print-content")):"项目建议书"==n.model.reviewstage||"可行性研究报告"==n.model.reviewstage||"项目概算"==n.model.reviewstage||"其它"==n.model.reviewstage?($("#"+n.model.showDiv+"_xmjys").hide(),$("#"+n.model.showDiv+"_xmjys_templ").show(),$(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").addClass("print-hide"),$(t).addClass("print-hide"),$(".content-wrapper").addClass("print-content"),print(),$("#"+n.model.showDiv+"_xmjys").show(),$("#"+n.model.showDiv+"_xmjys_templ").hide(),$(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").removeClass("print-hide"),$(t).removeClass("print-hide"),$(".content-wrapper").removeClass("print-content")):($(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").addClass("print-hide"),$(t).addClass("print-hide"),$(".content-wrapper").addClass("print-content"),print(),$(".main-sidebar,#flow_form,.header,.breadcrumb,.toolbar,#myTab").removeClass("print-hide"),$(t).removeClass("print-hide"),$(".content-wrapper").removeClass("print-content"))}var n=this;return n.model={},{templatePrint:o}}angular.module("app").factory("templatePrintSvc",t),t.$inject=["$http","bsWin","$state"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="新增课题研究",a.model={},a.model.fgwlx=0,a.model.sendFgw=0,n.params.id&&(a.model.id=n.params.id),a.initFileUpload=function(){a.model.id||e.$watch("vm.model.id",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.model.id,mainId:a.model.id,mainType:i.mainTypeValue().TOPIC,sysfileType:i.mainTypeValue().TOPIC_PLAN,sysBusiType:i.mainTypeValue().TOPIC_PLAN,showBusiType:!1},i.initUploadOptions({inputId:"sysfileinput",vm:a})},function(){a.model.id&&o.initDetail(a.model.id,function(t){a.model=t}),o.findOrgUser(function(t){a.principalUsers=t}),a.initFileUpload()}(),a.checkPrincipal=function(){var t=$("#mainPrinUserId").val();t&&$('#principalUser_ul input[selectType="assistUser"]').each(function(){$(this).attr("value")==t?($(this).removeAttr("checked"),$(this).attr("disabled","disabled")):$(this).removeAttr("disabled")})},a.create=function(){if(common.initJqValidation($("#topicform")),$("#topicform").valid()){var e=[];$('#principalUser_ul input[selectType="assistUser"]:checked').each(function(){e.push($(this).attr("value"))}),a.model.prinUserIds=e.join(","),o.createTopic(a.model,a.isCommit,function(e){e.flag||"ok"==e.reCode?(a.model=e.reObj,t.alert("操作成功！")):t.alert(e.reMsg)})}else t.alert("页面未填报完整或者为正确，请检查！")},a.startFlow=function(){common.initJqValidation($("#topicform")),$("#topicform").valid()?t.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){var e=[];$('#principalUser_ul input[selectType="assistUser"]:checked').each(function(){e.push($(this).attr("value"))}),a.model.prinUserIds=e.join(","),o.startFlow(a.model,a.isCommit,function(e){e.flag||"ok"==e.reCode?t.alert("保存成功！",function(){n.go("myTopic")}):t.alert(e.reMsg)})}}):t.alert("页面未填报完整或者为正确，请检查！")}}angular.module("app").controller("topicAddCtrl",t),t.$inject=["bsWin","$scope","sysfileSvc","topicSvc","$state"]}();!function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="课题研究存档表",r.filing={},r.zlList=[],function(){o.findByTopicId(n.params.topicId,function(t){r.filing=t,r.filing.topicId=n.params.topicId,r.initFileUpload()})}(),r.initFileUpload=function(){r.filing.id||e.$watch("vm.filing.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.filing.id,mainId:r.filing.topicId,mainType:a.mainTypeValue().TOPIC,sysfileType:a.mainTypeValue().TOPIC_FILING,sysBusiType:a.mainTypeValue().TOPIC_FILING},a.initUploadOptions({inputId:"sysfileinput",vm:r})},r.saveFiling=function(){o.save(r.filing,function(e){e.flag||"ok"==e.reCode?(r.filing=e.reObj,r.filing.topicId=n.params.topicId,t.alert("保存成功！")):t.error(e.reMsg)})},r.addZL=function(){r.filing.registerFileDto||(r.filing.registerFileDto=[]);var t={};t.id=common.uuid(),r.filing.registerFileDto.push(t)},r.delZL=function(){var e=$("#filingform input[tit='dynamicCheckbox']:checked");if(e.length<1)t.alert("请选择要删除的意见！");else{for(var o=[],n=0;n<e.length;n++)e[n].value&&o.push(e[n].value),$.each(r.filing.registerFileDto,function(t,i){i.id==e[n].value&&r.filing.registerFileDto.splice(t,1)});o.length>0&&i.deleteByIds(o.join(","),function(e){t.alert("删除成功！")})}},r.initInputValue=function(t,e){return t.target.checked&&!e?1:e}}angular.module("app").controller("filingEditCtrl",t),t.$inject=["bsWin","$scope","addRegisterFileSvc","filingSvc","$state","sysfileSvc"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/filing/initByTopicId",params:{topicId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/filing",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{findByTopicId:i,save:o}}angular.module("app").factory("filingSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="我的课题列表",function(){o.initMyGird(n)}(),n.searchForm=function(){n.myTopicOptions.dataSource.read()},n.formReset=function(){n.searchModel={}}}angular.module("app").controller("myTopicCtrl",t),t.$inject=["bsWin","$scope","sysfileSvc","topicSvc"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:rootPath+"/user/findChargeUsers"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function n(e,i,o){i=!0;var n={method:"post",url:rootPath+"/topicInfo",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/topicInfo/startFlow",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"post",url:rootPath+"/topicInfo/findById",params:{id:e.businessKey}},o=function(t){e.model={},e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/topicInfo/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"topicName",title:"课题名称",width:"25%",filterable:!1},{field:"cooperator",title:"合作单位",width:"20%",filterable:!1},{field:"createdDate",title:"创建日期",width:"25%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:"15%",template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.id,e,"flowEnd/"+t.id+"/"+flowcommon.getFlowDefinedKey().TOPIC_FLOW+"/"+t.processInstanceId,!e)}}];t.myTopicOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function l(e,i){var o={method:"post",url:rootPath+"/topicInfo/findDetailById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n,onError:function(){}})}function c(t,e,o){switch(t.curNode.activitiId){case flowcommon.getTopicFlowNode().TOPIC_BZSH_JH:case flowcommon.getTopicFlowNode().TOPIC_FGLD_JH:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_JH:case flowcommon.getTopicFlowNode().TOPIC_BZSH_FA:case flowcommon.getTopicFlowNode().TOPIC_FGLD_FA:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_FA:case flowcommon.getTopicFlowNode().TOPIC_BZSH_BG:case flowcommon.getTopicFlowNode().TOPIC_FGLD_BG:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_BG:case flowcommon.getTopicFlowNode().TOPIC_BZSH_JT:case flowcommon.getTopicFlowNode().TOPIC_FGLD_JT:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_JT:case flowcommon.getTopicFlowNode().TOPIC_BZSH_GD:case flowcommon.getTopicFlowNode().TOPIC_GDY_QR:e.buttBack=!0;break;case flowcommon.getTopicFlowNode().TOPIC_CGJD:case flowcommon.getTopicFlowNode().TOPIC_KTBG:o.showFlag.isMainPrinUser=!0,o.showFlag.expertEdit=!0;break;case flowcommon.getTopicFlowNode().TOPIC_KTJT:t.businessMap&&(e.isMainPrinUser=t.businessMap.MAIN_USER),o.showFlag.isMainPrinUser=!0,o.showFlag.expertEdit=!0;break;case flowcommon.getTopicFlowNode().TOPIC_LXDW:case flowcommon.getTopicFlowNode().TOPIC_QDHT:case flowcommon.getTopicFlowNode().TOPIC_YJSS:case flowcommon.getTopicFlowNode().TOPIC_NBCS:case flowcommon.getTopicFlowNode().TOPIC_YFZL:e.showUploadBT=!0,o.initFileUpload(i.mainTypeValue().TOPIC,i.mainTypeValue().TOPIC,i.mainTypeValue().TOPIC);break;case flowcommon.getTopicFlowNode().TOPIC_JHTC:e.businessTr=!0;break;case flowcommon.getTopicFlowNode().TOPIC_GZFA:e.businessTr=!0,t.businessMap&&(e.isMainPrinUser=t.businessMap.MAIN_USER);break;case flowcommon.getTopicFlowNode().TOPIC_ZLGD:e.businessTr=!0,o.showFlag.isMainPrinUser=!0,o.showFlag.expertEdit=!0}}return{findOrgUser:o,createTopic:n,startFlow:a,initFlowDeal:r,initFlowNode:c,initMyGird:s,initDetail:l}}angular.module("app").factory("topicSvc",t),t.$inject=["$http","bsWin","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.title="课题研究成果鉴定会工作方案",s.workplan={},n.params.topicId&&(s.workplan.topicId=n.params.topicId),function(){s.workplan.topicId&&o.findByTopicId(s.workplan.topicId,function(t){s.workplan=t,s.workplan.topicId=n.params.topicId,s.initFileUpload()})}(),s.saveWorkPlan=function(){o.save(s.workplan,function(e){e.flag||"ok"==e.reCode?(s.workplan=e.reObj,t.alert("保存成功！")):t.error(e.reMsg)})},s.initFileUpload=function(){s.workplan.id||a.$watch("vm.workplan.id",function(t,e){t&&t!=e&&!s.initUploadOptionSuccess&&s.initFileUpload()}),s.sysFile={businessId:s.workplan.id,mainId:s.workplan.topicId,mainType:r.mainTypeValue().TOPIC,sysfileType:r.mainTypeValue().TOPIC_WORKPLAN,sysBusiType:r.mainTypeValue().TOPIC_WORKPLAN},r.initUploadOptions({inputId:"sysfileinput",vm:s})},s.bookMeeting=function(){s.workplan.id?n.go("room",{businessId:s.workplan.id,businessType:"TOPIC_WP"}):t.alert("请先保存当前信息！")},s.selectExpert=function(){s.workplan.id?n.go("expertReviewEdit",{businessId:n.params.topicId,minBusinessId:s.workplan.id,businessType:"TOPIC"}):t.alert("请先保存当前信息，再继续操作！")},s.updateBookRoom=function(t){s.meetingList||e.findAllMeeting(function(t){s.meetingList=t}),$.each(s.workplan.roomDtoList,function(e,i){t==i.id&&(s.roombook=i)}),$("#roomBookDetailWindow").kendoWindow({width:"50%",height:"620px",title:"会议预定信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.saveRoom=function(){i.saveRoom(s.roombook,function(e){e.flag||"ok"==e.reCode?($.each(s.workplan.roomDtoList,function(t,i){s.roombook.id==i.id&&(i=e.reObj)}),t.success("操作成功！",function(){s.onRoomClose()})):t.error(e.reMsg)})},s.onRoomClose=function(){window.parent.$("#roomBookDetailWindow").data("kendoWindow").close()}}angular.module("app").controller("workPlanEditCtrl",t),t.$inject=["bsWin","meetingSvc","roomSvc","workPlanSvc","$state","$scope","sysfileSvc"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/workPlan/initByTopicId",params:{topicId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/workPlan",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{findByTopicId:i,save:o}}angular.module("app").factory("workPlanSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="用户列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteUser(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},o.queryUser=function(){e.queryUser(o)},o.resetPwd=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var n=[],a=0;a<t.length;a++)n.push(t[a].value);var r=n.join(",");i.confirm({title:"温馨提示",message:"确认重置密码？",onOk:function(){e.resetPwd(o,r)}})}},function(){e.grid(o)}()}angular.module("app").controller("userCtrl",t),t.$inject=["$location","userSvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="新增用户",n.isuserExist=!1,n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="编辑用户"),function(){n.isUpdate?e.getUserById(n):e.initZtreeClient(n),e.getOrg(function(t){n.org={},n.org=t})}(),n.create=function(){if(common.initJqValidation(),$("form").valid()){var t=e.getZtreeChecked(),i=$linq(t).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();n.model.roleDtoList=i,e.createUser(n.model,n.isSubmit,function(t){t.flag||"ok"==t.reCode?(n.model.id||(n.model.id=t.idCode),o.success("操作成功！")):o.error(t.reMsg)})}},n.update=function(){e.updateUser(n)}}angular.module("app").controller("userEditCtrl",t),t.$inject=["$location","userSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(i,o){var n={method:"put",url:p+"/resetPwd",params:{ids:o}},a=function(t){e.success("重置密码成功！"),i.gridOptions.dataSource.read()};common.http({vm:i,httpOptions:n,success:a,$http:t})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i=u(),o=$linq(i).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();e.model.roleDtoList=o;var n={method:"put",url:p,data:e.model},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:p,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/user",data:e},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"post",url:rootPath+"/org/listAll"},o=function(t){
void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function s(e){var i={method:"post",url:f=rootPath+"/role/findAllRoles"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var i={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},o=$linq(t.data).select(function(t){return{id:t.id,name:t.roleName}}).toArray(),n={id:"",name:"角色集合",children:o};$.fn.zTree.init($("#zTree"),i,n),e.isUpdate&&m(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e){var i={method:"post",url:rootPath+"/user/findUserById",params:{userId:e.id}},o=function(t){e.model=t.data,e.isUpdate&&s(e)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(p+"/fingByOData?$orderby=userSort",$("#usersform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"loginName",title:"登录名",width:100,filterable:!1},{field:"displayName",title:"显示名",width:100,filterable:!1},{field:"orgDto.name",title:"所属部门",width:100,filterable:!1},{field:"userIP",title:"登录IP",width:160,filterable:!1},{field:"lastLogin",title:"最后登录时间",width:160,filterable:!1},{field:"",title:"所属角色",width:160,filterable:!1,template:function(t){if(t.roleDtoList){for(var e="",i=0,o=t.roleDtoList.length;i<o;i++)e+=0==i?t.roleDtoList[i].roleName:", "+t.roleDtoList[i].roleName;return e}return" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function d(t){t.gridOptions.dataSource.read()}function u(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function m(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),i=$linq(t.model.roleDtoList).select(function(t){return t.roleName}).toArray(),o=e.getNodesByParam("level",1,null),n=$linq(o).where(function(t){return $linq(i).contains(t.name)}).toArray(),a=0,r=n.length;a<r;a++)e.checkNode(n[a],!0,!0)}var p=rootPath+"/user",f=rootPath+"/role/fingByOData";rootPath;return{grid:c,getUserById:l,initZtreeClient:s,createUser:a,deleteUser:n,updateUser:o,getOrg:r,queryUser:d,getZtreeChecked:u,resetPwd:i}}angular.module("app").factory("userSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.work={},n.title="项目基本信息",n.work.signId=i.params.signid,function(){e.initPage(n)}(),n.create=function(){e.createWP(n,!1)}}angular.module("app").controller("workprogramBaseEditCtrl",t),t.$inject=["$location","workprogramSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.work={},s.model={},s.title="评审方案编辑",s.startDateTime=new Date("2006/6/1 08:00"),s.endDateTime=new Date("2030/6/1 21:00"),s.work.signId=e.params.signid,s.work.id="",s.sign={},s.unSeledWork={},s.searchSign={},s.businessFlag={isSelfReview:!1,isSingleReview:!0,isMainWorkProj:!1,isLoadMeetRoom:!1,isReveiwAWP:!1},function(){s.showAll=!0,t.initPage(s),$("#wpTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)})}(),s.initFileUpload=function(){s.work.id||n.$watch("vm.work.id",function(t,e){t&&t!=e&&!s.initUploadOptionSuccess&&s.initFileUpload()}),s.sysFile={businessId:s.work.id,mainId:s.work.signId,mainType:o.mainTypeValue().SIGN,sysfileType:o.mainTypeValue().WORKPROGRAM,sysBusiType:o.mainTypeValue().WORKPROGRAM},o.initUploadOptions({inputId:"sysfileinput",vm:s})},s.reviewTypeChange=function(){"专家评审会"==s.work.reviewType?"合并评审"==s.work.isSigle&&(s.work.isMainProject=9):"自评"==s.work.reviewType?"合并评审"==s.work.isSigle&&(s.work.isSigle="单个评审",common.alert({vm:s,msg:"自评方案不能进行合并评审！",colseDialog:!0})):s.businessFlag.isMainWorkProj&&!s.businessFlag.isSingleReview&&"单个评审"==s.work.isSigle&&i.confirm({title:"询问提示",message:"该项目已经关联其他合并评审会关联，您确定要改为单个评审吗？",onOk:function(){$(".confirmDialog").modal("hide"),s.work.isMainProject="0",t.deleteAllMerge(e.params.signid,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！"):i.error("操作失败！")})},onCancel:function(){s.work.isSigle="合并评审",$(".confirmDialog").modal("hide")}})},s.onWorkClose=function(){window.parent.$(".workPro").data("kendoWindow").close()},s.formReset=function(){s.searchSign={}},s.filterSign=function(t){var e=!0;if(s.searchSign.projectname&&-1==t.projectname.indexOf(s.searchSign.projectname)&&(e=!1),e&&s.searchSign.reviewstage&&-1==t.reviewstage.indexOf(s.searchSign.reviewstage)&&(e=!1),e)return t},s.initMergeWP=function(){s.work.id?(t.initMergeInfo(s,s.work.signId),$("#mergeSign").kendoWindow({width:"75%",height:"700px",title:"合并评审",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):i.alert("请先保存工作方案！")},s.chooseSign=function(){var e=$("input[name='mergeSign']:checked");if(0==e.length)i.alert("请选择要合并评审的项目！");else{var o=[];$.each(e,function(t,e){o.push(e.value)}),t.chooseSign(s.work.signId,o.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(s,s.work.signId),i.alert(e.reMsg)})}},s.cancelSign=function(){var e=$("input[name='cancelMergeSignid']:checked");if(0==e.length)i.alert("请选择要取消合并评审的项目！");else{var o=[];$.each(e,function(t,e){o.push(e.value)})}t.cancelMergeSign(s.work.signId,o.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(s,s.work.signId),i.alert(e.reMsg)})},s.addTimeStage=function(){s.work.id?e.go("room",{businessId:s.work.id,businessType:"SIGN_WP"}):i.alert("请先保存！")},s.updateBookRoom=function(t){s.meetingList||a.findAllMeeting(function(t){s.meetingList=t}),$.each(s.work.roomBookingDtos,function(e,i){t==i.id&&(s.roombook=i)}),$("#roomBookDetailWindow").kendoWindow({width:"50%",height:"620px",title:"会议预定信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.saveRoom=function(){r.saveRoom(s.roombook,function(t){t.flag||"ok"==t.reCode?($.each(s.work.roomBookingDtos,function(e,i){s.roombook.id==i.id&&(s.roombook=t.reObj,s.work.roomBookingDtos[e].rbDate=s.roombook.rbDate)}),i.success("操作成功！",function(){s.onRoomClose()})):i.error(t.reMsg)})},s.onRoomClose=function(){window.parent.$("#roomBookDetailWindow").data("kendoWindow").close()},s.findUsersByOrgId=function(e){t.findUsersByOrgId(s,e)},s.create=function(){common.initJqValidation($("#work_program_form")),$("#work_program_form").valid()?t.createWP(s.work,!1,s.iscommit,function(t){t.flag||"ok"==t.reCode?(s.work.id=t.reObj.id,"自评"==t.reObj.reviewType&&(s.businessFlag.isSelfReview=!0),"合并评审"==t.reObj.isSigle&&(s.businessFlag.isSingleReview=!1),"9"==t.reObj.isMainProject&&(s.businessFlag.isMainWorkProj=!0),i.success("操作成功！")):i.error(t.reMsg)}):i.alert("表格填写不正确，请检查相应的必填项信息！")},s.selectExpert=function(){s.work.id?e.go("expertReviewEdit",{businessId:s.work.signId,minBusinessId:s.work.id,businessType:"SIGN"}):i.alert("请先保存当前信息，再继续操作！")}}angular.module("app").controller("workprogramEditCtrl",t),t.$inject=["workprogramSvc","$state","bsWin","sysfileSvc","$scope","meetingSvc","roomSvc"]}(),function(){"use strict";function t(t,e,i){function o(e,i){var o={method:"post",url:rootPath+"/signView/getMergeSignBySignId",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/signView/unMergeWPSign",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(t,e){n(e,function(e){t.unMergeSign=[],t.unMergeSign=e}),o(e,function(e){t.mergeSign=[],t.mergeSign=e})}function r(e,i,o){var n={method:"post",url:rootPath+"/signView/cancelMergeSign",params:{signId:e,cancelIds:i,mergeType:"1"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function s(e,i,o){var n={method:"post",url:rootPath+"/signView/mergeSign",params:{signId:e,mergeIds:i,mergeType:"1"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function l(e,i){var o={method:"post",url:rootPath+"/signView/deleteAllMerge",params:{signId:e,mergeType:"1"}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(e){var i={method:"get",url:rootPath+"/room/meeting"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function d(e){var i={method:"get",url:common.format(h+"/findCcompanys")},o=function(t){e.companys={},e.companys=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function u(e,i){var o={};"main"==i&&(o.orgId=e.work.reviewDept);var n={method:"get",url:rootPath+"/user/findUsersByOrgId",params:o},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){"main"==i&&(e.mainUserList={},e.mainUserList=t.data)}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}function m(o){var n={method:"post",url:rootPath+"/workprogram/html/initWorkProgram",params:{signId:o.work.signId}},a=function(t){null!=t.data&&""!=t.data&&(o.work=t.data.eidtWP,o.work.expertDtoList&&o.work.expertDtoList.length>0&&(!o.work.expertCost||o.work.expertCost<1e3*o.work.expertDtoList.length)&&(o.work.expertCost=1e3*o.work.expertDtoList.length),o.model.workProgramDtoList={},t.data.WPList&&t.data.WPList.length>0&&(o.model.workProgramDtoList=t.data.WPList),console.log(o.model.workProgramDtoList[0]),"1"==o.work.branchId&&d(o),o.work.signId=e.params.signid,o.work.projectType&&(o.work.projectTypeDicts=i.topSelectChange(o.work.projectType,i.DICT.PROJECTTYPE.dicts)),"自评"==o.work.reviewType&&(o.businessFlag.isSelfReview=!0),"合并评审"==o.work.isSigle&&(o.businessFlag.isSingleReview=!1),"9"==o.work.isMainProject&&(o.businessFlag.isMainWorkProj=!0),"合并评审"!=o.work.isSigle||"0"!=o.work.isMainProject&&0!=o.work.isMainProject||(o.businessFlag.isReveiwAWP=!0),o.initFileUpload())};common.http({vm:o,$http:t,httpOptions:n,success:a})}function p(e,i,o,n){o=!0,$("#studyBeginTime").val()&&(e.studyBeginTimeStr=$("#studyBeginTime").val()),$("#studyEndTime").val()&&(e.studyEndTimeStr=$("#studyEndTime").val()),$("#studyAllDay").val()&&$("#studyBeginTime").val()&&(e.studyBeginTime=$("#studyAllDay").val()+" "+$("#studyBeginTime").val()+":00"),$("#studyAllDay").val()&&$("#studyEndTime").val()&&(e.studyEndTime=$("#studyAllDay").val()+" "+$("#studyEndTime").val()+":00");var a={method:"post",url:rootPath+"/workprogram/addWork",data:e,params:{isNeedWorkProgram:i}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r,onError:function(t){o=!1}})}function f(e,i){var o={method:"delete",url:rootPath+"/room",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i()};common.http({$http:t,httpOptions:o,success:n})}var h=rootPath+"/company";return{initPage:m,createWP:p,findCompanys:d,findUsersByOrgId:u,deleteBookRoom:f,findAllMeeting:c,initMergeInfo:a,getMergeSignBySignId:o,unMergeWPSign:n,chooseSign:s,cancelMergeSign:r,deleteAllMerge:l}}angular.module("app").factory("workprogramSvc",t),t.$inject=["$http","$state","$rootScope"]}(),function(){"use strict";function t(t,e){var i=this;i.title="工作日列表",function(){e.grid(i)}(),i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteWorkday(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryWorkday=function(){e.queryWorkday(i)},i.ResetWorkday=function(){e.clearValue(i)}}angular.module("app").controller("workdayCtrl",t),t.$inject=["$location","workdaySvc"]}(),function(){"use strict";function t(t,e){function i(t){var e=$("#workdayForm").find("input,select");$.each(e,function(t,e){e.value=""}),t.gridOptions.dataSource.read()}function o(e){var i={method:"get",url:c+"/getWorkdayById",params:{id:e.id}},o=function(t){e.workday=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){t.gridOptions.dataSource.read()}function a(e){var i={method:"post",url:c+"/createWorkday",data:e.workday},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"put",url:c,data:e.workday},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e,i){var o={method:"delete",url:c,data:i},n=function(t){e.gridOptions.dataSource.read()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"/findByOdataObj",$("#workdayForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"dates",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"dates",title:"时间",width:200,format:"{0:yyyy-MM-dd}",filterable:!1},{field:"",title:"状态",width:100,filterable:!1,template:function(t){return t.status?"1"==t.status?"调休":"2"==t.status?"加班":void 0:""}},{field:"remark",title:"备注",width:140,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,columns:o,dataBound:i,resizable:!0}}var c=rootPath+"/workday",d="#/workday";return{grid:l,createWorkday:a,getWorkdayById:o,updateWorkday:r,deleteWorkday:s,queryWorkday:n,clearValue:i}}angular.module("app").factory("workdaySvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加工作日",o.id=i.params.id,o.workday={},o.workday.status="1",o.id&&(o.isUpdate=!0,o.title="更新工作日"),function(){o.isUpdate&&e.getWorkdayById(o)}(),o.create=function(){e.createWorkday(o)},o.update=function(){e.updateWorkday(o)}}angular.module("app").controller("workdayEditCtrl",t),t.$inject=["$location","workdaySvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="固定资产申购流程",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteAssertStorageBusiness(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}(),i.searchForm=function(){i.gridOptions.dataSource.read()},i.formReset=function(){i.searchModel={}}}angular.module("app").controller("assertStorageBusinessCtrl",t),t.$inject=["$location","assertStorageBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(t){if(r.conditions.length>0){return r.conditions.forEach(function(t,e){t.goodsName=$("#goodsName"+t.sort).val(),t.specifications=$("#specifications"+t.sort).val(),t.models=$("#models"+t.sort).val(),t.orgCompany=$("#orgCompany"+t.sort).val(),t.evaluate=$("#evaluate"+t.sort).val(),t.goodsNumber=$("#goodsNumber"+t.sort).val(),t.applyDept=r.model.applyDept,t.operator=r.model.operator,t.businessId=$("#businessId").val()}),!0}return!1}function a(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}var r=this;r.model={},r.conMaxIndex=0,r.conditions=new Array,r.title="添加固定资产申购流程",r.isuserExist=!1,r.businessId=i.params.businessId,r.showFlag={addBooksDeatail:!0,modBooksDetail:!0,bookBuyApplyTr:!1,bookBuyBzTr:!0,bookBuyFgzrTr:!0,bookBuyZrTr:!0,bookBuyYsrk:!0},r.businessId&&(r.isUpdate=!0,r.showFlag.modBooksDetail=!0,r.showFlag.addBooksDeatail=!1,r.title="更新图书采购申请业务信息",$("#businessId").val(r.businessId)),r.create=function(){e.createAssertStorageBusiness(r)},r.update=function(){e.updateAssertStorageBusiness(r)},r.addCondition=function(){r.condition={},r.showFlag.addBooksDeatail?r.condition.sort=r.conMaxIndex+1:(r.conMaxIndex=r.conditions.length,r.condition.sort=r.conditions.length+1),r.conditions.push(r.condition),r.conMaxIndex++},r.removeCondition=function(){var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],n=0;n<t.length;n++)$.each(r.conditions,function(e,o){t[n].value==o.sort&&(o.id?i.push(o.id):r.conditions.splice(e,1))});i.length>0?e.deleteSelConditions(i.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(o.success("操作成功！"),$.each(i,function(t,e){$.each(r.conditions,function(t,i){e==i.sort&&r.conditions.splice(t,1)})})):o.error(t.reMsg)}):o.success("操作成功！")}}):o.alert("请选择要删除的抽取条件！")},r.saveCondition=function(){n(!1)?e.saveGoodsDetailBusinessDetail(r.conditions,function(t){t.flag||"ok"==t.reCode?($("#businessId").val(t.reObj.businessId),o.success("保存成功！")):o.error(t.reMsg)}):o.error("请添加后再保存")},r.startFlow=function(){o.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){n(!1)?e.startFlow(r.conditions,r.isCommit,function(t){t.flag||"ok"==t.reCode?o.alert("保存成功！",function(){i.go("myAssertStorageBusiness")}):o.alert(t.reMsg)}):o.error("请添加图书信息后再发起流程！")}})},r.checkBookNum=function(t){var e="bookNumber"+t;if(!a($("#"+e).val()))return void $("span[data-valmsg-for='"+e+"']").html("图书数量只能输入正整数！");$("span[data-valmsg-for='"+e+"']").html("")},r.checkPrice=function(t){var e=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/,i="booksPrice"+t,o="bookNumber"+t;if(!e.test($("#"+i).val()))return $("#"+i).val(""),void $("span[data-valmsg-for='"+i+"']").html("价格只能输入数字！");$("span[data-valmsg-for='"+i+"']").html("");var n=$("#"+i).val(),a=$("#"+o).val();$("#total"+t).val(parseFloat(n)*a)},function(){r.isUpdate&&e.getAssertStorageBusinessById(r)}()}angular.module("app").controller("assertStorageBusinessEditCtrl",t),t.$inject=["$location","assertStorageBusinessSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:c,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:c,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){console.log(e);var o={method:"post",url:rootPath+"/assertStorageBusiness/saveGoodsDetailList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/assertStorageBusiness/startFlow",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"get",url:rootPath+"/assertStorageBusiness/html/findById",params:{id:e.businessKey}},o=function(t){e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(e){var i={method:"get",url:rootPath+"/assertStorageBusiness/html/findById",params:{id:e.businessId}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/assertStorageBusiness/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"businessName",title:"业务流程名称",width:"20%",filterable:!1},{field:"createdDate",title:"创建日期",width:"15%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:140,template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.businessId,e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var c=rootPath+"/assertStorageBusiness",d="#/assertStorageBusinessList";return{grid:l,getAssertStorageBusinessById:s,createAssertStorageBusiness:o,deleteAssertStorageBusiness:i,updateAssertStorageBusiness:e,saveGoodsDetailBusinessDetail:n,startFlow:a,initFlowDeal:r}}angular.module("app").factory("assertStorageBusinessSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="物品明细",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteGoodsDetail(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("goodsDetailCtrl",t),t.$inject=["$location","goodsDetailSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加物品明细",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新物品明细"),o.create=function(){e.createGoodsDetail(o)},o.update=function(){e.updateGoodsDetail(o)},function(){o.isUpdate&&e.getGoodsDetailById(o)}()}angular.module("app").controller("goodsDetailEditCtrl",t),t.$inject=["$location","goodsDetailSvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/goodsDetail/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"get",url:rootPath+"/bookBuyBusiness/html/findById"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({vm:vm,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"goodsCode",title:"goodsCode",width:100,filterable:!0},{field:"goodsName",title:"goodsName",width:100,filterable:!0},{field:"specifications",title:"specifications",width:100,filterable:!0},{field:"models",title:"models",width:100,filterable:!0},{field:"goodsPrice",title:"goodsPrice",width:100,filterable:!0},{field:"evaluate",title:"evaluate",width:100,filterable:!0},{field:"goodsNumber",title:"goodsNumber",width:100,filterable:!0},{field:"assertStorageBusiness",title:"assertStorageBusiness",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/goodsDetail",l="#/goodsDetailList";return{grid:r,getGoodsDetailById:n,createGoodsDetail:o,deleteGoodsDetail:i,updateGoodsDetail:e,getAllStoreAssert:a}}angular.module("app").factory("goodsDetailSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.conMaxIndex=0,o.conditions=new Array,o.title="添加用户资产明细",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新用户资产明细"),o.create=function(){e.createUserAssertDetail(o)},o.update=function(){e.updateUserAssertDetail(o)},o.addCondition=function(){o.condition={},o.condition.sort=o.conMaxIndex+1,o.conditions.push(o.condition),o.conMaxIndex++},function(){o.isUpdate?e.getUserAssertDetailById(o):e.initFillData(function(t){o.goodsDetailDtoList=t.reObj.goodsDetailDtoList})}()}angular.module("app").controller("userAssertDetailAddCtrl",t),t.$inject=["$location","userAssertDetailSvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="用户资产明细",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteUserAssertDetail(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("userAssertDetailCtrl",t),t.$inject=["$location","userAssertDetailSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/userAssertDetail/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"post",url:rootPath+"/userAssertDetail/html/initFillPageData"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"userId",title:"userId",width:100,filterable:!0},{field:"userName",title:"userName",width:100,filterable:!0},{field:"goodId",title:"goodId",width:100,filterable:!0},{field:"goodsName",title:"goodsName",width:100,filterable:!0},{field:"goodsNumber",title:"goodsNumber",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/userAssertDetail",l="#/userAssertDetailList";return{grid:r,getUserAssertDetailById:n,createUserAssertDetail:o,deleteUserAssertDetail:i,updateUserAssertDetail:e,initFillData:a}}angular.module("app").factory("userAssertDetailSvc",t),t.$inject=["$http"]}();