!function(){"use strict";angular.module("app",["ui.router","kendo.directives","angular-loading-bar","ngAnimate","froala"]).filter("trust2Html",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).config(["cfpLoadingBarProvider",function(t){t.parentSelector="#loading-bar-container",t.spinnerTemplate='<div style="position:fixed;width:100%;height:100%;left:0;top:0; z-index:10001;background:rgba(0, 0, 0, 0.3);overflow: hidden;"><div style="position: absolute;top:30%; width: 400px;height:40px;left:50%;"><i class="fa fa-spinner fa-pulse fa-1x fa-fw"></i>数据加载中...</div></div>'}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/welcome"),t.state("welcome",{url:"/welcome",templateUrl:rootPath+"/admin/welcome.html",controller:"adminWelComeCtrl",controllerAs:"vm"}).state("gtasks",{url:"/gtasks",templateUrl:rootPath+"/admin/gtasks.html",controller:"adminCtrl",controllerAs:"vm"}).state("agendaTasks",{url:"/agendaTasks",templateUrl:rootPath+"/admin/agendaTasks.html",controller:"adminAgendaCtrl",controllerAs:"vm"}).state("doingTasks",{url:"/doingTasks",templateUrl:rootPath+"/admin/doingTasks.html",controller:"adminDoTaskCtrl",controllerAs:"vm"}).state("flowDeal",{url:"/flowDeal/:businessKey/:processKey/:taskId/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowDeal/"+t.processKey+".html"},controller:"flowDealCtrl",controllerAs:"vm"}).state("flowDetail",{url:"/flowDetail/:businessKey/:processKey/:taskId/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowDetail/"+t.processKey+".html"},controller:"flowDetailCtrl",controllerAs:"vm"}).state("flowEnd",{url:"/flowEnd/:businessKey/:processKey/:instanceId",templateUrl:function(t){return rootPath+"/flow/flowEnd/"+t.processKey+".html"},controller:"flowEndCtrl",controllerAs:"vm"}).state("addSupp",{url:"/addSupp/:businessId/:businessType/:workId",templateUrl:rootPath+"/addSuppLetter/edit.html",controller:"addSuppLetterCtrl",controllerAs:"vm"}).state("addSuppletterList",{url:"/addSuppletterList/:businessId",templateUrl:rootPath+"/addSuppLetter/list.html",controller:"addSuppLetterListCtrl",controllerAs:"vm"}).state("addSuppLetterEdit",{url:"/addSuppLetterEdit/:id",templateUrl:rootPath+"/addSuppLetter/editUpload.html",controller:"addSuppLetterEditCtrl",controllerAs:"vm"}).state("suppletterList",{url:"/suppletterList",templateUrl:rootPath+"/addSuppLetter/suppLetterList.html",controller:"addSuppLetterQueryCtrl",controllerAs:"vm"}).state("querySuppLetterDetail",{url:"/querySuppLetterDetail/:id",templateUrl:rootPath+"/addSuppLetter/detail.html",controller:"addSuppLetterQueryEditCtrl",controllerAs:"vm"}).state("suppLetterApproveList",{url:"/suppLetterApproveList",templateUrl:rootPath+"/addSuppLetter/suppLetterApproveList.html",controller:"addSuppLetterQueryCtrl",controllerAs:"vm"}).state("suppLetterApproveEdit",{url:"/suppLetterApproveEdit/:id",templateUrl:rootPath+"/addSuppLetter/suppLetterApproveEdit.html",controller:"addSuppLetterQueryEditCtrl",controllerAs:"vm"}).state("registerFile",{url:"/registerFile/:businessId/",templateUrl:rootPath+"/addRegisterFile/list.html",controller:"addRegisterFileCtrl",controllerAs:"vm"}).state("dtasks",{url:"/dtasks",templateUrl:rootPath+"/admin/dtasks.html",controller:"adminDoingCtrl",controllerAs:"vm"}).state("personDtasks",{url:"/personDtasks",templateUrl:rootPath+"/admin/personDtasks.html",controller:"adminPersonDoingCtrl",controllerAs:"vm"}).state("etasks",{url:"/etasks",templateUrl:rootPath+"/admin/etasks.html",controller:"adminEndCtrl",controllerAs:"vm"}).state("role",{url:"/role",templateUrl:rootPath+"/role/html/list.html",controller:"roleCtrl",controllerAs:"vm"}).state("roleEdit",{url:"/roleEdit/:id",templateUrl:rootPath+"/role/html/edit.html",controller:"roleEditCtrl",controllerAs:"vm"}).state("user",{url:"/user",templateUrl:rootPath+"/user/html/list.html",controller:"userCtrl",controllerAs:"vm"}).state("userEdit",{url:"/userEdit/:id",templateUrl:rootPath+"/user/html/edit.html",controller:"userEditCtrl",controllerAs:"vm"}).state("org",{url:"/org",templateUrl:rootPath+"/org/html/list.html",controller:"orgCtrl",controllerAs:"vm"}).state("orgEdit",{url:"/orgEdit/:id",templateUrl:rootPath+"/org/html/edit.html",controller:"orgEditCtrl",controllerAs:"vm"}).state("orgUser",{url:"/orgUser/:id",templateUrl:rootPath+"/org/html/orgUser.html",controller:"orgUserCtrl",controllerAs:"vm"}).state("sysdept",{url:"/sysdept",templateUrl:rootPath+"/sysdept/html/list.html",controller:"sysdeptCtrl",controllerAs:"vm"}).state("sysdeptEdit",{url:"/sysdeptEdit/:id",templateUrl:rootPath+"/sysdept/html/edit.html",controller:"sysdeptEditCtrl",controllerAs:"vm"}).state("sysdeptUser",{url:"/sysdeptUser/:id",templateUrl:rootPath+"/sysdept/html/sysdeptUser.html",controller:"sysdeptUserCtrl",controllerAs:"vm"}).state("log",{url:"/log",templateUrl:rootPath+"/log/html/list.html",controller:"logCtrl",controllerAs:"vm"}).state("config",{url:"/config",templateUrl:rootPath+"/sysConfig/html/list.html",controller:"sysConfigCtrl",controllerAs:"vm"}).state("upload",{url:"/upload/:uploadid",templateUrl:rootPath+"/upload/html/edit.html",controller:"uploadEditCtrl",controllerAs:"vm"}).state("meeting",{url:"/meeting",templateUrl:rootPath+"/meeting/html/list.html",controller:"meetingCtrl",controllerAs:"vm"}).state("meetingEdit",{url:"/meetingEdit/:id",templateUrl:rootPath+"/meeting/html/edit.html",controller:"meetingEditCtrl",controllerAs:"vm"}).state("room",{url:"/room/:businessId/:businessType",templateUrl:rootPath+"/room/html/roomlist.html",controller:"roomCtrl",controllerAs:"vm"}).state("roomCount",{url:"/roomCount/:id",templateUrl:rootPath+"/room/html/countlist.html",controller:"roomCountCtrl",controllerAs:"vm"}).state("company",{url:"/company",templateUrl:rootPath+"/company/html/list.html",controller:"companyCtrl",controllerAs:"vm"}).state("companyEdit",{url:"/companyEdit/:id",templateUrl:rootPath+"/company/html/edit.html",controller:"companyEditCtrl",controllerAs:"vm"}).state("accountPwd",{url:"/accountPwd",templateUrl:rootPath+"/account/html/changePwd.html",controller:"homeCtrl",controllerAs:"vm"}).state("demo",{url:"/demo",templateUrl:rootPath+"/demo/html/list.html",controller:"demoCtrl",controllerAs:"vm"}).state("dict",{url:"/dict",templateUrl:rootPath+"/dict/html/list.html",controller:"dictCtrl",controllerAs:"vm"}).state("dict.edit",{url:"/edit/:id",templateUrl:rootPath+"/dict/html/edit.html",controller:"dictEditCtrl",controllerAs:"vm"}).state("expert",{url:"/expert",templateUrl:rootPath+"/expert/html/queryAllList.html",controller:"expertCtrl",controllerAs:"vm"}).state("expertAudit",{url:"/expertAudit",templateUrl:rootPath+"/expert/html/audit.html",controller:"expertAuditCtrl",controllerAs:"vm"}).state("expertRepeat",{url:"/expertRepeat",templateUrl:rootPath+"/expert/html/repeat.html",controller:"expertRepeatCtrl",controllerAs:"vm"}).state("expertEdit",{url:"/expertEdit/:expertID",templateUrl:rootPath+"/expert/html/edit.html",controller:"expertEditCtrl",controllerAs:"vm"}).state("expertReviewEdit",{url:"/expertReview/:businessId/:minBusinessId/:businessType",templateUrl:rootPath+"/expertReview/html/selectExpert.html",controller:"expertSelectCtrl",controllerAs:"vm"}).state("expertReviewList",{url:"/expertReviewList",templateUrl:rootPath+"/expert/html/reviewList.html",controller:"expertReviewListCtrl",controllerAs:"vm"}).state("addSign",{url:"/addSign",templateUrl:rootPath+"/sign/html/add.html",controller:"signCreateCtrl",controllerAs:"vm"}).state("fillSign",{url:"/fillSign/:signid",cache:"false",templateUrl:rootPath+"/sign/html/fillin.html",controller:"signFillinCtrl",controllerAs:"vm"}).state("listSign",{url:"/listSign",templateUrl:rootPath+"/sign/html/list.html",controller:"signCtrl",controllerAs:"vm"}).state("signFlowDeal",{url:"/signFlowDeal/:signid/:taskId/:processInstanceId",templateUrl:rootPath+"/sign/html/flowDeal.html",controller:"signFlowDealCtrl",controllerAs:"vm"}).state("signFlowDetail",{url:"/signFlowDetail/:signid/:taskId/:processInstanceId",templateUrl:rootPath+"/sign/html/signFlowDetail.html",controller:"signFlowDetailCtrl",controllerAs:"vm"}).state("signDetails",{url:"/signDetails/:signid/:processInstanceId",templateUrl:rootPath+"/sign/html/signDetails.html",controller:"signDetailsCtrl",controllerAs:"vm"}).state("endSignDetail",{url:"/endSignDetail/:signid/:processInstanceId",templateUrl:rootPath+"/sign/html/signEndDetails.html",controller:"signEndCtrl",controllerAs:"vm"}).state("signList",{url:"/signList",templateUrl:rootPath+"/signView/html/signList.html",controller:"adminSignListCtrl",controllerAs:"vm"}).state("selectHeader",{url:"/selectHeader",templateUrl:rootPath+"/sign/html/selectHeader.html",controller:"selectHeaderCtrl",controllerAs:"vm"}).state("pauseProject",{url:"/pauseProject",templateUrl:rootPath+"/projectStop/html/pauseProjectList.html",controller:"pauseProjectCtrl",controllerAs:"vm"}).state("projectStopForm",{url:"/projectStopForm/:signId/:stopId",templateUrl:rootPath+"/projectStop/html/projectStopForm.html",controller:"projectStopFormCtrl",controllerAs:"vm"}).state("reserveAdd",{url:"/reserveAdd",templateUrl:rootPath+"/sign/html/reserveAdd.html",controller:"signReserveAddCtrl",controllerAs:"vm"}).state("reserveList",{url:"/reserveList",templateUrl:rootPath+"/sign/html/reserveList.html",controller:"signReserveCtrl",controllerAs:"vm"}).state("reserveEdit",{url:"/reserveEdit",templateUrl:rootPath+"/sign/html/reserveList.html",controller:"signReserveCtrl",controllerAs:"vm"}).state("workprogramEdit",{url:"/workprogramEdit/:signid",templateUrl:rootPath+"/workprogram/html/edit.html",controller:"workprogramEditCtrl",controllerAs:"vm"}).state("dispatchEdit",{url:"/dispatchEdit/:signid",templateUrl:rootPath+"/dispatch/html/edit.html",controller:"dispatchEditCtrl",controllerAs:"vm"}).state("fileRecordEdit",{url:"/fileRecordEdit/:signid",templateUrl:rootPath+"/fileRecord/html/edit.html",controller:"fileRecordEditCtrl",controllerAs:"vm"}).state("assistPlan",{url:"/assistPlan",templateUrl:rootPath+"/assistPlan/html/manager.html",controller:"assistPlanCtrl",controllerAs:"vm"}).state("officeUserList",{url:"/officeUserList",templateUrl:rootPath+"/officeUser/html/list.html",controller:"officeUserCtrl",controllerAs:"vm"}).state("officeUserEdit",{url:"/officeUserEdit/:officeID",templateUrl:rootPath+"/officeUser/html/edit.html",controller:"officeUserEditCtrl",controllerAs:"vm"}).state("listDept",{url:"/listDept",templateUrl:rootPath+"/dept/html/list.html",controller:"deptCtrl",controllerAs:"vm"}).state("deptEdit",{url:"/deptEdit/:deptId",templateUrl:rootPath+"/dept/html/edit.html",controller:"deptEditCtrl",controllerAs:"vm"}).state("deptOfficeUser",{url:"/deptOfficeUser/:deptId",templateUrl:rootPath+"/dept/html/listOfficeUser.html",controller:"deptOfficeUserCtrl",controllerAs:"vm"}).state("assistUnit",{url:"/assistUnit",templateUrl:rootPath+"/assistUnit/html/assistUnitList.html",controller:"assistUnitCtrl",controllerAs:"vm"}).state("assistUnitEdit",{url:"/assistUnitEdit/:id",templateUrl:rootPath+"/assistUnit/html/assistUnitEdit.html",controller:"assistUnitEditCtrl",controllerAs:"vm"}).state("quartz",{url:"/quartz",templateUrl:rootPath+"/quartz/html/list.html",controller:"quartzCtrl",controllerAs:"vm"}).state("workday",{url:"/workday",templateUrl:rootPath+"/workday/html/list.html",controller:"workdayCtrl",controllerAs:"vm"}).state("workdayEdit",{url:"/workdayEdit/:id",templateUrl:rootPath+"/workday/html/edit.html",controller:"workdayEditCtrl",controllerAs:"vm"}).state("annountment",{url:"/annountment",templateUrl:rootPath+"/annountment/html/list.html",controller:"annountmentCtrl",controllerAs:"vm"}).state("annountmentEdit",{url:"/annountmentEdit/:id",templateUrl:rootPath+"/annountment/html/edit.html",controller:"annountmentEditCtrl",controllerAs:"vm"}).state("annountmentDetail",{url:"/annountmentDetail/:id",templateUrl:rootPath+"/annountment/html/detail.html",controller:"annountmentDetailCtrl",controllerAs:"vm"}).state("annountmentYet",{url:"/annountmentYet",templateUrl:rootPath+"/annountment/html/yetList.html",controller:"annountmentYetCtrl",controllerAs:"vm"}).state("sharingPlatlform",{url:"/sharingPlatlform",templateUrl:rootPath+"/sharingPlatlform/html/list.html",controller:"sharingPlatlformCtrl",controllerAs:"vm"}).state("sharingPlatlformEdit",{url:"/sharingPlatlformEdit/:sharId",templateUrl:rootPath+"/sharingPlatlform/html/edit.html",controller:"sharingPlatlformEditCtrl",controllerAs:"vm"}).state("sharingDetil",{url:"/sharingDetil/:sharId",templateUrl:rootPath+"/sharingPlatlform/html/flowDetail.html",controller:"sharingDetailCtrl",controllerAs:"vm"}).state("sharingPlatlformYet",{url:"/sharingPlatlformYet",templateUrl:rootPath+"/sharingPlatlform/html/yetList.html",controller:"sharingPlatlformYetCtrl",controllerAs:"vm"}).state("financialManager",{url:"/financialManager/:businessId",templateUrl:rootPath+"/financialManager/html/add.html",controller:"financialManagerCtrl",controllerAs:"vm"}).state("findAssistCostTable",{url:"/findAssistCostTable/:signid",templateUrl:rootPath+"/financialManager/html/stageCostTable.html",controller:"assistCostCountCtrl",controllerAs:"vm"}).state("assistCostlist",{url:"/assistCostlist",templateUrl:rootPath+"/financialManager/html/assistCostList.html",controller:"assistCostCountSvcEditCtrl",controllerAs:"vm"}).state("assistCostAdd",{url:"/assistCostAdd/:signid",templateUrl:rootPath+"/financialManager/html/assistCostAdd.html",controller:"assistCostCountCtrl",controllerAs:"vm"}).state("assistCostCountList",{url:"/assistCostCountList",templateUrl:rootPath+"/financialManager/html/assistCostCount.html",controller:"assistCostCountSvcEditCtrl",controllerAs:"vm"}).state("financialManagerList",{url:"/financialManagerList",templateUrl:rootPath+"/financialManager/html/list.html",controller:"financialManagerEditCtrl",controllerAs:"vm"}).state("expertPaymentCountList",{url:"/expertPaymentCountList/:beginTime",templateUrl:rootPath+"/financialManager/html/expertPaymentCount.html",controller:"expertPaymentCountCtrl",controllerAs:"vm"}).state("expertPaymentDetailCountList",{url:"/expertPaymentDetailCountList/:beginTime",templateUrl:rootPath+"/financialManager/html/expertPaymentDetailCount.html",controller:"expertPaymentDetailCountCtrl",controllerAs:"vm"}).state("exportCountList",{url:"/exportCountList",templateUrl:rootPath+"/financialManager/html/expertCount.html",controller:"exportCountCtrl",controllerAs:"vm"}).state("expertRevCondCountList",{url:"/expertRevCondCountList",templateUrl:rootPath+"/financialManager/html/expertReviewCondCount.html",controller:"expertRevConCountCtrl",controllerAs:"vm"}).state("projectCostCountList",{url:"/projectCostCountList",templateUrl:rootPath+"/financialManager/html/projectCostCount.html",controller:"projectCostCountCtrl",controllerAs:"vm"}).state("proCostClassifyCountList",{url:"/proCostClassifyCountList",templateUrl:rootPath+"/financialManager/html/proCostClassifyCount.html",controller:"proCostClassifyCountCtrl",controllerAs:"vm"}).state("proReviewConCountList",{url:"/proReviewConCountList",templateUrl:rootPath+"/financialManager/html/proReviewConCount.html",controller:"proReviewConditionCtrl",controllerAs:"vm"}).state("monthlyNewsletterList",{url:"/monthlyNewsletterList",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyNewsletterList.html",controller:"monthlyNewsletterCtrl",controllerAs:"vm"}).state("monthlyEdit",{url:"/monthlyEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyNewsletterEdit.html",controller:"monthlyNewsletterEditCtrl",controllerAs:"vm"}).state("theMonthsList",{url:"/theMonthsList",templateUrl:rootPath+"/monthlyNewsletter/html/theMonthsList.html",controller:"monthlyNewsletterCtrl",controllerAs:"vm"}).state("monthlyFindByMultiyear",{url:"/monthlyFindByMultiyear/:reportMultiyear",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearList.html",controller:"monthlyMultiyearCtrl",controllerAs:"vm"}).state("monthlyMultiyAppoveList",{url:"/monthlyMultiyAppoveList/:reportMultiyear",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyAppoveList.html",controller:"monthlyMultiyearCtrl",controllerAs:"vm"}).state("monthlyMultiyearEdit",{url:"/monthlyMultiyearEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearAdd.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("monthlyMultiAppoveEdit",{url:"/monthlyMultiAppoveEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyAppoveEdit.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("monthlyMultiyFileList",{url:"/monthlyMultiyFileList/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyFileList.html",controller:"monthlyMultiyearCtrl",controllerAs:"vm"}).state("monthlyMultiyearDetail",{url:"/monthlyMultiyearDetail/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyMultiyearDetail.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("uploadMonthly",{url:"/uploadMonthly/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyUpload.html",controller:"monthlyMultiyearEditCtrl",controllerAs:"vm"}).state("monthlyHistoryList",{url:"/monthlyHistoryList",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyHistoryList.html",controller:"monthlyHistoryCtrl",controllerAs:"vm"}).state("monthlyHistoryEdit",{url:"/monthlyHistoryEdit/:id",templateUrl:rootPath+"/monthlyNewsletter/html/monthlyHistoryAdd.html",controller:"monthlyHistoryEditCtrl",controllerAs:"vm"}).state("approveWindow",{url:"/approveWindow/:signId/:projectName/:id",templateUrl:rootPath+"/reviewProjectAppraise/html/approveWindow.html",controller:"approveWindowCtrl",controllerAs:"vm"}).state("reviewProjectAppraiseList",{url:"/reviewProjectAppraiseList/:id",templateUrl:rootPath+"/reviewProjectAppraise/html/list.html",controller:"reviewProjectAppraiseCtrl",controllerAs:"vm"}).state("reviewProjectAppraiseEdit",{url:"/reviewProjectAppraiseEdit",templateUrl:rootPath+"/reviewProjectAppraise/html/edit.html",controller:"reviewProjectAppraiseEditCtrl",controllerAs:"vm"}).state("approveList",{url:"/approveList",templateUrl:rootPath+"/reviewProjectAppraise/html/approveList.html",controller:"approveListCtrl",controllerAs:"vm"}).state("libraryAdd",{url:"/libraryAdd/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryAdd.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("archivesCityEdit",{url:"/archivesCityEdit/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesCityEdit.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("archivesProjectRead",{url:"/archivesProjectRead/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesProjectList.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("archivesLibraryProjectEdit",{url:"/archivesLibraryProjectEdit/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryEdit.html",controller:"archivesLibraryEditCtrl",controllerAs:"vm"}).state("archivesLibraryList",{url:"/archivesLibraryList/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryList.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("archivesLibraryDetail",{url:"/archivesLibraryDetail/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesLibraryDetail.html",controller:"archivesLibraryEditCtrl",controllerAs:"vm"}).state("archivesCityList",{url:"/archivesCityList/:id",templateUrl:rootPath+"/archivesLibrary/html/archivesCityList.html",controller:"archivesLibraryCtrl",controllerAs:"vm"}).state("pluginfile",{url:"/pluginfile",templateUrl:rootPath+"/file/html/pluginfile.html",controller:"pluginfileCtrl",controllerAs:"vm"}).state("takeUser",{url:"/takeUser",templateUrl:rootPath+"/personalCenter/html/takeUser.html",controller:"takeUserCtrl",controllerAs:"vm"}).state("fileLibrary",{url:"/fileLibrary",templateUrl:rootPath+"/fileLibrary/html/fileLibrary.html",controller:"fileLibraryCtrl",controllerAs:"vm"}).state("fileLibrary.fileList",{url:"/fileList/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/fileList.html",controller:"fileLibraryEditCtrl",controllerAs:"vm"}).state("fileLibrary.fileEdit",{url:"/fileEdit/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/fileEdit.html",controller:"fileLibraryEditCtrl",controllerAs:"vm"}).state("policyLibrary",{url:"/policyLibrary",templateUrl:rootPath+"/fileLibrary/html/policyLibrary.html",controller:"policyLibraryCtrl",controllerAs:"vm"}).state("policyLibrary.policyList",{url:"/policyList/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/policyList.html",controller:"policyLibraryEditCtrl",controllerAs:"vm"}).state("policyLibrary.policyEdit",{url:"/policyEdit/:parentId/:fileId",templateUrl:rootPath+"/fileLibrary/html/policyEdit.html",controller:"policyLibraryEditCtrl",controllerAs:"vm"}).state("bookBuyBusinessEdit",{url:"/bookBuyBusinessEdit/:businessId",templateUrl:rootPath+"/bookBuyBusiness/html/bookBuyBusinessEdit.html",controller:"bookBuyBusinessEditCtrl",controllerAs:"vm"}).state("myBookBuyBusiness",{url:"/myBookBuyBusiness",templateUrl:rootPath+"/bookBuyBusiness/html/bookBuyBusinessList.html",controller:"bookBuyBusinessCtrl",controllerAs:"vm"}).state("assertStorageBusinessEdit",{url:"/assertStorageBusinessEdit/:businessId",templateUrl:rootPath+"/assertStorageBusiness/html/assertStorageBusinessEdit.html",controller:"assertStorageBusinessEditCtrl",controllerAs:"vm"}).state("myAssertStorageBusiness",{url:"/myAssertStorageBusiness",templateUrl:rootPath+"/assertStorageBusiness/html/assertStorageBusinessList.html",controller:"assertStorageBusinessCtrl",controllerAs:"vm"}).state("assertApplyUse",{url:"/assertApplyUse",templateUrl:rootPath+"/userAssertDetail/html/userAssertDetailAdd.html",controller:"userAssertDetailAddCtrl",controllerAs:"vm"}).state("addTopic",{url:"/topicInfo/:id",templateUrl:rootPath+"/topicInfo/html/add.html",controller:"topicAddCtrl",controllerAs:"vm"}).state("myTopic",{url:"/myTopic",templateUrl:rootPath+"/topicInfo/html/myList.html",controller:"myTopicCtrl",controllerAs:"vm"}).state("header",{url:"/header",templateUrl:rootPath+"/header/html/list.html",controller:"headerCtrl",controllerAs:"vm"}).state("headerEdit",{url:"/headerEdit/:headerType",templateUrl:rootPath+"/header/html/selectHeader.html",controller:"headerEditCtrl",controllerAs:"vm"}).state("statisticalList",{url:"/statisticalList/:headerType",templateUrl:rootPath+"/header/html/statisticalList.html",controller:"statisticalListCtrl",controllerAs:"vm"}).state("statistical",{url:"/statistical",templateUrl:rootPath+"/statistical/html/list.html",controller:"statisticalCtrl",controllerAs:"vm"}).state("editWorkPlan",{url:"/editWorkPlan/:topicId",templateUrl:rootPath+"/workPlan/html/edit.html",controller:"workPlanEditCtrl",controllerAs:"vm"}).state("editFiling",{url:"/editFiling/:topicId",templateUrl:rootPath+"/filing/html/edit.html",controller:"filingEditCtrl",controllerAs:"vm"}).state("reviewFee",{url:"/reviewFee",templateUrl:rootPath+"/reviewFee/html/list.html",controller:"reviewFeeCtrl",controllerAs:"vm"})}]).run(function(t,e,i,o,n){t.getTBHeadName=function(t,e,i){return!e||"9"!=e||"项目建议书"!=t&&"可行性研究报告"!=t?t?"项目概算"==t?"概算审核"+i:t+i:i:"评估论证"+i},t.$state=i,t.$stateParams=o,t.$on("$stateChangeSuccess",function(e,i,o,n,a){t.previousState_name=n.name,t.previousState_params=a,"signFlowDeal"!=n.name&&"flowDeal"!=n.name||(t.$flowUrl=n.name,t.$flowParams=a)}),t.back=function(){t.previousState_name?i.go(t.previousState_name,t.previousState_params):i.go("welcome")},t.backtoflow=function(){t.$flowUrl?i.go(t.$flowUrl,t.$flowParams):i.go("gtasks")},t.topSelectChange=function(t,e,i){if(void 0!=e)for(var o=0;o<e.length;o++)if(i&&"code"==i){if(e[o].dictCode==t)return e[o].dicts}else if(e[o].dictName==t)return e[o].dicts},t.initInputValue=function(t,e){return t.target.checked&&!e?1:e},t.range=function(t){if(t)return new Array(t)},t.previewFile=function(t,e){var i,o,a;"office"==e?(i=rootPath+"/file/editFile?sysFileId="+t,o="82%",a="830px"):"pdf"==e?(i=rootPath+"/contents/libs/pdfjs-dist/web/viewer.html?file="+rootPath+"/file/preview/"+t,o="82%",a="830px"):"image"==e&&(i=rootPath+"/file/preview/"+t,o="75%",a="auto"),i?($("#iframePreview").attr("src",i),$("#previewModal").kendoWindow({width:o,height:a,title:"",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):n.alert("该文件不支持在线预览")},kendo.culture("zh-CN"),common.getTaskCount({$http:e}),common.initDictData({$http:e,scope:t})})}(),function(){"use strict";var t=angular.module("app");t.directive("goBack",function(){return{restrict:"AE",template:'<a class="btn btn-sm btn-primary" href="javascript:void(0);" ng-click="back();"><span class="glyphicon glyphicon-chevron-left"></span>返回</a>'}}),t.directive("goBackFlow",function(){return{restrict:"AE",template:'<button class="btn btn-sm btn-danger" ng-click="backtoflow();"><span class="glyphicon glyphicon-chevron-left"></span>返回流程</button>'}}),t.directive("flowFileButton",function(){return{restrict:"AE",template:'<button class="btn btn-sm btn-primary" ng-click="vm.clickUploadBt();" id="upload_file_bt">上传附件</button> <button class="btn btn-sm btn-primary" ng-click="vm.clickDetailBt();" id="detail_file_bt">查看附件</button>'}})}(),function(){"use strict";function t(t,e,i){var o=this;o.title="登记补充资料",o.sign={},o.addRegisters=[],o.businessId=i.params.businessId,o.addRegisterFile=function(){o.addRegister={},o.addRegister.businessId=o.businessId,o.addRegister.id=common.uuid(),o.addRegisters.push(o.addRegister)},o.saveRegisterFile=function(){e.saveRegisterFile(o.addRegisters,function(e){e.flag||"ok"==e.reCode?(t.alert("操作成功"),o.addRegisters=e.reObj):t.alert(e.reMsg)})},o.deleteRegisterFile=function(){var i=$("#addRegistersTable input[name='addRegistersCheck']:checked");if(i.length<1)t.alert("请选择要删除的记录！");else{for(var n=[],a=0;a<i.length;a++)o.addRegisters.forEach(function(t,e){t.id&&i[a].value==t.id&&(n.push(i[a].value),o.addRegisters.splice(e,1))});n.length>0&&e.deleteByIds(n.join(","),function(e){t.alert("删除成功！")})}},o.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},function(){i.params.businessId&&e.initAddRegisterFile(i.params.businessId,function(t){t&&(o.addRegisters=t)})}()}angular.module("app").controller("addRegisterFileCtrl",t),t.$inject=["bsWin","addRegisterFileSvc","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加登记补充资料",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新登记补充资料"),o.create=function(){e.createAddRegisterFile(o)},o.update=function(){e.updateAddRegisterFile(o)},function(){o.isUpdate&&e.getAddRegisterFileById(o)}()}angular.module("app").controller("addRegisterFileEditCtrl",t),t.$inject=["$location","addRegisterFileSvc","$state"]}(),function(){"use strict";function t(t){function e(t,e){$("#addRegister").kendoWindow({width:"70%",height:"660px",title:"意见选择",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()}function i(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function o(e,i){var o={method:"post",url:rootPath+"/addRegisterFile/save",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/addRegisterFile/findByBusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"delete",url:r+"/deleteFile",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}var r=rootPath+"/addRegisterFile";return{initAddRegisterFile:n,saveRegisterFile:o,isUnsignedInteger:i,initRegisterWinDow:e,deleteByIds:a}}angular.module("app").factory("addRegisterFileSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.suppletter={},r.suppletter.businessId=o.params.businessId,r.suppletter.businessType=o.params.businessType,r.suppletter.workId=o.params.workId,r.suppletter.id=o.params.id,r.title="登记补充资料",r.businessFlag={isInitFileOption:!1},function(){e.initAddSuppLetter(r)}(),r.initFileUpload=function(){r.suppletter.id||a.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.suppletter.id,mainId:r.suppletter.id,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().AADSUPP_FILE,sysBusiType:i.mainTypeValue().AADSUPP_FILE},i.initUploadOptions({inputId:"sysfileinput",vm:r})},r.saveAddSuppletter=function(){e.createAddSuppLetter(r)},r.addSuppContent=function(){if(r.suppletter.id){r.showsupp=!0;$("#addsuppletter").kendoWindow({width:"60%",height:"90%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),e.findByBusinessId(r)}else n.alert("请先保存业务数据")},r.del=function(t){common.confirm({vm:r,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteAddSuppLetter(r,t)}})},r.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:r,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");r.del(o)}}}angular.module("app").controller("addSuppLetterCtrl",t),t.$inject=["$location","addSuppLetterSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加登记补充资料",n.isuserExist=!1,n.id=o.params.id,n.suppletter={},n.suppletter.businessId=o.params.businessId,n.suppletter.businessType=o.params.businessType,n.suppletter.id=o.params.id,n.id&&(n.isUpdate=!0,n.title="更新登记补充资料"),n.businessFlag={isInitFileOption:!1},n.initFileUpload=function(){n.suppletter.id||$scope.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.suppletter.id,mainId:n.suppletter.id,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().AADSUPP_FILE,sysBusiType:i.mainTypeValue().AADSUPP_FILE},i.initUploadOptions({inputId:"sysfileinput",vm:n})},n.addSuppContent=function(){if(n.suppletter.id){n.showsupp=!0;$("#addsuppletter").kendoWindow({width:"60%",height:"90%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),e.findByBusinessId(n)}else bsWin.alert("请先保存业务数据")},n.submitAddSuppletter=function(){e.submitAddSuppLetter(n)},n.comeBack=function(){o.go("addSuppletterList",{businessId:n.suppletter.businessId})},n.update=function(){e.updateAddSuppLetter(n)},function(){e.getAddSuppLetterById(n)}()}angular.module("app").controller("addSuppLetterEditCtrl",t),t.$inject=["$location","addSuppLetterSvc","sysfileSvc","$state"]}(),function(){"use strict";function t(t,e){function i(e){var i={method:"post",url:rootPath+"/file/findByBusinessId",params:{businessId:e.suppletter.id}},o=function(t){e.sysFilelists=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e,i){var o={method:"post",url:rootPath+"/addSuppLetter/initSuppListDate",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:u+"/createFileNum",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i,o){var n={method:"post",url:rootPath+"/addSuppLetter/initSuppLetter",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data),vm.initFileUpload()};common.http({$http:t,httpOptions:n,success:a})}function r(e){var i={method:"post",url:rootPath+"/addSuppLetter/initSuppLetter",params:{businessId:e.suppletter.businessId,businessType:e.suppletter.businessType,workId:e.suppletter.workId}},o=function(t){e.suppletter=t.data,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e,i){e.isSubmit=!0;var o={
method:"delete",url:u,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(i){if(common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()){i.isCommit=!0;var o={method:"post",url:rootPath+"/addSuppLetter/submitSupp",data:i.suppletter},n=function(t){i.isCommit=!1,t.data.flag||"ok"==t.data.reCode?(i.suppletter=t.data.reObj,e.success("操作成功！")):e.error(t.data.reMsg)};common.http({$http:t,httpOptions:o,success:n,onError:function(t){i.isCommit=!1}})}else e.alert("表格填写不正确，请检查相应的必填项信息！")}function d(i){if(common.initJqValidation($("#suppletter_form")),$("#suppletter_form").valid()){i.isCommit=!0;var o={method:"post",url:rootPath+"/addSuppLetter/saveSupp",data:i.suppletter},n=function(t){i.isCommit=!1,i.suppletter.id=t.data.id,console.log(i.suppletter.id),e.alert("保存成功！")};common.http({$http:t,httpOptions:o,success:n,onError:function(t){i.isCommit=!1}})}else e.alert("表格填写不正确，请检查相应的必填项信息！")}function c(e,i){var o={method:"get",url:rootPath+"/addSuppLetter/findById",params:{id:e.id}},n=function(t){e.suppletter=t.data,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function m(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"orgName",title:"orgName",width:100,filterable:!0},{field:"userName",title:"userName",width:100,filterable:!0},{field:"suppLetterTime",title:"suppLetterTime",width:100,filterable:!0,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"disapDate",title:"disapDate",width:100,filterable:!0,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"secretLevel",title:"secretLevel",width:100,filterable:!0},{field:"mergencyLevel",title:"mergencyLevel",width:100,filterable:!0},{field:"filenum",title:"filenum",width:100,filterable:!0},{field:"title",title:"title",width:100,filterable:!0},{field:"dispaRange",title:"dispaRange",width:100,filterable:!0},{field:"suppleterSuggest",title:"suppleterSuggest",width:100,filterable:!0},{field:"meetingSuggest",title:"meetingSuggest",width:100,filterable:!0},{field:"leaderSuggest",title:"leaderSuggest",width:100,filterable:!0},{field:"printnum",title:"printnum",width:100,filterable:!0},{field:"signid",title:"signid",width:100,filterable:!0},{field:"fileSeq",title:"fileSeq",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var u=rootPath+"/addSuppLetter";return{grid:m,deleteAddSuppLetter:s,initAddSuppLetter:r,getAddSuppLetterById:c,createAddSuppLetter:d,submitAddSuppLetter:l,initSuppLetter:a,createFilenum:n,initSuppListDate:o,findByBusinessId:i}}angular.module("app").factory("addSuppLetterSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.suppletter={},n.suppletter.businessId=i.params.businessId,n.title="登记补充资料",function(){e.initSuppListDate(n.suppletter.businessId,function(t){n.suppletterlist=t})}(),n.getFilenum=function(t){e.createFilenum(t,function(t){t.flag||"ok"==t.reCode?(o.alert("操作成功！"),$.each(n.suppletterlist,function(e,i){i.id==t.reObj.id&&(i.filenum=t.reObj.filenum)})):o.alert(t.reMsg)})},n.findByIdAddSuppLetter=function(t){i.go("addSuppLetterEdit",{id:t})}}angular.module("app").controller("addSuppLetterListCtrl",t),t.$inject=["$location","addSuppLetterSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.suppletter={},n.id=i.params.id,n.title="登记补充资料",function(){e.approveGrid(n),e.addQueryGrid(n)}(),n.del=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),addSuppLetterSvc.deleteAddSuppLetter(n,t)}})},n.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.del(o)}}}angular.module("app").controller("addSuppLetterQueryCtrl",t),t.$inject=["$location","addSuppLetterQuerySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加登记补充资料",n.isuserExist=!1,n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="更新登记补充资料"),n.saveSuppletterApprove=function(){e.createaddSuppLetterQuery(n)},n.update=function(){e.updateaddSuppLetterQuery(n)},function(){e.getaddSuppLetterQueryById(n)}()}angular.module("app").controller("addSuppLetterQueryEditCtrl",t),t.$inject=["$location","addSuppLetterQuerySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/addSuppLetterQuery/initSuppListDate",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:m+"/createFileNum",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i,o){var n={method:"post",url:rootPath+"/addSuppLetterQuery/initSuppLetter",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:m,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(i){var o={method:"post",url:rootPath+"/addSuppLetter/updateApprove",data:i.suppletter},n=function(t){e.success("操作成功！")};common.http({$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"get",url:rootPath+"/addSuppLetter/findById",params:{id:e.id}},n=function(t){e.suppletter=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/addsuppListData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"title",title:"文件标题",width:180,filterable:!1},{field:"orgName",title:"拟稿部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:100,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"filenum",title:"文件字号",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.queryGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/addSuppApproveList"),schema:{data:"value",total:function(t){return t.count?$("#ADDSUPPLETTER_COUNT").html(t.count):$("#ADDSUPPLETTER_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"title",title:"文件标题",width:100,filterable:!1},{field:"orgName",title:"拟稿部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:100,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"filenum",title:"文件字号",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var m=rootPath+"/addSuppLetter";return{approveGrid:c,addQueryGrid:d,createaddSuppLetterQuery:s,deleteaddSuppLetterQuery:r,updateaddSuppLetterQuery:a,getaddSuppLetterQueryById:l,initSuppLetter:n,createFilenum:o,initSuppListDate:i}}angular.module("app").factory("addSuppLetterQuerySvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="待办任务",function(){e.agendaTaskGrid(i)}()}angular.module("app").controller("adminAgendaCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="待办项目",function(){e.gtasksGrid(i)}(),i.countWorkday=function(){e.countWorakday(i)}}angular.module("app").controller("adminCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="在办项目",n.model={},function(){n.showwin=!1,e.dtasksGrid(n)}(),n.pauseProject=function(t){o.findPausingProject(n,t,"")},n.Checked=function(){$("#fileNo").is(":checked")&&($("#file1").prop("checked",!1),$("#file2").prop("checked",!1))},n.Checked2=function(){$("#fileNo").prop("checked",!1)},n.commitProjectStop=function(){o.pauseProject(n)},n.closewin=function(){window.parent.$("#spwindow").data("kendoWindow").close()},n.startProject=function(t){common.confirm({vm:n,title:"",msg:"确认激活吗？",fn:function(){$(".confirmDialog").modal("hide"),i.activeFlow(n,t)}})}}angular.module("app").controller("adminDoingCtrl",t),t.$inject=["$location","adminSvc","flowSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t){var e=this;e.title="在办任务",function(){t.doingTaskGrid(e)}()}angular.module("app").controller("adminDoTaskCtrl",t),t.$inject=["adminSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="办结事项",function(){e.etasksGrid(i)}()}angular.module("app").controller("adminEndCtrl",t),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="个人在办任务",n.model={},function(){n.showwin=!1,e.persontasksGrid(n)}(),n.pauseProject=function(t){o.findPausingProject(n,t)},n.startProject=function(t){common.confirm({vm:n,title:"",msg:"确认激活吗？",fn:function(){$(".confirmDialog").modal("hide"),i.activeFlow(n,t)}})}}angular.module("app").controller("adminPersonDoingCtrl",t),t.$inject=["$location","adminSvc","flowSvc","pauseProjectSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目查询统计",a.currentAssociateSign={},a.signList={},a.headerList={},a.header="",a.project={},a.headerType="项目类型",a.fileName="项目统计报表",a.filters={},function(){e.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(a.orgDeptList=t.reObj)}),e.getSignList(a),e.statisticalGrid(a)}(),a.formReset=function(){var t=$("#searchform").find("input,select");$.each(t,function(t,e){$("input:checkbox").attr("checked",!1),e.value=""})},a.searchSignList=function(){a.signListOptions.dataSource.read(),a.filters=a.project},a.statistical=function(){var t=1;a.columns=[{field:"",title:"序号",width:50,filterable:!1,template:function(){return t++}}],n.findHeaderListSelected(a,function(t){a.selectedHeaderList=t;for(var e=0;e<a.selectedHeaderList.length;e++){var i=a.selectedHeaderList[e];a.columns.push({field:i.headerKey,title:i.headerName,width:140,filterable:!1})}$("#statisticalGrid").kendoGrid({dataSource:a.dataSource,filterable:common.kendoGridConfig().filterable,sortable:!0,selectable:"row",columns:a.columns}),$("#reportWindow").kendoWindow({width:"70%",height:"70%",title:"项目查询统计",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},a.excelExport=function(){var t=escape(encodeURIComponent(a.fileName));if(a.filters&&void 0!=a.filters)var e=JSON.stringify(a.filters),i=e.substring(1,e.length-1);window.open(rootPath+"/signView/excelExport?filterData="+escape(encodeURIComponent(i))+"&fileName="+t)}}angular.module("app").controller("adminSignListCtrl",t),t.$inject=["signSvc","adminSvc","bsWin","$state","headerSvc"]}(),function(){"use strict";function t(t,e,i){function o(t){var i={method:"get",url:rootPath+"/monthlyNewsletter/findHomeMonthly"},o=function(e){t.monthlyList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function n(t){var i={method:"get",url:rootPath+"/addSuppLetter/findHomeAddSuppLetter"},o=function(e){t.addSupLetterList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function a(t){var i={method:"get",url:rootPath+"/projectStop/findHomeProjectStop"},o=function(e){t.projectStopList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function r(t){var i={method:"get",url:rootPath+"/reviewProjectAppraise/findHomeAppraise"},o=function(e){t.appraiseList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function s(t,e,i){var e=escape(encodeURIComponent(e));window.open(rootPath+"/signView/excelExport?filterData="+i+"&fileName="+e)}function l(t){var i={method:"get",url:rootPath+"/workday/countWorkday"},o=function(t){};common.http({vm:t,$http:e,httpOptions:i,success:o})}function d(t){t.i=1;var i={method:"get",url:rootPath+"/annountment/getHomePageAnnountment"},o=function(e){t.annountmentList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function c(t){var i={method:"post",url:rootPath+"/file/listHomeFile"},o=function(e){t.pluginFileList={},t.pluginFileList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function m(t){var i={method:"post",url:rootPath+"/flow/getMyHomeTasks"},o=function(e){t.tasksList={},t.tasksList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function u(t){t.endTasksList={};var i={method:"post",url:rootPath+"/flow/getMyHomeEndTask"},o=function(e){t.endTasksList=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function p(t){var i={method:"get",url:rootPath+"/file/findByBusinessId",params:{businessId:t.anId}},o=function(e){t.file=e.data};common.http({vm:t,$http:e,httpOptions:i,success:o})}function f(t,e){window.open(rootPath+"/file/fileDownload?sysfileId="+e)}function h(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/tasks"),schema:{data:"value",total:function(t){return t.count?$("#DO_SIGN_COUNT").html(t.count):$("#DO_SIGN_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",filterable:!1,width:"15%",template:function(t){return g(t)?'<a href="#/signFlowDetail/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>":'<a href="#/signFlowDeal/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>"}},{field:"reviewStage",title:"项目阶段",filterable:!1,width:"10%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"",title:"合并评审",width:"10%",filterable:!1,template:function(t){return t.reviewType?9==t.reviewType||"9"==t.reviewType?"合并评审[主项目]":"合并评审[次项目]":"否"}},{field:"",title:"合并项目",width:"10%",filterable:!1,template:function(t){if(t.reviewSignDtoList){var e="";return angular.forEach(t.reviewSignDtoList,function(t,i,o){i>0&&(e+=","),e+=t.projectname}),e}return""}},{field:"preSignDate",title:"预签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"signDate",title:"签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"剩余工作日",width:"10%",filterable:!1,template:function(t){return void 0!=t.surplusDays?t.surplusDays>0?t.surplusDays:0:""}},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"",title:"状态",width:"6%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"6%",template:function(t){return g(t)?common.format($("#detailBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId):common.format($("#columnBtns").html(),"signFlowDeal",t.businessKey,t.taskId,t.processInstanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function g(t){var e=2==t.processState;return e||!t.reviewType||0!=t.reviewType&&"0"!=t.reviewType||"SIGN_BMLD_SPW1"!=t.nodeDefineKey&&"SIGN_FGLD_SPW1"!=t.nodeDefineKey||(e=!0),e}function v(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/endTasks"),schema:{data:"value",total:function(t){return t.count},model:{id:"id",fields:{createdDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:40},{field:"businessName",title:"任务名称",filterable:!1,width:180},{field:"createDate",title:"开始时间",width:150,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endDate",title:"结束时间",width:150,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"用时",width:180,filterable:!1,template:function(t){return t.durationTime?t.durationTime:'<span style="color:orangered;">已办结</span>'}},{field:"",title:"流程状态",width:120,filterable:!1,template:function(t){return'<span style="color:orangered;">已办结</span>'}},{field:"",title:"操作",width:80,template:function(t){return t.flowKey==flowcommon.getFlowDefinedKey().FINAL_SIGN_FLOW?common.format($("#columnBtns").html(),"endSignDetail",t.businessKey,t.processInstanceId):t.flowKey?common.format($("#columnBtns").html(),"flowEnd/"+t.businessKey,t.flowKey,t.processInstanceId):""}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function b(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/doingtasks"),schema:{data:"value",total:function(t){return t.count},model:{id:"id"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",filterable:!1,width:"18%",template:function(t){return'<a href="#/signFlowDetail/'+t.businessKey+"/"+t.taskId+"/"+t.processInstanceId+'" >'+t.projectName+"</a>"}},{field:"reviewStage",title:"项目阶段",filterable:!1,width:"10%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"preSignDate",title:"预签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"signDate",title:"签收时间",width:"10%",filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"剩余工作日",width:"10%",filterable:!1,template:function(t){return void 0!=t.surplusDays?t.surplusDays>0?t.surplusDays:0:""}},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"",title:"流程状态",width:"10%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"10%",template:function(t){return common.format($("#columnBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function w(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/getSignList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchDate",title:"发文日期",width:160,filterable:!1},{field:"reviewdays",title:"评审天数",width:140,filterable:!1},{field:"",title:"剩余工作日",width:140,filterable:!1,template:function(t){return void 0!=t.surplusdays?t.surplusdays>=0?t.surplusdays:0:""}},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizeValue",title:"审定投资",width:140,filterable:!1},{field:"extraValue",title:"核减（增）投资",width:140,filterable:!1},{field:"extraRate",title:"核减率",width:140,filterable:!1},{field:"approveValue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchType",title:"发文类型",width:140,filterable:!1},{field:"fileDate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyname",title:"建设单位",width:140,filterable:!1},{field:"isassistproc",title:"是否协审",width:140,filterable:!1,template:function(t){return 9==t.isassistproc?"是":"否"}},{field:"daysafterdispatch",title:"发文后工作日",width:140,filterable:!1}];t.signListOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function y(t){var i={method:"post",url:rootPath+"/sign/initSignList"},o=function(e){void 0!=t&&"function"==typeof t&&t(e.data)};common.http({$http:e,httpOptions:i,success:o})}function S(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/html/personDtasks"),schema:{data:"value",total:function(t){return t.count},model:{id:"id"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"",width:30,template:function(t){switch(t.lightState){case"4":return $("#span1").html();case"8":return $("#span5").html();case"7":return $("#span4").html();case"6":return $("#span3").html();case"5":return $("#span2").html();case"1":case"2":case"3":default:return""}}},{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"projectName",title:"项目名称",filterable:!1,width:150},{field:"reviewStage",title:"项目阶段",filterable:!1,width:150},{field:"nodeName",title:"当前环节",width:120,filterable:!1},{field:"preSignDate",title:"预签收时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"signDate",title:"正式签收时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"剩余工作日",width:100,filterable:!1,template:function(t){return void 0!=t.surplusDays?t.surplusDays>=0?t.surplusDays:0:""}},{field:"displayName",title:"处理人",width:100,filterable:!1},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:150,template:function(t){var e=!1;return e="2"==t.processState,"FINAL_SIGN_FLOW"==t.processKey||"SIGN_XS_FLOW"==t.processKey?common.format($("#columnBtns").html(),"signFlowDetail",t.businessKey,t.taskId,t.processInstanceId,"vm.pauseProject('"+t.businessKey+"')",e,"vm.startProject('"+t.businessKey+"')",e):'<a class="btn btn-xs btn-danger" >流程已停用</a>'}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function k(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/queryMyAgendaTask"),schema:{data:"value",total:function(t){return t.count?$("#DO_TASK_COUNT").html(t.count):$("#DO_TASK_COUNT").html(0),t.count},model:{id:"taskId"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createTime",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"instanceName",title:"流程名称",filterable:!1,width:"20%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"processName",title:"流程类别",width:"20%",filterable:!1},{field:"",title:"流程状态",width:"5%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"15%",template:function(t){return common.format($("#columnBtns").html(),t.businessKey,t.processKey,t.taskId,t.instanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function C(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/queryAgendaTask"),schema:{data:"value",total:function(t){return t.count},model:{id:"taskId"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createTime",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"instanceName",title:"流程名称",filterable:!1,width:"20%"},{field:"nodeName",title:"当前环节",width:"10%",filterable:!1},{field:"displayName",title:"处理人",width:"10%",filterable:!1},{field:"processName",title:"流程类别",width:"20%",filterable:!1},{field:"",title:"流程状态",width:"5%",filterable:!1,template:function(t){return t.processState&&2==t.processState?'<span style="color:orange;">已暂停</span>':'<span style="color:green;">进行中</span>'}},{field:"",title:"操作",width:"15%",template:function(t){return common.format($("#columnBtns").html(),t.businessKey,t.processKey,t.taskId,t.instanceId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function D(t){t.dataSource=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/getSignList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}})}return{gtasksGrid:h,etasksGrid:v,dtasksGrid:b,doingTaskGrid:C,persontasksGrid:S,countWorakday:l,agendaTaskGrid:k,initFile:p,upload:f,getSignList:w,initSignList:y,initAnnountment:d,findendTasks:u,findtasks:m,findHomePluginFile:c,excelExport:s,statisticalGrid:D,initProjectStop:a,findHomeAppraise:r,findHomeAddSuppLetter:n,findHomeMonthly:o}}angular.module("app").factory("adminSvc",t),t.$inject=["$rootScope","$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="主页",function(){e.initAnnountment(i),e.findtasks(i),e.findendTasks(i),e.findHomePluginFile(i),e.initProjectStop(i),e.findHomeAppraise(i),e.findHomeAddSuppLetter(i),e.findHomeMonthly(i)}()}angular.module("app").controller("adminWelComeCtrl",t).filter("FormatStrDate",function(){return function(t){var e=new Date(t),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate();return e.getFullYear()+"/"+i+"/"+o}}),t.$inject=["$location","adminSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="通知公告管理",function(){o.grid(a)}(),a.bathIssue=function(){o.updateIssueState(a,"9")},a.bathUnissue=function(){o.updateIssueState(a,"0")},a.del=function(t){i.confirm({title:"询问提示",message:"确认删除数据吗?",onOk:function(){o.deleteAnnountment(a,t)}})},a.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:a,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");a.del(o)}},a.detail=function(t){t&&e.go("annountmentDetail",{id:t})},a.queryAnnountment=function(){a.gridOptions.dataSource.read()},a.resetAnnountment=function(){var t=$("#annountmentform").find("input,select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("annountmentCtrl",t),t.$inject=["$location","$state","bsWin","annountmentSvc","sysfileSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="通知公告详情页",o.annountment={},o.annountment.anId=e.params.id,function(){i.findDetailById(o,o.annountment.anId)}(),o.post=function(t){i.findDetailById(o,t)},
o.next=function(t){i.findDetailById(o,t)},o.alertwd=function(){$("section").addClass("cont-alert")},o.closed=function(){$("section").removeClass("cont-alert")},o.prints=function(){var t,e="<div  style=\"width: 80%;height:80%; text-align: center; margin: auto; font-family: 'Microsoft YaHei'\">"+$("#context-body").html()+"</div>",i=$(window).height(),o=$(window).width();t=window.open("","","width="+o+",height="+i),t.document.body.innerHTML=e,t.print()}}angular.module("app").controller("annountmentDetailCtrl",t),t.$inject=["$location","$state","annountmentSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="通知公告编辑",n.annountment={},n.annountment.anId=t.params.id,n.businessFlag={isInitFileOption:!1},n.initFileUpload=function(){n.annountment.anId||o.$watch("vm.annountment.anId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.annountment.anId,mainId:n.annountment.anId,mainType:i.mainTypeValue().NOTICE},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.annountment.anId,function(t){n.sysFilelists=t})}})},function(){$("#froalaEditor").froalaEditor({language:"zh_cn",inlineMode:!1,placeholderText:"请输入内容",imageUploadURL:rootPath+"/froala/uploadImg",imageUploadParams:{rootPath:rootPath},height:"260px",enter:$.FroalaEditor.ENTER_BR,toolbarButtons:["bold","italic","underline","strikeThrough","fontFamily","paragraphFormat","align","color","fontSize","outdent","indent","insertImage","insertTable","undo","redo","insertLink","fullscreen"]}),n.annountment.anId?(n.isUpdate=!0,e.findAnnountmentById(n),i.findByBusinessId(n.annountment.anId,function(t){n.sysFilelists=t})):n.initFileUpload()}(),n.create=function(){e.createAnnountment(n)},n.update=function(){e.updateAnnountment(n)}}angular.module("app").controller("annountmentEditCtrl",t),t.$inject=["$state","annountmentSvc","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:p+"/initAnOrg"},o=function(t){e.annountment.anOrg="",e.annountment.anOrg=t.data.substring(1,t.data.length-1)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:p+"/findAnnountmentById",params:{anId:e.annountment.anId}},o=function(t){e.annountment=t.data,$("#froalaEditor").froalaEditor("html.set",e.annountment.anContent),e.initFileUpload()};common.http({$http:t,httpOptions:i,success:o})}function a(i){if(i.annountment.anContent=$("#froalaEditor").val(),common.initJqValidation(),$("#form").valid()){i.isSubmit=!0;var o={method:"post",url:p,data:i.annountment},n=function(t){i.isSubmit=!1,i.annountment.anId=t.data.anId,e.alert("保存成功！")};common.http({$http:t,httpOptions:o,success:n,onError:function(){i.isSubmit=!1}})}}function r(i){i.isSubmit=!0,i.annountment.anContent=$("#froalaEditor").val();var o={method:"put",url:p,data:i.annountment},n=function(t){i.isSubmit=!1,e.alert("操作成功！")};common.http({$http:t,httpOptions:o,success:n,onError:function(){i.isSubmit=!1}})}function s(i,o){var n={method:"delete",url:p,data:o},a=function(t){i.gridOptions.dataSource.read(),e.alert("删除成功！")};common.http({$http:t,httpOptions:n,success:a})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/annountment/fingByCurUser",$("#annountmentform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"issue",dir:"asc"}]}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"anTitle",title:"标题",width:300,filterable:!1},{field:"issueDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:160,filterable:!1},{field:"issueUser",title:"发布人",width:100,filterable:!1},{field:"",title:"发布状态",width:100,template:function(t){return t.issue&&"9"==t.issue?"已发布":"未发布"}},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.detail('"+t.anId+"')",t.anId,"vm.del('"+t.anId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function d(e,i){var o=common.getKendoCheckId(".grid");if(0==o.length)common.alert({vm:e,msg:"请选择数据"});else{for(var n=[],a=0;a<o.length;a++)n.push(o[a].value);var r={method:"post",url:rootPath+"/annountment/updateIssueState",params:{ids:n.join(","),issueState:i}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),common.alert({vm:e,msg:"操作成功",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:r,success:s})}}function c(e,o){var n={method:"post",url:p+"/findAnnountmentById",params:{anId:o}},a=function(t){e.annountment=t.data,i.findByBusinessId(o,function(t){e.sysFilelists=t}),m(e,o),u(e,o)};common.http({vm:e,$http:t,httpOptions:n,success:a})}function m(e,i){var o={method:"get",url:rootPath+"/annountment/postArticle",params:{anId:i}},n=function(t){e.annountmentPost=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function u(e,i){var o={method:"get",url:rootPath+"/annountment/nextArticle",params:{anId:i}},n=function(t){e.annountmentNext=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}var p=rootPath+"/annountment";return{grid:l,createAnnountment:a,initAnOrg:o,findAnnountmentById:n,updateIssueState:d,updateAnnountment:r,deleteAnnountment:s,findDetailById:c,postArticle:m,nextArticle:u}}angular.module("app").factory("annountmentSvc",t),t.$inject=["$http","bsWin","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="通知公告列表",function(){o.grid(n)}(),n.detail=function(t){t&&e.go("annountmentDetail",{id:t})},n.findAnnountment=function(){n.gridOptions.dataSource.read()},n.resetAnnountment=function(){var t=$("#annountmentYetform").find("input,select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("annountmentYetCtrl",t),t.$inject=["$location","$state","$http","annountmentYetSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/annountment/findByIssue",$("#annountmentYetform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"createdDate",dir:"desc"}]}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"anTitle",title:"标题",width:300,filterable:!1},{field:"issueDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:160,filterable:!1},{field:"issueUser",title:"发布人",width:100,filterable:!1},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.detail('"+t.anId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}return{grid:e}}angular.module("app").factory("annountmentYetSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.title="档案借阅管理",o.createLibrary=function(){common.initJqValidation(),$("form").valid()&&e.createArchivesLibrary(o.model,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！"):i.error(t.reMsg)})},o.createCityLibrary=function(){common.initJqValidation(),$("form").valid()&&e.createCityLibrary(o.model,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！"):i.error(t.reMsg)})},o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteArchivesLibrary(o,t)}})},o.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:o,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var n=e.join(",");o.del(n)}},function(){e.grid(o),e.centerLibraryGrid(o),e.cityGridOptions(o)}()}angular.module("app").controller("archivesLibraryCtrl",t),t.$inject=["$location","archivesLibrarySvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加档案借阅管理",n.isuserExist=!1,n.model={},n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="更新档案借阅管理"),n.updateLibrary=function(){common.initJqValidation(),$("form").valid()?e.updateArchivesLibrary(n):o.alert("请填写审批意见，再提交！")},function(){n.isUpdate&&(e.getArchivesLibraryById(n),e.getArchivesUserName(n))}()}angular.module("app").controller("archivesLibraryEditCtrl",t),t.$inject=["$location","archivesLibrarySvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e){var i={method:"get",url:rootPath+"/archivesLibrary/findByArchivesUser"},o=function(t){e.userlist=t.data,console.log(e.userlist)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e,i){var o={method:"post",url:m+"/saveCity",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(i){i.userlist.forEach(function(t,e){i.model.archivesUserName=t.displayName});var o={method:"put",url:m+"/updateLibrary",data:i.model},n=function(t){e.success("操作成功！")};common.http({$http:t,httpOptions:o,success:n})}function a(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:m+"/savaLibrary",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e){var i={method:"get",url:rootPath+"/archivesLibrary/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/findByProjectList"),schema:{data:"value",total:function(t){return t.count?$("#LIBRARY_COUNT").html(t.count):$("#LIBRARY_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"readCompany",title:"项目单位",width:140,filterable:!1},{field:"readProjectName",title:"查阅项目",width:140,filterable:!1},{field:"readUsername",title:"借阅人",width:100,filterable:!1},{field:"readArchivesCode",title:"归档编号",width:100,filterable:!1},{field:"readDate",title:"借阅时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/findByCenterList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"readCompany",title:"项目单位",width:140,filterable:!1},{field:"readProjectName",title:"查阅项目",width:140,filterable:!1},{field:"readUsername",title:"借阅人",width:100,filterable:!1},{field:"readArchivesCode",title:"归档编号",width:100,filterable:!1},{field:"archivesUserName",title:"归档员",width:100,filterable:!1},{field:"readDate",title:"借阅时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.centerGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/findByCityList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"readCompany",title:"项目单位",width:140,filterable:!1},{field:"readProjectName",title:"查阅项目",width:140,filterable:!1},{field:"readUsername",title:"借阅人",width:100,filterable:!1},{field:"readArchivesCode",title:"归档编号",width:100,filterable:!1},{field:"archivesUserName",title:"归档员",width:100,filterable:!1},{field:"readDate",title:"借阅时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.cityGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},resizable:!0}}var m=rootPath+"/archivesLibrary";return{grid:l,createArchivesLibrary:r,createCityLibrary:o,updateArchivesLibrary:n,centerLibraryGrid:d,cityGridOptions:c,getArchivesLibraryById:s,getArchivesUserName:i,deleteArchivesLibrary:a}}angular.module("app").factory("archivesLibrarySvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="图书管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteBookBuy(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("bookBuyCtrl",t),t.$inject=["$location","bookBuySvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加图书管理信息",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新图书管理信息"),o.create=function(){e.createBookBuy(o)},o.update=function(){e.updateBookBuy(o)},function(){o.isUpdate&&e.getBookBuyById(o)}()}angular.module("app").controller("bookBuyEditCtrl",t),t.$inject=["$location","bookBuySvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:r,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:r,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:r,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=s}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/bookBuy/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(r),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"booksBarCode",title:"booksBarCode",width:100,filterable:!0},{field:"booksCode",title:"booksCode",width:100,filterable:!0},{field:"booksName",title:"booksName",width:100,filterable:!0},{field:"booksPrice",title:"booksPrice",width:100,filterable:!0},{field:"booksType",title:"booksType",width:100,filterable:!0},{field:"professionalType",title:"professionalType",width:100,filterable:!0},{field:"storePosition",title:"storePosition",width:100,filterable:!0},{field:"buyer",title:"buyer",width:100,filterable:!0},{field:"publishingCompany",title:"publishingCompany",width:100,filterable:!0},{field:"bookNo",title:"bookNo",width:100,filterable:!0},{field:"author",title:"author",width:100,filterable:!0},{field:"publishingTime",title:"publishingTime",width:100,filterable:!0},{field:"bookNumber",title:"bookNumber",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var r=rootPath+"/bookBuy",s="#/bookBuyList";return{grid:a,getBookBuyById:n,createBookBuy:o,deleteBookBuy:i,updateBookBuy:e}}angular.module("app").factory("bookBuySvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="图书采购申请业务信息",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteBookBuyBusiness(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}(),i.searchForm=function(){i.gridOptions.dataSource.read()},i.formReset=function(){i.searchModel={}}}angular.module("app").controller("bookBuyBusinessCtrl",t),t.$inject=["$location","bookBuyBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(t){if(r.conditions.length>0){return r.conditions.forEach(function(t,e){t.booksName=$("#booksName"+t.sort).val(),t.booksType=$("#booksType"+t.sort).val(),t.publishingCompany=$("#publishingCompany"+t.sort).val(),t.bookNo=$("#bookNo"+t.sort).val(),t.author=$("#author"+t.sort).val(),t.bookNumber=$("#bookNumber"+t.sort).val(),t.storeConfirm=$("#storeConfirm"+t.sort).val(),t.booksPrice=$("#booksPrice"+t.sort).val(),t.applyDept=r.model.applyDept,t.operator=r.model.operator,t.buyChannel=r.model.buyChannel,t.businessId=$("#businessId").val()}),!0}return!1}function a(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}var r=this;r.model={},r.conMaxIndex=0,r.conditions=new Array,r.title="添加图书采购申请业务信息",r.isuserExist=!1,r.businessId=i.params.businessId,r.showFlag={addBooksDeatail:!0,modBooksDetail:!0,bookBuyApplyTr:!1,bookBuyBzTr:!0,bookBuyFgzrTr:!0,bookBuyZrTr:!0,bookBuyYsrk:!0},r.businessId?(r.isUpdate=!0,r.showFlag.modBooksDetail=!0,r.showFlag.addBooksDeatail=!1,r.title="更新图书采购申请业务信息",$("#businessId").val(r.businessId)):(r.showFlag.modBooksDetail=!1,r.showFlag.addBooksDeatail=!0),r.create=function(){e.createBookBuyBusiness(r)},r.update=function(){e.updateBookBuyBusiness(r)},r.addCondition=function(){r.condition={},r.showFlag.addBooksDeatail?r.condition.sort=r.conMaxIndex+1:(r.conMaxIndex=r.conditions.length,r.condition.sort=r.conditions.length+1),r.conditions.push(r.condition),r.conMaxIndex++},r.removeCondition=function(){var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var e=[],i=0;i<t.length;i++)$.each(r.conditions,function(o,n){t[i].value==n.sort&&(n.id?e.push(n.id):r.conditions.splice(o,1))});e.length>0?expertConditionSvc.deleteSelConditions(e.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(o.success("操作成功！"),$.each(e,function(t,e){$.each(r.conditions,function(t,i){e==i.sort&&r.conditions.splice(t,1)})})):o.error(t.reMsg)}):o.success("操作成功！")}}):o.alert("请选择要删除的抽取条件！")},r.saveCondition=function(){n(!1)?e.saveBookBuyBusinessDetail(r.conditions,function(t){t.flag||"ok"==t.reCode?($("#businessId").val(t.reObj.businessId),o.success("保存成功！")):o.error(t.reMsg)}):o.error("请添加后再保存")},r.startFlow=function(){o.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){n(!1)?e.startFlow(r.conditions,r.isCommit,function(t){t.flag||"ok"==t.reCode?o.alert("保存成功！",function(){i.go("myBookBuyBusiness")}):o.alert(t.reMsg)}):o.error("请添加图书信息后再发起流程！")}})},r.checkBookNum=function(t){var e="bookNumber"+t;if(!a($("#"+e).val()))return void $("span[data-valmsg-for='"+e+"']").html("图书数量只能输入正整数！");$("span[data-valmsg-for='"+e+"']").html("")},r.checkPrice=function(t){var e=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/,i="booksPrice"+t,o="bookNumber"+t;if(!e.test($("#"+i).val()))return $("#"+i).val(""),void $("span[data-valmsg-for='"+i+"']").html("价格只能输入数字！");$("span[data-valmsg-for='"+i+"']").html("");var n=$("#"+i).val(),a=$("#"+o).val();$("#total"+t).val(parseFloat(n)*a)},function(){r.isUpdate&&e.getBookBuyBusinessById(r,function(t){r.model=t,r.conditions=r.model.bookBuyList;for(var e=0;e<r.conditions.length;e++)r.conditions[e].sort=e+1})}()}angular.module("app").controller("bookBuyBusinessEditCtrl",t),t.$inject=["$location","bookBuyBusinessSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){common.initJqValidation();$("form").valid();{e.isSubmit=!0;var i={method:"post",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){var o={method:"post",url:rootPath+"/bookBuyBusiness/saveBooksDetailList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/bookBuyBusiness/startFlow",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"get",url:rootPath+"/bookBuyBusiness/html/findById",params:{id:e.businessKey}},o=function(t){e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(e,i){var o={method:"get",url:rootPath+"/bookBuyBusiness/html/findById",params:{id:e.businessId}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/bookBuyBusiness/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"businessName",title:"业务流程名称",width:"20%",filterable:!1},{field:"buyChannel",title:"购买渠道",width:"15%",filterable:!1},{field:"createdDate",title:"创建日期",width:"15%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:140,template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.businessId,e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var d=rootPath+"/bookBuyBusiness",c="#/bookBuyBusinessList";return{grid:l,getBookBuyBusinessById:s,createBookBuyBusiness:o,deleteBookBuyBusiness:i,updateBookBuyBusiness:e,saveBookBuyBusinessDetail:n,startFlow:a,initFlowDeal:r}}angular.module("app").factory("bookBuyBusinessSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="单位列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletecompany(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryConpany=function(){e.queryConpany(i)},function(){e.grid(i)}()}angular.module("app").controller("companyCtrl",t),t.$inject=["$location","companySvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="新增单位",o.iscompanyExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新单位"),o.create=function(){e.createcompany(o)},o.update=function(){e.updatecompany(o)},function(){o.isUpdate&&e.getcompanyById(o)}()}angular.module("app").controller("companyEditCtrl",t),t.$inject=["$location","companySvc","$state"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#form")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"coName",title:"单位名称",width:220,filterable:!1},{field:"coPhone",title:"单位电话",width:100,filterable:!1},{field:"coPC",title:"邮编",width:100,filterable:!1},{field:"coAddress",title:"地址",width:160,filterable:!1},{field:"coType",title:"单位类型",width:160,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function o(t){t.gridOptions.dataSource.read()}function n(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0;var i={method:"post",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function a(e){var i={method:"get",url:l+"/html/findByIdCompany",params:{id:e.id}},o=function(t){e.model=t.data,console.log(e.model)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){if(common.initJqValidation(),$("form").valid()&&0==e.iscompanyExist){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function s(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}var l=rootPath+"/company",d="#/company";rootPath;return{grid:i,createcompany:n,getcompanyById:a,updatecompany:r,deletecompany:s,queryConpany:o}}angular.module("app").factory("companySvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";var t=angular.module("app"),e="template/dialog/alert.html";t.factory("bsWin",["$rootScope","$injector","$templateCache","bsWinConfig",function(t,i,o,n){function a(e){e.msg&&(e.message=e.msg);var i=angular.extend({},n,e),o={winId:d++,scope:t.$new()};return r(o,i),i.onOk&&(o.scope.ok=function(){if(i.onOk&&0==i.onOk.apply(this))return!1;o.el.modal("hide")}),i.onCancel&&(o.scope.onCancel=function(){
if(i.onCancel&&0==i.onCancel.apply(this))return!1;o.el.modal("hide")}),o.el=s(o.scope,i.templateUrl).on("hidden.bs.modal",function(t){if(i.onClose&&0==i.onClose.apply(this,t))return!1;l(o)}).modal("show"),o}function r(t,e){t.scope.title=e.title,t.scope.message=e.message,t.scope.winId=t.winId,t.scope.type=e.type,t.scope.extraData=e.extraData,t.scope.options={onClose:e.onClose}}function s(t,e){var n=i.get("$compile"),a=n(o.get(e))(t);return $(a).appendTo("body")}function l(t){t.scope.$destroy(),t.el.unbind(),t.el.remove(),t.el=null,t=null}var d=0;return{success:function(t,e){return this.alert({message:t,type:"success",onClose:e})},warning:function(t,e){return this.alert({message:t,type:"warning",onClose:e})},error:function(t,e){return this.alert({message:t,type:"error",onClose:e})},alert:function(t,i,o){if(!angular.isObject(t)){var n;!i||angular.isFunction(i)?(o=i,i=t):n=t,t={message:i,onClose:o||function(){}},n&&(t.title=n)}return t.templateUrl=e,a(t)},confirm:function(t,e,i,o,n){if(!angular.isObject(t)){var r;!e||angular.isFunction(e)?(n=o||function(){},o=i||function(){},i=e||function(){},e=t):r=t,t={message:e,onOk:i,onClose:o,onCancel:n},r&&(t.title=r)}return t.templateUrl="template/dialog/confirm.html",a(t)},relogin:function(t){var e=this,o={message:t,onOk:function(){var t=this;return i.get("$http")({method:"POST",url:common.loginUrl,params:t.scope.model}).then(function(i){var o=i.data;"SUCCESS"==o.status?e.success(o.message||"登錄成功！",function(){t.el.modal("hide")}):e.error(o.message)}),!1}};return o.templateUrl="template/dialog/relogin.html",a(o)}}}]),t.constant("bsWinConfig",{title:"提示窗口",message:"",type:"info",timeout:0,templateUrl:e,onOk:null,onClose:function(t){}}),t.run(["$templateCache",function(t){t.put(e,'<div class="alertDialog modal fade" tabindex="-1" role="dialog">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title || \'消息提醒\'}}</h4>                        </div>                        <div class="modal-body text-{{type==\'error\'? \'danger\' : type}}">                            <p class="alertDialogMessage">                                <i class="fa fa-{{type == \'success\' ? \'check\' : (type == \'error\' ? \'ban\' : type)}}" aria-hidden="true"></i>                                 {{message}}                            </p>                        </div>                        <div class="modal-footer">                            <button type="button"  class="btn btn-info" data-dismiss="modal">关闭</button>                        </div>                    </div>                </div>            </div>'),t.put("template/dialog/confirm.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: 10000;">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title||\'提示\'}}</h4>                        </div>                        <div class="modal-body text-primary"><p><i class="fa fa-question-circle" aria-hidden="true"></i> {{message}}</p></div>                        <div class="modal-footer">                            <button type="button" ng-click="ok()" class="btn btn-info" >确认</button>                            <button type="button" ng-click="onCancel()" class="btn btn-info" data-dismiss="modal">取消</button>                        </div>                    </div>                </div>            </div>'),t.put("template/dialog/relogin.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">登录窗口</h4>                        </div>                        <div class="modal-body text-primary">                            <p><i class="fa fa-warning" aria-hidden="true"></i> {{message}}</p>                            <div><span ng-show="vm.message" class="errors" ng-bind="vm.message"></span></div>                            <div><span data-valmsg-for="loginName" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="用户名" maxlength="100" name="loginName" id="loginName" ng-model="model.loginName" data-val="true" data-val-required="用户名必填">                                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>                            </div>                            <div><span data-valmsg-for="password" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="password" class="form-control" placeholder="密码" maxlength="100" name="password" id="password" ng-model="model.password" data-val="true" data-val-required="密码必填">                                <span class="glyphicon glyphicon-lock form-control-feedback"></span>                            </div>                        </div>                        <div class="modal-footer">                            <div class="pull-right col-sm-12">                                <button type="button" ng-click="ok()"  class="btn btn-primary btn-block btn-flat l-icon">登 录</button>                            </div>                        </div>                    </div>                </div>            </div>')}])}(),function(){"use strict";function t(t,e,i){var o=new Blob([t],{type:"application/"+i}),n=document.createElement("a");document.body.appendChild(n),n.download=e,n.href=URL.createObjectURL(o),n.click()}function e(t){t?(t.removeData("validator"),t.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(t)):($("form").removeData("validator"),$("form").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse("form"))}function i(t){var e=function(e){C.alert({vm:t.vm,msg:e,fn:function(){t.vm.isSubmit=!1,$(".alertDialog").modal("hide")}})};if(t.response.status>400)e("发生错误！");else{var i=t.response.data;i&&555==i.status?e(i.message):t.fn&&t.fn(i)}}function o(){for(var t=arguments[0],e=1;e<arguments.length;e++){var i=new RegExp("\\{"+(e-1)+"\\}","gm");t=t.replace(i,arguments[e])}return t}function n(t){var e=t.toString().replace(/[^0-9]/g,"");return parseInt(e,10)}function a(t){return isNaN(parseFloat(t,10))?0:parseFloat(t,10)}function r(){return $(window).height()-180}function s(t){t.vm.alertDialogMessage=t.msg,t.vm.alertDialogFn=function(){t.closeDialog&&1==t.closeDialog&&($(".alertDialog").modal("hide"),$(".modal-backdrop").remove()),t.fn?t.fn():$(".alertDialog").modal("hide")},$(".alertDialog").modal({backdrop:"static",keyboard:!1})}function l(t){t.vm.dialogConfirmTitle=t.title,t.vm.dialogConfirmMessage=t.msg,$(".confirmDialog").modal({backdrop:"static"}),t.vm.dialogConfirmSubmit=t.fn,t.cancel?t.vm.dialogConfirmCancel=t.cancel:t.vm.dialogConfirmCancel=function(){$(".confirmDialog").modal("hide")}}function d(t,e){null==e&&(e=""),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=i.exec(window.location.href);return null==o?e:o[1]}function c(t,e){return new kendo.data.DataSource({type:"odata",transport:m().transport(t,e),schema:m().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}})}function m(){return{filterable:{extra:!1,operators:{string:{contains:"包含",eq:"等于"},number:{eq:"等于",neq:"不等于",gt:"大于",lt:"小于"},date:{gt:"大于",lt:"小于"}}},pageable:{pageSize:10,previousNext:!0,buttonCount:5,refresh:!0,pageSizes:!0},schema:function(t){return{data:"value",total:function(t){return t.count},model:t}},transport:function(t,e,i){return{read:{url:t,dataType:"json",type:"post",beforeSend:function(t){t.setRequestHeader("Token",C.getToken())},data:function(){if(e){var t=common.buildOdataFilter(e);return t?i&&i.filter?{$filter:t+" and "+i.filter}:{$filter:t}:i&&i.filter?{$filter:i.filter}:{}}return{}}}}},noRecordMessage:{template:"暂时没有数据."}}}function u(t){var e=$(t).find("tr td:nth-child(1)").find("input:checked"),i=[];return e.each(function(){var t=$(this).attr("relId");i.push({name:"id",value:t})}),i}function p(t){t.headers={Token:C.getToken()},t.$http(t.httpOptions).then(t.success,function(e){t.onError&&t.onError(e)})}function f(){return{get:function(t,e){var i=this.getAll(t);return i?i[e]:null},getAll:function(t){var e=encodeURIComponent(t)+"=",i=document.cookie.indexOf(e),o=null,n={};if(i>-1){var a=document.cookie.indexOf(";",i);if(-1==a&&(a=document.cookie.length),o=document.cookie.substring(i+e.length,a),o.length>0){for(var r=o.split("&"),s=0,l=r.length;s<l;s++){var d=r[s].split("=");n[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return n}}return null},set:function(t,e,i,o,n,a,r){var s=this.getAll(t)||{};s[e]=i,this.setAll(t,s,o,n,a,r)},setAll:function(t,e,i,o,n,a){var r=encodeURIComponent(t)+"=",s=new Array;for(var l in e)l.length>0&&e.hasOwnProperty(l)&&s.push(encodeURIComponent(l)+"="+encodeURIComponent(e[l]));s.length>0?(r+=s.join("&"),i instanceof Date&&(r+=";expires="+i.toGMTString()),o&&(r+=";path="+o),n&&(r+=";domain="+n),a&&(r+=";secure")):r+=";expires="+new Date(0).toGMTString(),document.cookie=r},unset:function(t,e,i,o,n){var a=this.getAll(t);a&&(delete a[e],this.setAll(t,a,null,i,o,n))},unsetAll:function(t,e,i,o){this.setAll(t,null,new Date(0),e,i,o)}}}function h(){var t=f().getAll("data");return null!=t?t.token:""}function g(t){return t.error=function(t){401==t.status&&(location.href=window.rootPath+"/home/login")},t}function v(t){var e=/^(?:checkbox|radio)$/i,i=/^(?:submit|button|image|reset|file)$/i,o=/^(?:input|select|textarea|keygen)/i;return $(t).map(function(){var t=jQuery.prop(this,"elements");return t?jQuery.makeArray(t):this}).filter(function(){var t=this.type;return this.value&&this.name&&!$(this).is(":disabled")&&o.test(this.nodeName)&&!i.test(t)&&(this.checked||!e.test(t))}).map(function(t,e){var i=$(this),o=i.val();if(!o)return!1;"Integer"!=(i.attr("data-type")||"String")&&(o="'"+o+"'");var n=i.attr("operator")||"eq",a=i.attr("data-role")||"";return"datepicker"==a?o="date"+o:"datetimepicker"==a&&(o="datetime"+o),"like"==n?"substringof("+o+", "+e.name+")":e.name+" "+n+" "+o}).get().join(" and ")}function b(t){if(k){t.scope.dictMetaData=k;var e={};w(e,t.scope.dictMetaData),t.scope.DICT=e}else t.$http({method:"get",url:rootPath+"/dict/dictItems"}).then(function(e){t.scope.dictMetaData=e.data;var i={};w(i,e.data),t.scope.DICT=i},function(t){alert("初始化数据字典失败")})}function w(t,e,i){if(e&&0!=e.length)if(i)for(var o=0;o<e.length;o++){var n=e[o];if(n.parentId&&n.parentId==i){t.dicts||(t.dicts=new Array);var a={};a.dictId=n.dictId,a.dictName=n.dictName,a.dictCode=n.dictCode,a.dictKey=n.dictKey,a.dictSort=n.dictSort,t.dicts.push(a),w(a,e,n.dictId)}}else for(var o=0;o<e.length;o++){var n=e[o];n.parentId||(t[n.dictCode]={},t[n.dictCode].dictId=n.dictId,t[n.dictCode].dictCode=n.dictCode,t[n.dictCode].dictName=n.dictName,t[n.dictCode].dictKey=n.dictKey,t[n.dictCode].dictSort=n.dictSort,w(t[n.dictCode],e,n.dictId))}}function y(t){t.$http({method:"get",url:rootPath+"/admin/myCountInfo"}).then(function(t){t.data.DO_SIGN_COUNT&&$("#DO_SIGN_COUNT").html(t.data.DO_SIGN_COUNT),t.data.DO_TASK_COUNT&&$("#DO_TASK_COUNT").html(t.data.DO_TASK_COUNT),t.data.PAUSE_COUNT&&$("#PAUSE_COUNT").html(t.data.PAUSE_COUNT),t.data.APPRAISE_COUNT&&$("#APPRAISE_COUNT").html(t.data.APPRAISE_COUNT),t.data.MONTHLY_COUNT&&$("#MONTHLY_COUNT").html(t.data.MONTHLY_COUNT),t.data.SUPPLETTER_COUNT&&$("#SUPPLETTER_COUNT").html(t.data.SUPPLETTER_COUNT)})}function S(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}).toUpperCase()}var k,C={initJqValidation:e,requestSuccess:i,format:o,blockNonNumber:n,floatNumberInput:a,adminContentHeight:r,alert:s,confirm:l,getQuerystring:d,kendoGridConfig:m,getKendoCheckId:u,cookie:f,getToken:h,http:p,gridDataSource:g,buildOdataFilter:v,initDictData:b,kendoGridDataSource:c,getTaskCount:y,uuid:S,downloadReport:t,initDictItems:function(t){k=t}};window.common=C}(),function(){"use strict";function t(t,i){return{request:function(t){return t.headers.Token=common.getToken(),t.headers["X-Requested-With"]="XMLHttpRequest",t},responseError:function(o){return o.config.headers.commonHttp||e(i,o.status,o.data),t.reject(o)}}}function e(t,e,i){switch(e){case 500:t.error("系统内部错误");break;case 401:t.warning("登录信息失效或您没有权限,请重新登录!");break;case 403:t.warning("无权限执行此操作");break;case 404:t.error("未找到相应的操作");break;case 408:t.warning("请求超时");break;case 412:t.warning(i.message||"操作失败");break;case 499:t.warning(i.message||"您的账号已在别的地方登录，请确认密码是否被修改！");break;default:t.error("发生错误,系统已记录,我们会尽快处理！")}}var i=angular.module("app");i.factory("commonHttpInterceptor",["$injector","bsWin",t]),i.config(["$httpProvider",function(e){e.interceptors.push(t)}]),jQuery&&jQuery(document).ajaxSend(function(t,e,i){e.setRequestHeader("Token",common.getToken())}).ajaxError(function(t,i,o,n){var a=angular.element("body"),r=a.scope(),s=a.injector().get("bsWin"),l=angular.isString(i.responseText)?JSON.parse(i.responseText||"{}"):i.responseText;r.$apply(function(){e(s,i.status,l||{})})})}(),function(){"use strict";function t(t,e){function i(i,o){i.ideaContent="",$("#ideaWindow").kendoWindow({width:"70%",height:"660px",title:"意见选择",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),i.ideas||t({method:"post",url:rootPath+"/idea/findMyIdea"}).then(function(t){i.ideas=t.data}),i.deleteCommonIdea=function(){var o=$("#commonIdeaTable input[type='checkbox']:checked");if(o.length<1)e.alert("请选择要删除的意见！");else{for(var n=[],a=0;a<o.length;a++)o[a].value&&n.push(o[a].value),$.each(i.ideas,function(t,e){t==o[a].name&&i.ideas.splice(t,1)});if(n.length>0){var r=n.join(",");t({method:"delete",url:rootPath+"/idea",params:{ideas:r}}).then(function(o){e.alert("删除成功！",function(){t({method:"post",url:rootPath+"/idea/findMyIdea"}).then(function(t){i.ideas=t.data})})})}}},i.addCorrentIdea=function(t){i.ideaContent+=t},i.addCommonIdea=function(){i.ideas||(i.ideas=[]),i.newIdea={},i.newIdea.ideaType="1",i.ideas.push(i.newIdea)},i.saveCommonIdea=function(){if(0==i.ideas.length)return void e.alert("请编辑你要保存的意见信息！");t({method:"post",url:rootPath+"/idea",headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(i.ideas)}).then(function(t){t.data.flag||"ok"==t.data.reCode?(i.ideas=t.data.reObj,e.alert("添加成功！")):e.alert(t.data.reMsg)})},i.saveCurrentIdea=function(){var t=$("#"+o.targetId);t.val(t.val()+i.ideaContent),window.parent.$("#ideaWindow").data("kendoWindow").close(),t.focus()}}function o(e){var i={method:"post",url:rootPath+"/idea/findMyIdea"},o=function(t){e.ideas=t.data};common.http({$http:t,httpOptions:i,success:o})}return{initIdeaData:i,initIdea:o}}angular.module("app").factory("ideaSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="处室管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteDept(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryDept=function(){e.queryDept(i)},function(){e.grid(i)}()}angular.module("app").controller("deptCtrl",t),t.$inject=["$location","deptSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="编辑处室",o.isuserExist=!1,o.deptId=i.params.deptId,o.deptId&&(o.isUpdate=!0,o.title="更新处室"),o.create=function(){e.createDept(o)},o.update=function(){e.updateDept(o)},function(){o.isUpdate&&e.getDeptById(o)}()}angular.module("app").controller("deptEditCtrl",t),t.$inject=["$location","deptSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function o(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function a(e){var i={method:"get",url:rootPath+"/dept/html/findById",params:{deptId:e.deptId}},o=function(t){t.data.offices&&(e.offices={},e.offiecs=t.data.offices),e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/fingByOData",$("#formDept")),schema:common.kendoGridConfig().schema({id:"deptId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.deptId)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"deptName",title:"处室名称",width:100,filterable:!1},{field:"deptUserName",title:"联系人",width:100,filterable:!1},{field:"address",title:"地址",width:100,filterable:!1},{field:"deptType",title:"类型",width:100,filterable:!1},{field:"",title:"状态",width:100,filterable:!1,template:function(t){return t.status?5==t.status?"正常":7==t.status?"已删除":void 0:" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.deptId+"')",t.deptId,t.deptId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var s=rootPath+"/dept",l="#/listDept";return{grid:r,getDeptById:a,createDept:n,deleteDept:o,updateDept:i,queryDept:e}}angular.module("app").factory("deptSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="办事处人员列表",n.id=e.params.deptId,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.deptOfficeGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.addOfficeUser=function(t){o.addOfficeUser(n,t)},n.remove=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),o.deletedeptOfficeUser(n,t)}})},n.removes=function(){var t=common.getKendoCheckId(".deptOfficeGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.remove(o)}},function(){o.grid(n),o.deptOfficeGrid(n)}()}angular.module("app").controller("deptOfficeUserCtrl",t),t.$inject=["$location","$state","deptSvc","deptOfficeUserSvc"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/dept/addOfficeUser",params:{deptId:e.id,officeId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.deptOfficeGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function i(e){var i={method:"get",url:common.format(d+"/getDepts")},o=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:rootPath+"/dept/deleteOfficeUsers",params:{deptId:e.id,officeId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e){var i={method:"get",url:rootPath+"/dept/html/findById",params:{officeID:e.officeID}},o=function(t){t.data.dept&&(e.depts={}),e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(u+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#allUserGridBtns").html(),"vm.addOfficeUser('"+t.officeID+"')",t.officeID)}}];t.deptOfficeGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"?deptId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var d=rootPath+"/dept",c="#/deptList",m=rootPath+"/dept/getDeptOfficeUsers",u=rootPath+"/dept/NotInoDeptfficeUsers";return{grid:l,getdeptById:r,createdept:a,deletedeptOfficeUser:n,updatedept:o,getDepts:i,deptOfficeGrid:s,addOfficeUser:e}}angular.module("app").factory("deptOfficeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="字典",o.model={},function(){t.initDictTree(function(t){function e(t,e,o){i.go("dict.edit",{id:o.id})}var n,a={callback:{onClick:e},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},r=$linq(t.value).select(function(t){var e=null;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();n=$.fn.zTree.init($("#zTree"),a,r),o.dictsTree=n})}(),o.del=function(n){e.confirm({title:"询问提示",message:"删除字典将会连下级字典一起删除，确认删除数据吗？",onOk:function(){t.deleteDict(n,o.isSubmit,function(t){o.isSubmit=!1,t.flag||"ok"==t.reCode?e.alert("消息提示","操作成功！",function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),i.go("dict",{},{reload:!0})}):e.alert(t.reMsg)})}})},o.dels=function(){var t=o.dictsTree.getSelectedNodes();t&&t.length>0?o.del(t[0].id):e.alert("请选择要删除的数据！")}}angular.module("app").controller("dictCtrl",t),t.$inject=["dictSvc","bsWin","$state"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="增加字典",n.model={},n.id=o.params.id,n.id&&(n.isUpdate=!0,n.title="编辑字典"),n.model.dictSort=0,function(){n.isUpdate?i.getDictById(n.id,function(t){t.flag||"ok"==t.reCode?(n.model=t.reObj,i.getTreeData(function(t){if(n.treeData={},n.treeData=t.value,n.isUpdate&&n.treeData&&n.model.parentId)for(var e=0;e<n.treeData.length;e++)if(n.treeData[e].dictId==n.model.parentId){n.model.parentDictName=n.treeData[e].dictName;break}})):e.alert(t.reMsg)}):(n.model.dictCode="",i.initpZtreeClient(function(t){var e={check:{enable:!0,chkStyle:"radio",radioType:"all"},callback:{},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},i=$linq(t.value).select(function(t){var e;return t.parentId&&(e=t.parentId),{id:t.dictId,name:t.dictName,pId:e}}).toArray();n.zpTree=$.fn.zTree.init($("#pzTree"),e,i)}))}(),n.createDict=function(){if(common.initJqValidation(),$("form").valid()){var t=n.zpTree.getCheckedNodes(!0);t&&t.length>0&&(n.model.parentId=t[0].id),i.createDict(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?($(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.alert("系统提示","操作成功！",function(){o.go("dict",{},{reload:!0})})):e.alert(t.reMsg)})}else e.alert("数据填写正确，请检查修改后再提交")},n.updateDict=function(){common.initJqValidation(),$("form").valid()?i.updateDict(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?($(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.alert("系统提示","操作成功！",function(){o.go("dict.edit",{id:n.model.dictId},{reload:!0})})):e.alert(t.reMsg)}):e.alert("数据填写正确，请检查修改后再提交")},n.dictTypeChange=function(){n.model.dictType&&(n.model.dictKey="")},n.apply=function(){t.$apply()}}angular.module("app").controller("dictEditCtrl",t),t.$inject=["$scope","bsWin","dictSvc","$state"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:common.format(m+"?dictCode={0}","DICT_SEX")},o=function(t){};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function a(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e,i,o){i=!0;var n={method:"post",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function s(e,i,o){i=!0;var n={method:"put",url:rootPath+"/dict",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function l(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function d(e){var i={method:"post",url:rootPath+"/dict/fingByOdata?$orderby=dictSort"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function c(e,i){var o={method:"post",url:rootPath+"/dict/fingById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}var m=(rootPath,rootPath+"/dict/dictNameData");return{initDictTree:l,createDict:r,getDictById:c,updateDict:s,deleteDict:a,initpZtreeClient:d,getTreeData:n,getdictItems:o}}angular.module("app").factory("dictSvc",t),t.$inject=["$http","$state","$location"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.model={},s.filterModel={},s.filterLow={},s.title="协审计划管理",s.splitNumArr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],s.plan={},s.planList=new Array,s.showPlan={},s.assistSign=new Array,s.pickSign=new Array,s.pickMainSign=new Array,s.lowerSign=new Array,s.selectPlanId="",s.selectMainSignId="",s.initPickLowSign=!1,s.drawType="",function(){i.initPlanPage(s),i.initPlanGrid(s),$("#planInfo li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)})}(),s.filterSign=function(t){var e=!0;if(!angular.isUndefined(t)&&(angular.isUndefined(s.filterModel.filterFilecode)||-1==t.filecode.indexOf(s.filterModel.filterFilecode)&&(e=!1),e&&(angular.isUndefined(s.filterModel.filterProjectCode)||-1==t.projectcode.indexOf(s.filterModel.filterProjectCode)&&(e=!1)),e&&(angular.isUndefined(s.filterModel.filterProjectName)||-1==t.projectname.indexOf(s.filterModel.filterProjectName)&&(e=!1)),e&&(angular.isUndefined(s.filterModel.filterBuiltName)||(angular.isUndefined(t.builtcompanyName)&&(e=!1),e&&-1==t.builtcompanyName.indexOf(s.filterModel.filterBuiltName)&&(e=!1))),e))return t},s.filterLowSign=function(t){var e=!0;if(!angular.isUndefined(t)&&(angular.isUndefined(s.filterLow.filterFilecode)||-1==t.filecode.indexOf(s.filterLow.filterFilecode)&&(e=!1),e&&(angular.isUndefined(s.filterLow.filterProjectCode)||-1==t.projectcode.indexOf(s.filterLow.filterProjectCode)&&(e=!1)),e&&(angular.isUndefined(s.filterLow.filterProjectName)||-1==t.projectname.indexOf(s.filterLow.filterProjectName)&&(e=!1)),e&&(angular.isUndefined(s.filterLow.filterBuiltName)||(angular.isUndefined(t.builtcompanyName)&&(e=!1),e&&-1==t.builtcompanyName.indexOf(s.filterLow.filterBuiltName)&&(e=!1))),e))return t},s.initSplit=function(t){s.plan.assistType==t&&(angular.isUndefined(s.plan.spliNum)||(s.plan.spliNum=0))},s.affirmSign=function(){var t=$("input[name='selASTSign']:checked");t.length<1?a.alert("请选择要挑选的项目"):t.length>1?"合并项目"==s.plan.assistType?a.alert("合并项目要先挑选一个主项目，再挑选次项目！"):a.alert("独立项目，每次只能选择一个！"):(s.model.signId=t[0].value,s.model.assistType=s.plan.assistType,s.model.single="合并项目"!=s.plan.assistType,s.model.splitNum=s.plan.spliNum,s.model.id=s.selectPlanId,s.assistSign.forEach(function(t,e){t.signid==s.model.signId&&(s.model.projectName=t.projectname)}),s.model.isDrawed="0",
s.model.assistPlanSignDtoList=s.showPlan.assistPlanSignDtoList,i.saveAssistPlan(s.model,s.isCommit,function(t){s.isCommit=!1,s.showPlan.id||s.gridOptions.dataSource.read(),s.showPlan=t.reObj,s.selectPlanId=s.showPlan.id,i.initPlanPage(s),"合并项目"==s.plan.assistType?s.showPickLowSign(s.model.signId):a.success("操作成功！")}))},s.cancelSign=function(){var t=$("input[name='checkASTSign']:checked");t.length<1?a.alert("请选择取消的项目"):common.confirm({vm:s,title:"",msg:"确认取消挑选项目吗?",fn:function(){$(".confirmDialog").modal("hide");for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.cancelPlanSign(s,e.join(","))}})},s.initSelPlan=function(){i.initSelPlan(s)},s.doDelete=function(){s.showPlan.id?a.confirm({title:"询问提示",message:"确认删除数据吗？删除数据不可恢复，请慎重！",onOk:function(){$(".confirmDialog").modal("hide"),i.deletePlan(s.showPlan.id,s.isCommit,function(t){s.isCommit=!1,i.initPlanPage(s),s.gridOptions.dataSource.read()})}}):a.alert("请选择要删除的协审计划包")},s.showPickLowSign=function(t){s.selectMainSignId=t,i.showPickLowSign(s),$("#lowerSignWin").kendoWindow({width:"1024px",height:"600px",title:"次项目信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.affirmLowerSign=function(){var t=$("input[name='selLowSign']:checked");if(t.length<1)common.alert({vm:s,msg:"请选择要挑选的次项目"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.saveLowPlanSign(s,e)}},s.cancelLowerSign=function(){var t=$("input[name='checkLowSign']:checked");if(t.length<1)a.alert("请选择要挑选的次项目");else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);i.cancelLowPlanSign(s,e.join(","))}},s.queryPlan=function(){i.queryPlan(s)};var l="";s.planId="",s.showPlanDetail=function(t){$("#planInfo").kendoWindow({width:"1024px",height:"600px",title:"协审项目清单",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),s.signNum=0,l=t,s.planId=t,i.getPlanSignByPlanId(s,t)},s.ministerOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.viceDirectorOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.directorOpinionEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(s,t)},s.assistPlan={},s.savePlanSign=function(){i.savePlanSign(s),s.assistPlan.id=l,i.savePlan(s)},s.checked="option1",s.chooseAssistUnit=function(){s.number=0,s.drawType="","option1"==s.checked&&(s.drawType="1",s.number=s.assistPlanSign.length+1),"option2"==s.checked&&(s.drawType="0",s.number=s.assistPlanSign.length),i.chooseAssistUnit(s)},s.againChooleAssistUnit=function(){$("#againChooleAssistUnit").kendoWindow({title:"选择参加协审单位",width:"600px",height:"500px",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),i.getAllUnit(s),s.num=0,"0"==s.showPlan.drawType?s.num=s.assistPlanSign.length:s.num=s.assistPlanSign.length+1},s.saveAddChooleUnit=function(t){i.saveAddChooleUnit(s,t)},s.drawAssistUnit=function(){if(console.log(s.showPlan.drawType),void 0!=s.assistPlanSign&&s.assistPlanSign.length>0)if(s.assistPlanSign.forEach(function(t,e){t.assistUnit=null}),s.drawAssistUnits=s.unitList.slice(0),"1"==s.drawType?s.drawAssistUnits.length>s.assistPlanSign.length:s.drawAssistUnits.length>=s.assistPlanSign.length){for(var t=0,e=-1,i=0;i<s.drawAssistUnits.length;i++)if("9"==s.drawAssistUnits[i].isLastUnSelected){var o=Math.floor(Math.random()*s.assistPlanSign.length);e=o,s.assistPlanSign[o].assistUnit=s.drawAssistUnits[i],s.drawPlanSign=s.assistPlanSign[o],s.drawAssistUnits.splice(i,1)}s.drawPlanSign=s.assistPlanSign[t];var a=0;s.isStartDraw=!0,s.isDrawDone=!1,s.t=n(function(){s.drawPlanSign=s.assistPlanSign[t];var i=Math.floor(Math.random()*s.drawAssistUnits.length),o=s.drawAssistUnits[i];s.showAssitUnitName=o.unitName,++a%20==0&&(t!=e?s.assistPlanSign[t].assistUnit=o:t!=s.assistPlanSign.length-1&&(s.assistPlanSign[++t].assistUnit=o),t++,t==e&&e==s.assistPlanSign.length-1&&(n.cancel(s.t),s.isDrawDone=!0),t==s.assistPlanSign.length&&(n.cancel(s.t),s.isDrawDone=!0),s.drawAssistUnits.forEach(function(t,e){t.id==o.id&&s.drawAssistUnits.splice(e,1)}))},50)}else common.alert({vm:s,msg:"当前协审单位少于项目计划数目，不能抽签！请先到项目计划表中选择参加的协审单位后再进行抽签！"})},s.saveDrawAssistUnit=function(){i.saveDrawAssistUnit(s)}}angular.module("app").controller("assistPlanCtrl",t),t.$inject=["$location","$state","assistSvc","$http","$interval","bsWin","ideaSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="协审单位",i.resource={},i.del=function(t){i.id=t,common.confirm({vm:i,title:"",msg:"确认要删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),i.resource={},e.deleteAssistUnit(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");0==t.length?common.alert({vm:i,msg:"请选择数据"}):common.confirm({vm:i,title:"",msg:"确认要删除数据吗？",fn:function(){$(".confirmDialog").modal("hide");for(var o=[],n=0;n<t.length;n++)o.push(t[n].value);var a=o.join(",");e.deleteAssistUnit(i,a)}})},i.queryAssistUnit=function(){e.queryAssistUnit(i)},function(){e.grid(i)}()}angular.module("app").controller("assistUnitCtrl",t),t.$inject=["$location","assistUnitSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()&&0==e.isUnitExist){var i={method:"post",url:s,data:e.assistUnit},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmint=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()&&0==e.isUnitExist){var i={method:"put",url:s,headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(e.assistUnit)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:s+"/getAssistUnitById",params:{id:e.id}},o=function(t){e.assistUnit=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){t.gridOptions.dataSource.read()}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/fingByOData",$("#assistUnitform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"},isUse:{},unitSort:{}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"unitSort",dir:"asc"}]}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1},{field:"unitName",title:"单位名称",width:100,filterable:!0},{field:"unitShortName",title:"单位简称",width:100,filterable:!0},{field:"principalName",title:"负责人名称",width:100,filterable:!1},{field:"principalPhone",title:"负责人电话",width:100,filterable:!1},{field:"fax",title:"负责人传真",width:100,filterable:!1},{field:"contactName",title:"联系人名称",width:100,filterable:!1},{field:"contactTell",title:"联系人手机号",width:100,filterable:!1},{field:"address",title:"企业地址",width:100,filterable:!0},{field:"isUse",title:"状态",width:100,filterable:!1,template:function(t){return t.isUse?"0"==t.isUse?"已停用":"1"==t.isUse?"在用":void 0:""}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id,t.isUse)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/assistUnit",l="#/assistUnit";return{grid:r,deleteAssistUnit:i,createAssistUnit:e,updateAssistUnit:o,getAssistUnitById:n,queryAssistUnit:a}}angular.module("app").factory("assistUnitSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="新增协审单位",o.id=i.params.id,o.isUnitExist=!1,o.id&&(o.isUpdate=!0,o.title="更新协审单位"),o.create=function(){e.createAssistUnit(o)},o.update=function(){e.updateAssistUnit(o)},function(){o.isUpdate&&e.getAssistUnitById(o)}()}angular.module("app").controller("assistUnitEditCtrl",t),t.$inject=["$location","assistUnitSvc","$state"]}(),function(){"use strict";function t(t,e){function i(){return[{field:"rowNumber",title:"序号",width:50,template:"<span class='row-number'></span>"},{field:"planName",title:"协审计划名称",width:100,filterable:!1},{field:"reportTime",title:"报审时间",width:50,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"drawTime",title:"抽签时间",width:100,filterable:!1},{field:"createdBy",title:"创建人员",width:100,filterable:!1},{field:"createdDate",title:"记录生成时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:100,filterable:!1,template:function(t){return'<button class="btn btn-xs btn-primary"  ng-click="vm.showPlanDetail(\''+t.id+'\')"><span class="glyphicon glyphicon-edit"></span>详情</button>'}}]}function o(t){var e=common.kendoGridDataSource(rootPath+"/assistPlan/findByOData",$("#searchform")),o=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i(),dataBound:o,resizable:!0}}function n(e){var i={method:"get",url:rootPath+"/assistPlan/initPlanManager"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.planList=new Array,t.data.signList&&t.data.signList.length>0&&(e.assistSign=t.data.signList),t.data.planList&&t.data.planList.length>0&&(e.planList=t.data.planList,e.selectPlanId||(e.showPlan=t.data.planList[0],e.selectPlanId=e.showPlan.id),m(e))}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/assistPlan",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/assistPlan",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function s(e,i){var o={method:"get",url:rootPath+"/sign/findByPlanId",params:{planId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.pickSign=t.data,e.pickMainSign=new Array,e.lowerSign=new Array,e.showPlan.assistPlanSignDtoList&&e.pickSign.forEach(function(t,i){e.showPlan.assistPlanSignDtoList.forEach(function(i,o){"9"==i.isMain&&i.signId==t.signid&&(t.assistType=i.assistType,e.pickMainSign.push(t))})}),1==e.initPickLowSign&&u(e)}})};common.http({vm:e,$http:t,httpOptions:o,success:n,onError:function(){e.isCommit=!1}})}function l(e,i){var o={method:"delete",url:rootPath+"/assistPlan/cancelPlanSign",params:{planId:e.selectPlanId,signIds:i}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:o,success:a,onError:function(){e.isCommit=!1}})}function d(e,i){var o=new Array;e.assistSign.forEach(function(t,n){for(var a=0,r=i.length;a<r;a++)if(t.signid==i[a]){var s={};s.signId=t.signid,s.projectName=t.projectname,s.assistType="合并项目",s.isMain="0",s.mainSignId=e.selectMainSignId,o.push(s)}}),e.model=e.showPlan,e.model.assistPlanSignDtoList=o,e.isCommit=!0;var a={method:"post",url:rootPath+"/assistPlan/saveLowPlanSign",data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.initPickLowSign=!0,n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:a,success:r,onError:function(){e.isCommit=!1}})}function c(e,i){e.isCommit=!0;var o={method:"delete",url:rootPath+"/assistPlan/cancelLowPlanSign",params:{planId:e.showPlan.id,signIds:i}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.initPickLowSign=!0,n(e),common.alert({vm:e,msg:"操作成功！",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:o,success:a,onError:function(){e.isCommit=!1}})}function m(t){t.selectPlanId?(t.planList.forEach(function(e,i){e.id==t.selectPlanId&&(t.showPlan=e,t.drawType=t.showPlan.drawType)}),s(t,t.selectPlanId)):(t.showPlan={},t.pickSign=new Array,t.pickMainSign=new Array,t.lowerSign=new Array,t.selectMainSignId="",t.initPickLowSign=!1)}function u(t){t.lowerSign=new Array,t.pickSign.forEach(function(e,i){t.showPlan.assistPlanSignDtoList.forEach(function(i,o){"0"==i.isMain&&i.mainSignId==t.selectMainSignId&&i.signId==e.signid&&t.lowerSign.push(e)})})}function p(t){t.gridOptions.dataSource.read()}function f(e,i){e.reviewNum="";var o={method:"get",url:rootPath+"/assistPlanSign/getPlanSignByPlanId",params:{planId:i}},n=function(t){e.assistPlanSign=t.data,e.reviewNum=e.assistPlanSign.length,e.assistPlanSign.length>0&&(v(e,i),C(e))};common.http({vm:e,$http:t,httpOptions:o,success:n})}function h(e){e.assistPlan.ministerOpinion=$("#ministerOpinion").val(),e.assistPlan.viceDirectorOpinion=$("#viceDirectorOpinion").val(),e.assistPlan.directorOpinion=$("#directorOpinion").val();var i={method:"put",url:rootPath+"/assistPlanSign/savePlanSign",headers:{contentType:"application/json;charset=utf-8"},dataType:"json",data:angular.toJson(e.assistPlanSign)},o=function(t){};common.http({vm:e,$http:t,httpOptions:i,success:o})}function g(e){var i={method:"put",url:rootPath+"/assistPlan",data:e.assistPlan},o=function(t){alert("保存成功！"),window.parent.$("#planInfo").data("kendoWindow").close()};common.http({vm:e,$http:t,httpOptions:i,success:o})}function v(e,i){var o={method:"get",url:rootPath+"/assistPlan/html/findById",params:{id:i}},n=function(t){e.assistPlan=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function b(e){var i={method:"get",url:rootPath+"/assistUnit/chooseAssistUnit",params:{planId:e.planId,number:e.number,drawType:e.drawType}},o=function(t){e.unitList=t.data,e.signNum=e.unitList.length,e.isChoose=!0};common.http({vm:e,$http:t,httpOptions:i,success:o})}function w(e){var i={method:"post",url:rootPath+"/assistUnitUser/findByOData"},o=function(t){e.unitUserList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function y(e){var i={method:"post",url:rootPath+"/assistUnit/fingByOData"},o=function(t){e.allUnitList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function S(e){var i="",o=e.assistPlanSign.length;e.assistPlanSign.forEach(function(t,e){i+=t.id+"|"+t.assistUnit.id,e!=o-1&&(i+=",")});var n="";if(e.drawAssistUnits.length>0){var a=e.drawAssistUnits.length;e.drawAssistUnits.forEach(function(t,e){n+=t.id,e!=a-1&&(n+=",")})}e.isCommit=!0;var r={method:"put",url:rootPath+"/assistPlan/saveDrawAssistUnit",params:{planId:e.planId,drawAssitUnitIds:i,unSelectedIds:n}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isCommit=!1,e.isCommited=!0,common.alert({closeDialog:!0,vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:r,success:s,onError:function(t){e.isCommit=!1}})}function k(e,i){if(e.unitList.length<e.num){var o=0;if(e.unitList.forEach(function(t){if(i.id==t.id)return o=-1,void common.alert({vm:e,msg:"该协审单位已被选中！"})}),-1!=o){var n={method:"post",url:rootPath+"/assistPlan/saveChooleUnit",params:{planId:e.showPlan.id,unitId:i.id}},a=function(t){common.alert({vm:e,msg:"添加成功！"})};common.http({vm:e,$http:t,httpOptions:n,success:a})}}else common.alert({vm:e,msg:"当前只能"+e.num+"家单位参与抽签"})}function C(e){var i={method:"get",url:rootPath+"/assistPlan/initAssistUnit",params:{planId:e.showPlan.id}},o=function(t){e.unitList=t.data,e.signNum=e.unitList.length,e.signNum>0&&(e.isChoose=!0)};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{initPlanPage:n,initPlanGrid:o,saveAssistPlan:a,deletePlan:r,findPlanSign:s,cancelPlanSign:l,saveLowPlanSign:d,cancelLowPlanSign:c,initSelPlan:m,showPickLowSign:u,queryPlan:p,getPlanSignByPlanId:f,savePlanSign:h,savePlan:g,initPlanByPlanId:v,chooseAssistUnit:b,saveDrawAssistUnit:S,getUnitUser:w,getAllUnit:y,saveAddChooleUnit:k,initAssistUnitByPlanId:C}}angular.module("app").factory("assistSvc",t),t.$inject=["$http","$state"]}(),function(){"dispatch strict";function t(t,e,i,o,n,a){var r=this;r.title="项目发文编辑",r.sign={},r.searchSign={},r.dispatchDoc={},r.dispatchDoc.signId=i.params.signid,r.dispatchDoc.id="",r.showFlag={buttSysFile:!1,isReveiwDS:!1},r.busiFlag={isMerge:!1,isMain:!1},function(){t.initDispatchData(r)}(),r.watchIsRelated=function(){n.$watch("vm.dispatchDoc.isRelated",function(t,e){0!=t&&"0"!=t||9!=e&&"9"!=e||1!=r.sign.isAssociate?0!=e&&"0"!=e||9!=t&&"9"!=t||r.sign.isAssociate&&0!=r.sign.isAssociate||o.confirm({title:"询问提示",message:"您要进行项目关联么？",onOk:function(){r.searchAssociateSign||(r.searchAssociateSign={signid:r.sign.signid,projectname:r.sign.projectname}),a.getAssociateSign(r.searchAssociateSign,function(t){r.currentAssociateSign=r.sign,r.associateSignList=[],t&&(r.associateSignList=t),$("#associateWindow").kendoWindow({width:"80%",height:"620px",title:"项目关联",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},onCancel:function(){r.dispatchDoc.isRelated=0}}):o.confirm({title:"询问提示",message:"该项目已经进行了关联，您要解除关联么？",onOk:function(){$(".confirmDialog").modal("hide"),a.saveAssociateSign(i.params.signid,null,function(){o.alert("项目解除关联成功"),window.location.reload()})},onCancel:function(){r.dispatchDoc.isRelated=9},onClose:function(){r.dispatchDoc.isRelated=9}})})},r.associateQuerySign=function(){a.getAssociateSign(r.searchAssociateSign,function(t){r.associateSignList=[],t&&(r.associateSignList=t)})},r.saveAssociateSign=function(t){if(r.sign.signid==t)return void o.alert("不能关联自身项目");a.saveAssociateSign(r.sign.signid,t,function(){t&&(r.sign.isAssociate=1),o.alert(void 0!=t?"项目关联成功":"项目解除关联成功",function(){window.parent.$("#associateWindow").data("kendoWindow").close()})})},r.initFileUpload=function(){r.dispatchDoc.id||n.$watch("vm.dispatchDoc.id",function(t,e){t&&t!=e&&!r.initUploadOptionSuccess&&r.initFileUpload()}),r.sysFile={businessId:r.dispatchDoc.id,mainId:r.dispatchDoc.signId,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().DISPATCH,sysBusiType:e.mainTypeValue().DISPATCH},e.initUploadOptions({inputId:"sysfileinput",vm:r})},r.sigleProject=function(){"1"==r.dispatchDoc.dispatchWay?r.busiFlag.isMerge&&r.busiFlag.isMain&&o.confirm({title:"询问提示",message:"该项目已经设为合并发文，并且已经有关联项目，如果现在要取消合并发文，以前的关联信息将被删除，您确定要取消合并发文么?",onOk:function(){$(".confirmDialog").modal("hide"),t.deleteAllMerge(r.dispatchDoc.signId,function(t){(t.flag||"ok"==t.reCode)&&(r.dispatchDoc.isMainProject="0",r.busiFlag.isMerge=!1,r.busiFlag.isMain=!1),o.alert(t.reMsg)})},onClose:function(){},onCancel:function(){r.dispatchDoc.dispatchWay="2",$(".confirmDialog").modal("hide")}}):"2"==r.dispatchDoc.dispatchWay&&(r.busiFlag.isMerge||(r.busiFlag.isMerge=!0,r.busiFlag.isMain="9"==r.dispatchDoc.isMainProject))},r.create=function(){t.saveDispatch(r)},r.count=function(){var t=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/;if(!t.test(r.dispatchDoc.declareValue))return r.dispatchDoc.declareValue=0,void $("span[data-valmsg-for='declareValue']").html("金额只能输入数字！");if(!t.test(r.dispatchDoc.authorizeValue))return r.dispatchDoc.authorizeValue=0,void $("span[data-valmsg-for='authorizeValue']").html("金额只能输入数字！");$("span[data-valmsg-for='declareValue']").html(""),$("span[data-valmsg-for='authorizeValue']").html("");var e=(parseFloat(r.dispatchDoc.declareValue)-parseFloat(r.dispatchDoc.authorizeValue)).toFixed(2),i=parseFloat(e/r.dispatchDoc.declareValue*1e4/100).toFixed(2);r.dispatchDoc.extraRate=i,r.dispatchDoc.extraValue=e},r.gotoMergePage=function(){r.busiFlag.isMain="9"==r.dispatchDoc.isMainProject,9!=r.dispatchDoc.isMainProject||r.dispatchDoc.id?(t.initMergeInfo(r,r.dispatchDoc.signId),$("#mergeSign").kendoWindow({width:"75%",height:"700px",title:"合并发文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):o.alert("请先保存！")},r.chooseSign=function(){var e=$("input[name='mergeSign']:checked");if(0==e.length)o.alert("请选择要合并发文的项目！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.chooseProject(r.dispatchDoc.signId,i.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(r,r.dispatchDoc.signId),o.alert(e.reMsg)})}},r.cancelSign=function(){var e=$("input[name='cancelMergeSignid']:checked");if(e.length<1)o.alert("请选择要取消合并发文的项目！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.cancelProject(r.dispatchDoc.signId,i.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(r,r.dispatchDoc.signId),o.alert(e.reMsg)})}},r.onClose=function(){window.parent.$("#mwindow").data("kendoWindow").close()},r.filterSign=function(t){var e=!0;if(r.searchSign.projectname&&-1==t.projectname.indexOf(r.searchSign.projectname)&&(e=!1),r.searchSign.reviewstage&&t.reviewstage!=r.searchSign.reviewstage&&(e=!1),e)return t},r.formReset=function(){r.searchSign={}}}angular.module("app").controller("dispatchEditCtrl",t),t.$inject=["dispatchSvc","sysfileSvc","$state","bsWin","$scope","signSvc"]}(),function(){"dispatch strict";function t(t,e,i,o){function n(t,e){m(e,function(e){t.unMergeSign=[],t.unMergeSign=e}),c(e,function(e){t.mergeSign=[],t.mergeSign=e})}function a(t){t.busiFlag.signleToMerge=!1;var o={method:"get",url:rootPath+"/dispatch/initData",params:{signid:t.dispatchDoc.signId}},n=function(e){var o=e.data;t.sign=o.sign,t.dispatchDoc=o.dispatch,t.dispatchDoc.signId=i.params.signid,t.dispatchDoc.dispatchWay&&2==t.dispatchDoc.dispatchWay&&(t.busiFlag.isMerge=!0),t.dispatchDoc.isMainProject&&9==t.dispatchDoc.isMainProject&&(t.busiFlag.isMain=!0),t.associateDispatchs=o.associateDispatchs,t.proofread=o.mainUserList,2==t.dispatchDoc.dispatchWay&&0==t.dispatchDoc.isMainProject&&(t.showFlag.isReveiwDS=!0),t.initFileUpload(),t.watchIsRelated()};common.http({vm:t,$http:e,httpOptions:o,success:n})}function r(t){t.isCommit=!0;var i={method:"post",url:rootPath+"/dispatch",data:t.dispatchDoc},n=function(e){t.isCommit=!1,(e.data.flag||"ok"==e.data.reCode)&&(t.dispatchDoc.dispatchWay&&2==t.dispatchDoc.dispatchWay&&(t.busiFlag.isMerge=!0),t.dispatchDoc.isMainProject&&9==t.dispatchDoc.isMainProject&&(t.busiFlag.isMain=!0),t.dispatchDoc.id||(t.dispatchDoc.id=e.data.reObj.id)),o.alert(e.data.reMsg)};common.http({$http:e,httpOptions:i,success:n,onError:function(){t.isCommit=!1}})}function s(t,i,o){var n={method:"post",url:rootPath+"/signView/mergeSign",params:{signId:t,mergeIds:i,mergeType:"2"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:e,httpOptions:n,success:a})}function l(t,i,o){var n={signId:t,mergeType:"2"};i&&(n.cancelIds=i);var a={method:"post",url:rootPath+"/signView/cancelMergeSign",params:n},r=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:e,httpOptions:a,success:r})}function d(t,i){var o={method:"post",url:rootPath+"/signView/deleteAllMerge",params:{signId:t,mergeType:"2"}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}function c(t,i){var o={method:"post",url:rootPath+"/signView/getMergeDISSign",params:{signId:t}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}function m(t,i){var o={method:"post",url:rootPath+"/signView/unMergeDISSign",params:{signId:t}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:e,httpOptions:o,success:n})}return{initDispatchData:a,saveDispatch:r,initMergeInfo:n,unMergeDISSign:m,getMergeDISSign:c,chooseProject:s,cancelProject:l,deleteAllMerge:d}}angular.module("app").factory("dispatchSvc",t),t.$inject=["sysfileSvc","$http","$state","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.searchAudit=function(){e.searchAudit(i)},i.auditToOfficial=function(){e.auditTo(i,2)},i.auditToAlternative=function(){e.auditTo(i,3)},i.auditToStop=function(){e.auditTo(i,4)},i.auditToRemove=function(){e.auditTo(i,5)},i.officialToAudit=function(){e.toAudit(i,2)},i.alternativeToAudit=function(){e.toAudit(i,3)},i.stopToAudit=function(){e.toAudit(i,4)},i.temoveToAudit=function(){e.toAudit(i,5)},function(){e.auditGrid(i)}()}angular.module("app").controller("expertAuditCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e){var i=this;i.data={},i.title="专家列表",function(){e.grid(i)}(),i.search=function(){e.searchMuti(i)},i.searchAudit=function(){e.searchMAudit(i)},i.formReset=function(){e.formReset(i)},i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpert(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}}}angular.module("app").controller("expertCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t,e,i,o,n,a,r,s){function l(t){var e={language:"zh",allowedPreviewTypes:["image"],allowedFileExtensions:["jpg","png","gif"],maxFileSize:2e3,showRemove:!1,uploadUrl:rootPath+"/expert/uploadPhoto",uploadExtraData:{expertId:t.model.expertID}};$("#expertphotofile").fileinput(e).on("filebatchselected",function(t,e){}).on("fileuploaded",function(e,i){$("#expertPhotoSrc").removeAttr("src"),$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+t.model.expertID+"&t="+Math.random())})}var d=this;d.model={},d.title="专家信息编辑",d.isuserExist=!1,d.expertID=r.params.expertID,d.showSS=!0,d.showSC=!1,d.showWS=!0,d.showWC=!1,d.MW=!1,d.MS=!1,function(){d.expertID&&o.getExpertById(d.expertID,function(t){d.model=t,d.showSS=!1,d.showSC=!0,d.showWS=!1,d.showWC=!0,l(d),$("#expertPhotoSrc").attr("src",rootPath+"/expert/transportImg?expertId="+d.model.expertID+"&t="+Math.random())})}(),d.showUploadWin=function(){d.model.expertID?$("#uploadWin").kendoWindow({width:"660px",height:"360px",title:"上传头像",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():common.alert({vm:d,msg:"先保存数据在执行操作！"})},d.saveEP=function(){common.initJqValidation(),$("form").valid()?(d.isSubmit=!0,d.model.birthDay=$("#birthDay").val(),d.model.graduateDate=$("#graduateDate").val(),o.saveExpert(d.model,d.isSubmit,function(e){d.isSubmit=!1,e.flag||"ok"==e.reCode?(d.model.expertID=e.reObj.expertID,d.model.expertNo=e.reObj.expertNo,t.success("保存成功！")):t.error(e.reMsg)})):t.alert("专家信息没有填写完整")},d.gotoWPage=function(){d.model.expertID?$("#wrwindow").kendoWindow({width:"680px",height:"420px",title:"工作简历",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},d.saveWorks=function(){common.initJqValidation($("#workForm")),$("#workForm").valid()&&(d.work.expertID||(d.work.expertID=d.model.expertID),i.saveWork(d.work,function(e){e.flag||"ok"==e.reCode?(d.work.weID?$.each(d.model.workDtoList,function(t,i){i.weID==d.work.weID&&(i=e.reObj)}):(d.model.workDtoList||(d.model.workDtoList=[]),d.model.workDtoList.push(e.reObj)),t.success(e.reMsg,function(){d.work={},d.onWClose()})):t.error(e.reMsg)}))},d.updateWork=function(){var e=$("input[name='checkwr']:checked");if(e.length<1)t.alert("请选择要更改的项目经历信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(d.model.workDtoList,function(t,e){e.weID==i&&(d.work=e)}),d.gotoWPage()}},d.deleteWork=function(){var e=$("input[name='checkwr']:checked");if(e.length<1)t.alert("请选择要删除的工作简历");else{var o=[];$.each(e,function(t,e){o.push(e.value)}),i.deleteWork(o.join(","),function(){$.each(o,function(t,e){$.each(d.model.workDtoList,function(t,i){i&&i.weID==e&&d.model.workDtoList.splice(t,1)})}),t.alert("操作成功！")})}},d.onWClose=function(){window.parent.$("#wrwindow").data("kendoWindow").close()},d.gotoJPage=function(){d.model.expertID?$("#pjwindow").kendoWindow({width:"690px",height:"330px",title:"添加项目经验",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},d.saveProject=function(){common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()&&(d.project.expertID||(d.project.expertID=d.model.expertID),d.project.projectbeginTime=$("#projectbeginTime").val(),d.project.projectendTime=$("#projectendTime").val(),e.saveProject(d.project,function(e){e.flag||"ok"==e.reCode?(d.project.peID?$.each(d.model.projectDtoList,function(t,i){i.peID==d.project.peID&&(i=e.reObj)}):(d.model.projectDtoList||(d.model.projectDtoList=[]),d.model.projectDtoList.push(e.reObj)),t.success(e.reMsg,function(){d.project={},d.onPClose()})):t.error(e.reMsg)}))},d.updateProjectPage=function(){var e=$("input[name='checkpj']:checked");if(e.length<1)t.alert("请选择要更改的项目经历信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(d.model.projectDtoList,function(t,e){e.peID==i&&(d.project=e)}),d.gotoJPage()}},d.delertProject=function(){common.initJqValidation();var i=$("input[name='checkpj']:checked");if(i.length<1)t.alert("请选择要删除的操作对象!");else{var o=[];$.each(i,function(t,e){o.push(e.value)}),e.delertProject(o.join(","),function(){$.each(o,function(t,e){$.each(d.model.projectDtoList,function(t,i){i&&i.peID==e&&d.model.projectDtoList.splice(t,1)})}),t.alert("操作成功！")})}},d.onPClose=function(){window.parent.$("#pjwindow").data("kendoWindow").close()},d.gotoExpertType=function(){d.model.expertID?$("#addExpertType").kendoWindow({width:"680px",height:"400px",title:"专家类型",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("请先保存专家信息！")},d.onETlose=function(){a.cleanValue(),window.parent.$("#addExpertType").data("kendoWindow").close()},d.saveExpertType=function(){common.initJqValidation($("#expertTypeForm")),$("#expertTypeForm").valid()&&(d.expertType.expertID||(d.expertType.expertID=d.model.expertID),a.saveExpertType(d.expertType,function(e){e.flag||"ok"==e.reCode?(d.expertType.id?$.each(d.model.expertTypeDtoList,function(t,i){i.id==d.expertType.id&&(i=e.reObj)}):(d.model.expertTypeDtoList||(d.model.expertTypeDtoList=[]),d.model.expertTypeDtoList.push(e.reObj)),t.success(e.reMsg,function(){d.expertType={},d.onETlose()})):t.error(e.reMsg)}))},d.updateProjectType=function(){var e=$("input[name='checkEType']:checked");if(e.length<1)t.alert("请选择要更改的专业信息！");else if(e.length>1)t.alert("每次只能更改一条记录！");else{var i=e.val();$.each(d.model.expertTypeDtoList,function(t,e){e.id==i&&(d.expertType=e)}),d.expertType.majobSmallDicts=s.topSelectChange(d.expertType.maJorBig,s.DICT.MAJOR.dicts),d.gotoExpertType()}},d.delertProjectType=function(){var e=$("input[name='checkEType']:checked");if(e.length<1)t.alert("请选择删除的专家类别信息！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),a.deleteExpertType(i.join(","),function(){$.each(i,function(t,e){$.each(d.model.expertTypeDtoList,function(t,i){i&&i.id==e&&d.model.expertTypeDtoList.splice(t,1)})}),t.alert("操作成功！")})}},d.gotoOfferPage=function(){d.model.expertID?$("#ep_offer_div").kendoWindow({width:"820px",height:"600px",title:"专家聘书",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():t.alert("先保存专家信息！")},d.saveOffer=function(){common.initJqValidation($("#expert_offer_form")),
$("#expert_offer_form").valid()&&(d.expertOffer.expertId=d.model.expertID,n.saveOffer(d.expertOffer,function(e){e.flag||"ok"==e.reCode?(d.expertOffer.id?$.each(d.model.expertOfferDtoList,function(t,i){i.id==d.expertOffer.id&&(i=e.reObj)}):(d.model.expertOfferDtoList||(d.model.expertOfferDtoList=[]),d.model.expertOfferDtoList.push(e.reObj)),t.success(e.reMsg,function(){d.expertOffer={},d.onETlose()})):t.error(e.reMsg)}))},d.closeOffer=function(){window.parent.$("#ep_offer_div").data("kendoWindow").close()},d.showOffer=function(){var e=$("input[name='checkps']:checked");if(e.length<1)t.alert("请选择要查看的聘书信息！");else if(e.length>1)t.alert("每次只能查看一条记录！");else{var i=e.val();$.each(d.model.expertOfferDtoList,function(t,e){if(e.id==i)return void(d.expertOffer=e)}),d.showProjectOffer=!0,d.gotoOfferPage()}},d.chooseMW=function(){d.MW=!0,d.showWS=!0,d.showWC=!1},d.cancelMW=function(){d.showWS=!1,d.showWC=!0},d.sureMW=function(){d.majorWork?(d.model.majorWork=d.majorWork,d.showWS=!1,d.showWC=!0):common.alert({vm:d,msg:"您未选择专业，请选择！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})},d.chooseMS=function(){d.MS=!0,d.showSS=!0,d.showSC=!1},d.cancelMS=function(){d.showSS=!1,d.showSC=!0},d.sureMS=function(){d.majorStudy?(d.model.majorStudy=d.majorStudy,d.showSS=!1,d.showSC=!0):common.alert({vm:d,msg:"您未选择专业，请选择！",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}}angular.module("app").controller("expertEditCtrl",t),t.$inject=["bsWin","projectExpeSvc","workExpeSvc","expertSvc","expertOfferSvc","expertTypeSvc","$state","$rootScope"]}(),function(){"use strict";function t(t,e){var i=this;!function(){e.repeatGrid(i)}()}angular.module("app").controller("expertRepeatCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expert strict";function t(t){function e(t){$("#searchform")[0].reset(),t.gridOptions.dataSource.read()}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:h,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(t){t.gridOptions.dataSource.read()}function n(e,i,o){i=!0;var n={method:"post",url:rootPath+"/expert",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function a(e,i){var o={method:"post",url:h+"/findById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(t){var e=common.kendoGridDataSource(rootPath+"/expert/findByOData",$("#searchform")),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:s(),dataBound:i,resizable:!0}}function s(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,template:"<span class='row-number'></span>"},{field:"name",title:"姓名",width:80,filterable:!0},{field:"sex",title:"性别",width:50,filterable:!0},{field:"degRee",title:"学位",width:50,filterable:!0},{field:"userPhone",title:"手机号码",width:100,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!0},{field:"degRee",title:"职称",width:100,filterable:!0},{field:"majorWork",title:"现从事专业",width:100,filterable:!0},{field:"acaDemy",title:"毕业院校",width:100,filterable:!0},{field:"expertSort",title:"专家类别",width:100,filterable:!0},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.expertID+"')",t.expertID)}}]}function l(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:100,filterable:!1},{field:"degRee",title:"学位",width:100,filterable:!1},{field:"sex",title:"性别",width:50,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!1},{field:"degRee",title:"职务",width:100,filterable:!1},{field:"",title:"专家类别",width:100,filterable:!1,template:function(t){if(t.expertTypeDtoList){for(var e="",i=0;i<t.expertTypeDtoList.length;i++)e+=0==i?t.expertTypeDtoList[i].expertType:"、"+t.expertTypeDtoList[i].expertType;return e}return""}}]}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '1' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:25,sort:{field:"createdDate",dir:"desc"}}),i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '2' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),o=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '3' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '4' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),a=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#auditform"),{filter:"state eq '5' and unable ne '1'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),r=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})};t.gridOptions1={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:r,resizable:!0},t.gridOptions2={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:r,resizable:!0},t.gridOptions3={dataSource:common.gridDataSource(o),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:r,resizable:!0},t.gridOptions4={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:r,resizable:!0},t.gridOptions5={dataSource:common.gridDataSource(a),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:l(),dataBound:r,resizable:!0}}function c(t){t.gridOptions1.dataSource.read(),t.gridOptions2.dataSource.read(),t.gridOptions3.dataSource.read(),t.gridOptions4.dataSource.read(),t.gridOptions5.dataSource.read()}function m(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findRepeatByOData"),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0}),i=function(){var t=this.items();$(t).each(function(t){$(this).find(".row-number").html(t+1)})};t.repeatGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:s(),dataBound:i,resizable:!0}}function u(t,e){var i=common.getKendoCheckId("#grid"+e);if(0==i.length)common.alert({vm:t,msg:"请选择数据"});else{for(var o=[],n=0;n<i.length;n++)o.push(i[n].value);f(t,o.join(","),1)}}function p(t,e){var i=common.getKendoCheckId("#grid1");if(0==i.length)common.alert({vm:t,msg:"请选择数据"});else{for(var o=[],n=0;n<i.length;n++)o.push(i[n].value);f(t,o.join(","),e)}}function f(e,i,o){e.isSubmit=!0;var n={method:"post",url:h+"/updateAudit",params:{ids:i,flag:o}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions1.dataSource.read(),e.gridOptions2.dataSource.read(),e.gridOptions3.dataSource.read(),e.gridOptions4.dataSource.read(),e.gridOptions5.dataSource.read(),common.alert({vm:e,msg:"操作成功"})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}var h=rootPath+"/expert";return{grid:r,auditGrid:d,getExpertById:a,saveExpert:n,deleteExpert:i,searchMuti:o,searchAudit:c,repeatGrid:m,updateAudit:f,toAudit:u,auditTo:p,formReset:e}}angular.module("app").factory("expertSvc",t),t.$inject=["$http"]}(),function(){"expert strict";function t(t,e){var i=this;i.data={},i.title="专家评分一览表"}angular.module("app").controller("expertReviewListCtrl",t),t.$inject=["$location","expertSvc"]}(),function(){"expertType strict";function t(t,e,i,o){function n(){var t=$("#addExpertType").find("input");$.each(t,function(t,e){e.value=""})}function a(e){var i={method:"GET",url:rootPath+"/expertType/getExpertType?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.expertTypeList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var o={method:"get",url:rootPath+"/expertType/getExpertTypeById",params:{expertTypeId:e.expertTypeId}},n=function(t){e.expertType=t.data,e.expertType.majobSmallDicts=i.topSelectChange(e.expertType.maJorBig,i.DICT.MAJOR.dicts)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"post",url:rootPath+"/expertType",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(i){if(common.initJqValidation($("#expertTypeForm")),$("#expertTypeForm").valid()){i.expertType.expertID=i.expertID;var o={method:"put",url:rootPath+"/expertType",data:i.expertType},a=function(t){common.requestSuccess({vm:i,response:t,fn:function(){window.parent.$("#addExpertType").data("kendoWindow").close(),e.getExpertById(i),n(),common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:i,$http:t,httpOptions:o,success:a})}}function d(e,i){var o={method:"delete",url:rootPath+"/expertType",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{cleanValue:n,getExpertType:a,getExpertTypeById:r,saveUpdate:l,deleteExpertType:d,saveExpertType:s}}angular.module("app").factory("expertTypeSvc",t),t.$inject=["$http","expertSvc","$rootScope","bsWin"]}(),function(){"projectExpe strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/dict/getAllDictByCode",params:{dictCode:"PROJECTTYPE"}},o=function(t){e.projectTypes=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(e,i){var o={method:"delete",url:rootPath+"/projectExpe/deleteProject",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e){var i={method:"get",url:common.format(rootPath+"/projectExpe/getProject?$filter=peID eq '{0}'",e.peID)},o=function(t){e.project={},e.project.projectName=t.data[0].projectName,e.project.projectType=t.data[0].projectType,e.project.projectbeginTime=t.data[0].projectbeginTime,e.project.projectendTime=t.data[0].projectendTime,e.isUpdate};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){if(common.initJqValidation($("#ProjectForm")),$("#ProjectForm").valid()){e.isSubmit=!0,e.project.peID=e.peID,e.project.expertID=e.expertID,e.project.projectbeginTime=$("#projectbeginTime").val(),e.project.projectendTime=$("#projectendTime").val();var i={method:"put",url:rootPath+"/projectExpe/updateProject",data:e.project},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#pjwindow").data("kendoWindow").close(),a(e),common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})}}common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"GET",url:rootPath+"/projectExpe/getProject?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.projectList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(t){var e=$("input[name='checkpj']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.peID=e.val(),o(t),t.expertID=t.model.expertID,gotoJPage(t))}function s(e,i){var o={method:"post",url:rootPath+"/projectExpe/saveExpe",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{getProject:a,saveProject:s,updateProject:n,updateProjectPage:r,getProjectById:o,delertProject:i,initProjectType:e}}angular.module("app").factory("projectExpeSvc",t),t.$inject=["$http"]}(),function(){"workExpe strict";function t(t,e){function i(e){var i={method:"GET",url:rootPath+"/workExpe/getWork?$filter=expert.expertID eq '"+e.model.expertID+"'"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.workList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e,i){var o={method:"delete",url:rootPath+"/workExpe/deleteWork",params:{ids:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t){var e=$("input[name='checkwr']:checked");e.length<1?common.alert({vm:t,msg:"请选择操作对象",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):e.length>1?common.alert({vm:t,msg:"无法同时操作多条数据",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}}):(t.weID=e.val(),a(t),gotoWPage(t),t.expertID=t.model.expertID)}function a(e){var i={method:"get",url:common.format(rootPath+"/workExpe/getWork?$filter=weID eq '{0}'",e.weID)},o=function(t){e.work={},e.work.companyName=t.data[0].companyName,e.work.workJob=t.data[0].workJob,e.work.beginTime=t.data[0].beginTime,e.work.endTime=t.data[0].endTime};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:rootPath+"/workExpe/saveWorkExpe",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e){if(common.initJqValidation(),$("form").valid()){e.work.weID=e.weID,e.work.expertID=e.expertID,e.work.beginTime=$("#beginTime").val(),e.work.endTime=$("#endTime").val();var o={method:"put",url:rootPath+"/workExpe/updateWork",data:e.work},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){window.parent.$("#wrwindow").data("kendoWindow").close(),i(e),cleanValue(),common.alert({vm:e,msg:"操作成功",fn:function(){e.showWorkHistory=!0,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}}return{saveWork:r,updateWork:s,deleteWork:o,updateWorkPage:n,getWorkById:a,getWork:i}}angular.module("app").factory("workExpeSvc",t),t.$inject=["$http","expertSvc"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/expertOffer",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(i){if(common.initJqValidation($("#expert_offer_form")),$("#expert_offer_form").valid()){i.expertOffer.expertId=i.model.expertID;var o={method:"put",url:rootPath+"/expertOffer",data:i.expertOffer},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){e.getExpertById(i),common.alert({vm:i,msg:"操作成功"})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}}return{saveOffer:i,updateOffer:o}}angular.module("app").factory("expertOfferSvc",t),t.$inject=["$http","expertSvc"]}(),function(){"use strict";function t(t){function e(e,i,o,n,a,r){var s={method:"post",url:rootPath+"/expertSelCondition/saveConditionList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(a),params:{businessId:e,minBusinessId:i,reviewId:n,businessType:o}},l=function(t){void 0!=r&&"function"==typeof r&&r(t.data)};common.http({$http:t,httpOptions:s,success:l})}function i(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function o(e,i,o){i=!0;var n={method:"delete",url:rootPath+"/expertSelCondition",params:{ids:e}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}return{saveCondition:e,deleteSelConditions:o,isUnsignedInteger:i}}angular.module("app").factory("expertConditionSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.parentId=e.params.parentId,n.fileId=e.params.fileId,n.fileLibrary={},function(){o.initFileFolder(function(t){function i(t,i,o){e.go("fileLibrary.fileList",{parentId:o.id,fileId:""})}var o,a={callback:{onClick:i},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},r=$linq(t).select(function(t){var e=null;return t.parentFileId&&(e=t.parentFileId),{id:t.fileId,name:t.fileName,pId:e}}).toArray();o=$.fn.zTree.init($("#zTree"),a,r),n.folderTree=o})}(),n.addFolderWindow=function(){$("#addRootFolder").kendoWindow({width:"500px",height:"300px",title:"新建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},n.saveRootFolder=function(){o.saveRootFolder(n)}}angular.module("app").controller("fileLibraryCtrl",t),t.$inject=["$scope","$state","$location","fileLibrarySvc"]}(),function(){"use strict";function t(t,e,i,o){function n(e,i){var o={method:"get",url:rootPath+"/fileLibrary/getFileUrlById",params:{fileId:i}},n=function(t){e.fileUrl=t.data.fileUrl,e.title=t.data.fileUrl,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(t){t.gridOptions.dataSource.read()}function r(i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteRootDirectory",params:{parentFileId:i.parentId}},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("fileLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteFile",params:{fileId:i}},n=function(t){e.gridOptions.dataSource.read()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(i){var o={method:"put",url:rootPath+"/fileLibrary/updateFile",data:i.fileLibrary},n=function(t){common.alert({vm:i,msg:"修改成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("fileLibrary.fileList",{parentId:i.parentId,fileId:i.fileLibrary.fileId})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}function d(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.addFolderWindow()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.fileUrl=e.fileLibrary.fileUrl,e.fileName=e.fileLibrary.fileName,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function m(e){if(common.initJqValidation(),$("form").valid()){var i={method:"post",url:rootPath+"/fileLibrary/saveFile",data:e.fileLibrary},o=function(t){e.fileId=t.data.fileId,common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function u(e){var i={method:"get",url:rootPath+"/fileLibrary/initFileFolder"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function p(i){if(void 0!=i.fileLibrary.fileName){var o={method:"post",url:rootPath+"/fileLibrary/addFileFolder",data:i.fileLibrary},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#addRootFolder").data("kendoWindow").close(),e.go("fileLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}else common.alert({vm:i,msg:"文件名不能为空",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function f(i){if(void 0!=i.fileLibrary.fileName){var o={method:"post",url:rootPath+"/fileLibrary/addFileFolder",data:i.fileLibrary},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#addChildFolder").data("kendoWindow").close(),e.go("fileLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}else common.alert({vm:i,msg:"文件名不能为空",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function h(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/fileLibrary/initFileList?fileId="+t.parentId,$("#fileLibraryForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"issue",dir:"asc"}]}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"fileName",title:"文件名",width:100,filterable:!1},{field:"",title:"附件",width:300,filterable:!1,template:function(t){if(t.sysFileDtoList.length>0){for(var e="",i=0,o=t.sysFileDtoList.length;i<o;i++)e+="<li>"+t.sysFileDtoList[i].showName+"</li>";return e}return""}},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.fileId+"')","vm.update('"+t.fileId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}return{saveRootFolder:p,saveChildFolder:f,initFileFolder:u,initFileList:h,saveFile:m,findFileById:c,updateFile:l,deleteFile:s,deleteRootDirectory:r,folderById:d,queryUser:a,getFileUrlById:n}}angular.module("app").factory("fileLibrarySvc",t),t.$inject=["$http","$state","$location","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.parentId=t.params.parentId,n.fileLibrary={},n.fileLibrary.parentFileId=n.parentId,n.fileId=t.params.fileId,n.fileUrl="",n.fileName="",n.businessFlag={isInitFileOption:!1},n.initFileUpload=function(){n.fileId||o.$watch("vm.fileId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.fileId,mainId:"",mainType:i.mainTypeValue().FILELIBRARY,sysBusiType:n.fileUrl.substring(n.fileUrl.lastIndexOf(i.mainTypeValue().FILELIBRARY),n.fileUrl.lastIndexOf(n.fileName))},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.fileId,function(t){n.sysFilelists=t})}})},function(){n.fileId&&(n.isUpdate=!0,e.findFileById(n,n.fileId),i.findByBusinessId(n.fileId,function(t){n.sysFilelists=t})),n.parentId&&(e.getFileUrlById(n,n.parentId),e.initFileList(n))}(),n.addFolderWindow=function(){n.fileLibrary.parentFileId=n.parentId,$("#addChildFolder").kendoWindow({width:"500px",height:"300px",title:"新建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},n.saveChildFolder=function(){e.saveChildFolder(n)},n.addFile=function(){t.go("fileLibrary.fileEdit",{parentId:n.parentId,fileId:""})},n.createFile=function(){e.saveFile(n)},n.update=function(e){t.go("fileLibrary.fileEdit",{parentId:n.parentId,fileId:e})},n.updateFile=function(){e.updateFile(n)},n.del=function(t){common.alert({vm:n,msg:"删除的数据将无法恢复，确定要删除？",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.deleteFile(n,t)}})},n.deleteRootDirectory=function(){e.deleteRootDirectory(n)},n.updateRootDirectory=function(){},n.queryUser=function(){e.queryUser(n)}}angular.module("app").controller("fileLibraryEditCtrl",t),t.$inject=["$state","fileLibrarySvc","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e){var i=this;i.title="专家列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteExpertReview(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.initExpertGrid(i),e.getReviewList(i)}()}angular.module("app").controller("expertReviewCtrl",t),t.$inject=["$location","expertReviewSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加附件",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新附件"),o.create=function(){e.createExpertReview(o)},o.update=function(){e.updateExpertReview(o)},function(){o.isUpdate&&e.getExpertReviewById(o)}()}angular.module("app").controller("expertReviewEditCtrl",t),t.$inject=["$location","expertReviewSvc","$state"]}(),function(){"use strict";function t(t,e,i,o){function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(){if(r.expertReview.expertSelConditionDtoList.length>0){var t=!0;return r.expertReview.expertSelConditionDtoList.forEach(function(e,i){r.expertReview.id&&(e.expertReviewDto={},e.expertReviewDto.id=r.expertReview.id),e.officialNum&&n(e.officialNum)||($("#errorsOfficialNum"+e.id).html("必填，且为数字"),t=!1),e.alternativeNum&&n(e.alternativeNum)||($("#errorsAlternativeNum"+e.id).html("必填，且为数字"),t=!1),t&&($("#errorsOfficialNum"+e.id).html(""),$("#errorsAlternativeNum"+e.id).html(""))}),t}return!1}var r=this;r.title="选择专家",r.conMaxIndex=0,r.customCondition=new Array,r.expertReview={},r.confirmEPList=[],r.matchEPMap={},r.selectIds=[],r.autoSelectedEPList=[],r.businessId=i.params.businessId,r.minBusinessId=i.params.minBusinessId,r.businessType=i.params.businessType,r.reFleshSelEPInfo=function(t){$.each(t,function(t,e){r.confirmEPList.push(e),r.selectIds.push(e.expertDto.expertID)}),r.excludeIds=r.selectIds.join(",")},r.reFleshAfterRemove=function(t){$.each(t,function(t,e){$.each(r.confirmEPList,function(t,i){i&&e==i.id&&r.confirmEPList.splice(t,1)})})},r.reFleshJoinState=function(t,e){$.each(t,function(t,i){$.each(r.confirmEPList,function(t,o){i==o.id&&(o.isJoin=e)})})},r.reFleshConfirmState=function(t,e){$.each(t,function(t,i){$.each(r.confirmEPList,function(t,o){i==o.id&&(o.isConfrim=e)})})},r.updateSelectedIndex=function(t){t?$.each(r.expertReview.expertSelConditionDtoList,function(e,i){i.id==t&&(i.selectIndex=i.selectIndex?i.selectIndex+1:1)}):$.each(r.expertReview.expertSelConditionDtoList,function(t,e){e.selectIndex=e.selectIndex?e.selectIndex+1:1})},r.init=function(e,i){t.initReview(e,i,function(t){r.expertReview=t,!angular.isUndefined(r.expertReview.expertSelectedDtoList)&&angular.isArray(r.expertReview.expertSelectedDtoList)&&($.each(r.expertReview.expertSelectedDtoList,function(t,e){r.selectIds.push(e.expertDto.expertID),r.confirmEPList.push(e)}),r.selectIds.length>0?r.excludeIds=r.selectIds.join(","):r.excludeIds="")})},function(){t.initExpertGrid(r),r.init(r.businessId,r.minBusinessId)}(),r.showSelfExpertGrid=function(){r.selfExpertOptions.dataSource.read(),$("#selfExpertDiv").kendoWindow({width:"70%",height:"680px",title:"自选评审专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.saveSelfExpert=function(){var e=common.getKendoCheckId("#selfExpertGrid");0==e.length?o.alert("请先选择专家！"):e.length>1?o.alert("自选专家最多只能选择一个！"):t.saveSelfExpert(r.businessId,r.minBusinessId,r.businessType,e[0].value,r.expertReview.id,r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.expertReview.id||(r.expertReview.id=t.idCode),r.reFleshSelEPInfo(t.reObj),o.success("操作成功！",function(){window.parent.$("#selfExpertDiv").data("kendoWindow").close()})):o.error(t.reMsg)})},r.delertSelfExpert=function(){var e=$("input[name='seletedEp']:checked");e.length<1?o.alert("请选择要删除的专家"):o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],n=0;n<e.length;n++)i.push(e[n].value);t.delSelectedExpert(r.expertReview.id,i.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.reFleshAfterRemove(i),o.success("操作成功！")):o.error(t.reMsg)})}})},r.querySelfExpert=function(){r.selfExpertOptions.dataSource.read()},r.showOutExpertGrid=function(){r.outExpertOptions.dataSource.read(),$("#outExpertDiv").kendoWindow({width:"70%",height:"680px",title:"自选新专家、市外、境外专家",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.delertOutSelfExpert=function(){var e=$("input[name='seletedOutEp']:checked");e.length<1?o.alert("请选择要删除的专家"):o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],n=0;n<e.length;n++)i.push(e[n].value);t.delSelectedExpert(r.expertReview.id,i.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.reFleshAfterRemove(i),o.success("操作成功！")):o.error(t.reMsg)})}})},r.saveOutExpert=function(){var e=common.getKendoCheckId("#outExpertGrid");if(0==e.length)o.alert("请先选择专家！");else{var i=[];$.each(e,function(t,e){i.push(e.value)}),t.saveOutExpert(r.businessId,r.minBusinessId,r.businessType,i.join(","),r.expertReview.id,r.isCommit,function(t){t.flag||"ok"==t.reCode?(r.expertReview.id||(r.expertReview.id=t.idCode),r.reFleshSelEPInfo(t.reObj),o.success("操作成功！",function(){window.parent.$("#outExpertDiv").data("kendoWindow").close()})):o.error(t.reMsg)})}},r.queryOutExpert=function(){r.outExpertOptions.dataSource.read()},r.countMatchExperts=function(e){if(r.expertReview.id){var i={};r.expertReview.expertSelConditionDtoList.forEach(function(t,o){t.id==e&&(i=t)}),t.countMatchExperts(i,r.minBusinessId,r.expertReview.id,function(t){r.matchEPMap[e]=t,$("#expertCount"+e).html(t.length)})}else o.alert("请保存整体抽取方案再计算")},r.showMatchExperts=function(t){r.matchExpertList=[],r.matchExpertList=r.matchEPMap[t],$("#matchExpertDiv").kendoWindow({width:"70%",height:"600px",title:"统计专家信息列表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.checkIntegerValue=function(t,i,o){return e.isUnsignedInteger(t)?($("#errorsOfficialNum"+o).html(""),$("#errorsAlternativeNum"+o).html(""),t):($("#errorsOfficialNum"+o).html("只能填写数字"),void $("#errorsAlternativeNum"+o).html("只能填写数字"))},r.addCondition=function(){
9==r.expertReview.state||"9"==r.expertReview.state?o.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):(r.expertReview.expertSelConditionDtoList||(r.expertReview.expertSelConditionDtoList=[]),r.condition={},r.condition.id=common.uuid(),r.condition.businessId=r.minBusinessId,r.condition.selectType="1",r.expertReview.expertSelConditionDtoList.push(r.condition))},r.removeCondition=function(){if(9==r.expertReview.state||"9"==r.expertReview.state)o.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！");else{var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],n=0;n<t.length;n++)$.each(r.expertReview.expertSelConditionDtoList,function(e,o){t[n].value==o.id&&i.push(o.id)});i.length>0?e.deleteSelConditions(i.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(o.success("操作成功！"),$.each(i,function(t,e){$.each(r.expertReview.expertSelConditionDtoList,function(t,i){e==i.id&&r.expertReview.expertSelConditionDtoList.splice(t,1)})})):o.error(t.reMsg)}):o.success("操作成功！")}}):o.alert("请选择要删除的抽取条件！")}},r.saveCondition=function(){9==r.expertReview.state||"9"==r.expertReview.state?o.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):a()?e.saveCondition(r.businessId,r.minBusinessId,r.businessType,r.expertReview.id,r.expertReview.expertSelConditionDtoList,function(t){t.flag||"ok"==t.reCode?(r.expertReview.expertSelConditionDtoList=t.reObj,r.expertReview.id||(r.expertReview.id=r.expertReview.expertSelConditionDtoList[0].expertReviewId),o.success("保存成功！")):o.error(t.reMsg)}):o.alert("专家抽取条件设置不完整！")},r.startAutoExpertWin=function(){return r.expertReview.id?9==r.expertReview.state||"9"==r.expertReview.state?void o.alert("当前项目已经进行整体专家方案的抽取，不能再修改方案！"):void(a()?e.saveCondition(r.businessId,r.minBusinessId,r.businessType,r.expertReview.id,r.expertReview.expertSelConditionDtoList,function(e){e.flag||"ok"==e.reCode?(r.expertReview.expertSelConditionDtoList=e.reObj,r.expertReview.id||(r.expertReview.id=r.expertReview.expertSelConditionDtoList[0].expertReviewId),t.queryAutoExpert(r.expertReview.expertSelConditionDtoList,r.minBusinessId,r.expertReview.id,function(e){e.flag||"ok"==e.reCode?(r.reFleshSelEPInfo(e.reObj.autoEPList),r.autoSelectedEPList=[],r.autoSelectedEPList=e.reObj.autoEPList,r.expertReview.state="9",r.showAutoExpertWin(),t.validateAutoExpert(e.reObj.allEPList,r)):o.error(e.reMsg)})):o.error(e.reMsg)}):o.alert("专家抽取条件设置不完整！")):void o.alert("请先进行整体！")},r.showAutoExpertWin=function(){$("#aotuExpertDiv").kendoWindow({width:"90%",height:"700px",title:"专家抽取",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.showAutoMatchResultWin=function(){$("#aotuMatchResultDiv").kendoWindow({width:"90%",height:"700px",title:"专家抽取结果",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.repeatAutoExpert=function(e){var i=[];if($.each(r.expertReview.expertSelConditionDtoList,function(t,o){o.id==e&&i.push(o)}),i[0].selectIndex>3)return void o.alert("该条件已经进行了3次抽取，不能再继续抽取！");t.queryAutoExpert(i,r.minBusinessId,r.expertReview.id,function(i){i.flag||"ok"==i.reCode?(r.reFleshSelEPInfo(i.reObj.autoEPList),r.expertReview.state="9",r.autoSelectedEPList=[],r.autoSelectedEPList=i.reObj.autoEPList,r.updateSelectedIndex(e),r.showAutoExpertWin(),t.validateAutoExpert(i.reObj.allEPList,r)):o.error(i.reMsg)})},r.affirmAutoExpert=function(){var e=$("#allAutoEPTable input[name='autoEPCheck']:checked");if(e.length<1)return void o.alert("请选择要确认的抽取专家！");for(var i=[],n=0;n<e.length;n++)i.push(e[n].value);t.affirmAutoExpert(r.minBusinessId,r.businessType,i.join(","),"9",function(t){o.success("操作成功"),r.reFleshConfirmState(i,"9")})},r.affirmJoinExpert=function(){$("#confirmJoinExpert").kendoWindow({width:"960px",height:"600px",title:"参加评审会专家确认",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},r.updateToJoin=function(){var e=$("#notJoinExpertTable input[name='notJoinExpert']:checked");if(e.length<1)o.alert("请选择要改为参加会议的专家");else{for(var i=[],n=0;n<e.length;n++)i.push(e[n].value);t.updateJoinState(r.minBusinessId,r.businessType,i.join(","),"9",r.isCommit,function(t){o.success("操作成功！"),r.reFleshJoinState(i,"9")})}},r.updateToNotJoin=function(){var e=$("#joinExpertTable input[name='joinExpert']:checked");if(e.length<1)o.alert("请选择未参加会议的专家");else{for(var i=[],n=0;n<e.length;n++)i.push(e[n].value);t.updateJoinState(r.minBusinessId,r.businessType,i.join(","),"0",r.isCommit,function(t){o.success("操作成功！"),r.reFleshJoinState(i,"0")})}}}angular.module("app").controller("expertSelectCtrl",t),t.$inject=["expertReviewSvc","expertConditionSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(e,i,o){var n={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:e,minBusinessId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function o(){return[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.expertID)},filterable:!1,width:25,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"name",title:"姓名",width:100,filterable:!1},{field:"degRee",title:"学位",width:100,filterable:!1},{field:"sex",title:"性别",width:50,filterable:!0},{field:"comPany",title:"工作单位",width:100,filterable:!1},{field:"degRee",title:"职务",width:100,filterable:!1},{field:"expertSort",title:"专家类别",width:100,filterable:!1}]}function n(t){var e=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},i=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#selfSelExpertForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.selfExpertOptions={dataSource:common.gridDataSource(i),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o(),dataBound:e,resizable:!0};var n=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expert/findByOData",$("#outSelExpertForm"),{filter:"state eq '3'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}});t.outExpertOptions={dataSource:common.gridDataSource(n),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o(),dataBound:e,resizable:!0}}function a(e,i,o,n,a,r,s){r=!0;var l={method:"post",url:rootPath+"/expertReview/saveExpertReview",params:{businessId:e,minBusinessId:i,businessType:o,reviewId:angular.isUndefined(a)?"":a,expertIds:n,selectType:"2"}},d=function(t){r=!1,void 0!=s&&"function"==typeof s&&s(t.data)};common.http({$http:t,httpOptions:l,success:d,onError:function(t){r=!1}})}function r(e,i,o,n,a,r,s){r=!0;var l={method:"post",url:rootPath+"/expertReview/saveExpertReview",params:{businessId:e,minBusinessId:i,businessType:o,reviewId:angular.isUndefined(a)?"":a,expertIds:n,selectType:"3"}},d=function(t){r=!1,void 0!=s&&"function"==typeof s&&s(t.data)};common.http({$http:t,httpOptions:l,success:d,onError:function(t){r=!1}})}function s(e,i,o,n){var a={method:"post",url:rootPath+"/expert/countReviewExpert",data:e,params:{minBusinessId:i,reviewId:o}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r})}function l(e){var i={method:"get",url:rootPath+"/expertReview/html/getReviewList"},o=function(t){e.reviewList=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o,onError:function(t){e.isCommit=!1}})}function d(e,i,o,n){var a={method:"post",url:rootPath+"/expert/autoExpertReview",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e),params:{minBusinessId:i,reviewId:o}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r})}function c(t,i){var o=0,n=i.autoSelectedEPList.length,a=0,r=e(function(){if(0==n)e.cancel(r);else{var s=Math.floor(Math.random()*t.length);i.showAutoExpertName=t[s].name,o++,o%10==0&&(i.autoSelectedEPList[a].show=!0,i.autoSelectedEPList[a].official=!0,i.autoSelectedEPList[a+1].show=!0,i.autoSelectedEPList[a+1].official=!1,a+=2,n-=2)}},200)}function m(e,i,o,n,a,r){a=!0;var s={method:"post",url:rootPath+"/expertReview/updateJoinState",params:{minBusinessId:e,businessType:i,expertSelId:o,state:n}},l=function(t){void 0!=r&&"function"==typeof r&&r(t.data)};common.http({$http:t,httpOptions:s,success:l,onError:function(t){a=!1}})}function u(e,i,o,n,a){var r={method:"post",url:rootPath+"/expertReview/affirmAutoExpert",params:{minBusinessId:e,businessType:i,expertSelId:o,state:n}},s=function(t){void 0!=a&&"function"==typeof a&&a(t.data)};common.http({$http:t,httpOptions:r,success:s,onError:function(t){}})}function p(e,i,o,n){o=!0;var a={method:"delete",url:rootPath+"/expertSelected",params:{reviewId:e,id:i,deleteAll:!1}},r=function(t){o=!1,void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r,onError:function(t){o=!1}})}function f(e,i){var o={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n,onError:function(t){}})}function h(e,i){var o={method:"put",url:rootPath+"/expertSelected",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function g(e,i,o){if(!b(e))return void bsWin.alert("应纳税额计算错误,保存失败！");i=!0;var n={method:"post",url:rootPath+"/expertReview/saveExpertReviewCostSingle",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function v(e,i,o){var n=rootPath+"/expertReview/getExpertReviewCost?expertIds={0}&month={1}",a={method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:common.format(n,e,i)},r=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:a,success:r})}function b(t){var e=!0;return void 0!=t&&t.length>0&&t.forEach(function(t,i){if(void 0==t.payDate)return t.errorMsg="请选择发放日期",void(e=!1);t.errorMsg="";var o=void 0==t.reviewCost?0:t.reviewCost,n=void 0==t.reviewTaxes?0:t.reviewTaxes,a=void 0==t.totalCost?0:t.totalCost;if(void 0!=t.expertSelectedDtoList&&t.expertSelectedDtoList.length>0){var r=0,s=0,l=0;if(t.expertSelectedDtoList.forEach(function(t,i){var o=void 0==t.reviewCost?0:t.reviewCost,n=void 0==t.reviewTaxes?0:t.reviewTaxes,a=void 0==t.totalCost?0:t.totalCost;if((parseFloat(o)+parseFloat(n)).toFixed(2)!=parseFloat(a).toFixed(2))return void(e=!1);r=parseFloat(r)+parseFloat(o),s=parseFloat(s)+parseFloat(n),l=parseFloat(l)+parseFloat(a)}),parseFloat(r).toFixed(2)!=parseFloat(o).toFixed(2))return void(e=!1);if(parseFloat(s).toFixed(2)!=parseFloat(n).toFixed(2))return void(e=!1);if(parseFloat(l).toFixed(2)!=parseFloat(a).toFixed(2))return void(e=!1)}}),e}return{initExpertGrid:n,saveSelfExpert:a,saveOutExpert:r,countMatchExperts:s,getReviewList:l,initReview:i,delSelectedExpert:p,queryAutoExpert:d,validateAutoExpert:c,affirmAutoExpert:u,updateJoinState:m,findByBusinessId:f,saveMark:h,savePayment:g,countTaxes:v}}angular.module("app").factory("expertReviewSvc",t),t.$inject=["$http","$interval"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="协审费用统计管理",n.financials=new Array,n.sign={},n.financial={},n.financial.businessId=i.params.signid,n.findAssistCostTable=function(){i.go("findAssistCostTable",{signid:n.financial.businessId})},n.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},n.assistCostAdd=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=n.financial.businessId;n.financial={},n.financial.chargeType="协审费用录入",n.financial.businessId=i,n.financial.projectName=t,n.financial.paymentData=e,n.financials.push(n.financial),n.i++},n.saveAssistCost=function(){e.saveAssistCost(n)},n.deleteAssistCost=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){n.financials.forEach(function(e,a){t[o].value!=e.id&&void 0!=e.id||n.financials.splice(a,1),i.push(t[o].value)});var a=i.join(",");e.deleteassistCostCount(n,a)}},function(){e.sumAssistCount(n),e.initAssistlProject(n)}()}angular.module("app").controller("assistCostCountCtrl",t),t.$inject=["$location","assistCostCountSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="财务管理",o.sign={},o.financial={},o.isuserExist=!1,o.id=i.params.id,o.financial.businessId=i.params.businessId,o.id&&(o.isUpdate=!0,o.title="更新财务管理"),o.create=function(){e.createassistCostCount(o)},o.update=function(){e.updateassistCostCount(o)},function(){e.grid(o),o.isUpdate&&e.getassistCostCountById(o)}()}angular.module("app").controller("assistCostCountSvcEditCtrl",t),t.$inject=["$location","assistCostCountSvc","$state"]}(),function(){"use strict";function t(t){function e(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function i(e){var i={method:"get",url:rootPath+"/financialManager/initfinancial",params:{signid:e.financial.businessId}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){var i={method:"get",url:rootPath+"/financialManager/html/sumfinancial",params:{businessId:e.financial.businessId}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:rootPath+"/financialManager",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){a()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(){window.location.reload()}function r(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,a()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/financialManager/assistCostCountList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:100,filterable:!1},{field:"builtcompanyName",title:"协审单位",width:100,filterable:!1},{field:"aUserName",title:"项目负责人",width:100,filterable:!1},{field:"filecode",title:"协审登记号",width:100,filterable:!1},{field:"declaration",title:"计划协审费用",width:120,filterable:!1},{field:"declaration",title:"实付协审费用",width:120,filterable:!1},{field:"signdate",title:"付款日期",width:100,filterable:!1},{field:"declaration",title:"申报金额",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var l=rootPath+"/financialManager";return{grid:s,deleteassistCostCount:r,saveAssistCost:n,sumAssistCount:o,initAssistlProject:i,isUnsignedInteger:e}}angular.module("app").factory("assistCostCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="专家费统计管理",n.financials=new Array,n.searchModel={},n.model={},n.sign={},n.financial={},n.financial.signid=i.params.signid,n.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},n.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=n.financial.signid;n.financial={},n.financial.chargeType="评审项目",n.financial.signid=i,n.financial.projectName=t,n.financial.paymentData=e,n.financials.push(n.financial),n.i++},n.saveFinancial=function(){e.savefinancial(n)},n.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:n,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){n.financials.forEach(function(e,a){t[o].value!=e.id&&void 0!=e.id||n.financials.splice(a,1),i.push(t[o].value)});var a=i.join(",");e.deleteexportCount(n,a)}},n.searchForm=function(){n.gridOptions.dataSource.read()},n.excelExport=function(){n.fileName="专家评审费明细",n.exportData=$("#statisticalGrid").data("kendoGrid")._data,e.excelExport(n,n.exportData,n.fileName)},n.formReset=function(){n.searchModel={}},function(){e.grid(n)}()}angular.module("app").controller("exportCountCtrl",t),t.$inject=["$location","exportCountSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function i(e){var i={method:"get",url:rootPath+"/exportCount/initfinancial",params:{signid:e.financial.signid}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){var i={method:"get",url:rootPath+"/exportCount/html/sumfinancial",params:{signId:e.financial.signid}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"post",url:rootPath+"/exportCount",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){a()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(){window.location.reload()}function r(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,a()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i,o){var n=window.encodeURIComponent(window.encodeURIComponent(o)),a={fileName:n},r=rootPath+"/expertSelected/expertDetailExport";if($("#searchform")){var s=common.buildOdataFilter($("#searchform"));s&&(a.$filter=s)}var l={method:"post",url:r,traditional:!0,dataType:"json",responseType:"arraybuffer",params:a},d=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:l,success:d})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertSelected/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expertDto.name",title:"姓名",width:80,filterable:!1},{field:"expertDto.idCard",title:"身份证号",width:180,filterable:!1},{field:"expertDto.openingBank",title:"开户行",width:80,filterable:!1},{field:"expertDto.bankAccount",title:"银行账号",width:180,filterable:!1},{field:"reviewCost",title:"评审费",width:80,filterable:!1},{field:"reviewTaxes",title:"应缴税",width:80,filterable:!1},{field:"expertReviewDto.reviewTitle",title:"项目名称",width:225,filterable:!1},{field:"expertReviewDto.reviewDate",title:"评审时间",width:80,filterable:!1},{field:"expertReviewDto.reviewDate",title:"函评时间",width:80,filterable:!1},{field:"principal",title:"负责人",width:75,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var d=rootPath+"/exportCount";return{grid:l,deleteexportCount:r,savefinancial:n,sumFinancial:o,initFinancialProject:i,isUnsignedInteger:e,excelExport:s}}angular.module("app").factory("exportCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t){var e="",i=0;if(t.length>0){for(var o=0;o<t.length;o++)if(i++,e+="<tr id='option"+i+"'>",e+="<td colspan='5'>",2==t[o].name.length?e+="<span style='margin-left: 6.5%;'><strong>"+t[o].name+"</strong></span>":e+="<span style='margin-left: 5%;'><strong>"+t[o].name+"</strong></span>",e+="<span style='margin-left: 8%;'></span><strong>"+t[o].expertNo+"</strong></span>",e+="<span style='margin-left: 65%;'></span><strong>合计:</strong></span>",e+="<span style='margin-left: 4%;'></span><strong>"+t[o].monthTotal+"</strong></span>",e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewcost,e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewtaxes,e+="</td>",e+="</tr>",t[o].expertCostDetailCountDtoList.length>0){for(var n=0;n<t[o].expertCostDetailCountDtoList.length;n++){i++;var a="";a+="<tr id='option"+i+"'>",a+="<td class='text-center' colspan='2'>",a+=t[o].expertCostDetailCountDtoList[n].reviewTitle,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewType,a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewcost,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewtaxes,a+="</td>",a+="</tr>"}e+=a}$("#expertCostHead").after(e)}}var a=this;a.title="专家缴税统计管理",a.model={},a.financials=new Array,a.sign={},a.financial={},a.financial.signid=i.params.signid,a.model.beginTime=i.params.beginTime,a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=a.financial.signid;a.financial={},a.financial.chargeType="评审项目",a.financial.signid=i,a.financial.projectName=t,a.financial.paymentData=e,a.financials.push(a.financial),a.i++},a.saveFinancial=function(){e.savefinancial(a)},a.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){a.financials.forEach(function(e,n){t[o].value!=e.id&&void 0!=e.id||a.financials.splice(n,1),i.push(t[o].value)});var n=i.join(",");e.deleteexpertPaymentCount(a,n)}},a.countExpertCostDetail=function(){e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo;for(var e=$("#expertCostTable tr").length,i=1;i<e;i++)$("#option"+i).remove();n(a.expertCostTotalInfo)})},a.countExpertCost=function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo})},a.getExpertCoustDetail=function(){i.go("expertPaymentDetailCountList",{beginTime:a.model.beginTime})},a.excelExport=function(){a.fileName="专家评审费统计报表"+a.model.beginTime,e.excelExport(a,a.expertCostTotalInfo,a.fileName)},function(){if(""==a.model.beginTime){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1;o=o<10?"0"+o:o,a.model.beginTime=i.toString()+"-"+o.toString(),a.year=i,a.month=o}else{var n=a.model.beginTime.split("-");a.year=n[0],a.month=n[1]}e.expertCostTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo})}()}angular.module("app").controller("expertPaymentCountCtrl",t),t.$inject=["$location","expertPaymentCountSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/expertCostTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:rootPath+"/expertSelected/expertCostDetailTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i,o){var n=window.encodeURIComponent(window.encodeURIComponent(o)),a={method:"post",url:rootPath+"/expertSelected/excelExport",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",responseType:"arraybuffer",data:angular.toJson(i),params:{fileName:n}},r=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:a,success:r})}function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(e){var i={method:"get",url:rootPath+"/expertPaymentCount/initfinancial",params:{signid:e.financial.signid}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"get",url:rootPath+"/expertPaymentCount/html/sumfinancial",params:{signId:e.financial.signid}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){var i={method:"post",url:rootPath+"/expertPaymentCount",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){l()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(){window.location.reload()}function d(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,l()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertReview/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expretCount",title:"姓名",width:100,filterable:!1},{field:"expretCount",title:"身份证号",width:100,filterable:!1},{field:"expretCount",title:"开户行",width:80,filterable:!1},{field:"expretCount",title:"银行账号",width:120,filterable:!1},{field:"reviewCost",title:"评审费（元）",width:160,filterable:!1},{field:"reviewTaxes",title:"应缴税",width:120,filterable:!1},{field:"reviewTitle",title:"项目名称",width:160,filterable:!1},{field:"reviewDate",title:"评审时间",width:160,filterable:!1},{field:"reviewDate",title:"函评时间",width:120,filterable:!1},{field:"reviewDate",title:"负责人",width:120,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var m=rootPath+"/expertPaymentCount";return{grid:c,deleteexpertPaymentCount:d,savefinancial:s,sumFinancial:r,initFinancialProject:a,isUnsignedInteger:n,expertCostTotal:e,expertCostDetailTotal:i,excelExport:o}}angular.module("app").factory("expertPaymentCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t){var e="",i=0;if(t.length>0){for(var o=0;o<t.length;o++)if(i++,e+="<tr id='option"+i+"'>",e+="<td colspan='5'>",2==t[o].name.length?e+="<span style='margin-left: 6.5%;'><strong>"+t[o].name+"</strong></span>":e+="<span style='margin-left: 5%;'><strong>"+t[o].name+"</strong></span>",e+="<span style='margin-left: 8%;'></span><strong>"+t[o].expertNo+"</strong></span>",e+="<span style='margin-left: 58%;'></span><strong>合计:</strong></span>",e+="<span style='margin-left: 4%;'></span><strong>"+t[o].monthTotal+"</strong></span>",e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewcost,e+="</td>",e+="<td class='text-center'>",e+=t[o].reviewtaxes,e+="</td>",e+="</tr>",t[o].expertCostDetailCountDtoList.length>0)for(var n=0;n<t[o].expertCostDetailCountDtoList.length;n++){i++;var a="";a+="<tr id='option"+i+"'>",a+="<td class='text-center' colspan='2'>",a+=t[o].expertCostDetailCountDtoList[n].reviewTitle,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewType,a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",void 0!=t[o].expertCostDetailCountDtoList[n].reviewDate&&(a+=t[o].expertCostDetailCountDtoList[n].reviewDate),a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewcost,a+="</td>",a+="<td class='text-center'>",a+=t[o].expertCostDetailCountDtoList[n].reviewtaxes,a+="</td>",a+="</tr>",e+=a}$("#expertCostHead").after(e)}}var a=this;a.title="专家缴税统计管理",a.model={},a.financials=new Array,a.sign={},a.financial={},a.financial.signid=i.params.signid,a.model.beginTime=i.params.beginTime,a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.getExpertCoust=function(){i.go("expertPaymentCountList",{beginTime:a.model.beginTime})},a.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=a.financial.signid;a.financial={},a.financial.chargeType="评审项目",a.financial.signid=i,a.financial.projectName=t,a.financial.paymentData=e,a.financials.push(a.financial),a.i++},a.saveFinancial=function(){e.savefinancial(a)},a.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){a.financials.forEach(function(e,n){t[o].value!=e.id&&void 0!=e.id||a.financials.splice(n,1),i.push(t[o].value)});var n=i.join(",")
;e.deleteexpertPaymentCount(a,n)}},a.countExpertCostDetail=function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo;for(var e=$("#expertCostTable tr").length,i=1;i<e;i++)$("#option"+i).remove();n(a.expertCostTotalInfo)})},function(){var t=a.model.beginTime.split("-");a.year=t[0],a.month=t[1],e.expertCostDetailTotal(a,function(t){a.expertCostTotalInfo=t.reObj.expertCostTotalInfo,n(a.expertCostTotalInfo)})}()}angular.module("app").controller("expertPaymentDetailCountCtrl",t),t.$inject=["$location","expertPaymentCountSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="专家评审基本情况统计",n.model={},n.expertRevConCount=function(){e.expertRevConCount(n,function(t){n.expertReviewConDtoList=t.reObj.expertReviewConDtoList})},n.formReset=function(){n.model={}},function(){e.expertRevConCount(n,function(t){n.expertReviewConDtoList=t.reObj.expertReviewConDtoList})}()}angular.module("app").controller("expertRevConCountCtrl",t),t.$inject=["$location","expertRevConCountSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/expertReviewCondDetailCount",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{expertRevConCount:e}}angular.module("app").factory("expertRevConCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="评审费录入",a.financials=new Array,a.sign={},a.financial={},a.financial.businessId=i.params.businessId,a.findStageCostTable=function(){n.initReview(a.financial.businessId,"",function(t){a.reviewTitle=t.reviewTitle,a.payDate=t.payDate,a.expertSelectedDtoList=t.expertSelectedDtoList,$("#stageCostWindow").kendoWindow({width:"70%",height:"600px",title:"评审费用统计表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},a.exportExcel=function(){var t=a.reviewTitle+"("+a.payDate+")";e.exportExcel(a,a.financial.businessId,t)},a.inputIntegerValue=function(t,i){e.isUnsignedInteger(t)?$("#errorsUnmber"+i).html(""):$("#errorsUnmber"+i).html("只能输入数字")},a.addFinancial=function(){var t=$("#projectName").val(),e=$("#paymentData").val(),i=a.financial.businessId;a.financial={},a.financial.chargeType="评审项目",a.financial.businessId=i,a.financial.projectName=t,a.financial.paymentData=e,a.financials.push(a.financial),a.i++},a.saveFinancial=function(){e.savefinancial(a)},a.deleteFinancial=function(){var t=$("#financialsTable input[name='financialsCheck']:checked");if(t.length<1)common.alert({vm:a,msg:"请选择要删除的记录！"});else for(var i=[],o=0;o<t.length;o++){a.financials.forEach(function(e,n){t[o].value!=e.id&&void 0!=e.id||a.financials.splice(n,1),i.push(t[o].value)});var n=i.join(",");e.deleteFinancialManager(a,n)}},function(){e.sumFinancial(a),e.initFinancialProject(a)}()}angular.module("app").controller("financialManagerCtrl",t),t.$inject=["$location","financialManagerSvc","$state","$http","expertReviewSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="评审费统计管理",n.sign={},n.financial={},n.isuserExist=!1,n.id=i.params.id,n.financial.businessId=i.params.businessId,n.id&&(n.isUpdate=!0,n.title="评审费统计管理"),n.businessFlag={expertReviews:[]},n.create=function(){e.createFinancialManager(n)},n.update=function(){e.updateFinancialManager(n)},n.findStageCostTable=function(){o.initFlowPageData(n.financial.businessId,function(){$("#stageCostWindow").kendoWindow({width:"800px",height:"400px",title:"评审费用统计表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},function(){e.grid(n),n.financial.businessId&&e.findStageCostTableList(n.financial.businessId,function(t){n.businessFlag.expertReviews=t.value,console.log(n.businessFlag.expertReviews)})}()}angular.module("app").controller("financialManagerEditCtrl",t),t.$inject=["$location","financialManagerSvc","$state","signSvc"]}(),function(){"use strict";function t(t){function e(t,e,i){var i=escape(encodeURIComponent(i));window.open(rootPath+"/financialManager/exportExcel?fileName="+i+"&businessId="+e)}function i(e,i){var o={method:"post",url:rootPath+"/expertReview/getBySignId/"+e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e){var i={method:"post",url:rootPath+"/financialManager/findByOData"},o=function(t){e.stageCountList=t.data.value};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}function a(e){var i={method:"get",url:rootPath+"/financialManager/initfinancial",params:{signid:e.financial.businessId}},o=function(t){e.model=t.data.financialDto,e.financials=t.data.financiallist};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"get",url:rootPath+"/financialManager/html/sumfinancial",params:{businessId:e.financial.businessId}},o=function(t){e.financial.stageCount=t.data,$("#financialCount").html(e.financial.stageCount)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){var i={method:"post",url:rootPath+"/financialManager",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e.financials)},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){l()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(){window.location.reload()}function d(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,l()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/financialManager/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:140,filterable:!1},{field:"designcompanyName",title:"建设单位",width:180,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"secondPriUser",title:"项目负责人",width:120,filterable:!1},{field:"projectcode",title:"计划专家费用",width:160,filterable:!1,template:function(t){return'<a href="#/financialManager/'+t.signid+'" >'+t.projectcode+"</a>"}},{field:"signdate",title:"签收日期",width:120,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var m=rootPath+"/financialManager";return{grid:c,deleteFinancialManager:d,savefinancial:s,sumFinancial:r,initFinancialProject:a,isUnsignedInteger:n,stageCostCountList:o,findStageCostTableList:i,exportExcel:e}}angular.module("app").factory("financialManagerSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目评审费分类统计",a.model={},a.projectCostCountList=function(){o.go("projectCostCountList")},a.initFinancial=function(t){var e=o.href("financialManager",{businessId:t});window.open(e,"_blank")},a.proCostClassifyCount=function(){e.projectCostClassifyCout(a,function(t){a.proReviewClassifyDetailDtoList=t.reObj.proReviewClassifyDetailDtoList,a.proReviewClassifyCountDtoList=t.reObj.proReviewClassifyCountDtoList})},a.formReset=function(){a.model={}},function(){i.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(a.orgDeptList=t.reObj)}),e.projectCostClassifyCout(a,function(t){a.proReviewClassifyDetailDtoList=t.reObj.proReviewClassifyDetailDtoList,a.proReviewClassifyCountDtoList=t.reObj.proReviewClassifyCountDtoList})}()}angular.module("app").controller("proCostClassifyCountCtrl",t),t.$inject=["$location","projectCostCountSvc","adminSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目评审费统计",a.model={},a.proCostClassifyCountList=function(){o.go("proCostClassifyCountList")},a.proCostCount=function(){e.projectCostTotal(a,function(t){a.projectReviewCostDtoList=t.reObj.projectReviewCostDtoList})},a.initFinancial=function(t){var e=o.href("financialManager",{businessId:t});window.open(e,"_blank")},a.formReset=function(){a.model={}},function(){i.initSignList(function(t){(t.flag||"ok"==t.reCode)&&(a.orgDeptList=t.reObj)}),e.projectCostTotal(a,function(t){a.projectReviewCostDtoList=t.reObj.projectReviewCostDtoList})}()}angular.module("app").controller("projectCostCountCtrl",t),t.$inject=["$location","projectCostCountSvc","adminSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/projectCostTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"post",url:rootPath+"/expertSelected/proCostClassifyTotal",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i,o){var n={method:"post",url:rootPath+"/expertSelected/excelExport",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",responseType:"arraybuffer",data:angular.toJson(i),params:{fileName:o}},a=function(t){o+=".xls";common.downloadReport(t.data,o,"vnd.ms-excel")};common.http({vm:e,$http:t,httpOptions:n,success:a})}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/expertReview/findByOData",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id"}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"expretCount",title:"姓名",width:100,filterable:!1},{field:"expretCount",title:"身份证号",width:100,filterable:!1},{field:"expretCount",title:"开户行",width:80,filterable:!1},{field:"expretCount",title:"银行账号",width:120,filterable:!1},{field:"reviewCost",title:"评审费（元）",width:160,filterable:!1},{field:"reviewTaxes",title:"应缴税",width:120,filterable:!1},{field:"reviewTitle",title:"项目名称",width:160,filterable:!1},{field:"reviewDate",title:"评审时间",width:160,filterable:!1},{field:"reviewDate",title:"函评时间",width:120,filterable:!1},{field:"reviewDate",title:"负责人",width:120,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}rootPath;return{grid:n,projectCostTotal:e,projectCostClassifyCout:i,excelExport:o}}angular.module("app").factory("projectCostCountSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){function n(t,e){var i,o,n;try{i=t.toString().split(".")[1].length}catch(t){i=0}try{o=e.toString().split(".")[1].length}catch(t){o=0}return n=Math.pow(10,Math.max(i,o)),(t*n+e*n)/n}function a(){r.total.projectcount=0,r.total.declarevalue=0,r.total.authorizevalue=0,r.total.ljhj=0,r.total.hjl=0,r.protReviewConditionList.forEach(function(t,e){void 0!=t.proCount&&(r.total.projectcount+=t.proCount),void 0!=t.declareValue&&(r.total.declarevalue=n(r.total.declarevalue,t.declareValue)),void 0!=t.authorizeValue&&(r.total.authorizevalue=n(r.total.authorizevalue,t.authorizeValue)),void 0!=t.ljhj&&(r.total.ljhj=n(r.total.ljhj,t.ljhj))}),r.total.hjl=Math.round(r.total.ljhj/r.total.declarevalue*1e4)/1e4*100}var r=this;r.title="项目评审情况统计",r.model={},r.total={},r.proReviewConCount=function(){if(console.log(r.model),null!=r.model.beginTime&&""!=r.model.beginTime){var t=r.model.beginTime.split("-");r.year=t[0],r.begMonth=t[1],"0"==r.begMonth.charAt(0)&&(r.begMonth=r.begMonth.charAt(1))}if(null!=r.model.endTime&&""!=r.model.endTime){var t=r.model.endTime.split("-");r.year=t[0],r.endMonth=t[1],"0"==r.endMonth.charAt(0)&&(r.endMonth=r.endMonth.charAt(1))}e.proReviewConCount(r,function(t){r.protReviewConditionList=t.reObj.protReviewConditionList,a()})},r.formReset=function(){r.model={}},function(){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1,n=t.getDate();o=o<10?"0"+o:o,r.model.beginTime=i.toString()+"-01",r.model.endTime=i.toString()+"-"+o.toString(),r.year=i,r.begMonth="1",r.endMonth=o,r.begDay="31",r.endDay=n,e.proReviewConCount(r,function(t){r.protReviewConditionList=t.reObj.protReviewConditionList,a()})}()}angular.module("app").controller("proReviewConditionCtrl",t),t.$inject=["$location","proReviewConditionSvc","$state","$http"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"post",url:rootPath+"/expertSelected/proReviewConditionCount",data:e.model},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{proReviewConCount:e}}angular.module("app").factory("proReviewConditionSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目归档编辑",a.fileRecord={},a.fileRecord.signId=e.params.signid,a.fileRecord.fileRecordId="",a.signId=e.params.signid,a.initFileUpload=function(){a.fileRecord.fileRecordId||n.$watch("vm.fileRecord.fileRecordId",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.fileRecord.fileRecordId,mainId:a.signId,mainType:i.mainTypeValue().SIGN,sysfileType:i.mainTypeValue().DOFILE,sysBusiType:i.mainTypeValue().DOFILE},i.initUploadOptions({inputId:"sysfileinput",vm:a})},function(){t.initFileRecordData(a)}(),a.create=function(){t.saveFileRecord(a)}}angular.module("app").controller("fileRecordEditCtrl",t),t.$inject=["fileRecordSvc","$state","sysfileSvc","bsWin","$scope"]}(),function(){"use strict";function t(t,e){function i(t){var i={method:"get",url:rootPath+"/fileRecord/initFillPage",params:{signId:t.fileRecord.signId}},o=function(e){null!=e.data&&""!=e.data&&(t.fileRecord=e.data.file_record,t.fileRecord.signId=t.signId,t.signUserList=e.data.sign_user_List,t.initFileUpload())};common.http({vm:t,$http:e,httpOptions:i,success:o})}function o(i){if(common.initJqValidation($("#fileRecord_form")),$("#fileRecord_form").valid()){i.signUserList.forEach(function(t,e){i.fileRecord.signUserid==t.id&&(i.fileRecord.signUserName=t.displayName)}),i.isCommit=!0;var o={method:"post",url:rootPath+"/fileRecord",data:i.fileRecord},n=function(e){i.isCommit=!1,e.data.flag||"ok"==e.data.reCode?(i.fileRecord=e.data.reObj,i.fileRecord.signId=i.signId,t.success("操作成功！")):t.error(e.data.reMsg)};common.http({$http:e,httpOptions:o,success:n,onError:function(t){i.isCommit=!1}})}}return{initFileRecordData:i,saveFileRecord:o}}angular.module("app").factory("fileRecordSvc",t),t.$inject=["bsWin","$http"]}(),function(){"use strict";function t(t,e){var i=this;i.header={},i.id="",i.create=function(e){e&&(i.header.id=e,i.isUpdate=!0,t.getHeaderById(i,e)),i.header={},$("#addHeaderWindow").kendoWindow({width:"500px",height:"300px",title:"新建表字段",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},i.save=function(){t.createHeader(i)},i.queryUser=function(){i.gridOptions.dataSource.read()},i.del=function(e){t.deleteHeader(i,e)},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.update=function(){t.updateHeader(i)},function(){t.headerGrid(i)}()}angular.module("app").controller("headerCtrl",t),t.$inject=["headerSvc","bsWin"]}(),function(){"use strict";function t(t,e){function i(i){common.initJqValidation();$("form").valid();if(void 0!=i.header.headerKey&&void 0!=i.header.headerName&&void 0!=i.header.headerType){var o={method:"put",url:rootPath+"/header/updateHeader",data:i.header},n=function(t){t.data.flag||"ok"==t.data.reCode?(e.success("修改成功!"),window.parent.$("#addHeaderWindow").data("kendoWindow").close(),i.gridOptions.dataSource.read()):e.error(t.data.reMsg)};common.http({vm:i,$http:t,httpOptions:o,success:n})}}function o(i,o){var n={method:"delete",url:rootPath+"/header",params:{id:o}},a=function(t){e.success("删除成功！"),i.gridOptions.dataSource.read()};common.http({vm:i,$http:t,httpOptions:n,success:a})}function n(e,i){var o={method:"get",url:rootPath+"/header/getHeaderById",params:{id:i}},n=function(t){e.header=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e,i){var o={method:"post",url:rootPath+"/header/findHeaderListSelected",params:{headerType:e.headerType}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"put",url:rootPath+"/header/updateSelectedHeader",params:{idStr:i}},n=function(t){};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"put",url:rootPath+"/header/updateCancelHeader",params:{idStr:i}},n=function(t){};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(i){common.initJqValidation();$("form").valid();if(console.log(i.header),void 0!=i.header.headerKey&&void 0!=i.header.headerName&&void 0!=i.header.headerType){console.log(12324);var o={method:"post",url:rootPath+"/header/createHeader",data:i.header},n=function(t){t.data.flag||"ok"==t.data.reCode?(e.success("操作成功！"),window.parent.$("#addHeaderWindow").data("kendoWindow").close(),i.gridOptions.dataSource.read()):e.error(t.data.reMsg)};common.http({vm:i,$http:t,httpOptions:o,success:n})}}function d(e){var i={method:"post",url:rootPath+"/header/findHeaderListNoSelected",params:{headerType:e.headerType}},o=function(t){e.allHeaderList=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/header/findAllHeader",$("#headerForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"headerName",title:"列名",width:100,filterable:!1},{field:"headerKey",title:"key值",width:100,filterable:!1},{field:"headerType",title:"类型",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')","vm.create('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{headerGrid:c,createHeader:l,findHeaderListNoSelected:d,updateSelectedHeader:r,updateCancelHeader:s,findHeaderListSelected:a,deleteHeader:o,getHeaderById:n,updateHeader:i}}angular.module("app").factory("headerSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.selectedHeaderList=[],i.selectList={},i.headerType=e.params.headerType,i.allChecked=function(){var t=$("#selectHeaderForm").find("input");$.each(t,function(t,e){e.checked=!0})},i.allCancel=function(){var t=$("#selectHeaderForm").find("input");$.each(t,function(t,e){e.checked=!1})},i.addHeader=function(){for(var e=[],o=0;o<i.allHeaderList.length;o++){var n=i.allHeaderList[o];n.checkbox&&(e.push(n.id),i.selectedHeaderList.push(n),i.allHeaderList.splice(o,1),o=0,n.checkbox=!1)}var a=e.join(",");t.updateSelectedHeader(i,a)},i.cancelHeader=function(){for(var e=[],o=0;o<i.selectedHeaderList.length;o++){var n=i.selectedHeaderList[o];n.checkbox&&(e.push(n.id),i.allHeaderList.push(n),i.selectedHeaderList.splice(o,1),o=0,n.checkbox=!1)}var a=e.join(",");t.updateCancelHeader(i,a)},i.changeType=function(){t.findHeaderListNoSelected(i),i.selectedHeaderList=[]},function(){t.findHeaderListNoSelected(i),t.findHeaderListSelected(i)}()}angular.module("app").controller("headerEditCtrl",t),t.$inject=["headerSvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="",i.changePwd=function(){e.changePwd(i)}}angular.module("app").controller("homeCtrl",t),t.$inject=["$location","homeSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var o={method:"put",url:i,data:e.model.password},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}}var i="/account/password";return{changePwd:e}}angular.module("app").factory("homeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="日志列表",function(){e.grid(i)}()}angular.module("app").controller("logCtrl",t),t.$inject=["$location","logSvc"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(o+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"id",title:"ID",width:80,filterable:!1},{field:"level",title:"级别",width:100,filterable:!0},{field:"message",title:"日志内容",filterable:!1},{field:"userId",title:"操作者",width:150,filterable:!0},{field:"createdDate",title:"操作时间",width:180,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var o=rootPath+"/log";rootPath;return{grid:i}}angular.module("app").factory("logSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="会议室列表",i.model={},i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteMeeting(i,t)}})},i.used=function(t){i.model.id=t,i.model.mrStatus="1",e.roomUseState(i)},i.stoped=function(t){common.confirm({vm:i,title:"",msg:"确定停用会议室么？",fn:function(){$(".confirmDialog").modal("hide"),i.model.id=t,i.model.mrStatus="2",e.roomUseState(i)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryMeeting=function(){e.queryMeeting(i)},function(){e.grid(i)}()}angular.module("app").controller("meetingCtrl",t),t.$inject=["$location","meetingSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加会议室",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新会议室"),o.create=function(){e.createMeeting(o)},o.update=function(){e.updateMeeting(o)},function(){o.isUpdate&&e.getMeetingById(o)}()}angular.module("app").controller("meetingEditCtrl",t),t.$inject=["$location","meetingSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function i(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function o(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e){var i={method:"put",url:d+"/roomUseState",data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o,onError:function(t){e.iscommit=!1}})}}function r(e){var i={method:"get",url:d+"/html/findByIdMeeting",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/fingByOData",$("#meetingFrom")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"num",title:"编号",width:100,filterable:!1},{field:"mrName",title:"会议室名称",width:150,filterable:!1},{field:"mrType",title:"类型",width:100,filterable:!1},{field:"addr",title:"会议室地点",width:200,filterable:!1},{field:"capacity",title:"容量",width:80,filterable:!1},{field:"",title:"状态",width:50,template:function(t){return"2"==t.mrStatus?"停用":"正常"}},{field:"",title:"操作",width:100,template:function(t){var e=!1;return e="2"==t.mrStatus,common.format($("#columnBtns").html(),"vm.stoped('"+t.id+"')",e,"vm.used('"+t.id+"')",e,t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function l(e){var i={method:"post",url:rootPath+"/meeting/findAll"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}var d=rootPath+"/meeting",c="#/meeting";return{grid:s,getMeetingById:r,createMeeting:a,deleteMeeting:o,updateMeeting:i,queryMeeting:e,roomUseState:n,findAllMeeting:l}}angular.module("app").factory("meetingSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){function o(t){var e={};if(void 0!=t.flow){var i=t.flow.processInstanceId;(angular.isUndefined(t.flow.hideFlowImg)||0==t.flow.hideFlowImg)&&(t.picture=rootPath+"/flow/processInstance/img/"+i),e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/processInstance/history/"+i),schema:common.kendoGridConfig().schema({id:"id"}),rowNumber:!0,headerCenter:!0})}var o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:40},{field:"nodeName",title:"环节名称",width:120,filterable:!1},{field:"displayName",title:"处理人",width:80,filterable:!1},{field:"startTime",title:"开始时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endTime",title:"结束时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"durationStr",title:"处理时长",width:120,filterable:!1},{field:"message",title:"处理信息",width:300,filterable:!1}];t.historygrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,resizable:!0,dataBound:function(){var e=this.items();$(e).each(function(i){i==e.length-1&&d(t),$(this).find(".row-number").html(i+1)})}}}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/flow/processInstance/history/"+t.instanceId),schema:common.kendoGridConfig().schema({id:"hctId"}),rowNumber:!0,headerCenter:!0}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:40},{field:"nodeName",title:"环节名称",width:120,filterable:!1},{field:"displayName",title:"处理人",width:80,filterable:!1},{field:"startTime",title:"开始时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"endTime",title:"结束时间",width:120,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"durationStr",title:"处理时长",width:120,filterable:!1},{field:"message",title:"处理信息",width:300,filterable:!1}];t.historygrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items();$(t).each(function(t){$(this).find(".row-number").html(t+1)})}}}function a(e,i,o){var n={method:"post",url:rootPath+"/flow/processInstance/flowNodeInfo",params:{taskId:e,processInstanceId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function r(e,i,o){if(common.initJqValidation($("#flow_form")),$("#flow_form").valid()){e=!0;var n={method:"post",url:rootPath+"/flow/commit",data:i},a=function(t){e=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){e=!1}})}}function s(e,i,o){i=!0;var n={method:"post",url:rootPath+"/flow/rollbacklast",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(t){i=!1}})}function l(e){var i={method:"post",url:rootPath+"/flow/rollbacklast",data:e.flow},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function d(t){t.backNode=[];for(var e=t.historygrid.dataSource.data(),i=e.length,o=0;o<i;o++)e[o].assignee&&e[o].endTime&&t.backNode.push({activitiId:e[o].activityId,activitiName:e[o].activityName,assignee:e[o].assignee})}function c(e,i){var o={method:"post",url:rootPath+"/flow/suspend/"+i,data:e.projectStop},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?e.isCommit=!1:(window.parent.$("#spwindow").data("kendoWindow").close(),e.gridOptions.dataSource.read())}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n,
onError:function(){e.isCommit=!1}})}function m(e,i){e.isCommit=!0;var o={method:"post",url:rootPath+"/flow/active/"+i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?e.isCommit=!1:e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n,onError:function(){e.isCommit=!1}})}function u(e){if(null==e.flow.dealOption||""==e.flow.dealOption)return void common.alert({vm:e,msg:"请填写处理信息！"});var i={method:"post",url:rootPath+"/flow/deleteFLow",data:e.flow},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功！"})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{initFlowData:o,getFlowInfo:a,commit:r,rollBackToLast:s,rollBack:l,initBackNode:d,suspendFlow:c,activeFlow:m,deleteFlow:u,historyData:n}}angular.module("app").factory("flowSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s){function l(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var d=this;d.title="待办任务处理",d.businessKey=e.params.businessKey,d.processKey=e.params.processKey,d.taskId=e.params.taskId,d.instanceId=e.params.instanceId,d.currentFlow,d.showFlag={businessNext:!1,businessTr:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),d.picture=rootPath+"/flow/processInstance/img/"+d.instanceId,n.historyData(d),n.getFlowInfo(d.taskId,d.instanceId,function(t){if(d.flow=t,d.currentFlow=t,d.flow.end)d.showFlag.nodeNext=!1;else switch(d.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:o.initFlowNode(d.flow,d.showFlag,d)}}),d.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:o.initFlowDeal(d);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:s.initFlowDeal(d);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:a.initFlowDeal(d)}}(),d.initFileUpload=function(t,e,i){d.sysFile={businessId:d.businessKey,mainId:d.businessKey,mainType:t,sysfileType:e,sysBusiType:i},sysfileSvc.initUploadOptions({inputId:"sysfileinput",vm:d})},d.commonDownloadSysFile=function(t){sysfileSvc.downloadFile(t)},d.ideaEdit=function(e){angular.isObject(e)||(e={}),t.initIdeaData(d,e)},d.selectedIdea=function(){d.flow.dealOption=d.chooseIdea},d.commitFlow=function(){if(d.flow.isSuspended)return void i.error("该流程目前为暂停状态，不能进行流转操作！");n.commit(d.isCommit,d.flow,function(t){t.flag||"ok"==t.reCode?i.success("操作成功！",function(){e.go("agendaTasks")}):i.alert(t.reMsg)})},d.backFlow=function(){common.initJqValidation($("#flow_form")),$("#flow_form").valid()&&i.confirm({title:"询问提示",message:"确认回退吗？",onOk:function(){n.rollBackToLast(d.flow,d.isCommit,function(t){d.isCommit=!1,t.flag||"ok"==t.reCode?i.alert("回退成功！",function(){e.go("agendaTasks")}):i.alert(t.reMsg)})}})},d.editSelectExpert=function(t){d.scoreExpert={},$.each(d.model.expertReviewDto.expertSelectedDtoList,function(e,i){if(i.id==t)return void(d.scoreExpert=i)}),$("#star").raty({score:function(){return $(this).attr("data-num",angular.isUndefined(d.scoreExpert.score)?0:d.scoreExpert.score),$(this).attr("data-num")},starOn:"../contents/libs/raty/lib/images/star-on.png",starOff:"../contents/libs/raty/lib/images/star-off.png",starHalf:"../contents/libs/raty/lib/images/star-half.png",readOnly:!1,halfShow:!0,size:34,click:function(t,e){d.scoreExpert.score=t}}),$("#score_win").kendoWindow({width:"820px",height:"365px",title:"编辑-专家星级",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},d.closeEditMark=function(){window.parent.$("#score_win").data("kendoWindow").close()},d.saveMark=function(){common.initJqValidation($("#expert_score_form")),$("#expert_score_form").valid()?r.saveMark(d.scoreExpert,function(){i.success("保存成功！",function(){d.closeEditMark()})}):i.alert("请填写评分和评分内容！")},d.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void i.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void i.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void i.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var e,o=t.expertSelectedDtoList.length,n="";$.each(t.expertSelectedDtoList,function(t,e){n+="'"+e.id+"'",t!=o-1&&(n+=",")});var a=t.payDate;e=a.substring(0,a.lastIndexOf("-")),r.countTaxes(n,e,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,o){var n=o.EXPERTID,a=o.id,r=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==n&&t.ESID!=a&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),r=parseFloat(r)+t.REVIEWCOST)}),o.reviewCost=void 0==o.reviewCost?0:o.reviewCost;var s=r+parseFloat(o.reviewCost);o.reviewTaxes=l(s).toFixed(2),o.totalCost=(parseFloat(o.reviewCost)+parseFloat(o.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(o.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(o.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)})})}}},d.closeEditPay=function(){window.parent.$("#payment").data("kendoWindow").close()},d.savePayment=function(t){common.initJqValidation($("#payform")),$("#payform").valid()?r.savePayment(t,d.isCommit,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！",function(){d.isCommit=!1}):i.alert(t.reMsg)}):i.alert("请正确填写专家评审费信息！")}}angular.module("app").controller("flowDealCtrl",t),t.$inject=["ideaSvc","$state","bsWin","topicSvc","flowSvc","bookBuyBusinessSvc","expertReviewSvc","assertStorageBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="在办任务详情页",r.businessKey=t.params.businessKey,r.processKey=t.params.processKey,r.taskId=t.params.taskId,r.instanceId=t.params.instanceId,r.showFlag={businessNext:!1,businessTr:!1,showUploadFile:!1,buttBack:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),r.picture=rootPath+"/flow/processInstance/img/"+r.instanceId,i.historyData(r),r.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:e.initFlowDeal(r);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:n.initFlowDeal(r);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:a.initFlowDeal(r)}o.findByBusinessId(r.businessKey,function(t){t&&t.length>0&&(r.sysFilelists=t,r.showFlag.showUploadFile=!0)})}()}angular.module("app").controller("flowDetailCtrl",t),t.$inject=["$state","topicSvc","flowSvc","sysfileSvc","bookBuyBusinessSvc","assertStorageBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.title="待办任务处理",r.businessKey=t.params.businessKey,r.processKey=t.params.processKey,r.instanceId=t.params.instanceId,r.showFlag={businessNext:!1,businessTr:!1,showUploadFile:!1,buttBack:!1},function(){switch($("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),i.historyData(r),r.processKey){case flowcommon.getFlowDefinedKey().TOPIC_FLOW:e.initFlowDeal(r);break;case flowcommon.getFlowDefinedKey().BOOKS_BUY_FLOW:n.initFlowDeal(r);break;case flowcommon.getFlowDefinedKey().ASSERT_STORAGE_FLOW:a.initFlowDeal(r)}o.findByBusinessId(r.businessKey,function(t){t&&t.length>0&&(r.sysFilelists=t,r.showFlag.showUploadFile=!0)})}()}angular.module("app").controller("flowEndCtrl",t),t.$inject=["$state","topicSvc","flowSvc","sysfileSvc","bookBuyBusinessSvc","assertStorageBusinessSvc"]}(),function(){"use strict";var t={SIGN_ZR:"SIGN_ZR",SIGN_QS:"SIGN_QS",SIGN_ZHB:"SIGN_ZHB",SIGN_FGLD_FB:"SIGN_FGLD_FB",SIGN_BMFB1:"SIGN_BMFB1",SIGN_BMFB2:"SIGN_BMFB2",SIGN_BMFB3:"SIGN_BMFB3",SIGN_BMFB4:"SIGN_BMFB4",SIGN_XMFZR1:"SIGN_XMFZR1",SIGN_XMFZR2:"SIGN_XMFZR2",SIGN_XMFZR3:"SIGN_XMFZR3",SIGN_XMFZR4:"SIGN_XMFZR4",SIGN_BMLD_SPW1:"SIGN_BMLD_SPW1",SIGN_BMLD_SPW2:"SIGN_BMLD_SPW2",SIGN_BMLD_SPW3:"SIGN_BMLD_SPW3",SIGN_BMLD_SPW4:"SIGN_BMLD_SPW4",SIGN_FGLD_SPW1:"SIGN_FGLD_SPW1",SIGN_FGLD_SPW2:"SIGN_FGLD_SPW2",SIGN_FGLD_SPW3:"SIGN_FGLD_SPW3",SIGN_FGLD_SPW4:"SIGN_FGLD_SPW4",SIGN_FW:"SIGN_FW",SIGN_QRFW:"SIGN_QRFW",SIGN_BMLD_QRFW_XB:"SIGN_BMLD_QRFW_XB",SIGN_BMLD_QRFW:"SIGN_BMLD_QRFW",SIGN_FGLD_QRFW_XB:"SIGN_FGLD_QRFW_XB",SIGN_FGLD_QRFW:"SIGN_FGLD_QRFW",SIGN_ZR_QRFW:"SIGN_ZR_QRFW",SIGN_FWBH:"SIGN_FWBH",SIGN_CWBL:"SIGN_CWBL",SIGN_GD:"SIGN_GD",SIGN_DSFZR_QRGD:"SIGN_DSFZR_QRGD",SIGN_QRGD:"SIGN_QRGD"},e={TOPIC_JHTC:"TOPIC_JHTC",TOPIC_BZSH_JH:"TOPIC_BZSH_JH",TOPIC_FGLD_JH:"TOPIC_FGLD_JH",TOPIC_ZRSH_JH:"TOPIC_ZRSH_JH",TOPIC_BFGW:"TOPIC_BFGW",TOPIC_LXDW:"TOPIC_LXDW",TOPIC_QDHT:"TOPIC_QDHT",TOPIC_YJSS:"TOPIC_YJSS",TOPIC_NBCS:"TOPIC_NBCS",TOPIC_GZFA:"TOPIC_GZFA",TOPIC_BZSH_FA:"TOPIC_BZSH_FA",TOPIC_FGLD_FA:"TOPIC_FGLD_FA",TOPIC_ZRSH_FA:"TOPIC_ZRSH_FA",TOPIC_CGJD:"TOPIC_CGJD",TOPIC_KTBG:"TOPIC_KTBG",TOPIC_BZSH_BG:"TOPIC_BZSH_BG",TOPIC_FGLD_BG:"TOPIC_FGLD_BG",TOPIC_ZRSH_BG:"TOPIC_ZRSH_BG",TOPIC_KTJT:"TOPIC_KTJT",TOPIC_BZSH_JT:"TOPIC_BZSH_JT",TOPIC_FGLD_JT:"TOPIC_FGLD_JT",TOPIC_ZRSH_JT:"TOPIC_ZRSH_JT",TOPIC_YFZL:"TOPIC_YFZL",TOPIC_ZLGD:"TOPIC_ZLGD"},i={BOOK_LEADER_CGQQ:"BOOK_LEADER_CGQQ",BOOK_BZSP:"BOOK_BZSP",BOOK_FGFZRSP:"BOOK_FGFZRSP",BOOK_ZXZRSP:"BOOK_ZXZRSP",BOOK_YSRK:"BOOK_YSRK"},o={FINAL_SIGN_FLOW:"FINAL_SIGN_FLOW",TOPIC_FLOW:"TOPIC_FLOW",BOOKS_BUY_FLOW:"BOOKS_BUY_FLOW",ASSERT_STORAGE_FLOW:"ASSERT_STORAGE_FLOW"},n={getFlowDefinedKey:function(){return o},getSignFlowNode:function(){return t},getTopicFlowNode:function(){return e},getBooksBuyFlowNode:function(){return i},getAssertStorageFlowNode:function(){return i}};window.flowcommon=n}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="待办事项",n.addregister={},n.model={},n.model.signid=i.params.signid,function(){n.showPrint=!1,e.grid(n)}(),n.print=function(){signcommon.registerFilePrint(n,{$http:o})},n.findbySuppleDate=function(t){}}angular.module("app").controller("registerFileCtrl",t),t.$inject=["$location","registerFileSvc","$state","$http"]}(),function(){"use strict";function t(t,e){function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridinlineConfig().transport(t,{readUrl:o+"/findByOData",updateUrl:o+"/update",destroyUrl:o+"/delete",createUrl:o+"/create/"+t.model.signid},{filter:"signid eq '"+t.model.signid+"'"}),schema:common.kendoGridConfig().schema({id:"id",fields:{fileName:{validation:{required:!0},type:"String"},totalNum:{type:"number",validation:{required:!0,min:1}},isHasOriginfile:{type:"boolean"},isHasCopyfile:{type:"boolean"},suppleDeclare:{type:"string"},suppleDate:{type:"date"},createdDate:{type:"date"},modifiedDate:{type:"date"}}}),batch:!0,pageSize:10,serverPaging:!0,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},n=[{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"fileName",title:"资料名称",width:"120px",filterable:!1},{field:"totalNum",title:"份数",width:"120px",filterable:!1},{field:"isHasOriginfile",title:"原件",width:"120px",filterable:!1,template:function(t){return t.isHasOriginfile?"是":"否"}},{field:"isHasCopyfile",title:"复印件",width:"120px",filterable:!1,template:function(t){return t.isHasCopyfile?"是":"否"}},{field:"suppleDeclare",title:"补充说明",width:"120px",filterable:!1},{field:"suppleDate",title:"补充日期",width:"120px",format:"{0:yyyy-MM-dd}",filterable:!1},{command:["destroy"],title:"&nbsp;",width:"250px"}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridinlineConfig().filterable,pageable:common.kendoGridinlineConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:n,toolbar:["create","save","cancel"],dataBound:i,editable:!0,navigatable:!0,resizable:!0}}var o=rootPath+"/addRegisterFile";return{grid:i}}angular.module("app").factory("registerFileSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.showsupp=!1,n.title="拟补资料函",n.suppletter={},n.model={},n.model.signid=i.params.signid,n.suppletter.id=i.params.id,n.addSuppContent=function(){n.showsupp=!0,$("#addsuppContent").kendoWindow({width:"50%",height:"80%",title:"拟补资料函正文",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()}}angular.module("app").controller("suppletterCtrls",t),t.$inject=["$location","suppletterSvc","$state","$http"]}(),function(){"use strict";function t(t,e){return{}}angular.module("app").factory("suppletterSvc",t),t.$inject=["$rootScope","$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="优秀评审报告管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletemonthlyHistory(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.monthlyHistoryGrid(i),e.deleteGridOptions(i)}()}angular.module("app").controller("monthlyHistoryCtrl",t),t.$inject=["$location","monthlyHistorySvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加月报简报历史数据",n.isuserExist=!1,n.id=i.params.id,n.monthly={},n.id&&(n.isUpdate=!0,n.title="更新月报简报"),n.createHistory=function(){common.initJqValidation(),$("form").valid()?e.createmonthlyHistory(n.monthly,function(t){t.flag||"ok"==t.reCode?o.alert("操作成功！"):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},n.update=function(){e.updatemonthlyHistory(n)},function(){n.isUpdate&&e.getmonthlyHistoryById(n)}()}angular.module("app").controller("monthlyHistoryEditCtrl",t),t.$inject=["$location","monthlyHistorySvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:s+"/deleteHistory",data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:s+"/savaHistory",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e){var i={method:"get",url:rootPath+"/monthlyHistory/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/mothlyHistoryList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"startDay",title:"开始时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"startDay",title:"结束时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"stageMunber",title:"已评审项目数",width:120,filterable:!1},{field:"declarationSum",title:"报审总投资",width:100,filterable:!1},{field:"assessorSum",title:"审核总投资",width:100,filterable:!1},{field:"authorizedUser",title:"录入人",width:100,filterable:!1},{field:"authorizedTime",title:"录入时间",width:100,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"/deleteHistoryList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"startDay",title:"开始时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"startDay",title:"结束时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"stageMunber",title:"已评审项目数",width:120,filterable:!1},{field:"declarationSum",title:"报审总投资",width:100,filterable:!1},{field:"assessorSum",title:"审核总投资",width:100,filterable:!1},{field:"authorizedUser",title:"录入人",width:100,filterable:!1},{field:"authorizedTime",title:"录入时间",width:100,filterable:!1}];t.deleteGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}var s=rootPath+"/monthlyNewsletter";return{monthlyHistoryGrid:a,deleteGridOptions:r,createmonthlyHistory:o,deletemonthlyHistory:i,getmonthlyHistoryById:n,updatemonthlyHistory:e}}angular.module("app").factory("monthlyHistorySvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="年度月报简报",i.addSuppQuery=function(){e.addSuppQuery(i)},i.resetAddSupp=function(){var t=$("#form_monthly").find("input,select");$.each(t,function(t,e){e.value=""})},i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deletemonthlyMultiyear(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.monthlyMultiyearGrid(i),e.monthlyAppoveGrid(i),e.monthlyYearGrid(i),e.findAllOrg(i),e.findAllUser(i)}()}angular.module("app").controller("monthlyMultiyearCtrl",t),t.$inject=["$location","monthlyMultiyearSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="添加中心文件稿纸",a.isuserExist=!1,a.isSubmit=!0,a.suppletter={},a.id=i.params.id,a.suppletter.id=i.params.id,a.id&&(a.isUpdate=!0,a.title="更新中心文件稿纸"),a.businessFlag={isInitFileOption:!1},a.updateApprove=function(){t.updateApprove(a)},a.initFileUpload=function(){a.suppletter.id||n.$watch("vm.suppletter.id",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.suppletter.id,mainId:a.suppletter.id,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().CENTER_FILE,sysBusiType:e.mainTypeValue().CENTER_FILE},e.initUploadOptions({inputId:"sysfileinput",vm:a})},a.addSuppContent=function(){if(a.suppletter.id){a.showsupp=!0;$("#addsuppMonthly").kendoWindow({width:"60%",height:"90%",title:"中心文件附件",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open(),t.findByBusinessId(a)}else o.alert("请先保存业务数据")},a.saveAddSuppletter=function(){common.initJqValidation(),$("form").valid()?t.createmonthlyMultiyear(a.suppletter,function(t){t.flag||"ok"==t.reCode?o.alert("操作成功！"):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},a.updateAddSuppletter=function(){common.initJqValidation(),$("form").valid()?t.updatemonthlyMultiyear(a.suppletter,function(t){t.flag||"ok"==t.reCode?o.alert("操作成功！"):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},function(){a.isUpdate&&t.getmonthlyMultiyearById(a),t.initMonthlyMultiyear(a),t.findByBusinessId(a)}()}angular.module("app").controller("monthlyMultiyearEditCtrl",t),t.$inject=["monthlyMultiyearSvc","sysfileSvc","$state","bsWin","$scope"]}(),function(){"use strict";function t(t,e){function i(e){var i={method:"get",url:common.format(g+"/findAllUsers")},o=function(t){e.userlist={},e.userlist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){var i={method:"get",url:common.format(g+"/getOrg")},o=function(t){e.orglist={},e.orglist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){t.monthlyYearGrid.dataSource.read()}function a(i){var o={method:"post",url:h+"/updateApprove",data:i.suppletter},n=function(t){e.success("操作成功！")};common.http({vm:i,$http:t,httpOptions:o,success:n})}function r(e){var i={method:"post",url:rootPath+"/file/findByBusinessId",params:{businessId:e.suppletter.id}},o=function(t){e.sysFilelists=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){e.isSubmit=!0;var i={method:"post",url:h+"/initMonthlyMultiyear"},o=function(t){e.suppletter=t.data,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e,i){var o={method:"post",url:h+"/saveMonthlyMultiyear",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(e,i){e.isSubmit=!0;var o={method:"delete",url:h+"/deleteMutiyear",data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"post",url:h+"/saveMonthlyMultiyear",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function m(e){var i={method:"get",url:rootPath+"/addSuppLetter/findById",params:{id:e.id}},o=function(t){e.suppletter=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function u(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(h+"/monthlyMultiyearList",$("#form_monthly")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:180,filterable:!1,template:function(t){return'<a href="#/monthlyMultiyearEdit/'+t.id+'" >'+t.title+"</a>"}},{field:"orgName",title:"拟办部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:120,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1},{field:"secretLevel",title:"秘密等级",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.monthlyYearGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function p(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(h+"/monthlyAppoveList"),schema:{data:"value",total:function(t){return t.count?$("#MONTHLY_COUNT").html(t.count):$("#MONTHLY_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:180,filterable:!1,template:function(t){return'<a href="#/monthlyMultiyearEdit/'+t.id+'" >'+t.title+"</a>"}},{field:"orgName",title:"拟办部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:120,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1},{field:"secretLevel",title:"秘密等级",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.monthlyAppoveGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function f(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(h+"/monthlyMultiyearList",$("#form")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"title",title:"文件标题",width:180,filterable:!1,template:function(t){return'<a href="#/monthlyMultiyearEdit/'+t.id+'" >'+t.title+"</a>"}},{field:"orgName",title:"拟办部门",width:100,filterable:!1},{field:"userName",title:"拟稿人",width:120,filterable:!1},{field:"suppLetterTime",title:"拟稿时间",width:100,filterable:!1},{field:"secretLevel",title:"秘密等级",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.id)}}];t.multiyearGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}var h=rootPath+"/monthlyNewsletter",g=rootPath+"/user";return{createmonthlyMultiyear:c,initMonthlyMultiyear:s,monthlyMultiyearGrid:f,monthlyAppoveGrid:p,monthlyYearGrid:u,getmonthlyMultiyearById:m,updatemonthlyMultiyear:l,findByBusinessId:r,updateApprove:a,addSuppQuery:n,findAllOrg:o,findAllUser:i,deletemonthlyMultiyear:d}}angular.module("app").factory("monthlyMultiyearSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="月报简报",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteMonthlyNewsletter(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.monthlyNewsletterGrid(i),e.monthlyDeleteGrid(i),e.theMonthGrid(i)}()}angular.module("app").controller("monthlyNewsletterCtrl",t),t.$inject=["$location","monthlyNewsletterSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="添加月报简报",n.isuserExist=!1,n.id=i.params.id,n.monthly={},n.id&&(n.isUpdate=!0,n.title="更新月报简报"),n.createMothlyNewsletter=function(){common.initJqValidation(),$("form").valid()?e.createMonthlyNewsletter(n.monthly,function(t){t.flag||"ok"==t.reCode?o.alert("操作成功！"):o.error(t.reMsg)}):o.alert("缺少部分没有填写，请仔细检查")},n.update=function(){e.updateMonthlyNewsletter(n)},function(){n.isUpdate&&e.getMonthlyNewsletterById(n)}()}angular.module("app").controller("monthlyNewsletterEditCtrl",t),t.$inject=["$location","monthlyNewsletterSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:l+"/deleteMonthlyData",data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:l+"/savaMonthlyNewsletter",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e){var i={method:"get",url:rootPath+"/monthlyNewsletter/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/getMonthlyList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"reportMultiyear",title:"报告年度",width:100,filterable:!1},{field:"theMonths",title:"报告月份",width:100,filterable:!1},{field:"remark",title:"报告说明",width:100,filterable:!1},{field:"authorizedUser",title:"编制人",width:100,filterable:!1},{field:"authorizedTime",title:"编制时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function r(t){var e=new kendo.data.DataSource({type:"odata",
transport:common.kendoGridConfig().transport(l+"/deleteMonthlyList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:5,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"reportMultiyear",title:"报告年度",width:100,filterable:!1},{field:"theMonths",title:"报告月份",width:100,filterable:!1},{field:"remark",title:"报告说明",width:100,filterable:!1},{field:"authorizedUser",title:"编制人",width:100,filterable:!1},{field:"authorizedTime",title:"编制时间",width:100,filterable:!1,format:"{0: yyyy-MM-dd HH:mm:ss}"}];t.monthlyDeleteGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/getMonthlyList"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"monthlyNewsletterName",title:"名称",width:100,filterable:!1,template:function(t){return'<a href="#/monthlyFindByMultiyear/"'+t.id+'">'+t.monthlyNewsletterName+"</a>"}},{field:"reportMultiyear",title:"年份",width:100,filterable:!1},{field:"remark",title:"备注",width:100,filterable:!1},{field:"authorizedTime",title:"添加时间",width:100,filterable:!1}];t.theMonthGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}var l=rootPath+"/monthlyNewsletter";return{monthlyNewsletterGrid:a,monthlyDeleteGrid:r,theMonthGrid:s,createMonthlyNewsletter:o,deleteMonthlyNewsletter:i,getMonthlyNewsletterById:n,updateMonthlyNewsletter:e}}angular.module("app").factory("monthlyNewsletterSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="处室人员管理",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOfficeUser(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryOffice=function(){e.queryOffice(i)},function(){e.grid(i)}()}angular.module("app").controller("officeUserCtrl",t),t.$inject=["$location","officeUserSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加人员",o.isuserExist=!1,o.officeID=i.params.officeID,o.officeID&&(o.isUpdate=!0,o.title="更新人员"),o.create=function(){e.createOfficeUser(o)},o.update=function(){e.updateOfficeUser(o)},function(){o.isUpdate&&e.getOfficeUserById(o),e.getDepts(o)}()}angular.module("app").controller("officeUserEditCtrl",t),t.$inject=["$location","officeUserSvc","$state"]}(),function(){"use strict";function t(t){function e(t){t.gridOptions.dataSource.read()}function i(e){var i={method:"get",url:common.format(l+"/getDepts")},o=function(t){e.depts={},e.depts=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:l,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=d}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e){var i={method:"get",url:rootPath+"/officeUser/html/findById",params:{officeID:e.officeID}},o=function(t){t.data.dept,e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#formOffice")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.officeID)},filterable:!1,width:20,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:30,filterable:!1,template:"<span class='row-number'></span>"},{field:"officeUserName",title:"办事处联系人",width:100,filterable:!1},{field:"deptName",title:"所在办事处",width:100,filterable:!1},{field:"officePhone",title:"电话",width:100,filterable:!1},{field:"officeEmail",title:"邮件",width:100,filterable:!1},{field:"officeDesc",title:"描述",width:100,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.officeID+"')",t.officeID)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var l=rootPath+"/officeUser",d="#/officeUserList";return{grid:s,getOfficeUserById:r,createOfficeUser:a,deleteOfficeUser:n,updateOfficeUser:o,getDepts:i,queryOffice:e}}angular.module("app").factory("officeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="部门列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteOrg(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryOrg=function(){e.queryOrg(i)},function(){e.grid(i)}()}angular.module("app").controller("orgCtrl",t),t.$inject=["$location","orgSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.title="新增部门",n.isorgExist=!1,n.model.id=i.params.id,n.model.id&&(n.isUpdate=!0,n.title="更新部门"),function(){e.initRoleUsers(function(t){n.orgMLeaderUsers=t.DIRECTOR,n.orgSLeaderUser=t.VICE_DIRECTOR,n.OrgDirectorUsers=t.DEPT_LEADER}),n.isUpdate&&e.getOrgById(n.model.id,function(t){n.model=t})}(),n.create=function(){common.initJqValidation(),$("form").valid()?($.each(n.OrgDirectorUsers,function(t,e){e.id==n.model.orgDirector&&(n.model.orgDirectorName=e.displayName)}),$.each(n.orgMLeaderUsers,function(t,e){e.id==n.model.orgMLeader&&(n.model.orgMLeaderName=e.displayName)}),$.each(n.orgSLeaderUser,function(t,e){e.id==n.model.orgSLeader&&(n.model.orgSLeaderName=e.displayName)}),e.createOrg(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?(n.model.id||(n.model.id=t.idCode),o.success("操作成功！")):o.error(t.reMsg)})):o.alert("信息填写不完整或者填写不正确，请检查改正之后再保存！")},n.update=function(){common.initJqValidation(),$("form").valid()?($.each(n.OrgDirectorUsers,function(t,e){e.id==n.model.orgDirector&&(n.model.orgDirectorName=e.displayName)}),$.each(n.orgMLeaderUsers,function(t,e){e.id==n.model.orgMLeader&&(n.model.orgMLeaderName=e.displayName)}),$.each(n.orgSLeaderUser,function(t,e){e.id==n.model.orgSLeader&&(n.model.orgSLeaderName=e.displayName)}),e.updateOrg(n.model,n.isSubmit,function(t){n.isSubmit=!1,t.flag||"ok"==t.reCode?o.success("操作成功！"):o.error(t.reMsg)})):o.alert("信息填写不完整或者填写不正确，请检查改正之后再保存！")}}angular.module("app").controller("orgEditCtrl",t),t.$inject=["$location","orgSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e){function i(t){t.gridOptions.dataSource.read()}function o(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"/fingByOData",$("#orgForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"sort",dir:"asc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"name",title:"部门名称",width:130,filterable:!1},{field:"orgFunction",title:"职能",width:130,filterable:!1},{field:"orgDirectorName",title:"部门负责人",width:100,filterable:!1},{field:"orgSLeaderName",title:"分管领导",width:100,filterable:!1},{field:"orgPhone",title:"电话",width:130,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function n(e,i,o){i=!0;var n={method:"post",url:c,data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function a(e){var i={method:"get",url:common.format(c+"/getCompany")},o=function(t){e.company={},e.company=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e,i){var o={method:"post",url:rootPath+"/org/getOrgById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i,o){i=!0;var n={method:"put",url:rootPath+"/org",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function l(e,i){e.isSubmit=!0;var o={method:"delete",url:c,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function d(e){var i={method:"post",url:rootPath+"/user/initRoleUsers"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}var c=rootPath+"/org";rootPath;return{grid:o,createOrg:n,getOrgById:r,updateOrg:s,deleteOrg:l,getCompany:a,initRoleUsers:d,queryOrg:i}}angular.module("app").factory("orgSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.id=e.params.id,n.showAddUserDialog=function(){$(".addUser").modal({backdrop:"static",keyboard:!1}),n.orgUserGrid.dataSource.read()},n.closeAddUserDialog=function(){$(".addUser").modal("hide")},n.add=function(t){o.add(n,t)},n.remove=function(t){o.remove(n,t)},n.removes=function(){var t=common.getKendoCheckId(".orgUserGrid");if(0==t.length)common.alert({vm:n,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.remove(o)}},function(){o.orgUserGrid(n),o.allUserGrid(n)}()}angular.module("app").controller("orgUserCtrl",t),t.$inject=["$location","$state","orgSvc","orgUserSvc"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"delete",url:rootPath+"/org/deleteUsers",params:{orgId:e.id,userId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/org/addUsers",params:{orgId:e.id,userId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.orgUserGrid.dataSource.read(),e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(r+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"loginName",title:"登录名",width:200,filterable:!0},{field:"displayName",title:"显示名",width:200,filterable:!0},{field:"remark",title:"描述",filterable:!1},{field:"",title:"操作",width:80,template:function(t){return common.format($("#allUserGridBtns").html(),"vm.add('"+t.id+"')")}}];t.orgUserGrid={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s+"?orgId="+t.id),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!1,serverSorting:!1,serverFiltering:!1,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"loginName",title:"登录名",width:200,filterable:!1},{field:"displayName",title:"显示名",width:200,filterable:!1},{field:"remark",title:"描述",filterable:!1},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.remove('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var r=rootPath+"/org/userNotIn",s=rootPath+"/org/users";return{orgUserGrid:a,allUserGrid:n,add:o,remove:i}}angular.module("app").factory("orgUserSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目暂停审批",function(){e.grid(a),n.initIdea(a)}(),a.pauseProjectWindow=function(t,i){e.pauseProjectWindow(a,t,i)},a.commitProjectStop=function(){e.updateProjectStop(a)},a.closewin=function(){window.parent.$("#spwindow").data("kendoWindow").close()},a.selectMinisterIdea=function(){a.projectStop.directorIdeaContent+=a.directorIdea},a.selectDirectorIdea=function(){a.projectStop.leaderIdeaContent+=a.leaderIdea}}angular.module("app").controller("pauseProjectCtrl",t),t.$inject=["$location","pauseProjectSvc","$state","adminSvc","ideaSvc"]}(),function(){"use strict";function t(t,e,i){function o(t,e,i){t.sign={},t.projectStop={},t.projectStop.signid=e,$("#spwindow").kendoWindow({width:"1000px",height:"600px",title:"暂停项目审批处理",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),a(t,e),r(t,e),""!=i&&(t.showIdea=!0,l(t,i))}function n(o,n){var a={method:"get",url:rootPath+"/projectStop/findPausingProject",params:{signId:n}},r=function(t){""!=t.data?i.success("该项目暂停申请正在处理"):e.go("projectStopForm",{signId:n,stopId:""})};common.http({vm:o,$http:t,httpOptions:a,success:r})}function a(e,i){var o={method:"get",url:rootPath+"/projectStop/initProjectBySignId",params:{signId:i}},n=function(t){e.sign=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"get",url:rootPath+"/projectStop/countUsedWorkday",params:{signId:i}},n=function(t){e.sign.countUsedWorkday=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function s(o){if(common.initJqValidation(),$("#form").valid()){var n=[];$("#file1").is(":checked")&&n.push($("#file1").val()),$("#file2").is(":checked")&&n.push($("#file2").val());var a=n.join(",");o.projectStop.material=a;var r={method:"post",url:rootPath+"/projectStop/savePauseProject",data:o.projectStop},s=function(t){i.success("操作成功"),e.go("personDtasks")};common.http({vm:o,$http:t,httpOptions:r,success:s})}}function l(e,i,o){var n={method:"get",url:rootPath+"/projectStop/getProjectStopByStopId",params:{stopId:i}},a=function(t){if(void 0!=o&&"function"==typeof o)return o(t.data)};common.http({vm:e,$http:t,httpOptions:n,success:a})}function d(o){if(common.initJqValidation(),$("#form").valid()){var n={method:"post",url:rootPath+"/projectStop/updateProjectStop",data:o.projectStop},a=function(t){i.success("操作成功"),e.go("pauseProject")};common.http({vm:o,$http:t,httpOptions:n,success:a})}}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/projectStop/findByOData"),schema:{data:"value",total:function(t){return t.count?$("#PAUSE_COUNT").html(t.count):$("#PAUSE_COUNT").html(0),t.count},model:{id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"",title:"项目名称",width:200,filterable:!1,template:function(t){return t.sign.projectname}},{field:"",title:"评审阶段",width:100,filterable:!1,template:function(t){return t.sign.reviewstage}},{field:"createdDate",title:"申请日期",width:100,format:"{0:yyyy-MM-dd}",filterable:!1},{field:"",title:"操作",width:100,filterable:!1,template:function(t){return common.format($("#columnBtns").html(),t.sign.signid,t.stopid)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}return{pauseProjectWindow:o,pauseProject:s,initProject:a,countUsedWorkday:r,grid:c,getProjectStopByStopId:l,updateProjectStop:d,findPausingProject:n}}angular.module("app").factory("pauseProjectSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.sign={};var o=t.params.signId,n=t.params.stopId;i.projectStop={},i.projectStop.signid=o,function(){e.initProject(i,o),e.countUsedWorkday(i,o),""!=n&&(i.showIdea=!0,e.getProjectStopByStopId(i,n,function(t){i.projectStop=t,void 0==i.projectStop.directorIdeaContent&&(i.projectStop.directorIdeaContent=""),void 0==i.projectStop.leaderIdeaContent&&(i.projectStop.leaderIdeaContent="")}))}(),i.commitProjectStop=function(){""!=n?e.updateProjectStop(i):e.pauseProject(i)},i.selectMinisterIdea=function(){i.projectStop.directorIdeaContent+=i.directorIdea},i.selectDirectorIdea=function(){i.projectStop.leaderIdeaContent+=i.leaderIdea},i.Checked=function(){$("#fileNo").is(":checked")&&($("#file1").prop("checked",!1),$("#file2").prop("checked",!1))},i.Checked2=function(){$("#fileNo").prop("checked",!1)}}angular.module("app").controller("projectStopFormCtrl",t),t.$inject=["$state","pauseProjectSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="个人代办",function(){e.getUser(i)}(),i.cancelTakeUser=function(){""==i.takeUser||null==i.takeUser?common.confirm({vm:i,title:"",msg:"暂无代办人！？",fn:function(){$(".confirmDialog").modal("hide")}}):common.confirm({vm:i,title:"",msg:"确认取消该代办人？",fn:function(){$(".confirmDialog").modal("hide"),e.cancelTakeUser(i)}})},i.showChooseTakeUser=function(){$("#chooseTakeUserWindow").kendoWindow({width:"500px",height:"300px",title:"选择代办人",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),e.initAllUser(i)},i.saveTakeUser=function(){e.saveTakeUser(i)}}angular.module("app").controller("takeUserCtrl",t),t.$inject=["$location","takeUserSvc"]}(),function(){"use strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/user/getAllUserDisplayName"},o=function(t){e.users=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(e){if(common.initJqValidation(),$("#form").valid()){var i={method:"post",url:rootPath+"/user/saveTakeUser",params:{takeUserId:e.takeUserId}},n=function(t){e.chooseTakeUser=!1,common.confirm({vm:e,title:"",msg:"保存成功！",fn:function(){$(".confirmDialog").modal("hide"),window.parent.$("#chooseTakeUserWindow").data("kendoWindow").close(),o(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}}function o(e){var i={method:"get",url:rootPath+"/user/getUserByLoginName"},o=function(t){e.takeUser=t.data.displayName};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(e){var i={method:"get",url:rootPath+"/user/cancelTakeUser"},n=function(t){o(e)};common.http({vm:e,$http:t,httpOptions:i,success:n})}return{initAllUser:e,saveTakeUser:i,getUser:o,cancelTakeUser:n}}angular.module("app").factory("takeUserSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.parentId=e.params.parentId,n.fileId=e.params.fileId,n.fileLibrary={},function(){o.initPolicyFolder(function(t){function i(t,i,o){e.go("policyLibrary.policyList",{parentId:o.id,fileId:""})}var o,a={callback:{onClick:i},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}}},r=$linq(t).select(function(t){var e=null;return t.parentFileId&&(e=t.parentFileId),{id:t.fileId,name:t.fileName,pId:e}}).toArray();o=$.fn.zTree.init($("#zTree"),a,r),n.folderTree=o})}(),n.addFolderWindow=function(){$("#addRootFolder").kendoWindow({width:"500px",height:"300px",title:"新建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},n.saveRootFolder=function(){o.saveRootFolder(n)}}angular.module("app").controller("policyLibraryCtrl",t),t.$inject=["$scope","$state","$location","policyLibrarySvc"]}(),function(){"use strict";function t(t,e,i,o){function n(e,i){var o={method:"get",url:rootPath+"/fileLibrary/getFileUrlById",params:{fileId:i}},n=function(t){e.fileUrl=t.data.fileUrl,e.title=t.data.fileUrl,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(t){t.gridOptions.dataSource.read()}function r(i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteRootDirectory",params:{parentFileId:i.parentId}},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("policyLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"delete",url:rootPath+"/fileLibrary/deleteFile",params:{fileId:i}},n=function(t){e.gridOptions.dataSource.read()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(i){var o={method:"put",url:rootPath+"/fileLibrary/updateFile",data:i.fileLibrary},n=function(t){common.alert({vm:i,msg:"修改成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.go("policyLibrary.policyList",{parentId:i.parentId,fileId:i.fileLibrary.fileId})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}function d(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.addFolderWindow()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"get",url:rootPath+"/fileLibrary/findFileById",params:{fileId:i}},n=function(t){e.fileLibrary=t.data,e.fileUrl=e.fileLibrary.fileUrl,e.fileName=e.fileLibrary.fileName,e.initFileUpload()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function m(e){if(common.initJqValidation(),$("form").valid()){var i={method:"post",url:rootPath+"/fileLibrary/savePolicyFile",data:e.fileLibrary},o=function(t){e.fileId=t.data.fileId,common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function u(e){var i={method:"get",url:rootPath+"/fileLibrary/initPolicyFolder"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function p(i){if(void 0!=i.fileLibrary.fileName){var o={method:"post",url:rootPath+"/fileLibrary/addPolicyFolder",data:i.fileLibrary},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#addRootFolder").data("kendoWindow").close(),e.go("policyLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}else common.alert({vm:i,msg:"文件名不能为空",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function f(i){if(void 0!=i.fileLibrary.fileName){var o={method:"post",url:rootPath+"/fileLibrary/addPolicyFolder",data:i.fileLibrary},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){i.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#addChildFolder").data("kendoWindow").close(),e.go("policyLibrary",{},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}else common.alert({vm:i,msg:"文件名不能为空",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}function h(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/fileLibrary/initFileList?fileId="+t.parentId,$("#fileLibraryForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:[{field:"issue",dir:"asc"}]}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.anId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"fileName",title:"文件名",width:100,filterable:!1},{field:"",title:"附件",width:300,filterable:!1,template:function(t){if(t.sysFileDtoList.length>0){for(var e="",i=0,o=t.sysFileDtoList.length;i<o;i++)e+="<li>"+t.sysFileDtoList[i].showName+"</li>";return e}return""}},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.fileId+"')","vm.update('"+t.fileId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}return{saveRootFolder:p,saveChildFolder:f,initPolicyFolder:u,initFileList:h,saveFile:m,findFileById:c,updateFile:l,deleteFile:s,deleteRootDirectory:r,folderById:d,queryUser:a,getFileUrlById:n}}angular.module("app").factory("policyLibrarySvc",t),t.$inject=["$http","$state","$location","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.parentId=t.params.parentId,n.fileLibrary={},n.fileLibrary.parentFileId=n.parentId,n.fileId=t.params.fileId,n.fileUrl="",n.fileName="",n.businessFlag={isInitFileOption:!1},n.initFileUpload=function(){n.fileId||o.$watch("vm.fileId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.fileId,mainId:"",mainType:i.mainTypeValue().POLICYLIBRARY,sysBusiType:n.fileUrl.substring(n.fileUrl.lastIndexOf(i.mainTypeValue().POLICYLIBRARY),n.fileUrl.lastIndexOf(n.fileName))},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.fileId,function(t){n.sysFilelists=t})}})},function(){n.parentId&&(e.getFileUrlById(n,n.parentId),e.initFileList(n)),n.fileId&&(n.isUpdate=!0,e.findFileById(n,n.fileId),i.findByBusinessId(n.fileId,function(t){n.sysFilelists=t}))}(),n.addFolderWindow=function(){n.fileLibrary.parentFileId=n.parentId,$("#addChildFolder").kendoWindow({width:"500px",height:"300px",title:"新建文件夹",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()},n.saveChildFolder=function(){e.saveChildFolder(n)},n.addFile=function(){t.go("policyLibrary.policyEdit",{parentId:n.parentId,fileId:""})},n.createFile=function(){e.saveFile(n)},n.update=function(e){t.go("policyLibrary.policyEdit",{parentId:n.parentId,fileId:e})},n.updateFile=function(){e.updateFile(n)},n.del=function(t){common.alert({vm:n,msg:"删除的数据将无法恢复，确定要删除？",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.deleteFile(n,t)}})},n.deleteRootDirectory=function(){e.deleteRootDirectory(n)},n.queryUser=function(){e.queryUser(n)}}angular.module("app").controller("policyLibraryEditCtrl",t),t.$inject=["$state","policyLibrarySvc","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e,i){function o(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var n=this;n.title="项目列表",function(){t.projectGrid(n)}(),n.dealWindow=function(e){t.findExpertReview(n,e,function(t){n.expertReview=t,$("#payFromWindow").kendoWindow({width:"70%",height:"60%",title:"评审费发放",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},n.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void i.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void i.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void i.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var n,a=t.expertSelectedDtoList.length,r="";$.each(t.expertSelectedDtoList,function(t,e){r+="'"+e.id+"'",t!=a-1&&(r+=",")});var s=t.payDate;n=s.substring(0,s.lastIndexOf("-")),e.countTaxes(r,n,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,n){var a=n.EXPERTID,r=n.id,s=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==a&&t.ESID!=r&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),s=parseFloat(s)+t.REVIEWCOST)}),n.reviewCost=void 0==n.reviewCost?0:n.reviewCost;var l=s+parseFloat(n.reviewCost);n.reviewTaxes=o(l).toFixed(2),n.totalCost=(parseFloat(n.reviewCost)+parseFloat(n.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(n.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(n.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)})})}}},n.savePayment=function(t){common.initJqValidation($("#payform")),
$("#payform").valid()?e.savePayment(t,n.isCommit,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！",function(){n.isCommit=!1,window.parent.$("#payFromWindow").data("kendoWindow").close(),n.gridOptions.dataSource.read()}):i.alert(t.reMsg)}):i.alert("请正确填写专家评审费信息！")}}angular.module("app").controller("reviewFeeCtrl",t),t.$inject=["reviewFeeSvc","expertReviewSvc","bsWin"]}(),function(){"use strict";function t(t){function e(e,i,o){var n={method:"post",url:rootPath+"/expertReview/initBybusinessId",params:{businessId:i,minBusinessId:""}},a=function(t){void 0==o&&"function"!=typeof o||o(t.data)};common.http({vm:e,$http:t,httpOptions:n,success:a})}function i(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewFee/findSignDispaWork"),schema:common.kendoGridConfig().schema({id:"id",fields:{}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"",title:"操作",width:"6%",template:function(t){return common.format($("#columnBtns").html(),"vm.dealWindow('"+t.signid+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{projectGrid:i,findExpertReview:e}}angular.module("app").factory("reviewFeeSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){var e=this;e.approve=!0,e.idea=!1,e.appraise={},function(){t.approveListGrid(e)}()}angular.module("app").controller("approveListCtrl",t),t.$inject=["reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e){var i=this,o=t.params.signId,n=t.params.projectName,a=t.params.id;!function(){a&&""!=a?(i.approve=!0,i.idea=!1,e.getAppraiseById(a,function(t){i.appraise=t,i.appraise.generalConductorOpinion="9"})):(i.approve=!1,i.idea=!0,i.appraise={},i.appraise.signId=o,i.appraise.projectName=n,e.initProposer(function(t){i.appraise.proposerName=t.proposerName,i.appraise.generalConductorOpinion="9"}))}(),i.commitApprove=function(){a&&""!=a?e.saveApprove(i):e.saveApply(i)}}angular.module("app").controller("approveWindowCtrl",t),t.$inject=["$state","reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="优秀评审报告列表",function(){e.appraisingProjectGrid(i)}()}angular.module("app").controller("reviewProjectAppraiseCtrl",t),t.$inject=["$location","reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e,i){function o(o){if(common.initJqValidation(),$("#form").valid()&&void 0!=o.appraise.ministerOpinion){var n={method:"put",url:rootPath+"/reviewProjectAppraise/saveApprove",data:o.appraise},a=function(t){e.success("操作成功！",function(){i.go("approveList")})};common.http({vm:o,$http:t,httpOptions:n,success:a})}}function n(e,i){var o={method:"get",url:rootPath+"/reviewProjectAppraise/getAppraiseById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e){var i={method:"get",url:rootPath+"/reviewProjectAppraise/initProposer"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function r(t){$("#appraiseWindow").kendoWindow({width:"800px",height:"400px",title:"评审报告评优申请",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()}function s(o){if(common.initJqValidation(),$("#form").valid()&&void 0!=o.appraise.appraiseReportName&&void 0!=o.appraise.proposerTime&&void 0!=o.appraise.appraiseCause){var n={method:"post",url:rootPath+"/reviewProjectAppraise/saveApply",data:o.appraise},a=function(t){e.success("保存成功！"),i.go("reviewProjectAppraiseEdit")};common.http({vm:o,$http:t,httpOptions:n,success:a})}}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewProjectAppraise/findEndProject"),schema:common.kendoGridConfig().schema({id:"id",fields:{}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchtype",title:"发文日期",width:160,filterable:!1},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizevalue",title:"审定投资",width:140,filterable:!1},{field:"extravalue",title:"核减（增）投资",width:140,filterable:!1},{field:"extrarate",title:"核减率",width:140,filterable:!1},{field:"approvevalue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchtype",title:"发文类型",width:140,filterable:!1},{field:"ffiledate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyName",title:"建设单位",width:140,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return 9==t.isAppraising?"优秀评审项目":8==t.isAppraising?"申请未通过":1==t.isAppraising?"审核中":common.format($("#columnBtns").html(),t.signid,t.projectname,"")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewProjectAppraise/findAppraisingProject"),schema:common.kendoGridConfig().schema({id:"id",fields:{}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchtype",title:"发文日期",width:160,filterable:!1},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizevalue",title:"审定投资",width:140,filterable:!1},{field:"extravalue",title:"核减（增）投资",width:140,filterable:!1},{field:"extrarate",title:"核减率",width:140,filterable:!1},{field:"approvevalue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchtype",title:"发文类型",width:140,filterable:!1},{field:"ffiledate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyName",title:"建设单位",width:140,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function c(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/reviewProjectAppraise/getAppraiseReport"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectName+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectName+"</a>"}},{field:"appraiseReportName",title:"评审报告名称",width:160,filterable:!1},{field:"proposerName",title:"申请人",width:160,filterable:!1},{field:"proposerTime",title:"申请时间",width:160,filterable:!1,format:"{0: yyyy-MM-dd}"},{field:"",title:"操作",width:100,template:function(t){return common.format($("#columnBtns").html(),t.signid,t.projectname,t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}function m(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/signView/getSignList",$("#searchform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"",title:"序号",template:"<span class='row-number'></span>",width:50},{field:"",title:"项目名称",width:160,filterable:!1,template:function(t){return t.processInstanceId?'<a href="#/signDetails/'+t.signid+"/"+t.processInstanceId+'" >'+t.projectname+"</a>":'<a href="#/signDetails/'+t.signid+'/" >'+t.projectname+"</a>"}},{field:"reviewstage",title:"评审阶段",width:140,filterable:!1},{field:"signdate",title:"收文日期",width:200,filterable:!1},{field:"dispatchtype",title:"发文日期",width:160,filterable:!1},{field:"reviewdays",title:"评审天数",width:140,filterable:!1},{field:"surplusdays",title:"剩余工作日",width:140,filterable:!1},{field:"reviewOrgName",title:"评审部门",width:140,filterable:!1},{field:"aUserName",title:"项目负责人",width:140,filterable:!1},{field:"ffilenum",title:"归档编号",width:140,filterable:!1},{field:"dfilenum",title:"文件字号",width:140,filterable:!1},{field:"appalyinvestment",title:"申报投资",width:140,filterable:!1},{field:"authorizevalue",title:"审定投资",width:140,filterable:!1},{field:"extravalue",title:"核减（增）投资",width:140,filterable:!1},{field:"extrarate",title:"核减率",width:140,filterable:!1},{field:"approvevalue",title:"批复金额",width:140,filterable:!1},{field:"receivedate",title:"批复来文时间",width:140,filterable:!1},{field:"dispatchtype",title:"发文类型",width:140,filterable:!1},{field:"ffiledate",title:"归档日期",width:140,filterable:!1},{field:"builtcompanyName",title:"建设单位",width:140,filterable:!1},{field:"isassistproc",title:"是否协审",width:140,filterable:!1,template:function(t){return 9==t.sisassistproc?"是":"否"}},{field:"daysafterdispatch",title:"发文后工作日",width:140,filterable:!1},{field:"",title:"操作",width:100,template:function(t){return 0==t.isAssociate?'<button class="btn btn-xs btn-success" ng-click="vm.showAssociate(\''+t.signid+'\')" ng-disabled="vm.isSubmit">  <span class="glyphicon glyphicon-resize-small"></span>关联项目</button>':'<button class="btn btn-xs btn-warning" ng-click="vm.disAssociateSign(\''+t.signid+'\')" ng-disabled="vm.isSubmit">  <span class="glyphicon glyphicon-resize-small"></span>取消关联</button>'}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0,dataBound:function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})}}}return{endProjectGrid:l,appraisingProjectGrid:d,monthlyExcellentGrid:m,appraiseWindow:r,initProposer:a,saveApply:s,approveListGrid:c,getAppraiseById:n,saveApprove:o}}angular.module("app").factory("reviewProjectAppraiseSvc",t),t.$inject=["$http","bsWin","$state"]}(),function(){"use strict";function t(t){var e=this;e.title="评审项目评优列表",e.approve=!1,e.idea=!0,function(){t.endProjectGrid(e)}()}angular.module("app").controller("reviewProjectAppraiseEditCtrl",t),t.$inject=["reviewProjectAppraiseSvc"]}(),function(){"use strict";function t(t,e){var i=this;i.title="角色列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteRole(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("roleCtrl",t),t.$inject=["$location","roleSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加角色",o.isRoleExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新角色"),o.create=function(){e.createRole(o)},o.update=function(){e.updateRole(o)},o.checkRole=function(){e.checkRole(o)},function(){o.isUpdate?e.getRoleById(o):e.initZtreeClient(o)}()}angular.module("app").controller("roleEditCtrl",t),t.$inject=["$location","roleSvc","$state"]}(),function(){"use strict";function t(t,e){function i(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function o(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),i=$linq(t.model.resources).select(function(t){return t.path}).toArray(),o=e.getNodesByParam("level",1,null),n=$linq(o).where(function(t){return $linq(i).contains(t.path)}).toArray(),a=0,r=n.length;a<r;a++)e.checkNode(n[a],!0,!0)}function n(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/fingByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:70,filterable:!1,template:"<span class='row-number'></span>"},{field:"roleName",title:"角色名称",width:200,filterable:!1},{field:"remark",title:"描述",filterable:!1},{field:"createdDate",title:"创建时间",width:180,filterable:!1,format:"{0:yyyy-MM-dd HH:mm:ss}"},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function a(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0;var o=i(),n=$linq(o).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n;var a={method:"post",url:m,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=u}})}})};common.http({vm:e,$http:t,httpOptions:a,success:r})}}function r(t){}function s(e){var i={method:"post",url:rootPath+"/role/findById",params:{roleId:e.id}},o=function(t){e.model=t.data,e.isUpdate&&c(e)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e){if(common.initJqValidation(),$("form").valid()&&0==e.isRoleExist){e.isSubmit=!0,e.model.id=e.id;var o=i(),n=$linq(o).where(function(t){return!0}).select(function(t){return{id:t.id,name:t.name,path:t.path,method:t.method}}).toArray();e.model.resources=n;var a={method:"put",url:m,data:e.model},r=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:a,success:r})}}function d(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function c(e){var i={method:"get",url:p},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var i={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},n=t.data;$.fn.zTree.init($("#zTree"),i,n),e.isUpdate&&o(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:n})}var m=rootPath+"/role",u="#/role",p=rootPath+"/sys/resource";return{grid:n,createRole:a,checkRole:r,getRoleById:s,updateRole:l,deleteRole:d,initZtreeClient:c}}angular.module("app").factory("roleSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e){var i=this;i.title="预定会议统计列表",i.queryRoomCount=function(){e.queryRoomCount(i)},i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteroomCount(i,t)}})},i.ResetRoomCount=function(){e.cleanValue()},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i),e.roomList(i),e.findAllOrg(i),e.findAllRoom(i)}()}angular.module("app").controller("roomCountCtrl",t),t.$inject=["$location","roomCountSvc"]}(),function(){"use strict";function t(t,e){function i(){var t=$("#roomCountform").find("input,select");$.each(t,function(t,e){e.value=""})}function o(t){t.gridOptions.dataSource.read()}function n(e){var i={method:"get",url:common.format(d+"/findAllUsers")},o=function(t){e.userlist={},e.userlist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"get",url:common.format(d+"/getOrg")},o=function(t){e.orglist={},e.orglist=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"get",url:common.format(l+"/meeting")},o=function(t){e.roomlists={},e.roomlists=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(l+"/fingByOData",$("#roomCountform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{field:"rowNumber",title:"序号",width:40,filterable:!1,template:"<span class='row-number'></span>"},{field:"rbName",title:"会议名称",width:120,filterable:!1},{field:"addressName",title:"会议地点",width:120,filterable:!1},{field:"rbDay",title:"会议日期",width:160,filterable:!1},{field:"beginTimeStr",title:"会议开始时间",width:160,filterable:!1},{field:"endTimeStr",title:"会议结束时间",type:"date",width:160,filterable:!1},{field:"rbType",title:"会议类型",width:100,filterable:!1},{field:"dueToPeople",title:"会议预定人",width:100,filterable:!1}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var l=(rootPath,rootPath+"/room"),d=rootPath+"/user",d=rootPath+"/user";return{grid:s,queryRoomCount:o,roomList:r,findAllOrg:a,cleanValue:i,findAllRoom:n}}angular.module("app").factory("roomCountSvc",t),t.$inject=["$http","$compile"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="会议室预定列表",n.initSuccess=!1,n.model={businessId:o.params.businessId,businessType:o.params.businessType},n.startDateTime=new Date("2006/6/1 08:00"),n.endDateTime=new Date("2030/6/1 21:00"),n.currentDate="",n.reportName="会议室安排表",n.mrID="",function(){e.initRoom(n),e.showMeeting(n,function(t){n.meetings={},n.meetings=t,e.initDefaultValue(n.model.businessId,n.model.businessType,function(t){n.model=t,n.meetings&&n.meetings.length>0&&(n.mrID=n.meetings[0].id,n.model.mrID=n.mrID),e.updateDataSource(n)})})}(),n.editRoom=function(){e.editRoom(n)},n.exportThisWeekStage=function(){n.currentDate=$(".k-sm-date-format").html(),n.rbType="0",n.reportName="本周评审会会议安排表",e.exportThisWeekStage(n)},n.exportThisWeek=function(){n.currentDate=$(".k-sm-date-format").html(),n.rbType="1",n.reportName="本周全部会议安排表",e.exportThisWeekStage(n)},n.exportNextWeek=function(){var t=$(".k-sm-date-format").html(),i=t.split("-")[0].split("/"),o=i[0],a=2==i[1].length?i[1]:"0"+i[1],r=i[2].length>=2?i[2].substr(0,2):"0"+i[2].substr(0,1),s=new Date(a+"/"+r+"/"+o),l=new Date(a+"/"+r+"/"+o);s.setDate(s.getDate()+8-s.getDay()),l.setDate(l.getDate()+15-l.getDay());var d=new Date(s),c=new Date(l);n.currentDate=d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate()+"-"+c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate(),n.rbType="1",n.reportName="下周全部会议安排表",e.exportThisWeekStage(n)},n.exportNextWeekStage=function(){var t=$(".k-sm-date-format").html(),i=t.split("-")[0].split("/"),o=i[0],a=2==i[1].length?i[1]:"0"+i[1],r=i[2].length>=2?i[2].substr(0,2):"0"+i[2].substr(0,1),s=new Date(a+"/"+r+"/"+o),l=new Date(a+"/"+r+"/"+o);s.setDate(s.getDate()+8-s.getDay()),l.setDate(l.getDate()+15-l.getDay());var d=new Date(s),c=new Date(l);n.currentDate=d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate()+"-"+c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate(),n.rbType="0",n.reportName="下周评审会会议安排表",e.exportThisWeekStage(n)},n.findMeeting=function(){e.findMeeting(n)},n.getPDF=function(t){kendo.drawing.drawDOM($(t)).then(function(t){kendo.drawing.pdf.saveAs(t,"会议室安排表.pdf")})}}angular.module("app").controller("roomCtrl",t),t.$inject=["bsWin","roomSvc","$rootScope","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加会议室预定",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新会议室"),function(){o.isUpdate&&e.getroomById(o)}()}angular.module("app").controller("roomEditCtrl",t),t.$inject=["$location","roomSvc","$state"]}(),function(){"use strict";function t(t,e){function i(i){if(i.model.id=$("#id").val(),i.model.rbName=$("#rbName").val(),i.model.mrID=$("#mrID").val(),i.model.rbType=$("#rbType").val(),i.model.host=$("#host").val(),i.model.dueToPeople=$("#dueToPeople").val(),i.model.rbDay=$("#rbDay").val(),i.model.beginTime=$("#beginTime").val(),i.model.endTime=$("#endTime").val(),i.model.content=$("#content").val(),i.model.content=$("#remark").val(),common.initJqValidation($("#formRoom")),$("#formRoom").valid()){i.iscommit=!0;var o={method:"put",url:rootPath+"/room/updateRoom",data:i.model},n=function(t){e.alert("操作成功"),$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()};common.http({vm:i,$http:t,httpOptions:o,success:n})}}function o(i){i.mrID&&(i.model.mrID=i.mrID);var o=new kendo.data.SchedulerDataSource({batch:!0,sync:function(){this.read()},transport:{read:function(e){var i=e.data.mrID,o=rootPath+"/room";i&&(o+="?"+i),t.get(o).success(function(t){e.success(t.value)}).error(function(t){console.log("查询数据失败！")})},create:function(t){n(i)},update:function(t){n(i)},destroy:function(i){var o=i.data.models[0].id,n={method:"delete",url:p,params:{id:o}},a=function(t){e.alert("删除成功")};common.http({$http:t,httpOptions:n,success:a})},parameterMap:function(t,e){if("read"!==e&&t.models)return{models:kendo.stringify(t.models)}}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,schema:{model:{id:"taskId",fields:{bookId:{from:"id"},title:{from:"addressName",defaultValue:"会议室"},start:{type:"date",from:"beginTime"},end:{type:"date",from:"endTime"},businessId:{from:"businessId",defaultValue:i.model.businessId},businessType:{from:"businessType",defaultValue:i.model.businessType},rbName:{from:"rbName",defaultValue:i.model.rbName},stageOrgName:{from:"stageOrgName",defaultValue:i.model.stageOrgName},host:{from:"host",defaultValue:i.model.host},dueToPeople:{from:"dueToPeople",defaultValue:i.model.dueToPeople},mrID:{from:"mrID",defaultValue:i.model.mrID},content:{from:"content",defaultValue:i.model.content},remark:{from:"remark",defaultValue:i.model.remark}}}}}),a=$("#scheduler").data("kendo-scheduler");a.setDataSource(o),i.mrID?a.dataSource.read({mrID:common.format("$filter=mrID eq '{0}'",i.mrID)}):a.dataSource.read()}function n(i){if(common.initJqValidation($("#formRoom")),$("#formRoom").valid()){var o={};if($("#bookId").val()&&(o.id=$("#bookId").val()),o.rbName=$("#rbName").val(),o.mrID=$("#mrID").val(),o.stageOrgName=$("#stageOrgName").val(),o.rbDay=$("#rbDay").val(),o.host=$("#host").val(),o.dueToPeople=$("#dueToPeople").val(),o.beginTimeStr=$("#beginTime").val(),o.endTimeStr=$("#endTime").val(),o.beginTime=$("#rbDay").val()+" "+$("#beginTime").val()+":00",o.endTime=$("#rbDay").val()+" "+$("#endTime").val()+":00",o.content=$("#content").val(),o.remark=$("#remark").val(),o.businessId=i.model.businessId,o.businessType=i.model.businessType,new Date(o.endTime)<new Date(o.beginTime))return void e.alert("开始时间不能大于结束时间!");var n={method:"post",url:rootPath+"/room/addRoom",data:o},a=function(t){t.data.flag||"ok"==t.data.reCode?e.alert("操作成功",function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}):e.alert(t.data.reMsg),s(i)};common.http({$http:t,httpOptions:n,success:a})}}function a(t){t.schedulerOptions={date:new Date,startTime:t.startDateTime,endTime:t.endDateTime,height:600,views:["day","workWeek",{type:"week",selected:!0},"month","agenda"],editable:{template:$("#customEditorTemplate").html()},eventTemplate:$("#event-template").html(),timezone:"Etc/UTC",footer:!1,remove:function(){e.alert("已经预定的会议室不能删除！"),o(t)},cancel:function(){o(t)}}}function r(e,i){t.get(p+"/meeting").success(function(t){void 0!=i&&"function"==typeof i&&i(t)}).error(function(t){})}function s(t){t.mrID&&(t.model.mrID=t.mrID),o(t)}function l(e,i,o){var n={method:"post",url:rootPath+"/room/initDefaultValue",params:{businessId:e,businessType:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function d(i,o){if(common.initJqValidation($("#stageForm")),$("#stageForm").valid()){if(i.beginTime=$("#rbDay").val()+" "+$("#beginTime").val()+":00",i.endTime=$("#rbDay").val()+" "+$("#endTime").val()+":00",new Date(i.endTime)<new Date(i.beginTime))return void e.error("开始时间不能大于结束时间!");var n={method:"post",url:rootPath+"/room/saveRoom",data:i},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}}function c(t){var e=escape(encodeURIComponent(t.reportName));window.open(p+"/exportThisWeekStage?currentDate="+t.currentDate+"&rbType="+t.rbType+"&mrId="+t.mrID+"&fileName="+e)}function m(e){var i={method:"get",url:p+"/exportThisWeekStage",params:{currentDate:e.currentDate}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function u(){window.open(p+"/exportWeek")}var p=rootPath+"/room";return{initRoom:a,showMeeting:r,findMeeting:s,exportThisWeekStage:c,exportNextWeekStage:m,exportThisWeek:u,editRoom:i,initDefaultValue:l,updateDataSource:o,saveRoom:d}}angular.module("app").factory("roomSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="资料共享详情页",n.model={},n.model.sharId=e.params.sharId,n.downloadSysFile=function(t){o.downloadSysfile(t)},function(){o.getSharingDetailById(n,n.model.sharId),i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})}()}angular.module("app").controller("sharingDetailCtrl",t),t.$inject=["$location","$state","sysfileSvc","sharingPlatlformSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="共享资料管理",function(){o.grid(n)}(),n.del=function(t){common.confirm({vm:n,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),o.deleteSharingPlatlform(n,t)}})},n.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:n,msg:"请选择要删除的数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");n.del(o)}},n.bathPublish=function(){o.updatePublish(n,!0)},n.bathDown=function(){o.updatePublish(n,!1)},n.querySharing=function(){n.gridOptions.dataSource.read()}}angular.module("app").controller("sharingPlatlformCtrl",t),t.$inject=["$location","$state","$http","sharingPlatlformSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="新增共享资料",n.model={},n.businessFlag={isUpdate:!1,isLoadModel:!1,isLoadOrgUser:!1},n.model.sharId=e.params.sharId,n.model.sharId&&(n.businessFlag.isUpdate=!0,n.title="更改共享资料"),n.initFileUpload=function(){n.model.sharId||o.$watch("vm.model.sharId",function(t,e){t&&t!=e&&!n.initUploadOptionSuccess&&n.initFileUpload()}),n.sysFile={businessId:n.model.sharId,mainId:n.model.sharId,mainType:i.mainTypeValue().SHARE},i.initUploadOptions({inputId:"sysfileinput",vm:n,uploadSuccess:function(){i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})}})},function(){n.model.sharId?(t.getSharingPlatlformById(n),i.findByBusinessId(n.model.sharId,function(t){n.sysFilelists=t})):n.initFileUpload(),t.initOrgAndUser(n)}(),n.resetSharing=function(){var t=$("#formSharing").find("input,select");$.each(t,function(t,e){e.value=""})},n.create=function(){t.createSharingPlatlform(n)},n.checkBox=function(t){var e=t.target,i=e.checked,o=e.value;i?$('input[tit="'+o+'"]').each(function(){$(this).attr("disabled","disabled"),$(this).removeAttr("checked")}):$('input[tit="'+o+'"]').each(function(){$(this).removeAttr("disabled")})}}angular.module("app").controller("sharingPlatlformEditCtrl",t),t.$inject=["sharingPlatlformSvc","$state","sysfileSvc","$scope"]}(),function(){"use strict";function t(t,e){function i(t){!t.businessFlag.isLoadOrgUser||!t.businessFlag.isLoadModel||t.model.isNoPermission&&"9"==t.model.isNoPermission||t.shareOrgList&&t.shareOrgList.length>0&&(t.model.privilegeDtoList&&t.model.privilegeDtoList.length>0&&t.shareOrgList.forEach(function(e,i){t.model.privilegeDtoList.forEach(function(t,i){1==t.businessType||"1"==t.businessType?t.businessId==e.id&&(e.isChecked=!0,e.userDtos.forEach(function(t,e){t.isDisabled=!0})):2!=t.businessType&&"2"!=t.businessType||e.userDtos.forEach(function(e,i){t.businessId==e.id&&(e.isChecked=!0)})})}),t.noOrgUsetList&&t.noOrgUsetList.length>0&&t.noOrgUsetList.forEach(function(e,i){t.model.privilegeDtoList.forEach(function(t,i){2!=t.businessType&&"2"!=t.businessType||t.businessId!=e.id||(e.isChecked=!0)})}),t.businessFlag.isInitSeled=!0)}function o(e){var o={method:"post",url:rootPath+"/sharingPlatlform/initOrgAndUser"},n=function(t){e.shareOrgList=t.data.orgDtoList,e.noOrgUsetList=t.data.noOrgUserList,e.businessFlag.isLoadOrgUser=!0,i(e)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"get",url:c+"/html/sharingDeatilById",
params:{id:i}},n=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(i,o){i.isSubmit=!0;var n={method:"delete",url:c+"/sharingDelete",data:o},a=function(t){i.isSubmit=!1,i.gridOptions.dataSource.read(),e.alert("操作成功")};common.http({vm:i,$http:t,httpOptions:n,success:a})}function r(i){if($("form").valid()){if(i.isSubmit=!0,9!=i.model.isNoPermission){i.model.privilegeDtoList=[];var o=$("input[name='shareOrg']:checked");if(o.length>0)for(var n=0;n<o.length;n++){var a={};a.businessId=o[n].value,a.businessType="1",i.model.privilegeDtoList.push(a)}var r=$("input[name='shareUser']:not(:disabled):checked");if(r.length>0)for(var n=0;n<r.length;n++){var s={};s.businessId=r[n].value,s.businessType="2",i.model.privilegeDtoList.push(s)}}var l={method:"post",url:rootPath+"/sharingPlatlform/saveSharing",data:i.model},d=function(t){i.isSubmit=!1,i.model.sharId=t.data.sharId,e.alert("操作成功")};common.http({$http:t,httpOptions:l,success:d,onError:function(){i.isSubmit=!1}})}}function s(e){var o={method:"get",url:c+"/html/findById",params:{id:e.model.sharId}},n=function(t){e.model=t.data,e.businessFlag.isLoadModel=!0,i(e)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(c+"/findByCurUser",$("#formSharing")),schema:common.kendoGridConfig().schema({id:"sharId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.sharId)},filterable:!1,width:30,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"theme",title:"主题",width:180,filterable:!1},{field:"publishUsername",title:"发布人",width:120,filterable:!1},{field:"publishDate",title:"发布时间",format:"{0:yyyy-MM-dd hh24:mm:ss}",width:180,filterable:!1},{field:"isPublish",title:"发布状态",width:100,template:function(t){return t.isPublish&&9==t.isPublish?"已发布":"未发布"}},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),t.sharId,t.sharId,"vm.del('"+t.sharId+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,dataBound:i,columns:o,resizable:!0}}function d(e,i){var o=common.getKendoCheckId(".grid");if(0==o.length)common.alert({vm:e,msg:"请选择要批量发布的数据"});else{for(var n=[],a=0;a<o.length;a++)n.push(o[a].value);var r={method:"post",url:rootPath+"/sharingPlatlform/updatePublish",params:{ids:n.join(","),status:1==i?"9":"0"}},s=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read(),common.alert({vm:e,msg:"操作成功",closeDialog:!0})}})};common.http({vm:e,$http:t,httpOptions:r,success:s})}}var c=rootPath+"/sharingPlatlform";return{grid:l,getSharingPlatlformById:s,createSharingPlatlform:r,deleteSharingPlatlform:a,getSharingDetailById:n,initOrgAndUser:o,initSeleObj:i,updatePublish:d}}angular.module("app").factory("sharingPlatlformSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="共享管理",n.model={},function(){o.grid(n)}(),n.findSharing=function(){n.gridOptions.dataSource.read()},n.resetShared=function(){var t=$("#formSharingPub").find("select");$.each(t,function(t,e){e.value=""})}}angular.module("app").controller("sharingPlatlformYetCtrl",t),t.$inject=["$location","$state","$http","sharingPlatlformYetSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sharingPlatlform/findByReception",$("#formSharingPub")),schema:common.kendoGridConfig().schema({id:"sharId",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.sharId)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"unitSort",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"theme",title:"共享主题",width:180,filterable:!0},{field:"publishUsername",title:"发布人",width:100,filterable:!0},{field:"publishDate",title:"发布时间",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),t.sharId)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}return{grid:e}}angular.module("app").factory("sharingPlatlformYetSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.title="新增收文",n.create=function(){common.initJqValidation(),$("form").valid()&&e.createSign(n.model,function(t){t.flag||"ok"==t.reCode?t.reObj.processInstanceId?o.alert("操作成功！"):o.success("操作成功，请继续填写项目审核登记表",function(){i.go("fillSign",{signid:t.reObj.signid},{reload:!0})}):o.error(t.reMsg)})}}angular.module("app").controller("signCreateCtrl",t),t.$inject=["$location","signSvc","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="收文列表",function(){t.signGrid(a)}(),a.querySign=function(){a.gridOptions.dataSource.read()},a.check=function(){a.isAssociate=a.ischeck?9:0},a.del=function(e){n.confirm({title:"询问提示",message:"确认删除该条项目数据吗？删除数据不可恢复，请慎重！",onOk:function(){$(".confirmDialog").modal("hide"),t.deleteSign(e,function(t){t.flag||"ok"==t.reCode?n.alert("删除成功！",function(){a.gridOptions.dataSource.read()}):n.alert(t.reMsg)})}})},a.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:a,msg:"请选择数据"});else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);var o=e.join(",");a.del(o)}},a.startNewFlow=function(t){n.confirm({title:"询问提示",message:"确认已经完成填写，并且发起流程么？",onOk:function(){$(".confirmDialog").modal("hide"),o.startFlow(t,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！",function(){a.gridOptions.dataSource.read()}):n.error(t.reMsg)})}})},a.realSign=function(e){n.confirm({title:"询问提示",message:"确认正式签收了么？",onOk:function(){$(".confirmDialog").modal("hide"),t.realSign(e,function(t){t.flag||"ok"==t.reCode?n.success("操作成功！",function(){a.gridOptions.dataSource.read()}):n.error(t.reMsg)})}})}}angular.module("app").controller("signCtrl",t),t.$inject=["signSvc","$state","flowSvc","signFlowSvc","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a){var r=this;r.model={},r.title="填写报审登记表",r.model.signid=i.params.signid,r.flowDeal=!1,r.busiObj={},function(){t.initFillData(r.model.signid,function(t){r.model=t.reObj.sign,r.deptlist=t.reObj.deptlist,t.reObj.mainOfficeList&&(r.mainOfficeList=t.reObj.mainOfficeList),t.reObj.assistOfficeList&&(r.assistOfficeList=t.reObj.assistOfficeList),r.companyList=t.reObj.companyList,r.busiObj.leaderList=t.reObj.leaderList,r.sysFile={businessId:r.model.signid,mainId:r.model.signid,mainType:e.mainTypeValue().SIGN,sysfileType:e.mainTypeValue().FILLSIGN,sysBusiType:e.mainTypeValue().FILLSIGN},e.initUploadOptions({inputId:"sysfileinput",vm:r})})}(),r.checkOrgType=function(t){var e=t.target,i=e.checked,o=e.value;i&&(r.model.leaderName=signcommon.getDefaultLeader(o),$.each(r.busiObj.leaderList,function(t,e){e.mngOrgType==o&&(r.model.leaderId=e.id,r.model.leaderName=e.displayName,r.model.comprehensivehandlesug="请"+e.displayName.substring(0,1)+"主任阅示。")}),o==signcommon.getBusinessType().GX?r.model.leaderhandlesug="请（概算一部         概算二部）组织评审。":r.model.leaderhandlesug="请（评估一部         评估二部         评估一部信息化组）组织评审。",r.model.leaderId||n.alert("选择的默认办理部门没有合适的分管领导，请先设置分管领导角色用户！"))},r.startNewFlow=function(){common.initJqValidation($("#sign_fill_form")),$("#sign_fill_form").valid()?(r.isSubmit=!0,n.confirm({title:"询问提示",message:"确定发起流程么，请确保填写的信息已经保存正确！",onOk:function(){$(".confirmDialog").modal("hide"),t.updateFillin(r.model,function(t){var e={method:"post",url:rootPath+"/sign/startNewFlow",params:{signid:r.model.signid}},a=function(t){r.isSubmit=!1,"ok"==t.data.reCode?n.success("操作成功！",function(){i.go("gtasks")}):n.error(t.data.reMsg)};common.http({$http:o,httpOptions:e,success:a})})}})):n.alert("项目填报内容不完整或者填报信息不正确，请检查之后再提交！")},r.signPreview=function(t){var e=$(".well").parents("body"),i=e.find(".main-sidebar"),o=e.find(".main-header"),n=e.find(".content-wrapper");i.hide(),o.hide(),$(".toolbar").hide(),$(".well input").each(function(){var t=$(this).attr("type");"text"==t&&$(this).before('<span class="printmesge" data="text" style="white-space : nowrap;">'+$(this).val()+"</span>"),"checkbox"==t&&($(this).is(":checked")?$(this).before('<span class="printmesge" data="text">有</span>'):$(this).before('<span class="printmesge" data="text">无</span>'))}),$(".printmesge").show(),$(".well input[type=text]").hide(),$(".well input[type=checkbox]").hide(),$(".well button").hide(),n.find("td div select").hide(),n.find("td div span").css("margin","0"),$(".well").addClass("printbody"),$(".well .table-bordered").addClass("tableBOX"),n.find("input").addClass("noborder"),n.addClass("nomargin"),window.print(),i.show(),o.show(),$(".toolbar").show(),$(".printmesge").hide(),$(".well input[type=text]").show(),$(".well input[type=checkbox]").show(),$(".well button").show(),n.find("td div select").show(),n.find("td div span").css("margin-left","100px"),$(".well").removeClass("printbody"),$(".well .table-bordered").removeClass("tableBOX"),$("[data=text]").remove(),n.find("input").removeClass("noborder"),n.removeClass("nomargin")},r.updateFillin=function(){common.initJqValidation($("#sign_fill_form")),$("#sign_fill_form").valid()?(r.isSubmit=!0,r.model.leaderhandlesug=$("#leaderhandlesug").val(),t.updateFillin(r.model,function(t){r.isSubmit=!1,n.alert("操作成功！")})):n.alert("项目填报内容不完整或者填报信息不正确，请检查之后再提交！")},r.findOfficeUsersByDeptName=function(e){var i={};"main"==e?i.maindeptName=r.model.maindeptName:i.assistdeptName=r.model.assistdeptName,t.findOfficeUsersByDeptName(i,function(t){"main"==e?(r.mainOfficeList={},r.mainOfficeList=t):(r.assistOfficeList={},r.assistOfficeList=t)})}}angular.module("app").controller("signFillinCtrl",t),t.$inject=["signSvc","sysfileSvc","$state","$http","bsWin","$scope"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="已办结项目详情",n.model={},n.flow={},n.model.signid=i.params.signid,n.flow.processInstanceId=i.params.processInstanceId,n.flow.hideFlowImg=!0,n.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},n.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),o.initFlowData(n),e.initFlowPageData(n.model.signid,function(t){n.model=t,n.model.dispatchDocDto&&(n.showFlag.tabDispatch=!0,n.dispatchDoc=n.model.dispatchDocDto,2==n.dispatchDoc.dispatchWay&&0==n.dispatchDoc.isMainProject||n.dispatchDoc.fileNum?n.businessFlag.isCreateDisFileNum=!0:n.showFlag.buttDisFileNum=!0),n.model.fileRecordDto&&(n.showFlag.tabFilerecord=!0,n.fileRecord=n.model.fileRecordDto),n.model.processState>1&&(n.showFlag.tabWorkProgram=!0),n.model.suppLetterDtoList&&(n.showSupperIndex=0)}),t.findByMianId(n.model.signid,function(t){t&&t.length>0&&(n.showFlag.tabSysFile=!0,n.sysFileList=t)})}(),n.commonDownloadSysFile=function(e){t.downloadFile(e)},n.commonEditSysFile=function(t){$("#editSysFileWindow").kendoWindow({width:"80%",title:"在线编辑",content:rootPath+"/file/editFile?sysFileId="+t})}}angular.module("app").controller("signEndCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc"]}(),function(){"use strict";function t(t,e,i){function o(e,i){var o={method:"post",url:rootPath+"/sign/startNewFlow",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(t){switch(t.flow.curNode.activitiId){case flowcommon.getSignFlowNode().SIGN_QS:t.showFlag.businessTr=!0,t.showFlag.nodeSign=!0;break;case flowcommon.getSignFlowNode().SIGN_ZHB:t.showFlag.buttBack=!0,t.showFlag.businessNext=!0,t.showFlag.nodeSelViceMgr=!0,t.flow.businessMap&&(t.viceDirectors=t.flow.businessMap.viceDirectors);break;case flowcommon.getSignFlowNode().SIGN_FGLD_FB:t.showFlag.buttBack=!0,t.showFlag.businessNext=!0,t.showFlag.nodeSelOrgs=!0,t.flow.businessMap&&(t.orgs=t.flow.businessMap.orgs);break;case flowcommon.getSignFlowNode().SIGN_BMFB1:t.businessFlag.isMainBranch=!0;case flowcommon.getSignFlowNode().SIGN_BMFB2:case flowcommon.getSignFlowNode().SIGN_BMFB3:case flowcommon.getSignFlowNode().SIGN_BMFB4:t.showFlag.businessNext=!0,t.showFlag.nodeSelPrincipal=!0,t.flow.businessMap&&t.flow.businessMap.users&&(t.users=t.flow.businessMap.users,t.users.forEach(function(t,e){t.isSelected=!1}));break;case flowcommon.getSignFlowNode().SIGN_XMFZR1:t.businessFlag.isMainBranch=!0,t.businessFlag.curBranchId="1",t.showFlag.isMainPrinUser=!0;case flowcommon.getSignFlowNode().SIGN_XMFZR2:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="2");case flowcommon.getSignFlowNode().SIGN_XMFZR3:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="3");case flowcommon.getSignFlowNode().SIGN_XMFZR4:t.businessFlag.curBranchId||(t.businessFlag.curBranchId="4"),t.showFlag.businessTr=!0,t.showFlag.nodeWorkProgram=!0,t.businessFlag.isFinishWP=t.flow.businessMap.isFinishWP,t.model.processState>=2&&t.model.workProgramDtoList&&($.each(t.model.workProgramDtoList,function(e,i){i.branchId==t.businessFlag.curBranchId&&(t.businessFlag.editEPReviewId=i.expertReviewId)}),t.businessFlag.editExpertSC=!0,t.showFlag.tabWorkProgram=!0,$("#show_workprogram_a").click());break;case flowcommon.getSignFlowNode().SIGN_BMLD_SPW1:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW2:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW3:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW4:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW1:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW2:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW3:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW4:t.showFlag.buttBack=!0,t.showFlag.tabWorkProgram=!0,$("#show_workprogram_a").click();break;case flowcommon.getSignFlowNode().SIGN_FW:t.showFlag.businessTr=!0,t.showFlag.nodeDispatch=!0,t.showFlag.isMainPrinUser=!0,t.showFlag.expertEdit=!0,t.flow.businessMap.prilUserList&&(t.businessFlag.principalUsers=t.flow.businessMap.prilUserList,t.showFlag.businessNext=!0),t.model.processState>=4&&(t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click());break;case flowcommon.getSignFlowNode().SIGN_QRFW:case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW_XB:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW_XB:t.watchPassDis(),t.showFlag.buttBack=!1,t.showFlag.businessTr=!0,t.showFlag.nodeConfirmDis=!0,t.businessFlag.passDis="9",t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click();break;case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW:case flowcommon.getSignFlowNode().SIGN_ZR_QRFW:t.showFlag.buttBack=!0,t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click();break;case flowcommon.getSignFlowNode().SIGN_FWBH:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,$("#show_dispatch_a").click(),t.showFlag.businessTr=!0,t.showFlag.nodeCreateDisNum=!0,t.showFlag.isMainPrinUser=!0;break;case flowcommon.getSignFlowNode().SIGN_CWBL:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.businessTr=!0,t.showFlag.financialCode=!0;break;case flowcommon.getSignFlowNode().SIGN_GD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.isMainPrinUser=!0,t.flow.businessMap.checkFileUser&&(t.showFlag.businessNext=!0),t.showFlag.businessTr=!0,t.showFlag.nodeFileRecord=!0,t.model.processState>6&&(t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click());break;case flowcommon.getSignFlowNode().SIGN_DSFZR_QRGD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click(),t.showFlag.buttBack=!0;break;case flowcommon.getSignFlowNode().SIGN_QRGD:t.showFlag.tabWorkProgram=!0,t.showFlag.tabDispatch=!0,t.showFlag.tabFilerecord=!0,$("#show_filerecord_a").click(),t.showFlag.buttBack=!0,t.showFlag.nodeNext=!1}}function a(t){t.flow.businessMap||(t.flow.businessMap={});var e={};switch(e.resultTag=!0,t.flow.curNode.activitiId){case flowcommon.getSignFlowNode().SIGN_ZHB:$("#viceDirector").val()?t.flow.businessMap.FGLD=$("#viceDirector").val():e.resultTag=!1;break;case flowcommon.getSignFlowNode().SIGN_FGLD_FB:if(e.resultTag=!1,$('.seleteTable input[selectType="main"]:checked').each(function(){t.flow.businessMap.MAIN_ORG=$(this).val(),e.resultTag=!0}),e.resultTag){var i=[];$('.seleteTable input[selectType="assist"]:checked').each(function(){i.push($(this).val())}),i.length>3?(e.resultTag=!1,e.resultMsg="协办部门最多只能选择3个！"):t.flow.businessMap.ASSIST_ORG=i.join(",")}else e.resultMsg="主办部门不为空！";break;case flowcommon.getSignFlowNode().SIGN_BMFB1:if(!t.model.isassistflow||9!=t.model.isassistflow&&"9"!=t.model.isassistflow){var o=$("#selPrincipalMainUser").val();if(!o){e.resultTag=!1,e.resultMsg="必须要选择一个第一负责人！";break}e.resultTag=!0,t.flow.businessMap.M_USER_ID=o;var n=[];$('#principalAssistUser input[selectType="assistUser"]:checked').each(function(){n.push($(this).val())}),n.length>0&&(t.flow.businessMap.A_USER_ID=n.join(","))}else t.businessFlag.principalUsers&&0!=t.businessFlag.principalUsers.length?(e.resultTag=!1,$.each(t.businessFlag.principalUsers,function(t,i){"9"!=i.isMainUser&&9!=i.isMainUser||(e.resultTag=!0)}),e.resultTag||(e.resultMsg="必须要选择一个第一负责人！")):(e.resultTag=!1,e.resultMsg="请先选择项目负责人！"),e.resultTag&&(t.flow.businessMap.PRINCIPAL=t.businessFlag.principalUsers);break;case flowcommon.getSignFlowNode().SIGN_BMFB2:case flowcommon.getSignFlowNode().SIGN_BMFB3:case flowcommon.getSignFlowNode().SIGN_BMFB4:if(!t.model.isassistflow||9!=t.model.isassistflow&&"9"!=t.model.isassistflow){var n=[];$('#principalAssistUser input[selectType="assistUser"]:checked').each(function(){n.push($(this).val())}),n.length>0?t.flow.businessMap.A_USER_ID=n.join(","):(e.resultTag=!1,e.resultMsg="必须要选择负责人！")}else t.businessFlag.principalUsers&&0!=t.businessFlag.principalUsers.length||(e.resultTag=!1,e.resultMsg="请先选择项目负责人！"),e.resultTag&&(t.flow.businessMap.PRINCIPAL=t.businessFlag.principalUsers);break;case flowcommon.getSignFlowNode().SIGN_XMFZR1:case flowcommon.getSignFlowNode().SIGN_XMFZR2:case flowcommon.getSignFlowNode().SIGN_XMFZR3:case flowcommon.getSignFlowNode().SIGN_XMFZR4:9==t.businessFlag.isNeedWP&&0==t.businessFlag.isFinishWP&&(e.resultTag=!1,e.resultMsg="您还没有完成工作方案，不能进行下一步操作！"),t.flow.businessMap.IS_NEED_WP=t.businessFlag.isNeedWP;break;case flowcommon.getSignFlowNode().SIGN_BMLD_SPW1:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW2:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW3:case flowcommon.getSignFlowNode().SIGN_BMLD_SPW4:break;case flowcommon.getSignFlowNode().SIGN_FGLD_SPW1:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW2:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW3:case flowcommon.getSignFlowNode().SIGN_FGLD_SPW4:break;case flowcommon.getSignFlowNode().SIGN_FW:t.model.processState<4&&(e.resultTag=!1,e.resultMsg="您还没完成发文操作，不能进行下一步操作！"),t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_QRFW:case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW_XB:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW_XB:"9"==t.businessFlag.passDis||9==t.businessFlag.passDis?t.flow.businessMap.AGREE="9":t.flow.businessMap.AGREE="0",t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_BMLD_QRFW:case flowcommon.getSignFlowNode().SIGN_FGLD_QRFW:case flowcommon.getSignFlowNode().SIGN_ZR_QRFW:case flowcommon.getSignFlowNode().SIGN_FWBH:t.flow.businessMap.DIS_ID=t.dispatchDoc.id;break;case flowcommon.getSignFlowNode().SIGN_CWBL:break;case flowcommon.getSignFlowNode().SIGN_GD:t.model.processState<7&&(e.resultTag=!1,e.resultMsg="您还没完成归档操作，不能进行下一步操作！");break;case flowcommon.getSignFlowNode().SIGN_DSFZR_QRGD:case flowcommon.getSignFlowNode().SIGN_QRGD:t.flow.businessMap.GD_ID=t.fileRecord.fileRecordId}return e}function r(e){var i={method:"get",url:rootPath+"/dispatch/html/initDispatchBySignId",params:{signId:e.model.signid}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.dispatchDoc=t.data,$("#show_dispatch_a").click()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e){var i={method:"get",url:rootPath+"/fileRecord/html/initBySignId",params:{signId:e.model.signid}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.fileRecord=t.data,$("#show_filerecord_a").click()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(e){var i={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e.model.signid,queryAll:!0}},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.model=t.data,e.model.workProgramDtoList&&e.model.workProgramDtoList.length>0&&(e.show_workprogram=!0,e.model.workProgramDtoList.forEach(function(t,i){9==t.isMain?(e.showMainwork=!0,e.mainwork={},e.mainwork=t):0==t.isMain&&(e.showAssistwork=!0,e.assistwork={},e.assistwork=t)})),e.model.dispatchDocDto&&(e.show_dispatch=!0,e.dispatchDoc=e.model.dispatchDocDto),e.model.fileRecordDto&&(e.show_filerecord=!0,e.fileRecord=e.model.fileRecordDto)}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}return{startFlow:o,initBusinessParams:n,checkBusinessFill:a,getChargeDispatch:r,getChargeFilerecord:s,endSignDetail:l}}angular.module("app").factory("signFlowSvc",t),t.$inject=["$http","$state","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n,a,r,s,l,d,c){function m(t){t=void 0==t?0:t;var e=0;return t>800&&t<=4e3?e=.2*(t-800):t>4e3&&t<=2e4?e=.8*t*.2:t>2e4&&t<=5e4&&(e=.8*t*.3-2e3),e}var u=this;u.title="项目流程处理",u.model={},u.flow={},u.mainwork={},u.assistwork={},u.dispatchDoc={},u.fileRecord={},u.expertReview={},u.work={},u.showFlag={businessTr:!1,businessDis:!1,businessNext:!1,nodeNext:!0,nodeSelViceMgr:!1,nodeSelOrgs:!1,nodeSelPrincipal:!1,isMainBranch:!1,nodeSign:!1,nodeWorkProgram:!1,nodeDispatch:!1,nodeConfirmDis:!1,nodeCreateDisNum:!1,nodeFileRecord:!1,nodeXSWorkProgram:!1,tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,buttBack:!1,expertRemark:!1,expertpayment:!1,expertEdit:!1,isMainPrinUser:!1},u.businessFlag={isLoadSign:!1,isLoadFlow:!1,isGotoDis:!1,isMakeDisNum:!1,principalUsers:[],isSelMainPriUser:!1,editExpertSC:!1,expertScore:{},isNeedWP:9,isMainBranch:!1,isFinishWP:!1,passDis:!1,curBranchId:"",editEPReviewId:""},u.model.signid=o.params.signid,u.work.id=o.params.id,u.flow.taskId=o.params.taskId,u.flow.processInstanceId=o.params.processInstanceId,function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),e.initFlowPageData(u.model.signid,function(t){u.model=t,u.model.dispatchDocDto&&(u.showFlag.tabDispatch=!0,u.dispatchDoc=u.model.dispatchDocDto,2==u.dispatchDoc.dispatchWay&&0==u.dispatchDoc.isMainProject||u.dispatchDoc.fileNum?u.businessFlag.isCreateDisFileNum=!0:u.showFlag.buttDisFileNum=!0),u.model.fileRecordDto&&(u.showFlag.tabFilerecord=!0,u.fileRecord=u.model.fileRecordDto),u.businessFlag.isLoadSign=!0,u.businessFlag.isLoadSign&&u.businessFlag.isLoadFlow&&a.initBusinessParams(u),u.model.suppLetterDtoList&&(u.showSupperIndex=0)}),n.getFlowInfo(u.flow.taskId,u.flow.processInstanceId,function(t){u.flow=t,u.flow.end&&(u.showFlag.nodeNext=!1),u.businessFlag.isLoadFlow=!0,u.businessFlag.isLoadSign&&u.businessFlag.isLoadFlow&&a.initBusinessParams(u)}),n.initFlowData(u),t.findByMianId(u.model.signid,function(t){t&&t.length>0&&(u.showFlag.tabSysFile=!0,u.sysFileList=t)}),r.initIdea(u)}(),u.ideaEdit=function(t){angular.isObject(t)||(t={}),r.initIdeaData(u,t)},u.selectedIdea=function(){u.flow.dealOption=u.chooseIdea},u.editSelectExpert=function(t){u.scoreExpert={},$.each(u.model.expertReviewDto.expertSelectedDtoList,function(e,i){if(i.id==t)return void(u.scoreExpert=i)}),$("#star").raty({score:function(){return $(this).attr("data-num",angular.isUndefined(u.scoreExpert.score)?0:u.scoreExpert.score),$(this).attr("data-num")},starOn:"../contents/libs/raty/lib/images/star-on.png",starOff:"../contents/libs/raty/lib/images/star-off.png",starHalf:"../contents/libs/raty/lib/images/star-half.png",readOnly:!1,halfShow:!0,size:34,click:function(t,e){u.scoreExpert.score=t}}),$("#score_win").kendoWindow({width:"820px",height:"365px",title:"编辑-专家星级",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},u.closeEditMark=function(){window.parent.$("#score_win").data("kendoWindow").close()},u.saveMark=function(){common.initJqValidation($("#expert_score_form")),$("#expert_score_form").valid()?l.saveMark(u.scoreExpert,function(){c.success("保存成功！",function(){u.closeEditMark()})}):c.alert("请填写评分和评分内容！")},u.countTaxes=function(t){if(void 0!=t){if(void 0==t.payDate)return void c.alert("请选择评审费发放日期");if(!/^(\d{4}-\d{1,2}-\d{1,2})$/.exec(t.payDate))return void c.alert("请输入正确的日期格式");if(void 0==t.expertSelectedDtoList||0==t.expertSelectedDtoList.length)return void c.alert("该方案还没评审专家");common.initJqValidation($("#payform"));if($("#payform").valid()){var e,i=t.expertSelectedDtoList.length,o="";$.each(t.expertSelectedDtoList,function(t,e){o+="'"+e.id+"'",t!=i-1&&(o+=",")});var n=t.payDate;e=n.substring(0,n.lastIndexOf("-")),l.countTaxes(o,e,function(e){var i=e;t.reviewCost=0,t.reviewTaxes=0,t.totalCost=0,$.each(t.expertSelectedDtoList,function(e,o){if(!("9"!=o.isConfrim&&9!=o.isConfrim||"9"!=o.isJoin&&9!=o.isJoin)){var n=o.EXPERTID,a=o.id,r=0;void 0!=i&&i.length>0&&i.forEach(function(t,e){t.EXPERTID==n&&t.ESID!=a&&(t.REVIEWCOST=void 0==t.REVIEWCOST?0:t.REVIEWCOST,t.REVIEWCOST=parseFloat(t.REVIEWCOST),r=parseFloat(r)+t.REVIEWCOST)}),o.reviewCost=void 0==o.reviewCost?0:o.reviewCost;var s=r+parseFloat(o.reviewCost);o.reviewTaxes=m(s).toFixed(2),o.totalCost=(parseFloat(o.reviewCost)+parseFloat(o.reviewTaxes)).toFixed(2),t.reviewCost=(parseFloat(t.reviewCost)+parseFloat(o.reviewCost)).toFixed(2),t.reviewTaxes=(parseFloat(t.reviewTaxes)+parseFloat(o.reviewTaxes)).toFixed(2),t.totalCost=(parseFloat(t.reviewCost)+parseFloat(t.reviewTaxes)).toFixed(2)}})})}}},u.closeEditPay=function(){window.parent.$("#payment").data("kendoWindow").close()},u.savePayment=function(t){common.initJqValidation($("#payform")),$("#payform").valid()?l.savePayment(t,u.isCommit,function(t){t.flag||"ok"==t.reCode?c.alert("操作成功！",function(){u.isCommit=!1}):c.alert(t.reMsg)}):c.alert("请正确填写专家评审费信息！")},u.commitNextStep=function(){if(u.flow.isSuspended)return void c.error("该流程目前为暂停状态，不能进行流转操作！");var t=a.checkBusinessFill(u);t.resultTag?n.commit(u.isCommit,u.flow,function(t){t.flag||"ok"==t.reCode?c.success("操作成功！",function(){o.go("gtasks")}):c.alert(t.reMsg)}):c.alert(t.resultMsg)},u.commitBack=function(){common.initJqValidation($("#flow_form")),$("#flow_form").valid()&&c.confirm({title:"询问提示",message:"确认回退吗？",onOk:function(){n.rollBackToLast(u.flow,u.isCommit,function(t){t.flag||"ok"==t.reCode?(u.isCommit=!1,c.alert("回退成功！",function(){o.go("gtasks")})):c.alert(t.reMsg)})}})},u.deleteFlow=function(){c.confirm({title:"询问提示",message:"终止流程将无法恢复，确认删除么？？",onOk:function(){$(".confirmDialog").modal("hide"),n.deleteFlow(u)}})},u.editSign=function(){o.go("fillSign",{signid:u.model.signid})},u.addWorkProgram=function(){o.go("workprogramEdit",{signid:u.model.signid})},u.addSuppLetter=function(){e.findWorkProgramBySignId(u,function(){console.log(u.workProgramId),u.workProgramId?o.go("addSupp",{businessId:u.model.signid,businessType:"SIGN",workId:u.workProgramId}):c.alert("请先保存工作方案")})},u.addSuppLetterList=function(){o.go("addSuppletterList",{businessId:u.model.signid})},u.addRegisterFile=function(){o.go("registerFile",{businessId:u.model.signid})},u.addBaseWP=function(){o.go("workprogramBaseEdit",{signid:u.model.signid})},u.addDisPatch=function(){u.model.isAssociate&&0!=u.model.isAssociate||signcommon.getReviewStage().STAGE_STUDY!=u.model.reviewstage&&signcommon.getReviewStage().STAGE_BUDGET!=u.model.reviewstage?o.go("dispatchEdit",{signid:u.model.signid}):c.confirm({title:"询问提示",message:"该项目还没进行项目关联，是否需要进行关联设置？",onOk:function(){u.searchAssociateSign||(u.searchAssociateSign={signid:u.model.signid,projectname:u.model.projectname}),e.getAssociateSign(u.searchAssociateSign,function(t){u.associateSignList=[],t&&(u.associateSignList=t),$("#associateWindow").kendoWindow({width:"75%",height:"650px",title:"项目关联",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","close"]}).data("kendoWindow").center().open()})},onCancel:function(){o.go("dispatchEdit",{signid:u.model.signid})}})},u.associateQuerySign=function(){e.getAssociateSign(u.searchAssociateSign,function(t){u.associateSignList=[],t&&(u.associateSignList=t)})},u.saveAssociateSign=function(t){if(u.model.signid==t)return void c.alert("不能关联自身项目");e.saveAssociateSign(u.model.signid,t,function(){t&&(u.model.isAssociate=1),c.alert(void 0!=t?"项目关联成功":"项目解除关联成功"),window.parent.$("#associateWindow").data("kendoWindow").close()})},u.addFinancialApply=function(){o.go("financialManager",{businessId:u.model.signid})},u.assistCostAdd=function(){o.go("assistCostAdd",{signid:u.model.signid})},u.addDoFile=function(){o.go("fileRecordEdit",{signid:u.model.signid})},u.addRegisterFileRecord=function(){u.fileRecord.fileRecordId?o.go("registerFile",{signid:u.fileRecord.fileRecordId}):c.alert("请保存归档再操作！")},u.mainOrg=function(t){var e=t.target,i=e.checked,o=e.value;i?$('.seleteTable input[selectType="main"]').each(function(){var t=$(this).attr("value");t!=o?($(this).removeAttr("checked"),$("#assist_"+t).removeAttr("disabled")):($("#assist_"+o).removeAttr("checked"),$("#assist_"+o).attr("disabled","disabled"))}):$("#assist_"+o).removeAttr("disabled"),u.initOption()},u.initOption=function(){var t=[];$('.seleteTable input[selectType="main"]:checked').each(function(){t.push($(this).attr("tit"))}),$('.seleteTable input[selectType="assist"]:checked').each(function(){t.push($(this).attr("tit"))}),t.length>0&&(u.flow.dealOption="请（"+t.join("，")+"）组织评审")},u.checkPrincipal=function(){var t=$("#selPrincipalMainUser").val();t&&$('#principalAssistUser input[selectType="assistUser"]').each(function(){$(this).attr("value")==t?($(this).removeAttr("checked"),$(this).attr("disabled","disabled")):$(this).removeAttr("disabled")}),u.initUserOption()},u.initUserOption=function(){var t=$("#selPrincipalMainUser").val(),e=!1,i="请（";t&&$.each(u.users,function(o,n){n.id==t&&(i+=n.displayName,e=!0)});var o=[];$('#p_assistUser input[selectType="assistUser"]:checked').each(function(){o.push($(this).attr("tit"))}),o.length>0&&(e&&(i+=", "),i+=o.join(", ")),i+=" )组织办理。",u.flow.dealOption=i},u.checkBoxSingle=function(t,e){var i=t.target,o=i.checked,n=i.value;o?$('.seleteTable input[selectType="'+e+'"]').each(function(){var t=$(this).attr("id"),i=$(this).attr("value");t!=e+"_"+n?($("#"+disabletype+"_"+i).removeAttr("disabled"),$(this).removeAttr("checked")):$("#"+disabletype+"_"+n).attr("disabled","disabled")
}):$("#"+disabletype+"_"+n).removeAttr("disabled")},u.checkBoxSingle=function(t,e){var i=t.target,o=i.checked,n=i.value;o&&$('#xs_table input[selectType="'+e+'"]').each(function(){$(this).attr("id");$(this).attr("value")!=n&&$(this).removeAttr("checked")})},u.addPriUser=function(){var t=$("#xs_bmfb input[name='unSelPriUser']:checked");if(t.length<1)c.alert("请选择负责人");else{if(u.businessFlag.isMainBranch){if(9==u.isMainPriUser&&t.length>1)return void c.alert("总负责人只能选一个");if(0==u.businessFlag.isSelMainPriUser&&(angular.isUndefined(u.isMainPriUser)||0==u.isMainPriUser))return void c.alert("请先选择总负责人");if(1==u.businessFlag.isSelMainPriUser&&9==u.isMainPriUser)return void c.alert("你已经选择了一个总负责人，不能再次选择负责人！")}if(u.businessFlag.principalUsers&&u.businessFlag.principalUsers.length+t.length>3)return void c.alert("最多只能选择3个负责人，请重新选择！");for(var e=0;e<t.length;e++){var i={};i.userId=t[e].value,i.userType=$("#userType").val(),9==u.isMainPriUser?(u.businessFlag.isSelMainPriUser=!0,i.isMainUser=9,u.isMainPriUser):i.isMainUser=0,u.users.forEach(function(o,n){o.id==t[e].value&&(o.isSelected=!0,i.userId=o.id,i.userName=o.displayName)}),u.businessFlag.principalUsers.push(i)}}},u.delPriUser=function(){var t=$("#xs_bmfb input[name='selPriUser']:checked");if(t.length<1)c.alert("请选择取消的负责人");else for(var e=0;e<t.length;e++)u.users.forEach(function(i,o){i.id==t[e].value&&(i.isSelected=!1)}),u.businessFlag.principalUsers.forEach(function(i,o){i.userId==t[e].value&&(9==i.isMainUser&&(u.businessFlag.isSelMainPriUser=!1),u.businessFlag.principalUsers.splice(o,1))})},u.checkNeedWP=function(t){var i=t.target,o=i.checked;o?u.businessFlag.isNeedWP=9:u.businessFlag.isFinishWP?c.confirm({title:"询问提示",message:"取消工作方案操作将会对您之前的做的工作方案进行清除，数据清除不可恢复，确定不做工作么？",onOk:function(){$(".confirmDialog").modal("hide"),u.businessFlag.isNeedWP=0,e.removeWP(u)},onClose:function(){i.checked=!o,u.businessFlag.isNeedWP=9}}):u.businessFlag.isNeedWP=0},u.meetingDoc=function(){common.confirm({vm:u,title:"",msg:"如果之前已经生成会前准备材料，则本次生成的文档会覆盖之前产生的文档，确定执行操作么？",fn:function(){$(".confirmDialog").modal("hide"),e.findWorkProgramBySignId(u,function(){e.meetingDoc(u)})}})},u.commonDownloadSysFile=function(e){t.downloadFile(e)},u.createDispatchFileNum=function(){e.createDispatchFileNum(u.model.signid,u.dispatchDoc.id,function(t){(t.flag||"ok"==t.reCode)&&(u.dispatchDoc.fileNum=t.reObj),c.alert(t.reMsg)})},u.dispatchTemplate=function(){e.createDispatchTemplate(u)},u.watchPassDis=function(){d.$watch("vm.businessFlag.passDis",function(t,e){u.flow.dealOption=9==t?"通过":"不通过"})},u.affirmJoinExpert=function(){u.model.expertReviewDto&&u.model.expertReviewDto.expertSelectedDtoList?(u.confirmEPList=u.model.expertReviewDto.expertSelectedDtoList,$("#confirmJoinExpert").kendoWindow({width:"75%",height:"600px",title:"参加评审会专家确认",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):c.alert("该项目没有评审专家！")},u.updateToJoin=function(){var t=$("#notJoinExpertTable input[name='notJoinExpert']:checked");if(t.length<1)c.alert("请选择要改为参加会议的专家");else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);l.updateJoinState("","",e.join(","),"9",u.isCommit,function(t){c.success("操作成功！"),u.reFleshJoinState(e,"9")})}},u.updateToNotJoin=function(){var t=$("#joinExpertTable input[name='joinExpert']:checked");if(t.length<1)c.alert("请选择未参加会议的专家");else{for(var e=[],i=0;i<t.length;i++)e.push(t[i].value);l.updateJoinState("","",e.join(","),"0",u.isCommit,function(t){c.success("操作成功！"),u.reFleshJoinState(e,"0")})}},u.reFleshJoinState=function(t,e){$.each(t,function(t,i){$.each(u.confirmEPList,function(t,o){i==o.id&&(o.isJoin=e)})})}}angular.module("app").controller("signFlowDealCtrl",t),t.$inject=["sysfileSvc","signSvc","workprogramSvc","$state","flowSvc","signFlowSvc","ideaSvc","addRegisterFileSvc","expertReviewSvc","$scope","bsWin"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="项目流程信息",a.model={},a.flow={},a.work={},a.dispatchDoc={},a.fileRecord={},a.model.signid=i.params.signid,a.flow.taskId=i.params.taskId,a.flow.processInstanceId=i.params.processInstanceId,a.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},a.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),o.initFlowData(a),e.initFlowPageData(a.model.signid,function(t){a.model=t,a.model.dispatchDocDto&&(a.showFlag.tabDispatch=!0,a.dispatchDoc=a.model.dispatchDocDto,2==a.dispatchDoc.dispatchWay&&0==a.dispatchDoc.isMainProject||a.dispatchDoc.fileNum?a.businessFlag.isCreateDisFileNum=!0:a.showFlag.buttDisFileNum=!0),a.model.fileRecordDto&&(a.showFlag.tabFilerecord=!0,a.fileRecord=a.model.fileRecordDto),a.model.processState>1&&(a.showFlag.tabWorkProgram=!0),a.model.suppLetterDtoList&&(a.showSupperIndex=0)}),t.findByMianId(a.model.signid,function(t){t&&t.length>0&&(a.showFlag.tabSysFile=!0,a.sysFileList=t)})}(),a.getExpertStar=function(t,e){var i="";if(void 0!=e)for(var o=0;o<e;o++)i+="<span style='color:gold;font-size:20px;'><i class='fa fa-star' aria-hidden='true'></i></span>";$("#"+t+"_starhtml").html(i)}}angular.module("app").controller("signFlowDetailCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc","signFlowSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.title="新增预签收收文",o.reserveAdd=function(){e.reserveAdd(o)}}angular.module("app").controller("signReserveAddCtrl",t),t.$inject=["$location","reserveSignSvc","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.title="预签收列表",o.del=function(t){common.confirm({vm:o,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteReserveSign(o,t)}})},o.querySign=function(){e.querySign(o)},function(){e.grid(o)}()}angular.module("app").controller("signReserveCtrl",t),t.$inject=["$location","reserveSignSvc","$state"]}(),function(){"use strict";function t(t,e){function i(t){t.gridOptions.dataSource.read()}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:d+"/deleteReserve",params:{signid:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){var i={method:"put",url:d+"/roomUseState",data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(i){if(common.initJqValidation(),$("form").valid()){i.isSubmit=!0;var o={method:"post",url:d+"/html/reserveAddPost",data:i.model},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功,请继续填写报审登记表！",closeDialog:!0,fn:function(){e.go("fillSign",{signid:t.data.signid},{reload:!0})}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n,onError:function(t){i.iscommit=!1}})}}function s(e){var i={method:"get",url:d+"/html/findByIdsign",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/reserveListSign",$("#reserveFrom")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:160,filterable:!1},{field:"projectcode",title:"收文编号",width:120,filterable:!1},{field:"designcompanyName",title:"项目单位",width:150,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"projectcode",title:"项目代码",width:120,filterable:!1},{field:"receivedate",title:"收文时间",width:160,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.ispresign?0==t.ispresign?'<span style="color:green;">预签收</span>':void 0:" "}},{field:"",title:"操作",width:180,template:function(t){return common.format($("#columnBtns").html(),t.signid,"vm.del('"+t.signid+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var d=rootPath+"/sign";return{grid:l,getsignById:s,reserveAdd:r,deleteReserveSign:n,updatesign:o,querySign:i,roomUseState:a}}angular.module("app").factory("reserveSignSvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.model={},n.flow={},n.title="项目综合查询",n.model.signid=i.params.signid,n.flow.processInstanceId=i.params.processInstanceId,n.showFlag={tabWorkProgram:!1,tabBaseWP:!1,tabDispatch:!1,tabFilerecord:!1,tabExpert:!1,tabSysFile:!1,tabAssociateSigns:!1},n.businessFlag={expertReviews:[]},function(){$("#myTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)}),i.params.processInstanceId&&o.initFlowData(n),e.initFlowPageData(n.model.signid,function(t){n.model=t,n.model.dispatchDocDto&&(n.showFlag.tabDispatch=!0,n.dispatchDoc=n.model.dispatchDocDto,2==n.dispatchDoc.dispatchWay&&0==n.dispatchDoc.isMainProject||n.dispatchDoc.fileNum?n.businessFlag.isCreateDisFileNum=!0:n.showFlag.buttDisFileNum=!0),n.model.fileRecordDto&&(n.showFlag.tabFilerecord=!0,n.fileRecord=n.model.fileRecordDto),n.model.processState>1&&(n.showFlag.tabWorkProgram=!0),n.model.suppLetterDtoList&&(n.showSupperIndex=0)}),t.findByMianId(n.model.signid,function(t){t&&t.length>0&&(n.showFlag.tabSysFile=!0,n.sysFileList=t)})}()}angular.module("app").controller("signDetailsCtrl",t),t.$inject=["sysfileSvc","signSvc","$state","flowSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(e){var i={method:"post",url:rootPath+"/dispatch/createDispatchTemplate",params:{signId:e.model.signid}},o=function(t){};common.http({$http:t,httpOptions:i,success:o})}function a(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/findBySignUser",$("#searchform")),schema:common.kendoGridConfig().schema({id:"signid",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.signid)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"projectname",title:"项目名称",width:120,filterable:!1},{field:"filecode",title:"收文编号",width:80,filterable:!1},{field:"designcompanyName",title:"项目单位",width:100,filterable:!1},{field:"reviewstage",title:"项目阶段",width:80,filterable:!1},{field:"projectcode",title:"项目代码",width:80,filterable:!1},{field:"signdate",title:"签收日期",width:100,filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"流程状态",width:80,filterable:!1,template:function(t){return t.signState?1==t.signState?'<span style="color:green;">进行中</span>':2==t.signState?'<span style="color:orange;">已暂停</span>':8==t.signState?'<span style="color:red;">强制结束</span>':9==t.signState?'<span style="color:blue;">已完成</span>':5==t.signState?"未发起":"":"未发起"}},{field:"",title:"操作",width:180,template:function(t){var e=angular.isString(t.processInstanceId),i=!(!t.issign||9!=t.issign);return common.format($("#columnBtns").html(),t.signid,e,t.signid+"/"+t.processInstanceId,"vm.del('"+t.signid+"')",e,"vm.startNewFlow('"+t.signid+"')",e,"vm.realSign('"+t.signid+"')",i)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function r(e,i){var o={method:"post",url:rootPath+"/sign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"post",url:rootPath+"/officeUser/findOfficeUsersByDeptName",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(e,i){var o={method:"put",url:rootPath+"/sign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(e,i){var o={method:"delete",url:rootPath+"/sign",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function c(e,i){var o={method:"post",url:rootPath+"/sign/html/initFillPageData",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function m(e,i){var o={method:"get",url:rootPath+"/sign/html/initDetailPageData",params:{signid:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function u(e,i){var o={method:"get",url:rootPath+"/sign/initFlowPageData",params:{signid:e,queryAll:!0}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function p(e){var o={method:"delete",url:rootPath+"/workprogram/deleteBySignId",params:{signId:e.model.signid}},n=function(t){e.isSubmit=!1,t.data.flag||"ok"==t.data.reCode?(e.businessFlag.isFinishWP=!1,i.success("操作成功！")):i.error(t.data.reMsg)};common.http({vm:e,$http:t,httpOptions:o,success:n})}function f(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sign/fingByOData",$("#searchAssociateform"),{filter:"isAssociate eq 0"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"projectname",title:"项目名称",width:160,filterable:!1},{field:"projectcode",title:"收文编号",width:140,filterable:!1},{field:"designcompanyName",title:"项目单位",width:200,filterable:!1},{field:"reviewstage",title:"项目阶段",width:160,filterable:!1},{field:"projectcode",title:"项目代码",width:140,filterable:!1}];t.associateGridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}function h(e,i){var o={method:"post",url:rootPath+"/sign/findAssociateSign",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function g(e,i,o){i="undefined"==i?null:i;var n={method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:rootPath+"/sign/associate",data:$.param({signId:e,associateId:i},!0)},a=function(t){void 0!=o&&"function"==typeof o&&o()};common.http({$http:t,httpOptions:n,success:a})}function v(e,i){var o={method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:rootPath+"/sign/associate?signId="+i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){if(void 0!=t.data){e.associateSign=t.data;for(var i=t.data,o="",n=i.length-1;n>=0;n--){var a=i[n],r=a.signdate||"";o+='<div class="intro-list"><div class="intro-list-left">项目阶段：'+a.reviewstage+"<br/>签收时间："+r+'</div><div class="intro-list-right"><span></span><div class="intro-list-content">名称：<span style="color:red;">'+a.projectname+'</span><br/>送件人：<span style="color:red;">'+a.sendusersign+"</span><br/></div></div></div>"}$("#introFlow").html(o);$("#myStep").step({animate:!0,initStep:1,speed:1e3})}}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function b(e,i){var o={method:"get",url:rootPath+"/workprogram/findByPrincipalUser",params:{signId:e.model.signid}},n=function(t){e.workProgramId=t.data.id,void 0!=i&&"function"==typeof i&&i()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function w(e){var i="";switch(e.flow.curNode.activitiId){case flowcommon.getSignFlowNode().SIGN_XMFZR1:case flowcommon.getSignFlowNode().SIGN_XMFZR2:case flowcommon.getSignFlowNode().SIGN_XMFZR3:case flowcommon.getSignFlowNode().SIGN_XMFZR4:!angular.isUndefined(e.workProgramId)&&e.workProgramId&&(i=e.workProgramId);break;default:i=""}if(i){var n={method:"get",url:rootPath+"/workprogram/createMeetingDoc",params:{signId:e.model.signid,workprogramId:i}},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:t.data.reMsg,closeDialog:!0,fn:function(){"error"==t.data.reCode?e.isCommit=!1:o.findByMianId(e.model.signid,function(t){(t||t.length>0)&&(e.showFlag.tabSysFile=!0,e.sysFileList=t)})}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}else common.alert({vm:e,msg:"请先填写工作方案信息！"})}function y(e,i,o){var n={method:"post",url:rootPath+"/dispatch/createFileNum",params:{signId:e,dispatchId:i}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function S(e,i){var o={method:"post",url:rootPath+"/sign/realSign",params:{signid:i}},n=function(t){void 0!=callBack&&"function"==typeof callBack&&callBack(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{signGrid:a,createSign:r,initFillData:c,initDetailData:m,updateFillin:l,deleteSign:d,findOfficeUsersByDeptName:s,initFlowPageData:u,removeWP:p,associateGrid:f,getAssociateSign:h,saveAssociateSign:g,initAssociateSigns:v,meetingDoc:w,createDispatchFileNum:y,realSign:S,findWorkProgramBySignId:b,createDispatchTemplate:n}}angular.module("app").factory("signSvc",t),t.$inject=["$http","$state","bsWin","sysfileSvc"]}(),function(){"use strict";function t(){return n}function e(t){var e="";switch(t){case n.PD:e=a.ZHANG_YF;break;case n.GD:e=a.LI_J}return e}function i(t){var e="";switch(t){case n.PD:e="请张主任阅示。";break;case n.GD:e="请李主任阅示。"}return e}function o(){return r}var n={PX:"PX",GX:"GX"},a={ZHANG_YF:"张一帆",LI_J:"李军"},r={godispatch:"godispatch",principaluser:"principaluser",seconduser:"seconduser"},s={getBusinessType:t,getDefaultLeader:e,getDefaultZHBYJ:i,getFlowParams:o,getReviewStage:function(){return{STAGE_SUG:"项目建议书",STAGE_STUDY:"可行性研究报告",STAGE_BUDGET:"项目概算",APPLY_REPORT:"资金申请报告",OTHERS:"其它",DEVICE_BILL_HOMELAND:"设备清单（国产）",DEVICE_BILL_IMPORT:"设备清单（进口）",IMPORT_DEVICE:"进口设备"}}};window.signcommon=s}(),function(){"use strict";function t(t,e){var i=this;i.model={},i.title="系统配置",function(){e.queryList(i)}(),i.addConfig=function(){i.model={},$("#configdiv").kendoWindow({width:"700px",height:"440px",title:"参数编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},i.closeWin=function(){window.parent.$("#configdiv").data("kendoWindow").close()},i.doCommit=function(){common.initJqValidation(),$("#configForm").valid()&&e.saveConfig(i)},i.editConfig=function(t){i.configList.forEach(function(e,o){e.id==t&&(i.model=e)}),$("#configdiv").kendoWindow({width:"700px",height:"440px",title:"参数编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},i.del=function(t){var o=$("input[name='configid']:checked");o.length<1?common.alert({vm:i,msg:"请选择删除的参数"}):common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide");for(var t=[],n=0;n<o.length;n++)t.push(o[n].value);e.deleteConfig(i,t.join(","))}})}}angular.module("app").controller("sysConfigCtrl",t),t.$inject=["$location","sysConfigSvc"]}(),function(){"use strict";function t(t){function e(e){var i={method:"get",url:rootPath+"/sysConfig/queryList"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.configList=new Array,e.configList=t.data}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function i(i,o){var n={method:"delete",url:rootPath+"/sysConfig",params:{id:o}},a=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),i.isSubmit=!1,e(i)}})}})};common.http({vm:i,$http:t,httpOptions:n,success:a})}function o(i){var o={method:"post",url:rootPath+"/sysConfig",data:i.model},n=function(t){common.requestSuccess({vm:i,response:t,fn:function(){common.alert({vm:i,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),i.isSubmit=!1,e(i)}})}})};common.http({vm:i,$http:t,httpOptions:o,success:n})}return{queryList:e,deleteConfig:i,saveConfig:o}}angular.module("app").factory("sysConfigSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){var e=this;e.model={},e.title="部门小组列表",function(){t.listGrid(e.gridOptions)}()}angular.module("app").controller("sysdeptCtrl",t),t.$inject=["sysdeptSvc"]}(),function(){"use strict";function t(t){var e=this;e.model={},e.title="部门小组编辑",e.model.id=$state.params.id,e.model.id&&(e.isUpdate=!0,e.title="更新部门"),function(){e.isUpdate&&t.findById(e.model.id,function(t){e.model=t})}()}angular.module("app").controller("sysdeptEditCtrl",t),t.$inject=["sysdeptSvc"]}(),function(){"use strict";function t(t){function e(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/sysdept/fingByOData",$("#sysDeptForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"name",title:"小组名称",width:160,filterable:!1},{field:"",title:"操作",width:200,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];common.gridDataSource(e),common.kendoGridConfig().filterable,common.kendoGridConfig().pageable,common.kendoGridConfig().noRecordMessage}function i(e,i){var o={method:"post",url:rootPath+"/sysdept/getSysDeptById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{listGrid:e,findById:i}}angular.module("app").factory("sysdeptSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="系统安装包列表",function(){e.queryPluginfile(i)}()}angular.module("app").controller("pluginfileCtrl",t),t.$inject=["$location","sysfileSvc"]}(),function(){"use strict";function t(t,e){function i(){alert(12)}function o(){return{SIGN:"项目附件",FILLSIGN:"审批登记",HUMAN:"人事附件",BOOKS:"图书附件",NOTICE:"通知公告",SHARE:"资料共享",MEETTINGROOM:"会议室预定",WORKPROGRAM:"工作方案",DISPATCH:"发文",DOFILE:"归档",MEETING:"会前准备材料",SUPPLEMENT:"补充函",STAGEMEETING:"评审会会议",FILELIBRARY:"质量管理文件库",POLICYLIBRARY:"政策标准库",TOPIC:"课题附件",TOPIC_PLAN:"课题计划书",TOPIC_WORKPLAN:"课题工作方案",TOPIC_FILING:"课题归档",CENTER_FILE:"中心文件（稿纸）",AADSUPP_FILE:"拟补充资料函"}}function n(t){window.open(rootPath+"/file/fileDownload?sysfileId="+t)}function a(e,i){var o={method:"post",url:rootPath+"/file/findByBusinessId",params:{businessId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function r(e,i){var o={method:"post",url:rootPath+"/file/findByMainId",params:{mainId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function s(e,i){var o={method:"delete",url:rootPath+"/file/deleteSysFile",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function l(t){t.vm.initUploadOptionSuccess=!1;var i={width:"70%",height:"460px",uploadBt:"upload_file_bt",detailBt:"detail_file_bt",inputId:"sysfileinput",mainType:"没有归类附件",sysBusiType:"",showBusiType:!0};if(!t.vm.sysFile)return void e.alert("初始化附件控件失败，请先定义附件对象！");if(t.sysBusiType&&(i.sysBusiType=t.sysBusiType),t.width&&(i.width=t.width),t.height&&(i.height=t.height),angular.isUndefined(t.vm.sysFile.showBusiType)&&(t.vm.sysFile.showBusiType=i.showBusiType),t.vm.downloadSysFile=function(t){n(t)},t.vm.delSysFile=function(i){s(i,function(){e.alert("删除成功！"),$.each(t.vm.sysFilelists,function(e,o){o.sysFileId==i&&t.vm.sysFilelists.splice(e,1)})})},t.vm.clickUploadBt=function(){t.vm.sysFile.businessId?$("#commonUploadWindow").kendoWindow({width:i.width,height:i.height,title:"附件上传",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open():e.alert("请先保存业务数据！")},t.vm.clickDetailBt=function(){if(!t.vm.sysFile.businessId)return void e.alert("请先保存业务数据！");a(t.vm.sysFile.businessId,function(e){t.vm.sysFilelists=[],t.vm.sysFilelists=e,$("#commonQueryWindow").kendoWindow({width:"800px",height:"500px",title:"附件上传列表",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()})},t.vm.sysFile.businessId){var o={language:"zh",allowedPreviewTypes:["image"],allowedFileExtensions:["jpg","png","gif","docx","doc","xls","xlsx","pdf","ppt","pptx","zip","rar"],maxFileSize:5e3,showRemove:!1,uploadUrl:rootPath+"/file/fileUpload",uploadExtraData:function(e,o){var n={};return n.businessId=t.vm.sysFile.businessId,n.mainId=t.vm.sysFile.mainId,n.mainType=t.vm.sysFile.mainType||i.mainType,n.sysfileType=t.vm.sysFile.sysfileType,n.sysBusiType=t.vm.sysFile.sysBusiType||i.sysBusiType,n}},r=0;$("#"+t.inputId||i.inputId).fileinput(o).on("filebatchselected",function(t,e){r=e.length}).on("fileuploaded",function(e,i,n,a){o.sysBusiType=t.vm.sysFile.sysBusiType,r==a+1&&void 0!=t.uploadSuccess&&"function"==typeof t.uploadSuccess&&t.uploadSuccess(e,i,n,a)}),t.vm.initUploadOptionSuccess=!0}}function d(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/file/getPluginFile"),schema:common.kendoGridConfig().schema(),serverPaging:!1,serverSorting:!0,serverFiltering:!0,sort:{field:"createdDate",dir:"desc"}}),i=[{field:"fileName",title:"名称",filterable:!1},{field:"fileLength",title:"大小",width:160,filterable:!1},{field:"",title:"操作",width:150,template:function(t){return common.format($("#columnBtns").html(),rootPath+"/"+t.relativePath)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}return{initUploadOptions:l,delSysFile:s,downloadFile:n,queryPluginfile:d,findByMianId:r,findByBusinessId:a,mainTypeValue:o,previewFile:i}}angular.module("app").factory("sysfileSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t){var e=this;e.showHistogram=!0,e.gotoHistogram=function(){e.showHistogram=!0,e.showLineChart=!1,e.showPie=!1,e.initHistogram()},e.gotoLineChart=function(){e.showHistogram=!1,e.showPie=!1,e.showLineChart=!0,e.initLineChart()},e.gotoPie=function(){e.showHistogram=!1,e.showLineChart=!1,e.showPie=!0,e.initPie()},e.initHistogram=function(){var t=echarts.init(document.getElementById("histogram")),e={title:{text:"项目统计",subtext:"按评审阶段进行项目统计",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#283b56"}}},legend:{orient:"vertical",left:"left",data:["2014年","2015年","2016年","2017年"]},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},grid:{left:"10%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",name:"年份",data:["可行性研究报告","项目概算","项目建议书","资金申请报告"],axisTick:{alignWithLabel:!0},axisLabel:{interval:0,rotate:0,margin:2,textStyle:{fontWeight:"bolder",color:"#295645"}}},yAxis:{type:"value",name:"案例",interval:5},series:[{name:"2014年",type:"bar",data:[20,15,12,10],barWidth:30,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return t.value}}}}},{name:"2015年",type:"bar",data:[50,20,15,30],barWidth:30,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return t.value}}}}},{name:"2016年",type:"bar",data:[40,20,20,20],barWidth:30,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return t.value}}}}},{name:"2017年",type:"bar",data:[42,18,21,16],barWidth:30,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return t.value}}}}}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.5)"}}};t.setOption(e)},e.initPie=function(){var t=echarts.init(document.getElementById("pie")),e={title:{text:"2017年度项目统计情况",subtext:"按评审计划统计占比例",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/> {b} : {c} ({d}%)"},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"left",data:["可行性研究报告","项目概算","项目建议书","资金申请报告"]},series:[{type:"pie",radius:"65%",center:["50%","50%"],selectMode:"single",data:[{value:"20",name:"可行性研究报告",label:{normal:{formatter:" {b} : {c} ({d}%)"}}},{value:"18",name:"项目概算",label:{normal:{formatter:" {b} : {c} ({d}%)"}}},{value:"6",name:"项目建议书",label:{normal:{formatter:" {b} : {c} ({d}%)"}}},{value:"12",name:"资金申请报告",label:{normal:{formatter:"{b} : {c} ({d}%)"}}}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.5)"}}}]};t.setOption(e)},e.initLineChart=function(){var t=echarts.init(document.getElementById("lineChart")),e={title:{text:"2014-2017年各评审阶段项目变化情况",subtext:"",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/> {b} : {c}"},grid:{left:"15%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"left",data:["可行性研究报告","项目概算","项目建议书","资金申请报告"]},xAxis:{type:"category",name:"年份",data:["2014年","2015年","2016年","2017年"]},yAxis:{type:"value",name:"案例"},series:[{name:"可行性研究报告",type:"line",data:[20,50,40,42]},{name:"项目概算",type:"line",data:[15,20,20,18]},{name:"项目建议书",type:"line",data:[12,15,20,21]},{name:"资金申请报告",type:"line",data:[10,30,20,16]}]};t.setOption(e)},function(){e.initHistogram()}()}angular.module("app").controller("statisticalCtrl",t),t.$inject=["$location"]}(),function(){"use strict";function t(t,e){var i=this;i.title="定时器配置",function(){e.grid(i)}(),i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteQuartz(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.addQuartz=function(){i.quartz={},$("#quartz_edit_div").kendoWindow({
width:"600px",height:"400px",title:"定时器编辑",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},i.edit=function(t){i.id=t,$("#quartz_edit_div").kendoWindow({width:"600px",height:"400px",title:"定时器修改",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),e.getQuartzById(i)},i.colseQuartz=function(){window.parent.$("#quartz_edit_div").data("kendoWindow").close()},i.saveQuartz=function(){e.saveQuartz(i)},i.execute=function(t){e.quartzExecute(i,t)},i.stop=function(t){e.quartzStop(i,t)}}angular.module("app").controller("quartzCtrl",t),t.$inject=["$location","quartzSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加定时器配置",o.isuserExist=!1,o.id=i.params.id,o.create=function(){e.createQuartz(o)},o.update=function(){e.updateQuartz(o)}}angular.module("app").controller("quartzEditCtrl",t),t.$inject=["$location","quartzSvc","$state"]}(),function(){"use strict";function t(t){function e(e,i){var o={method:"put",url:l+"/quartzExecute",params:{quartzId:i}},n=function(t){var i="操作成功";"defeated"==t.data.substring(1,t.data.length-1)&&(i="该定时器未存在！"),common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:i,fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function i(e,i){var o={method:"put",url:l+"/quartzStop",params:{quartzId:i}},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.quartz.id=e.id;var i={method:"put",url:l+"/updateQuartz",data:e.quartz},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#quartz_edit_div").data("kendoWindow").close(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){e.isSubmit=!0;var o={method:"delete",url:l,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function a(e){if(common.initJqValidation($("#quartz_form")),$("#quartz_form").valid()){e.isSubmit=!0;var i={method:"post",url:rootPath+"/quartz",data:e.quartz},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),window.parent.$("#quartz_edit_div").data("kendoWindow").close(),e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function r(e){var i={method:"get",url:rootPath+"/quartz/html/findById",params:{id:e.id}},o=function(t){e.quartz=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/quartz/findByOData"),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"quartzName",title:"定时器名称",width:100,filterable:!0},{field:"className",title:"类名",width:100,filterable:!0},{field:"cronExpression",title:"表达式",width:100,filterable:!0},{field:"",title:"执行状态",width:80,filterable:!0,template:function(t){return t.curState?"9"==t.curState?"在执行":"0"==t.curState?"未执行":void 0:""}},{field:"",title:"是否可用",width:80,filterable:!0,template:function(t){return t.isEnable?"0"==t.isEnable?"停用":"9"==t.isEnable?"在用":void 0:""}},{field:"descInfo",title:"描述",width:180},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')","vm.edit('"+t.id+"')",t.isEnable,"vm.execute('"+t.id+"')",t.curState,"vm.stop('"+t.id+"')")}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var l=rootPath+"/quartz";return{grid:s,getQuartzById:r,saveQuartz:a,deleteQuartz:n,updateQuartz:o,quartzExecute:e,quartzStop:i}}angular.module("app").factory("quartzSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="新增课题研究",a.model={},a.model.fgwlx=0,a.model.sendFgw=0,n.params.id&&(a.model.id=n.params.id),a.initFileUpload=function(){a.model.id||e.$watch("vm.model.id",function(t,e){t&&t!=e&&!a.initUploadOptionSuccess&&a.initFileUpload()}),a.sysFile={businessId:a.model.id,mainId:a.model.id,mainType:i.mainTypeValue().TOPIC,sysfileType:i.mainTypeValue().TOPIC_PLAN,sysBusiType:i.mainTypeValue().TOPIC_PLAN,showBusiType:!1},i.initUploadOptions({inputId:"sysfileinput",vm:a})},function(){a.model.id&&o.initDetail(a.model.id,function(t){a.model=t}),o.findOrgUser(function(t){a.principalUsers=t}),a.initFileUpload()}(),a.checkPrincipal=function(){var t=$("#mainPrinUserId").val();t&&$('#principalUser_ul input[selectType="assistUser"]').each(function(){$(this).attr("value")==t?($(this).removeAttr("checked"),$(this).attr("disabled","disabled")):$(this).removeAttr("disabled")})},a.create=function(){if(common.initJqValidation($("#topicform")),$("#topicform").valid()){var e=[];$('#principalUser_ul input[selectType="assistUser"]:checked').each(function(){e.push($(this).attr("value"))}),a.model.prinUserIds=e.join(","),o.createTopic(a.model,a.isCommit,function(e){e.flag||"ok"==e.reCode?(a.model=e.reObj,t.alert("操作成功！")):t.alert(e.reMsg)})}else t.alert("页面未填报完整或者为正确，请检查！")},a.startFlow=function(){common.initJqValidation($("#topicform")),$("#topicform").valid()?t.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){var e=[];$('#principalUser_ul input[selectType="assistUser"]:checked').each(function(){e.push($(this).attr("value"))}),a.model.prinUserIds=e.join(","),o.startFlow(a.model,a.isCommit,function(e){e.flag||"ok"==e.reCode?t.alert("保存成功！",function(){n.go("myTopic")}):t.alert(e.reMsg)})}}):t.alert("页面未填报完整或者为正确，请检查！")}}angular.module("app").controller("topicAddCtrl",t),t.$inject=["bsWin","$scope","sysfileSvc","topicSvc","$state"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="课题研究存档表",a.filing={},a.zlList=[],function(){o.findByTopicId(n.params.topicId,function(t){a.filing=t,a.filing.topicId=n.params.topicId})}(),a.saveFiling=function(){o.save(a.filing,function(e){e.flag||"ok"==e.reCode?(a.filing=e.reObj,a.filing.topicId=n.params.topicId,t.alert("保存成功！")):t.error(e.reMsg)})},a.addZL=function(){a.filing.registerFileDto||(a.filing.registerFileDto=[]);var t={};t.id=common.uuid(),a.filing.registerFileDto.push(t)},a.delZL=function(){var e=$("#filingform input[tit='dynamicCheckbox']:checked");if(e.length<1)t.alert("请选择要删除的意见！");else{for(var o=[],n=0;n<e.length;n++)e[n].value&&(alert(e[n].value),o.push(e[n].value)),$.each(a.filing.registerFileDto,function(t,i){i.id==e[n].value&&a.filing.registerFileDto.splice(t,1)});o.length>0&&i.deleteByIds(o.join(","),function(e){t.alert("删除成功！")})}},a.initInputValue=function(t,e){return t.target.checked&&!e?1:e}}angular.module("app").controller("filingEditCtrl",t),t.$inject=["bsWin","$scope","addRegisterFileSvc","filingSvc","$state"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/filing/initByTopicId",params:{topicId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/filing",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{findByTopicId:i,save:o}}angular.module("app").factory("filingSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="我的课题列表",function(){o.initMyGird(n)}(),n.searchForm=function(){n.myTopicOptions.dataSource.read()},n.formReset=function(){n.searchModel={}}}angular.module("app").controller("myTopicCtrl",t),t.$inject=["bsWin","$scope","sysfileSvc","topicSvc"]}(),function(){"use strict";function t(t,e,i){function o(e){var i={method:"get",url:rootPath+"/user/findChargeUsers"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function n(e,i,o){i=!0;var n={method:"post",url:rootPath+"/topicInfo",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/topicInfo/startFlow",data:e},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"post",url:rootPath+"/topicInfo/findById",params:{id:e.businessKey}},o=function(t){e.model={},e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/topicInfo/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"topicName",title:"课题名称",width:"25%",filterable:!1},{field:"cooperator",title:"合作单位",width:"20%",filterable:!1},{field:"createdDate",title:"创建日期",width:"15%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:180,template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.id,e)}}];t.myTopicOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function l(e,i){var o={method:"post",url:rootPath+"/topicInfo/findDetailById",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n,onError:function(){}})}function d(t,e,o){switch(t.curNode.activitiId){case flowcommon.getTopicFlowNode().TOPIC_BZSH_JH:case flowcommon.getTopicFlowNode().TOPIC_FGLD_JH:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_JH:case flowcommon.getTopicFlowNode().TOPIC_BZSH_FA:case flowcommon.getTopicFlowNode().TOPIC_FGLD_FA:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_FA:case flowcommon.getTopicFlowNode().TOPIC_BZSH_BG:case flowcommon.getTopicFlowNode().TOPIC_FGLD_BG:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_BG:case flowcommon.getTopicFlowNode().TOPIC_BZSH_JT:case flowcommon.getTopicFlowNode().TOPIC_FGLD_JT:case flowcommon.getTopicFlowNode().TOPIC_ZRSH_JT:case flowcommon.getTopicFlowNode().TOPIC_BZSH_GD:case flowcommon.getTopicFlowNode().TOPIC_GDY_QR:e.buttBack=!0;break;case flowcommon.getTopicFlowNode().TOPIC_CGJD:case flowcommon.getTopicFlowNode().TOPIC_KTBG:case flowcommon.getTopicFlowNode().TOPIC_KTJT:t.businessMap&&(e.isMainPrinUser=t.businessMap.MAIN_USER);case flowcommon.getTopicFlowNode().TOPIC_LXDW:case flowcommon.getTopicFlowNode().TOPIC_QDHT:case flowcommon.getTopicFlowNode().TOPIC_YJSS:case flowcommon.getTopicFlowNode().TOPIC_NBCS:case flowcommon.getTopicFlowNode().TOPIC_YFZL:e.showUploadBT=!0,o.initFileUpload(i.mainTypeValue().TOPIC,i.mainTypeValue().TOPIC,i.mainTypeValue().TOPIC);break;case flowcommon.getTopicFlowNode().TOPIC_JHTC:e.businessTr=!0,e.showUploadBT=!0;break;case flowcommon.getTopicFlowNode().TOPIC_GZFA:e.businessTr=!0,e.showUploadBT=!0,t.businessMap&&(e.isMainPrinUser=t.businessMap.MAIN_USER);break;case flowcommon.getTopicFlowNode().TOPIC_ZLGD:e.businessTr=!0,e.showUploadBT=!0}}return{findOrgUser:o,createTopic:n,startFlow:a,initFlowDeal:r,initFlowNode:d,initMyGird:s,initDetail:l}}angular.module("app").factory("topicSvc",t),t.$inject=["$http","bsWin","sysfileSvc"]}(),function(){"use strict";function t(t,e,i,o,n){var a=this;a.title="课题研究成果鉴定会工作方案编辑",a.workplan={},n.params.topicId&&(a.workplan.topicId=n.params.topicId),function(){a.workplan.topicId&&o.findByTopicId(a.workplan.topicId,function(t){a.workplan=t,a.workplan.topicId=n.params.topicId})}(),a.saveWorkPlan=function(){o.save(a.workplan,function(e){e.flag||"ok"==e.reCode?(a.workplan=e.reObj,t.alert("保存成功！")):t.error(e.reMsg)})},a.bookMeeting=function(){a.workplan.id?n.go("room",{businessId:a.workplan.id,businessType:"TOPIC_WP"}):t.alert("请先保存当前信息！")},a.selectExpert=function(){a.workplan.id?n.go("expertReviewEdit",{businessId:n.params.topicId,minBusinessId:a.workplan.id,businessType:"TOPIC"}):t.alert("请先保存当前信息，再继续操作！")},a.updateBookRoom=function(t){a.meetingList||e.findAllMeeting(function(t){a.meetingList=t}),$.each(a.workplan.roomDtoList,function(e,i){t==i.id&&(a.roombook=i)}),$("#roomBookDetailWindow").kendoWindow({width:"50%",height:"620px",title:"会议预定信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},a.saveRoom=function(){i.saveRoom(a.roombook,function(e){e.flag||"ok"==e.reCode?($.each(a.workplan.roomDtoList,function(t,i){a.roombook.id==i.id&&(i=e.reObj)}),t.success("操作成功！",function(){a.onRoomClose()})):t.error(e.reMsg)})},a.onRoomClose=function(){window.parent.$("#roomBookDetailWindow").data("kendoWindow").close()}}angular.module("app").controller("workPlanEditCtrl",t),t.$inject=["bsWin","meetingSvc","roomSvc","workPlanSvc","$state"]}(),function(){"use strict";function t(t,e){function i(e,i){var o={method:"post",url:rootPath+"/workPlan/initByTopicId",params:{topicId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function o(e,i){var o={method:"post",url:rootPath+"/workPlan",data:e},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}return{findByTopicId:i,save:o}}angular.module("app").factory("workPlanSvc",t),t.$inject=["$http","bsWin"]}(),function(){"use strict";function t(t,e){var i=this;i.title="工作日列表",function(){e.grid(i)}(),i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteWorkday(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryWorkday=function(){e.queryWorkday(i)},i.ResetWorkday=function(){e.clearValue(i)}}angular.module("app").controller("workdayCtrl",t),t.$inject=["$location","workdaySvc"]}(),function(){"use strict";function t(t,e){function i(t){var e=$("#workdayForm").find("input,select");$.each(e,function(t,e){e.value=""}),t.gridOptions.dataSource.read()}function o(e){var i={method:"get",url:d+"/getWorkdayById",params:{id:e.id}},o=function(t){e.workday=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function n(t){t.gridOptions.dataSource.read()}function a(e){var i={method:"post",url:d+"/createWorkday",data:e.workday},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"put",url:d,data:e.workday},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide"),$(".modal-backdrop").remove(),location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(e,i){var o={method:"delete",url:d,data:i},n=function(t){e.gridOptions.dataSource.read()};common.http({vm:e,$http:t,httpOptions:o,success:n})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(d+"/findByOdataObj",$("#workdayForm")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"dates",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"dates",title:"时间",width:200,format:"{0:yyyy-MM-dd}",filterable:!1},{field:"",title:"状态",width:100,filterable:!1,template:function(t){return t.status?"1"==t.status?"调休":"2"==t.status?"加班":void 0:""}},{field:"remark",title:"备注",width:140,filterable:!1},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,columns:o,dataBound:i,resizable:!0}}var d=rootPath+"/workday",c="#/workday";return{grid:l,createWorkday:a,getWorkdayById:o,updateWorkday:r,deleteWorkday:s,queryWorkday:n,clearValue:i}}angular.module("app").factory("workdaySvc",t),t.$inject=["$http","$state"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加工作日",o.id=i.params.id,o.workday={},o.workday.status="1",o.id&&(o.isUpdate=!0,o.title="更新工作日"),function(){o.isUpdate&&e.getWorkdayById(o)}(),o.create=function(){e.createWorkday(o)},o.update=function(){e.updateWorkday(o)}}angular.module("app").controller("workdayEditCtrl",t),t.$inject=["$location","workdaySvc","$state"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.work={},n.title="项目基本信息",n.work.signId=i.params.signid,function(){e.initPage(n)}(),n.create=function(){e.createWP(n,!1)}}angular.module("app").controller("workprogramBaseEditCtrl",t),t.$inject=["$location","workprogramSvc","$state","$http"]}(),function(){"use strict";function t(t,e,i,o,n,a,r){var s=this;s.work={},s.model={},s.title="评审方案编辑",s.startDateTime=new Date("2006/6/1 08:00"),s.endDateTime=new Date("2030/6/1 21:00"),s.work.signId=e.params.signid,s.work.id="",s.sign={},s.unSeledWork={},s.searchSign={},s.businessFlag={isSelfReview:!1,isSingleReview:!0,isMainWorkProj:!1,isLoadMeetRoom:!1,isReveiwAWP:!1},function(){t.initPage(s),$("#wpTab li").click(function(t){var e=$("a",this);t.preventDefault(),e.tab("show");var i=e.attr("for-div");$(".tab-pane").removeClass("active").removeClass("in"),$("#"+i).addClass("active").addClass("in").show(500)})}(),s.initFileUpload=function(){s.work.id||n.$watch("vm.work.id",function(t,e){t&&t!=e&&!s.initUploadOptionSuccess&&s.initFileUpload()}),s.sysFile={businessId:s.work.id,mainId:s.work.signId,mainType:o.mainTypeValue().SIGN,sysfileType:o.mainTypeValue().WORKPROGRAM,sysBusiType:o.mainTypeValue().WORKPROGRAM},o.initUploadOptions({inputId:"sysfileinput",vm:s})},s.reviewTypeChange=function(){"自评"==s.work.reviewType?"合并评审"==s.work.isSigle&&(s.work.isSigle="单个评审",common.alert({vm:s,msg:"自评方案不能进行合并评审！",colseDialog:!0})):s.businessFlag.isMainWorkProj&&!s.businessFlag.isSingleReview&&"单个评审"==s.work.isSigle&&i.confirm({title:"询问提示",message:"该项目已经关联其他合并评审会关联，您确定要改为单个评审吗？",onOk:function(){$(".confirmDialog").modal("hide"),s.work.isMainProject="0",t.deleteAllMerge(e.params.signid,function(t){t.flag||"ok"==t.reCode?i.alert("操作成功！"):i.error("操作失败！")})},onCancel:function(){s.work.isSigle="合并评审",$(".confirmDialog").modal("hide")}})},s.onWorkClose=function(){window.parent.$(".workPro").data("kendoWindow").close()},s.formReset=function(){s.searchSign={}},s.filterSign=function(t){var e=!0;if(s.searchSign.projectname&&-1==t.projectname.indexOf(s.searchSign.projectname)&&(e=!1),e&&s.searchSign.reviewstage&&-1==t.reviewstage.indexOf(s.searchSign.reviewstage)&&(e=!1),e)return t},s.initMergeWP=function(){s.work.id?(t.initMergeInfo(s,s.work.signId),$("#mergeSign").kendoWindow({width:"75%",height:"700px",title:"合并评审",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()):i.alert("请先保存工作方案！")},s.chooseSign=function(){var e=$("input[name='mergeSign']:checked");if(0==e.length)i.alert("请选择要合并评审的项目！");else{var o=[];$.each(e,function(t,e){o.push(e.value)}),t.chooseSign(s.work.signId,o.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(s,s.work.signId),i.alert(e.reMsg)})}},s.cancelSign=function(){var e=$("input[name='cancelMergeSignid']:checked");if(0==e.length)i.alert("请选择要取消合并评审的项目！");else{var o=[];$.each(e,function(t,e){o.push(e.value)})}t.cancelMergeSign(s.work.signId,o.join(","),function(e){(e.flag||"ok"==e.reCode)&&t.initMergeInfo(s,s.work.signId),i.alert(e.reMsg)})},s.addTimeStage=function(){s.work.id?e.go("room",{businessId:s.work.id,businessType:"SIGN_WP"}):i.alert("请先保存！")},s.updateBookRoom=function(t){s.meetingList||a.findAllMeeting(function(t){s.meetingList=t}),$.each(s.work.roomBookingDtos,function(e,i){t==i.id&&(s.roombook=i)}),$("#roomBookDetailWindow").kendoWindow({width:"50%",height:"620px",title:"会议预定信息",visible:!1,modal:!0,closable:!0,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open()},s.saveRoom=function(){r.saveRoom(s.roombook,function(t){t.flag||"ok"==t.reCode?($.each(s.work.roomBookingDtos,function(e,i){s.roombook.id==i.id&&(i=t.reObj)}),i.success("操作成功！",function(){s.onRoomClose()})):i.error(t.reMsg)})},s.onRoomClose=function(){window.parent.$("#roomBookDetailWindow").data("kendoWindow").close()},s.findUsersByOrgId=function(e){t.findUsersByOrgId(s,e)},s.create=function(){common.initJqValidation($("#work_program_form")),$("#work_program_form").valid()?t.createWP(s.work,!1,s.iscommit,function(t){t.flag||"ok"==t.reCode?(s.work.id=t.reObj.id,"自评"==t.reObj.reviewType&&(s.businessFlag.isSelfReview=!0),"合并评审"==t.reObj.isSigle&&(s.businessFlag.isSingleReview=!1),"9"==t.reObj.isMainProject&&(s.businessFlag.isMainWorkProj=!0),i.success("操作成功！")):i.error(t.reMsg)}):i.alert("表格填写不正确，请检查相应的必填项信息！")},s.selectExpert=function(){s.work.id?e.go("expertReviewEdit",{businessId:s.work.signId,minBusinessId:s.work.id,businessType:"SIGN"}):i.alert("请先保存当前信息，再继续操作！")}}angular.module("app").controller("workprogramEditCtrl",t),t.$inject=["workprogramSvc","$state","bsWin","sysfileSvc","$scope","meetingSvc","roomSvc"]}(),function(){"use strict";function t(t,e,i){function o(e,i){var o={method:"post",url:rootPath+"/signView/getMergeSignBySignId",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function n(e,i){var o={method:"post",url:rootPath+"/signView/unMergeWPSign",params:{signId:e}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(t,e){n(e,function(e){t.unMergeSign=[],t.unMergeSign=e}),o(e,function(e){t.mergeSign=[],t.mergeSign=e})}function r(e,i,o){var n={method:"post",url:rootPath+"/signView/cancelMergeSign",params:{signId:e,cancelIds:i,mergeType:"1"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function s(e,i,o){var n={method:"post",url:rootPath+"/signView/mergeSign",params:{signId:e,mergeIds:i,mergeType:"1"}},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a})}function l(e,i){var o={method:"post",url:rootPath+"/signView/deleteAllMerge",params:{signId:e,mergeType:"1"}},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function d(e){var i={method:"get",url:rootPath+"/room/meeting"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function c(e){var i={method:"get",url:common.format(h+"/findCcompanys")},o=function(t){e.companys={},e.companys=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function m(e,i){var o={};"main"==i&&(o.orgId=e.work.reviewDept);var n={method:"get",url:rootPath+"/user/findUsersByOrgId",params:o},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){"main"==i&&(e.mainUserList={},e.mainUserList=t.data)}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}function u(o){var n={method:"post",url:rootPath+"/workprogram/html/initWorkProgram",params:{signId:o.work.signId}},a=function(t){null!=t.data&&""!=t.data&&(o.work=t.data.eidtWP,o.work.expertDtoList&&o.work.expertDtoList.length>0&&(!o.work.expertCost||o.work.expertCost<1e3*o.work.expertDtoList.length)&&(o.work.expertCost=1e3*o.work.expertDtoList.length),o.model.workProgramDtoList={},t.data.WPList&&t.data.WPList.length>0&&(o.model.workProgramDtoList=t.data.WPList),"1"==o.work.branchId&&c(o),o.work.signId=e.params.signid,o.work.projectType&&(o.work.projectTypeDicts=i.topSelectChange(o.work.projectType,i.DICT.PROJECTTYPE.dicts)),"自评"==o.work.reviewType&&(o.businessFlag.isSelfReview=!0),"合并评审"==o.work.isSigle&&(o.businessFlag.isSingleReview=!1),"9"==o.work.isMainProject&&(o.businessFlag.isMainWorkProj=!0),"合并评审"!=o.work.isSigle||"0"!=o.work.isMainProject&&0!=o.work.isMainProject||(o.businessFlag.isReveiwAWP=!0),o.initFileUpload())};common.http({vm:o,$http:t,httpOptions:n,success:a})}function p(e,i,o,n){o=!0,$("#studyBeginTime").val()&&(e.studyBeginTimeStr=$("#studyBeginTime").val()),$("#studyEndTime").val()&&(e.studyEndTimeStr=$("#studyEndTime").val()),$("#studyAllDay").val()&&$("#studyBeginTime").val()&&(e.studyBeginTime=$("#studyAllDay").val()+" "+$("#studyBeginTime").val()+":00"),$("#studyAllDay").val()&&$("#studyEndTime").val()&&(e.studyEndTime=$("#studyAllDay").val()+" "+$("#studyEndTime").val()+":00");var a={method:"post",url:rootPath+"/workprogram/addWork",data:e,params:{isNeedWorkProgram:i}},r=function(t){void 0!=n&&"function"==typeof n&&n(t.data)};common.http({$http:t,httpOptions:a,success:r,onError:function(t){o=!1}})}function f(e,i){var o={method:"delete",url:rootPath+"/room",params:{id:e}},n=function(t){void 0!=i&&"function"==typeof i&&i()};common.http({$http:t,httpOptions:o,success:n})}var h=rootPath+"/company";return{initPage:u,createWP:p,findCompanys:c,findUsersByOrgId:m,deleteBookRoom:f,findAllMeeting:d,initMergeInfo:a,getMergeSignBySignId:o,unMergeWPSign:n,chooseSign:s,cancelMergeSign:r,deleteAllMerge:l}}angular.module("app").factory("workprogramSvc",t),t.$inject=["$http","$state","$rootScope"]}(),function(){"use strict";function t(t,e){var i=this;i.title="用户列表",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteUser(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},i.queryUser=function(){e.queryUser(i)},function(){e.grid(i)}()}angular.module("app").controller("userCtrl",t),t.$inject=["$location","userSvc"]}(),function(){"use strict";function t(t,e,i,o){var n=this;n.title="新增用户",n.isuserExist=!1,n.id=i.params.id,n.id&&(n.isUpdate=!0,n.title="编辑用户"),function(){n.isUpdate?e.getUserById(n):e.initZtreeClient(n),e.getOrg(function(t){n.org={},n.org=t})}(),n.create=function(){if(common.initJqValidation(),$("form").valid()){var t=e.getZtreeChecked(),i=$linq(t).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();n.model.roleDtoList=i,e.createUser(n.model,n.isSubmit,function(t){t.flag||"ok"==t.reCode?(n.model.id||(n.model.id=t.idCode),o.success("操作成功！")):o.error(t.reMsg)})}},n.update=function(){e.updateUser(n)}}angular.module("app").controller("userEditCtrl",t),t.$inject=["$location","userSvc","$state","bsWin"]}();!function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i=d(),o=$linq(i).where(function(t){return 0==t.isParent}).select(function(t){return{id:t.id,roleName:t.name}}).toArray();e.model.roleDtoList=o;var n={method:"put",url:m,data:e.model},a=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:n,success:a})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:m,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e,i,o){i=!0;var n={method:"post",url:rootPath+"/user",data:e},a=function(t){void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function n(e){var i={method:"post",url:rootPath+"/org/listAll"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function a(e){var i={method:"post",url:u=rootPath+"/role/findAllRoles"},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){var i={check:{chkboxType:{Y:"ps",N:"ps"},enable:!0}},o=$linq(t.data).select(function(t){return{id:t.id,name:t.roleName}}).toArray(),n={id:"",name:"角色集合",children:o};$.fn.zTree.init($("#zTree"),i,n),e.isUpdate&&c(e)}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}function r(e){var i={method:"post",url:rootPath+"/user/findUserById",params:{userId:e.id}},o=function(t){e.model=t.data,e.isUpdate&&a(e)};common.http({vm:e,$http:t,httpOptions:i,success:o})}function s(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(m+"/fingByOData?$orderby=userSort",$("#usersform")),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"},modifiedDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"loginName",title:"登录名",width:100,filterable:!1},{field:"displayName",title:"显示名",width:100,filterable:!1},{field:"orgDto.name",title:"所属部门",width:100,filterable:!1},{field:"userIP",title:"登录IP",width:160,filterable:!1},{field:"lastLogin",title:"最后登录时间",width:160,filterable:!1},{field:"",title:"所属角色",width:160,filterable:!1,template:function(t){if(t.roleDtoList){
for(var e="",i=0,o=t.roleDtoList.length;i<o;i++)e+=0==i?t.roleDtoList[i].roleName:", "+t.roleDtoList[i].roleName;return e}return" "}},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}function l(t){t.gridOptions.dataSource.read()}function d(){return $.fn.zTree.getZTreeObj("zTree").getCheckedNodes(!0)}function c(t){for(var e=$.fn.zTree.getZTreeObj("zTree"),i=$linq(t.model.roleDtoList).select(function(t){return t.roleName}).toArray(),o=e.getNodesByParam("level",1,null),n=$linq(o).where(function(t){return $linq(i).contains(t.name)}).toArray(),a=0,r=n.length;a<r;a++)e.checkNode(n[a],!0,!0)}var m=rootPath+"/user",u=rootPath+"/role/fingByOData";rootPath;return{grid:s,getUserById:r,initZtreeClient:a,createUser:o,deleteUser:i,updateUser:e,getOrg:n,queryUser:l,getZtreeChecked:d}}angular.module("app").factory("userSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="固定资产申购流程",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteAssertStorageBusiness(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}(),i.searchForm=function(){i.gridOptions.dataSource.read()},i.formReset=function(){i.searchModel={}}}angular.module("app").controller("assertStorageBusinessCtrl",t),t.$inject=["$location","assertStorageBusinessSvc"]}(),function(){"use strict";function t(t,e,i,o){function n(t){if(r.conditions.length>0){return r.conditions.forEach(function(t,e){t.goodsName=$("#goodsName"+t.sort).val(),t.specifications=$("#specifications"+t.sort).val(),t.models=$("#models"+t.sort).val(),t.orgCompany=$("#orgCompany"+t.sort).val(),t.evaluate=$("#evaluate"+t.sort).val(),t.goodsNumber=$("#goodsNumber"+t.sort).val(),t.applyDept=r.model.applyDept,t.operator=r.model.operator,t.businessId=$("#businessId").val()}),!0}return!1}function a(t){return!!(/^(\+|-)?\d+$/.test(t)&&t>0)}var r=this;r.model={},r.conMaxIndex=0,r.conditions=new Array,r.title="添加固定资产申购流程",r.isuserExist=!1,r.businessId=i.params.businessId,r.showFlag={addBooksDeatail:!0,modBooksDetail:!0,bookBuyApplyTr:!1,bookBuyBzTr:!0,bookBuyFgzrTr:!0,bookBuyZrTr:!0,bookBuyYsrk:!0},r.businessId&&(r.isUpdate=!0,r.showFlag.modBooksDetail=!0,r.showFlag.addBooksDeatail=!1,r.title="更新图书采购申请业务信息",$("#businessId").val(r.businessId)),r.create=function(){e.createAssertStorageBusiness(r)},r.update=function(){e.updateAssertStorageBusiness(r)},r.addCondition=function(){r.condition={},r.showFlag.addBooksDeatail?r.condition.sort=r.conMaxIndex+1:(r.conMaxIndex=r.conditions.length,r.condition.sort=r.conditions.length+1),r.conditions.push(r.condition),r.conMaxIndex++},r.removeCondition=function(){var t=$("#conditionTable input[name='epConditionSort']:checked");t.length>0?o.confirm({title:"询问提示",message:"删除数据不可恢复，确定删除么？",onOk:function(){$(".confirmDialog").modal("hide");for(var i=[],n=0;n<t.length;n++)$.each(r.conditions,function(e,o){t[n].value==o.sort&&(o.id?i.push(o.id):r.conditions.splice(e,1))});i.length>0?e.deleteSelConditions(i.join(","),r.isCommit,function(t){t.flag||"ok"==t.reCode?(o.success("操作成功！"),$.each(i,function(t,e){$.each(r.conditions,function(t,i){e==i.sort&&r.conditions.splice(t,1)})})):o.error(t.reMsg)}):o.success("操作成功！")}}):o.alert("请选择要删除的抽取条件！")},r.saveCondition=function(){n(!1)?e.saveGoodsDetailBusinessDetail(r.conditions,function(t){t.flag||"ok"==t.reCode?($("#businessId").val(t.reObj.businessId),o.success("保存成功！")):o.error(t.reMsg)}):o.error("请添加后再保存")},r.startFlow=function(){o.confirm({title:"询问提示",message:"发起流程后，当前页面数据将不能再修改！确认发起流程么？",onOk:function(){n(!1)?e.startFlow(r.conditions,r.isCommit,function(t){t.flag||"ok"==t.reCode?o.alert("保存成功！",function(){i.go("myAssertStorageBusiness")}):o.alert(t.reMsg)}):o.error("请添加图书信息后再发起流程！")}})},r.checkBookNum=function(t){var e="bookNumber"+t;if(!a($("#"+e).val()))return void $("span[data-valmsg-for='"+e+"']").html("图书数量只能输入正整数！");$("span[data-valmsg-for='"+e+"']").html("")},r.checkPrice=function(t){var e=/^(-)?(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,4})?$/,i="booksPrice"+t,o="bookNumber"+t;if(!e.test($("#"+i).val()))return $("#"+i).val(""),void $("span[data-valmsg-for='"+i+"']").html("价格只能输入数字！");$("span[data-valmsg-for='"+i+"']").html("");var n=$("#"+i).val(),a=$("#"+o).val();$("#total"+t).val(parseFloat(n)*a)},function(){r.isUpdate&&e.getAssertStorageBusinessById(r)}()}angular.module("app").controller("assertStorageBusinessEditCtrl",t),t.$inject=["$location","assertStorageBusinessSvc","$state","bsWin"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:d,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:d,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=c}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e,i){console.log(e);var o={method:"post",url:rootPath+"/assertStorageBusiness/saveGoodsDetailList",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},n=function(t){void 0!=i&&"function"==typeof i&&i(t.data)};common.http({$http:t,httpOptions:o,success:n})}function a(e,i,o){i=!0;var n={method:"post",url:rootPath+"/assertStorageBusiness/startFlow",headers:{contentType:"application/json;charset=utf-8"},traditional:!0,dataType:"json",data:angular.toJson(e)},a=function(t){i=!1,void 0!=o&&"function"==typeof o&&o(t.data)};common.http({$http:t,httpOptions:n,success:a,onError:function(){i=!1}})}function r(e){var i={method:"get",url:rootPath+"/assertStorageBusiness/html/findById",params:{id:e.businessKey}},o=function(t){e.model=t.data};common.http({$http:t,httpOptions:i,success:o,onError:function(){}})}function s(e){var i={method:"get",url:rootPath+"/assertStorageBusiness/html/findById",params:{id:e.businessId}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function l(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(rootPath+"/assertStorageBusiness/findByOData",$("#myTopicForm"),{filter:"createdBy eq ${CURRENT_USER.id}"}),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=function(){var t=this.items(),e=this.pager.page()-1,i=this.pager.pageSize();$(t).each(function(){var t=$(this).index()+1+e*i,o=$(this).find(".row-number");$(o).html(t)})},o=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"rowNumber",title:"序号",width:50,filterable:!1,template:"<span class='row-number'></span>"},{field:"businessName",title:"业务流程名称",width:"20%",filterable:!1},{field:"createdDate",title:"创建日期",width:"15%",filterable:!1,format:"{0:yyyy/MM/dd HH:mm:ss}"},{field:"",title:"已发起流程",width:"15%",filterable:!1,template:function(t){return t.processInstanceId?"是":"否"}},{field:"",title:"操作",width:140,template:function(t){var e=!!t.processInstanceId;return common.format($("#columnBtns").html(),t.businessId,e)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:o,dataBound:i,resizable:!0}}var d=rootPath+"/assertStorageBusiness",c="#/assertStorageBusinessList";return{grid:l,getAssertStorageBusinessById:s,createAssertStorageBusiness:o,deleteAssertStorageBusiness:i,updateAssertStorageBusiness:e,saveGoodsDetailBusinessDetail:n,startFlow:a,initFlowDeal:r}}angular.module("app").factory("assertStorageBusinessSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e){var i=this;i.title="物品明细",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteGoodsDetail(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("goodsDetailCtrl",t),t.$inject=["$location","goodsDetailSvc"]}(),function(){"use strict";function t(t,e,i){var o=this;o.title="添加物品明细",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新物品明细"),o.create=function(){e.createGoodsDetail(o)},o.update=function(){e.updateGoodsDetail(o)},function(){o.isUpdate&&e.getGoodsDetailById(o)}()}angular.module("app").controller("goodsDetailEditCtrl",t),t.$inject=["$location","goodsDetailSvc","$state"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/goodsDetail/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"get",url:rootPath+"/bookBuyBusiness/html/findById"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({vm:vm,$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"goodsCode",title:"goodsCode",width:100,filterable:!0},{field:"goodsName",title:"goodsName",width:100,filterable:!0},{field:"specifications",title:"specifications",width:100,filterable:!0},{field:"models",title:"models",width:100,filterable:!0},{field:"goodsPrice",title:"goodsPrice",width:100,filterable:!0},{field:"evaluate",title:"evaluate",width:100,filterable:!0},{field:"goodsNumber",title:"goodsNumber",width:100,filterable:!0},{field:"assertStorageBusiness",title:"assertStorageBusiness",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/goodsDetail",l="#/goodsDetailList";return{grid:r,getGoodsDetailById:n,createGoodsDetail:o,deleteGoodsDetail:i,updateGoodsDetail:e,getAllStoreAssert:a}}angular.module("app").factory("goodsDetailSvc",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,e,i){var o=this;o.model={},o.conMaxIndex=0,o.conditions=new Array,o.title="添加用户资产明细",o.isuserExist=!1,o.id=i.params.id,o.id&&(o.isUpdate=!0,o.title="更新用户资产明细"),o.create=function(){e.createUserAssertDetail(o)},o.update=function(){e.updateUserAssertDetail(o)},o.addCondition=function(){o.condition={},o.condition.sort=o.conMaxIndex+1,o.conditions.push(o.condition),o.conMaxIndex++},function(){o.isUpdate?e.getUserAssertDetailById(o):e.initFillData(function(t){o.goodsDetailDtoList=t.reObj.goodsDetailDtoList})}()}angular.module("app").controller("userAssertDetailAddCtrl",t),t.$inject=["$location","userAssertDetailSvc","$state"]}(),function(){"use strict";function t(t,e){var i=this;i.title="用户资产明细",i.del=function(t){common.confirm({vm:i,title:"",msg:"确认删除数据吗？",fn:function(){$(".confirmDialog").modal("hide"),e.deleteUserAssertDetail(i,t)}})},i.dels=function(){var t=common.getKendoCheckId(".grid");if(0==t.length)common.alert({vm:i,msg:"请选择数据"});else{for(var e=[],o=0;o<t.length;o++)e.push(t[o].value);var n=e.join(",");i.del(n)}},function(){e.grid(i)}()}angular.module("app").controller("userAssertDetailCtrl",t),t.$inject=["$location","userAssertDetailSvc"]}(),function(){"use strict";function t(t){function e(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0,e.model.id=e.id;var i={method:"put",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",fn:function(){e.isSubmit=!1,$(".alertDialog").modal("hide")}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function i(e,i){e.isSubmit=!0;var o={method:"delete",url:s,data:i},n=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,e.gridOptions.dataSource.read()}})}})};common.http({vm:e,$http:t,httpOptions:o,success:n})}function o(e){if(common.initJqValidation(),$("form").valid()){e.isSubmit=!0;var i={method:"post",url:s,data:e.model},o=function(t){common.requestSuccess({vm:e,response:t,fn:function(){common.alert({vm:e,msg:"操作成功",closeDialog:!0,fn:function(){e.isSubmit=!1,location.href=l}})}})};common.http({vm:e,$http:t,httpOptions:i,success:o})}}function n(e){var i={method:"get",url:rootPath+"/userAssertDetail/html/findById",params:{id:e.id}},o=function(t){e.model=t.data};common.http({vm:e,$http:t,httpOptions:i,success:o})}function a(e){var i={method:"post",url:rootPath+"/userAssertDetail/html/initFillPageData"},o=function(t){void 0!=e&&"function"==typeof e&&e(t.data)};common.http({$http:t,httpOptions:i,success:o})}function r(t){var e=new kendo.data.DataSource({type:"odata",transport:common.kendoGridConfig().transport(s),schema:common.kendoGridConfig().schema({id:"id",fields:{createdDate:{type:"date"}}}),serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sort:{field:"createdDate",dir:"desc"}}),i=[{template:function(t){return kendo.format("<input type='checkbox'  relId='{0}' name='checkbox' class='checkbox' />",t.id)},filterable:!1,width:40,title:"<input id='checkboxAll' type='checkbox'  class='checkbox'  />"},{field:"id",title:"id",width:100,filterable:!0},{field:"userId",title:"userId",width:100,filterable:!0},{field:"userName",title:"userName",width:100,filterable:!0},{field:"goodId",title:"goodId",width:100,filterable:!0},{field:"goodsName",title:"goodsName",width:100,filterable:!0},{field:"goodsNumber",title:"goodsNumber",width:100,filterable:!0},{field:"",title:"操作",width:140,template:function(t){return common.format($("#columnBtns").html(),"vm.del('"+t.id+"')",t.id)}}];t.gridOptions={dataSource:common.gridDataSource(e),filterable:common.kendoGridConfig().filterable,pageable:common.kendoGridConfig().pageable,noRecords:common.kendoGridConfig().noRecordMessage,columns:i,resizable:!0}}var s=rootPath+"/userAssertDetail",l="#/userAssertDetailList";return{grid:r,getUserAssertDetailById:n,createUserAssertDetail:o,deleteUserAssertDetail:i,updateUserAssertDetail:e,initFillData:a}}angular.module("app").factory("userAssertDetailSvc",t),t.$inject=["$http"]}();