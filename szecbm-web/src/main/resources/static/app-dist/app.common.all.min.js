!function(){"use strict";if("undefined"!=typeof angular){angular.module("sn.common",[]).filter("formatUrl",function(){return function(e){return util.formatUrl(e)}}).run(["$templateCache",function(e){e.put("template/sys/topMenu.html",'<span class="top-tab" ng-repeat="x in MAIN_MENU">                <a ng-click="!!x.children && csHide(x.resId)" id="menu_{{x.resId}}" ng-href="{{x.resUri||\'javascript:;\'}}" target="{{x.target}}">                    <i class="t-z-green-hover {{x.resIcon||\'fa fa-bars\'}}"></i>                    <span>{{x.resName}}</span>                </a>            </span>'),e.put("template/sys/leftMenu.html",'<ul class="sidebar-menu" ng-repeat="x in MAIN_MENU"  ng-if="menuBoxResId==x.resId">                <li class="active treeview">                    <a href="#/"><i class="fa fa-home"></i><span>主页</span></a>                </li>                <li class="treeview">                    <a class="t-z-blue-dep" href="javascript:;">                        <i class="{{x.resIcon||\'fa fa-bars\'}}"></i>                        <span> &nbsp; {{x.resName}}</span>                    </a>                </li>                <li class="treeview active" ng-repeat="y in x.children" ng-if="!!x.children">                    <a class="" ng-href="{{y.resUri||\'javascript:;\'}}" target="{{y.target}}">                        <i class="{{y.resIcon||\'fa fa-bars\'}}"></i>                        <span>{{y.resName}}</span>                        <span class="pull-right-container" ng-if="!!y.children">                            <i class="fa fa-angle-left pull-right"></i>                        </span>                    </a>                    <ul class="treeview-menu" ng-if="!!y.children">                        <li ng-repeat="z in y.children">                            <a ng-href="{{z.resUri||\'javascript:;\'}}" target="{{z.target}}">                                <i class="{{z.resIcon||\'fa fa-circle-o\'}}"></i> {{z.resName}}                            </a>                        </li>                    </ul>                </li>            </ul>')}]).factory("snBaseUtils",["$http","$templateCache",function(e,t){function a(e,t){if(!e)return{};for(var n,i={},r=[],o=0,l=e.length;o<l;o++)if(n=e[o],!t&&!n.parentId||t&&t==n.parentId){var s=a(e,n.dictId),c={dictKey:n.dictKey,dictName:n.dictName,remark:n.remark,dict:n,dicts:s.dicts,dictList:s.dictList};i[n.dictKey]=c,r.push(c)}return{dicts:i,dictList:r}}function n(e,t){e=e||[];for(var a,i,r=[],o=0,l=e.length;o<l;o++)a=e[o],(t||a.parentId)&&a.parentId!=t||(i=n(e,a.resId),i.length>0&&(a.children=i),a.resUri&&0!=a.resUri.indexOf("#")&&(a.resUri=util.formatUrl(a.resUri)),r.push(a));return r}return{initDicts:function(t){e.get(util.formatUrl("sys/dict/all")).success(function(e){var n=e||[];t.dictMetaData=n,t.DICT=a(n).dicts})},initMenus:function(a,i){e.get(util.formatUrl("sys/user/resources?status=1")).success(function(e){a.MAIN_MENU=n(e),i&&i(t.get("template/sys/topMenu.html"),t.get("template/sys/leftMenu.html"))})}}}])}}(),function(){"use strict";if("undefined"!=typeof angular){var e=angular.module("sn.common"),t=$("body"),a="template/dialog/alert.html";e.factory("bsWin",["$rootScope","$injector","$templateCache","bsWinConfig",function(e,n,i,r){function o(t){t.msg&&(t.message=t.msg);var a=angular.extend({},r,t),n={winId:d++,scope:e.$new()};return l(n,a),a.onOk&&(n.scope.ok=function(){if(a.onOk&&0==a.onOk.apply(n))return!1;n.el.modal("hide")}),n.el=s(n.scope,a.templateUrl).on("hidden.bs.modal",function(e){if(a.onClose&&0==a.onClose.apply(n,e))return!1;c(n)}).modal("show"),n}function l(e,t){var a=e.scope;a.title=t.title,a.message=t.message,a.winId=e.winId,a.type=t.type,a.extraData=t.extraData,a.onKeyEnter=function(t){13===t.which?a.ok?a.ok():e.el.modal("hide"):27==t.which&&e.el.modal("hide")},e.scope.options={onClose:t.onClose}}function s(e,t){var a=n.get("$compile"),r=a(i.get(t))(e);return $(r).appendTo("body")}function c(e){e.scope.$destroy(),e.el.unbind(),e.el.remove(),e.el=null,e=null,t.css("padding-right","")}var d=0,u=util.formatUrl("workflow/process/trace/");return e.reloginWin=!1,{success:function(e,t){return this.alert({message:e,type:"success",onClose:t})},warning:function(e,t){return this.alert({message:e,type:"warning",onClose:t})},error:function(e,t){return this.alert({message:e,type:"error",onClose:t})},alert:function(e,t,n){if(!angular.isObject(e)){var i;!t||angular.isFunction(t)?(n=t,t=e):i=e,e={message:t,onClose:n||function(){}},i&&(e.title=i)}return e.templateUrl=a,o(e)},confirm:function(e,t,a,n){if(!angular.isObject(e)){var i;!t||angular.isFunction(t)?(n=a||function(){},a=t||function(){},t=e):i=e,e={message:t,onOk:a,onClose:n},i&&(e.title=i)}return e.templateUrl="template/dialog/confirm.html",o(e)},relogin:function(t){if(e.reloginWin)return!1;var a=this,i={message:t,onOk:function(){var e=this,t=n.get("$http"),i=new JSEncrypt;return t.get(util.formatUrl("rsaKey")).success(function(n){e.scope.model.username=e.scope.model.username.replace(/\s+/g,""),i.setPublicKey(n),e.scope.model.password=i.encrypt(e.scope.model.password),t({method:"POST",url:util.loginUrl,data:$.param(e.scope.model),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){var n=t.data;"SUCCESS"==n.status?(e.el.modal("hide"),a.success("登陆成功！")):a.error(n.message)})}),!1},onClose:function(){e.reloginWin=!1}};i.templateUrl="template/dialog/relogin.html";var r=o(i);return r.scope.loginCaptcha=loginCaptcha||!1,r.scope.captchaImagePath=util.formatUrl("captchaImage"),r.scope.reloadVerify=function(){r.scope.captchaImagePath=util.formatUrl("captchaImage?"+Math.random())},e.reloginWin=!0,r},traceImg:function(e){var t={message:"",onClose:function(){}};t.templateUrl="template/dialog/traceImg.html";var a=o(t);return a.scope.imgUrl=e?u+e:"#",a}}}]),e.constant("bsWinConfig",{title:"提示窗口",message:"",type:"info",timeout:0,templateUrl:a,onOk:null,onClose:function(e){}}),e.run(["$templateCache",function(e){e.put(a,'<div class="alertDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title || \'消息提醒\'}}</h4>                        </div>                        <div class="modal-body text-{{type==\'error\'? \'danger\' : type}}">                            <p class="alertDialogMessage">                                <i class="fa fa-{{type == \'success\' ? \'check\' : (type == \'error\' ? \'ban\' : type)}}" aria-hidden="true"></i>                                 {{message}}                            </p>                        </div>                        <div class="modal-footer">                            <button type="button"  class="btn btn-default" data-dismiss="modal">关闭</button>                        </div>                    </div>                </div>            </div>'),e.put("template/dialog/confirm.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title||\'提示\'}}</h4>                        </div>                        <div class="modal-body text-primary"><p><i class="fa fa-question-circle" aria-hidden="true"></i> {{message}}</p></div>                        <div class="modal-footer">                            <button type="button" ng-click="ok()" class="btn btn-primary" >确认</button>                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>                        </div>                    </div>                </div>            </div>'),e.put("template/dialog/relogin.html",'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">登录窗口</h4>                        </div>                        <div class="modal-body text-primary">                            <p><i class="fa fa-warning" aria-hidden="true"></i> {{message}}</p>                            <div><span ng-show="vm.message" class="errors" ng-bind="vm.message"></span></div>                            <div><span data-valmsg-for="username" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="用户名" maxlength="100" name="username" id="username" ng-model="model.username" data-val="true" data-val-required="用户名必填">                                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>                            </div>                            <div><span data-valmsg-for="password" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="password" class="form-control" placeholder="密码" maxlength="100" name="password" id="password" ng-model="model.password" data-val="true" data-val-required="密码必填">                                <span class="glyphicon glyphicon-lock form-control-feedback"></span>                            </div>                            <div ng-if="loginCaptcha"><span data-valmsg-for="captcha" data-valmsg-replace="true" class="errors"></span></div>                            <div ng-if="loginCaptcha" class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="验证码" maxlength="10" name="captcha" id="captcha" ng-model="model.captcha" data-val="true" data-val-required="验证码必填"/>                                <span>                                    <label class="code_word" ng-click="reloadVerify()">看不清，换一张</label>                                    <img id="verify" width="100" height="50" ng-click="reloadVerify()" ng-src="{{captchaImagePath}}" />                                </span>                            </div>                        </div>                        <div class="modal-footer">                            <div class="pull-right col-sm-12">                                <button type="button" ng-click="ok()" class="btn btn-primary btn-block btn-flat l-icon">登 录</button>                            </div>                        </div>                    </div>                </div>            </div>'),e.put("template/dialog/traceImg.html",'<div class="traceImgDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog modal-lg" role="document">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">流程图</h4>                        </div>                        <div class="modal-body" style="overflow: auto;min-height: 500px;">                            <img id="traceImg" ng-src="{{imgUrl}}">                        </div>                    </div>                </div>            </div>')}])}}(),function(){"use strict";"undefined"!=typeof angular&&angular.module("sn.common").directive("snDatetimepicker",function(){var e={language:"zh-CN",autoclose:!0,minView:2,pickerPosition:"bottom-right",format:"yyyy-mm-dd",todayBtn:!0,todayHighlight:!0};return{restrict:"A",require:"?ngModel",scope:{ngModel:"="},link:function(t,a,n,i){a.datetimepicker($.extend(e,n))}}})}(),function(){"use strict";function e(e,a){return{request:function(e){return e.headers["X-Requested-With"]="XMLHttpRequest",e},responseError:function(n){return t(a,n.status,n.data),e.reject(n)}}}function t(e,t,a){switch(t){case 500:e.error(a.message||"系统内部错误");break;case 400:e.warning(a.message||"操作失败");break;case 401:e.warning("缺少操作权限");break;case 403:e.warning("无权限执行此操作");break;case 404:e.error("未找到相应的操作");break;case 408:e.relogin("登录超时，请重新登录系统");break;case 412:case 415:e.warning(a.message||"操作失败");break;default:e.error("操作失败")}}if("undefined"!=typeof angular){var a=angular.module("sn.common");a.factory("commonHttpInterceptor",["$injector","bsWin",e]),a.config(["$httpProvider",function(t){t.defaults.headers.get||(t.defaults.headers.get={}),t.defaults.headers.get["Cache-Control"]="no-cache",t.defaults.headers.get.Pragma="no-cache",t.interceptors.push(e)}]),"undefined"!=typeof jQuery&&jQuery(document).ajaxSend(function(e,t,a){}).ajaxError(function(e,a,n,i){var r=angular.element("body"),o=r.scope(),l=r.injector().get("bsWin"),s=angular.isString(a.responseText)?JSON.parse(a.responseText||"{}"):a.responseText;o.$apply(function(){t(l,a.status,s||{})})})}}(),function(){"use strict";if("undefined"!=typeof angular){var e={placeholder:"请选择单位",filter:!0,noMatchesFound:"未查询到单位",single:!0};angular.module("sn.common").directive("snMultipleSelect",function(t){return{restrict:"EA",require:"?ngModel",scope:{snMultipleSelect:"=",ngModel:"="},link:function(a,n,i,r){function o(){s&&(n.multipleSelect("setSelects",[r.$modelValue]),s=!1)}n.multipleSelect($.extend({},e,i));var l=!1,s=!1;a.$watch("snMultipleSelect",function(e){if(e){var a=[];$.each(e,function(e,t){a.push(util.format('<option value="{0}">{1}</option>',t.organId,t.organName))}),n.html(a.join("")),t(function(){n.multipleSelect("refresh",!0),o(),l=!0},100)}}),a.$watch(function(){return r.$modelValue},function(e){s=!0,l&&t(o)})}}})}}(),function(e,t){function a(i,r){var o,l,s,c,d,u,p,f,m,g=[],h=i.logic||"and";for(m=i.field?[i]:i.filters||[],o=0,l=m.length;o<l;o++)i=m[o],s=i.field,p=i.value,u=i.operator,i.filters?i=a(i,r):(f=i.ignoreCase,s=s.replace(/\./g,"/"),i=n[u],r&&(i=n[u]),"isnull"===u||"isnotnull"===u?i=util.format("{0} {1} null",s,i):"isempty"===u||"isnotempty"===u?i=util.format("{0} {1} ''",s,i):i&&p!==t&&(c=e.type(p),"string"===c?(d="'{1}'",p=p.replace(/'/g,"''"),!0===f&&(s="tolower("+s+")"),p=encodeURIComponent(p)):d="date"===c?"datetime'{1:yyyy-MM-dd HH:mm:ss}'":"{1}",i.length>3?"substringof"!==i?d="{0}({2},"+d+")":(d="{0}("+d+",{2})","doesnotcontain"===u&&(r?(d="{0}({2},'{1}') eq -1",i="indexof"):d+=" eq false")):d="{2} {0} "+d,i=util.format(d,i,p,s))),i&&g.push(i);return i=g.join(" "+h+" "),g.length>1&&(i="("+i+")"),i}if("undefined"!=typeof jQuery){var n={eq:"eq",neq:"ne",gt:"gt",gte:"ge",lt:"lt",lte:"le",ni:"ni",in:"in",like:"substringof",nolike:"substringof",contains:"substringof",doesnotcontain:"substringof",endswith:"endswith",startswith:"startswith",isnull:"eq",isnotnull:"ne",isempty:"eq",isnotempty:"ne"},i={pageSize:e.noop,page:e.noop,filter:function(e,t,n){t&&(t=a(t,n))&&(e.$filter=t)},sort:function(t,a){e.isArray(a)||(a=[a]);var n=e.map(a,function(e){var t=e.field.replace(/\./g,"/");return"desc"===e.dir&&(t+=" desc"),t}).join(",");n&&(t.$orderby=n)},skip:function(e,t){t&&(e.$skip=t)},take:function(e,t){t&&(e.$top=t)}};e.extend({toOdata:function(e){e=e||{};var t={$inlinecount:"allpages"};for(var a in e)i[a]?i[a](t,e[a],!0):t[a]=e[a];return t},toOdataFilter:function(e){return a(e,!0)}})}}(jQuery),function(e){"use strict";function t(e){e=e||"form",$(e).removeData("validator").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(e)}function a(e){return e=e||"",0==e.indexOf("http://")||0==e.indexOf("https://")||"undefined"==typeof contextPath||e.indexOf("javascript:;")>-1?e:(0!=e.indexOf("/")&&(e="/"+e),contextPath+n(e,Array.prototype.slice.call(arguments,1)))}function n(){var e,t=arguments[0]||"";if(!t)return!1;var a=Array.prototype.slice.call(arguments,1);return(1==a.length&&"[object Object]"==Object.prototype.toString.call(a[0])||"[object Array]"==Object.prototype.toString.call(a[0]))&&(a=a[0]),t.replace(d,function(t,n,i){return e=a[n],void 0===e||null==e?"":"[object Date]"==Object.prototype.toString.call(e)?e.format(i.substr(1)):"object"==typeof e?JSON.stringify(e):(i&&i.length>1&&(e=new Date(e).format(i.substr(1))),e)})}function i(e,t,a){if(!a)return!1;var n=0;if(t=t||0,e){var i=e.length;n=i<=t?t-i:0}else n=t;$("#"+a).html("<font size='5'>"+n+"</font>")}function r(e,t){return t=t||[],angular.isArray(t)||(t=[t]),$(e).find("input,select,textarea").each(function(e,a){var n,i=$(this),r=a.value,o=a.name;if(o&&r){if(0==o.indexOf("filter_")){var l=o.split("_");if(3==l.length)n=l[1],o=l[2]||"";else{if(2!=l.length)return;n="like",o=l[1]||""}}else r&&(n=i.attr("operator")||"eq");var s=o.split("|");if(s.length>1){var c=[];for(var d in s)c.push({field:s[d],operator:n,value:r});t.push({logic:"or",filters:c})}else t.push({field:o,operator:n,value:r})}}),0==t.length?"":$.toOdataFilter({logic:"and",filters:t})}function o(e){return e=e||{},$.extend({},u,{queryParams:function(e){var t=this,a={$skip:e.offset,$top:e.limit,$orderby:e.sort?e.sort+" "+e.order:t.defaultSort,$filter:r(t.toolbar||"#toolbar",t.defaultFilters)};return t.pagination&&(a.$inlinecount="allpages"),a}},e)}function l(e){return e=e||{},$.extend({},u,{filterControl:!0,filterShowClear:!0},e)}function s(e,t,n){if(!e)return!1;if(!n)return alert("缺少参数，上传控件无法初始化"),!1;var i=angular.element("body").scope();t=$.extend({},{uploader:a("sys/attachment/upload"),swf:a("libs/uploadify/uploadify.swf"),cancelImage:a("libs/uploadify/uploadify-cancel.png"),multi:!1,fileObjName:"files",fileSizeLimit:"40MB",buttonText:'<span style="font-size: 12px">选择文件</span>',fileExt:"*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps",fileTypeExts:"*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps",fileTypeDesc:"请选择*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps文件",removeCompleted:!0,onUploadError:function(e,t,a,o){i.$apply(function(){switch(t){case-100:n.error("上传的文件数量已经超出系统限制的"+r.uploadify("settings","queueSizeLimit")+"个文件！");break;case-110:n.error("文件 ["+e.name+"] 大小超出系统限制的"+r.uploadify("settings","fileSizeLimit")+"大小！");break;case-120:n.error("文件 ["+e.name+"] 大小异常！");break;case-130:n.error("文件 ["+e.name+"] 类型不正确！");break;default:n.error("上传失败")}})},onCancel:function(e){i.$apply(function(){n.confirm("询问提示","确认删除该文件吗！")})},onFallback:function(){setTimeout(function(){i.$apply(function(){n.warning("您未安装FLASH控件，无法上传图片！请安装FLASH控件后再试。")})},100)},onQueueComplete:function(){$(".upload_load").remove()}},t||{});var r=$(e).uploadify(t);return r}var c={loginUrl:a("login"),initJqValidation:t,formatUrl:a,checkLength:i,format:n,buildOdataFilter:r,getTableOption:o,getTableFilterOption:l,initUpload:s,debounce:function(e,t,a){var n,i,r=function(){var r=this,o=Array.prototype.slice.call(arguments);if(n&&clearTimeout(n),a){var l=!n;n=setTimeout(function(){n=null},t),l&&(i=e.apply(r,o))}else n=setTimeout(function(){i=e.apply(r,o)},t);return i};return r.cancel=function(){clearTimeout(n),n=null},r},UUID:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:7&a|8).toString(16)})}};e.util=c;var d=/\{(\w+)(:[^\}]+)?(\.[^\}]+)?\}/g,u={sidePagination:"server",cache:!1,striped:!0,pagination:!0,pageSize:10,pageList:[10,25,50,100],showColumns:!0,showRefresh:!0,minimumCountColumns:2,clickToSelect:!0,maintainSelected:!0,totalField:"count",dataField:"value",defaultSort:"createdDate desc",defaultFilters:null};if(Date.prototype.format||(Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}),$.fn.bootstrapTable&&$.fn.bootstrapTable.defaults.filterTemplate){var p=$.fn.bootstrapTable.Constructor,f=p.prototype.initColumn;p.prototype.initColumn=function(e){var t=e.filterControl;if("string"==typeof t&&"dict"==t.toLowerCase()){var a=e.filterData;if("string"==typeof a){var n=e.filterDataName||"dictName";e.formatter||(e.formatter=c.format("{{{0}.dicts[row.{1}].{2}}}",a,e.field,n))}}return $.extend({},f.apply(this,Array.prototype.slice.apply(arguments)),e)},$.extend($.fn.bootstrapTable.defaults.filterTemplate,{dict:function(e,t,a,n,i,r){var o=r.filterData||"DICT",l=r.filterDataKey||"key",s=r.filterDataName||"value";if("string"==typeof o){"key"==l&&(l="dictKey"),s&&"value"!=s||(s="dictName");return c.format('<select class="form-control odata-filter select-filter-control bootstrap-table-filter-control-{0}" name="{0}" style="width: 100%; visibility: {1}"><option value="">请选择……</option><option ng-repeat="x in {2}.dictList" value="{{{3}}}">{{{4}}}</option></select>',t,a,o,"x."+l,"x."+s)}if($.isArray(o)){var d=[c.format('<select class="form-control odata-filter select-filter-control bootstrap-table-filter-control-{0}" name="{0}" style="width: 100%; visibility: {1}">',t,a)];return d.push('<option value="">请选择……</option>'),$.each(o,function(e,t){var a=t[l],n=t[s];a&&n&&d.push(c.format('<option value="{0}">{1}</option>',a,n))}),d.push("</select>"),d.join("")}return""}})}}(window);