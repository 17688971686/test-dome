!function(){"use strict";if("undefined"!=typeof angular){var i="template/sys/leftMenu.html";angular.module("sn.common",[]).filter("formatUrl",function(){return function(e){return util.formatUrl(e)}}).run(["$templateCache",function(e){e.put(i,'<ul class="sidebar-menu">                <li class="active treeview">                    <a href="#/"><i class="fa fa-home"></i><span>主页</span></a>                </li>                <li class="treeview active" ng-repeat="y in MAIN_MENU" >                    <a class="" ng-href="{{y.resUri||\'javascript:;\'}}" target="{{y.target}}">                        <i class="{{y.resIcon||\'fa fa-bars\'}}"></i>                        <span>{{y.resName}}</span>                        <span class="pull-right-container" ng-if="!!y.children">                            <i class="fa fa-angle-left pull-right"></i>                        </span>                    </a>                    <ul class="treeview-menu" ng-if="!!y.children">                        <li ng-repeat="z in y.children">                            <a ng-href="{{z.resUri||\'javascript:;\'}}" target="{{z.target}}">                                <i class="{{z.resIcon||\'fa fa-circle-o\'}}"></i> {{z.resName}}                            </a>                        </li>                    </ul>                </li>            </ul>')}]).factory("snBaseUtils",["$http","$templateCache",function(e,n){return{initDicts:function(a){e.get(util.formatUrl("sys/dict/all")).success(function(e){var t=e||[];a.dictMetaData=t,a.DICT=function e(t,a){if(!t)return{};var n,i={},r=[];for(var o=0,l=t.length;o<l;o++)if(n=t[o],!a&&!n.parentId||a&&a==n.parentId){var s=e(t,n.dictId),c={dictKey:n.dictKey,dictName:n.dictName,remark:n.remark,dict:n,dicts:s.dicts,dictList:s.dictList};i[n.dictKey]=c,r.push(c)}return{dicts:i,dictList:r}}(t).dicts})},initMenus:function(t,a){e.get(util.formatUrl("sys/user/resources?status=1")).success(function(e){t.MAIN_MENU=function e(t,a){t=t||[];var n,i,r=[];for(var o=0,l=t.length;o<l;o++)n=t[o],(a||n.parentId)&&n.parentId!=a||(0<(i=e(t,n.resId)).length&&(n.children=i),n.resUri&&0!=n.resUri.indexOf("#")&&(n.resUri=util.formatUrl(n.resUri)),r.push(n));return r}(e),a&&a(n.get(i))})}}}])}}(),function(){"use strict";if("undefined"!=typeof angular){var e=angular.module("sn.common"),m=$("body"),i="template/dialog/alert.html",o="template/dialog/confirm.html",l="template/dialog/relogin.html",s="template/dialog/traceImg.html";e.factory("bsWin",["$rootScope","$injector","$templateCache","bsWinConfig",function(c,d,u,p){var f=0,n=util.formatUrl("workflow/process/trace/");return c.reloginWin=!1,{success:function(e,t){return this.alert({message:e,type:"success",onClose:t})},warning:function(e,t){return this.alert({message:e,type:"warning",onClose:t})},error:function(e,t){return this.alert({message:e,type:"error",onClose:t})},alert:function(e,t,a){var n;angular.isObject(e)||(!t||angular.isFunction(t)?(a=t,t=e):n=e,e={message:t,onClose:a||function(){}},n&&(e.title=n));return e.templateUrl=i,r(e)},confirm:function(e,t,a,n){var i;angular.isObject(e)||(!t||angular.isFunction(t)?(n=a||function(){},a=t||function(){},t=e):i=e,e={message:t,onOk:a,onClose:n},i&&(e.title=i));return e.templateUrl=o,r(e)},relogin:function(e){if(c.reloginWin)return!1;var i=this,t={message:e,onOk:function(){var a=this,t=d.get("$http"),n=new JSEncrypt;return t.get(util.formatUrl("rsaKey")).success(function(e){a.scope.model.username=a.scope.model.username.replace(/\s+/g,""),n.setPublicKey(e),a.scope.model.password=n.encrypt(a.scope.model.password),t({method:"POST",url:util.loginUrl,data:$.param(a.scope.model),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){var t=e.data;"SUCCESS"==t.status?(a.el.modal("hide"),i.success("登陆成功！")):i.error(t.message)})}),!1},onClose:function(){c.reloginWin=!1}};t.templateUrl=l;var a=r(t);return a.scope.loginCaptcha=loginCaptcha||!1,a.scope.captchaImagePath=util.formatUrl("captchaImage"),a.scope.reloadVerify=function(){a.scope.captchaImagePath=util.formatUrl("captchaImage?"+Math.random())},c.reloginWin=!0,a},traceImg:function(e){var t={message:"",onClose:function(){}};t.templateUrl=s;var a=r(t);return a.scope.imgUrl=e?n+e:"#",a}};function r(e){e.msg&&(e.message=e.msg);var t,a,n,i,r,o,l=angular.extend({},p,e),s={winId:f++,scope:c.$new()};return a=l,(n=(t=s).scope).title=a.title,n.message=a.message,n.winId=t.winId,n.type=a.type,n.extraData=a.extraData,n.onKeyEnter=function(e){13===e.which?n.ok?n.ok():t.el.modal("hide"):27==e.which&&t.el.modal("hide")},t.scope.options={onClose:a.onClose},l.onOk&&(s.scope.ok=function(){if(l.onOk&&0==l.onOk.apply(s))return!1;s.el.modal("hide")}),s.el=(i=s.scope,r=l.templateUrl,o=d.get("$compile")(u.get(r))(i),$(o).appendTo("body")).on("hidden.bs.modal",function(e){if(l.onClose&&0==l.onClose.apply(s,e))return!1;var t;(t=s).scope.$destroy(),t.el.unbind(),t.el.remove(),t.el=null,t=null,m.css("padding-right","")}).modal("show"),s}}]),e.constant("bsWinConfig",{title:"提示窗口",message:"",type:"info",timeout:0,templateUrl:i,onOk:null,onClose:function(e){}}),e.run(["$templateCache",function(e){e.put(i,'<div class="alertDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{10000000000000000009 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title || \'消息提醒\'}}</h4>                        </div>                        <div class="modal-body text-{{type==\'error\'? \'danger\' : type}}">                            <p class="alertDialogMessage">                                <i class="fa fa-{{type == \'success\' ? \'check\' : (type == \'error\' ? \'ban\' : type)}}" aria-hidden="true"></i>                                 {{message}}                            </p>                        </div>                        <div class="modal-footer">                            <button type="button"  class="btn btn-default" data-dismiss="modal">关闭</button>                        </div>                    </div>                </div>            </div>'),e.put(o,'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{100000000000000000009 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">{{title||\'提示\'}}</h4>                        </div>                        <div class="modal-body text-primary"><p><i class="fa fa-question-circle" aria-hidden="true"></i> {{message}}</p></div>                        <div class="modal-footer">                            <button type="button" ng-click="ok()" class="btn btn-primary" >确认</button>                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>                        </div>                    </div>                </div>            </div>'),e.put(l,'<div class="confirmDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{1000000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog" role="document" style="margin:80px auto;width:80%;max-width:400px;">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">登录窗口</h4>                        </div>                        <div class="modal-body text-primary">                            <p><i class="fa fa-warning" aria-hidden="true"></i> {{message}}</p>                            <div><span ng-show="vm.message" class="errors" ng-bind="vm.message"></span></div>                            <div><span data-valmsg-for="username" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="用户名" maxlength="100" name="username" id="username" ng-model="model.username" data-val="true" data-val-required="用户名必填">                                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>                            </div>                            <div><span data-valmsg-for="password" data-valmsg-replace="true" class="errors"></span></div>                            <div class="form-group has-feedback">                                <input type="password" class="form-control" placeholder="密码" maxlength="100" name="password" id="password" ng-model="model.password" data-val="true" data-val-required="密码必填">                                <span class="glyphicon glyphicon-lock form-control-feedback"></span>                            </div>                            <div ng-if="loginCaptcha"><span data-valmsg-for="captcha" data-valmsg-replace="true" class="errors"></span></div>                            <div ng-if="loginCaptcha" class="form-group has-feedback">                                <input type="text" class="form-control" placeholder="验证码" maxlength="10" name="captcha" id="captcha" ng-model="model.captcha" data-val="true" data-val-required="验证码必填"/>                                <span>                                    <label class="code_word" ng-click="reloadVerify()">看不清，换一张</label>                                    <img id="verify" width="100" height="50" ng-click="reloadVerify()" ng-src="{{captchaImagePath}}" />                                </span>                            </div>                        </div>                        <div class="modal-footer">                            <div class="pull-right col-sm-12">                                <button type="button" ng-click="ok()" class="btn btn-primary btn-block btn-flat l-icon">登 录</button>                            </div>                        </div>                    </div>                </div>            </div>'),e.put(s,'<div class="traceImgDialog modal fade" tabindex="-1" role="dialog" style="z-index: {{1000000 + winId}};" ng-keypress="onKeyEnter($event)">                <div class="modal-dialog modal-lg" role="document">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                            <h4 class="modal-title text-info">流程图</h4>                        </div>                        <div class="modal-body" style="overflow: auto;min-height: 500px;">                            <img id="traceImg" ng-src="{{imgUrl}}">                        </div>                    </div>                </div>            </div>')}])}}(),function(){"use strict";"undefined"!=typeof angular&&angular.module("sn.common").directive("snDatetimepicker",function(){var i={language:"zh-CN",autoclose:!0,minView:2,pickerPosition:"bottom-right",format:"yyyy-mm-dd",todayBtn:!0,todayHighlight:!0};return{restrict:"A",require:"?ngModel",scope:{ngModel:"="},link:function(e,t,a,n){t.datetimepicker($.extend(i,a))}}})}(),function(){"use strict";if("undefined"!=typeof angular){var e=angular.module("sn.common");e.factory("commonHttpInterceptor",["$injector","bsWin",t]),e.config(["$httpProvider",function(e){e.defaults.headers.get||(e.defaults.headers.get={}),e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",e.interceptors.push(t)}]),"undefined"!=typeof jQuery&&jQuery(document).ajaxSend(function(e,t,a){}).ajaxError(function(e,t,a,n){var i=angular.element("body"),r=i.scope(),o=i.injector().get("bsWin"),l=angular.isString(t.responseText)?JSON.parse(t.responseText||"{}"):t.responseText;r.$apply(function(){s(o,t.status,l||{})})})}function t(t,a){return{request:function(e){return e.headers["X-Requested-With"]="XMLHttpRequest",e},responseError:function(e){return s(a,e.status,e.data),t.reject(e)}}}function s(e,t,a){switch(t){case 500:e.error(a.message||"系统内部错误");break;case 400:e.warning(a.message||"操作失败");break;case 401:e.warning("缺少操作权限");break;case 403:e.warning("无权限执行此操作");break;case 404:e.error("未找到相应的操作");break;case 408:e.relogin("登录超时，请重新登录系统");break;case 412:case 415:e.warning(a.message||"操作失败");break;default:e.error("操作失败")}}}(),function(){"use strict";if("undefined"!=typeof angular){var s={placeholder:"请选择单位",filter:!0,noMatchesFound:"未查询到单位",single:!0};angular.module("sn.common").directive("snMultipleSelect",function(l){return{restrict:"EA",require:"?ngModel",scope:{snMultipleSelect:"=",ngModel:"="},link:function(e,t,a,n){t.multipleSelect($.extend({},s,a));var i=!1,r=!1;function o(){r&&(t.multipleSelect("setSelects",[n.$modelValue]),r=!1)}e.$watch("snMultipleSelect",function(e){if(e){var a=[];$.each(e,function(e,t){a.push(util.format('<option value="{0}">{1}</option>',t.organId,t.organName))}),t.html(a.join("")),l(function(){t.multipleSelect("refresh",!0),o(),i=!0},100)}}),e.$watch(function(){return n.$modelValue},function(e){r=!0,i&&l(o)})}}})}}(),function(f,m){if("undefined"!=typeof jQuery){var g={eq:"eq",neq:"ne",gt:"gt",gte:"ge",lt:"lt",lte:"le",ni:"ni",in:"in",like:"substringof",nolike:"substringof",contains:"substringof",doesnotcontain:"substringof",endswith:"endswith",startswith:"startswith",isnull:"eq",isnotnull:"ne",isempty:"eq",isnotempty:"ne"},n={pageSize:f.noop,page:f.noop,filter:function(e,t,a){t&&(t=h(t,a))&&(e.$filter=t)},sort:function(e,t){f.isArray(t)||(t=[t]);var a=f.map(t,function(e){var t=e.field.replace(/\./g,"/");return"desc"===e.dir&&(t+=" desc"),t}).join(",");a&&(e.$orderby=a)},skip:function(e,t){t&&(e.$skip=t)},take:function(e,t){t&&(e.$top=t)}};f.extend({toOdata:function(e){e=e||{};var t={$inlinecount:"allpages"};for(var a in e)n[a]?n[a](t,e[a],!0):t[a]=e[a];return t},toOdataFilter:function(e){return h(e,!0)}})}function h(e,t){var a,n,i,r,o,l,s,c,d,u=[],p=e.logic||"and";for(a=0,n=(d=e.field?[e]:e.filters||[]).length;a<n;a++)i=(e=d[a]).field,s=e.value,l=e.operator,e.filters?e=h(e,t):(c=e.ignoreCase,i=i.replace(/\./g,"/"),e=g[l],t&&(e=g[l]),"isnull"===l||"isnotnull"===l?e=util.format("{0} {1} null",i,e):"isempty"===l||"isnotempty"===l?e=util.format("{0} {1} ''",i,e):e&&s!==m&&("string"===(r=f.type(s))?(o="'{1}'",s=s.replace(/'/g,"''"),!0===c&&(i="tolower("+i+")"),s=encodeURIComponent(s)):o="date"===r?"datetime'{1:yyyy-MM-dd HH:mm:ss}'":"{1}",3<e.length?"substringof"!==e?o="{0}({2},"+o+")":(o="{0}("+o+",{2})","doesnotcontain"===l&&(t?(o="{0}({2},'{1}') eq -1",e="indexof"):o+=" eq false")):o="{2} {0} "+o,e=util.format(o,e,s,i))),e&&u.push(e);return e=u.join(" "+p+" "),1<u.length&&(e="("+e+")"),e}}(jQuery),function(e){"use strict";var d={loginUrl:a("login"),initJqValidation:function(e){e=e||"form",$(e).removeData("validator").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(e)},formatUrl:a,checkLength:function(e,t,a){if(!a)return!1;var n=0;if(t=t||0,e){var i=e.length;n=i<=t?t-i:0}else n=t;$("#"+a).html("<font size='5'>"+n+"</font>")},format:n,buildOdataFilter:r,getTableOption:function(e){return e=e||{},$.extend({},i,{queryParams:function(e){var t=this,a={$skip:e.offset,$top:e.limit,$orderby:e.sort?e.sort+" "+e.order:t.defaultSort,$filter:r(t.filterForm||t.toolbar||"#toolbar",t.defaultFilters)};return t.pagination&&(a.$inlinecount="allpages"),a}},e)},getTableFilterOption:function(e){return e=e||{},$.extend({},i,{filterControl:!0,filterShowClear:!0},e)},initUpload:function(e,t,i){if(!e)return!1;if(!i)return alert("缺少参数，上传控件无法初始化"),!1;var r=angular.element("body").scope();t=$.extend({},{uploader:a("sys/attachment/upload"),swf:a("libs/uploadify/uploadify.swf"),cancelImage:a("libs/uploadify/uploadify-cancel.png"),multi:!1,fileObjName:"files",fileSizeLimit:"40MB",buttonText:'<span style="font-size: 12px">选择文件</span>',fileExt:"*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps",fileTypeExts:"*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps",fileTypeDesc:"请选择*.pdf;*.txt;*.png;*.jpg;*.doc;*.docx;*.wps文件",removeCompleted:!0,onUploadError:function(e,t,a,n){r.$apply(function(){switch(t){case-100:i.error("上传的文件数量已经超出系统限制的"+o.uploadify("settings","queueSizeLimit")+"个文件！");break;case-110:i.error("文件 ["+e.name+"] 大小超出系统限制的"+o.uploadify("settings","fileSizeLimit")+"大小！");break;case-120:i.error("文件 ["+e.name+"] 大小异常！");break;case-130:i.error("文件 ["+e.name+"] 类型不正确！");break;default:i.error("上传失败")}})},onCancel:function(e){r.$apply(function(){i.confirm("询问提示","确认删除该文件吗！")})},onFallback:function(){setTimeout(function(){r.$apply(function(){i.warning("您未安装FLASH控件，无法上传图片！请安装FLASH控件后再试。")})},100)},onQueueComplete:function(){$(".upload_load").remove()}},t||{});var o=$(e).uploadify(t);return o},debounce:function(n,i,r){var o,l,e=function(){var e=this,t=Array.prototype.slice.call(arguments);if(o&&clearTimeout(o),r){var a=!o;o=setTimeout(function(){o=null},i),a&&(l=n.apply(e,t))}else o=setTimeout(function(){l=n.apply(e,t)},i);return l};return e.cancel=function(){clearTimeout(o),o=null},e},UUID:function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==e?t:7&t|8).toString(16)})}};function a(e){return 0==(e=e||"").indexOf("http://")||0==e.indexOf("https://")||"undefined"==typeof contextPath||-1<e.indexOf("javascript:;")?e:(0!=e.indexOf("/")&&(e="/"+e),contextPath+n(e,Array.prototype.slice.call(arguments,1)))}e.util=d;var t=/\{(\w+)(:[^\}]+)?(\.[^\}]+)?\}/g;function n(){var n,e=arguments[0]||"";if(!e)return!1;var i=Array.prototype.slice.call(arguments,1);return(1==i.length&&"[object Object]"==Object.prototype.toString.call(i[0])||"[object Array]"==Object.prototype.toString.call(i[0]))&&(i=i[0]),e.replace(t,function(e,t,a){return void 0===(n=i[t])||null==n?"":"[object Date]"==Object.prototype.toString.call(n)?n.format(a.substr(1)):"object"==typeof n?JSON.stringify(n):(a&&1<a.length&&(n=new Date(n).format(a.substr(1))),n)})}var i={sidePagination:"server",cache:!1,striped:!0,pagination:!0,pageSize:10,pageList:[10,25,50,100],showColumns:!0,showRefresh:!0,minimumCountColumns:2,clickToSelect:!0,maintainSelected:!0,filterForm:null,totalField:"count",dataField:"value",defaultSort:"createdDate desc",defaultFilters:null};function r(e,d){return d=d||[],angular.isArray(d)||(d=[d]),$(e).find("input,select,textarea").each(function(e,t){var a,n=$(this),i=t.value,r=t.name;if(r&&i){if(n.hasClass("date-input")&&(-1==i.indexOf(" ")&&(i+=" 00:00:00"),i=new Date(i)),0==r.indexOf("filter_")){var o=r.split("_");if(3==o.length)a=o[1],r=o[2]||"";else{if(2!=o.length)return;a="like",r=o[1]||""}}else i&&(a=n.attr("operator")||"eq");var l=r.split("|");if(1<l.length){var s=[];for(var c in l)s.push({field:l[c],operator:a,value:i});d.push({logic:"or",filters:s})}else d.push({field:r,operator:a,value:i})}}),0==d.length?"":$.toOdataFilter({logic:"and",filters:d})}if(Date.prototype.format||(Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}),$.fn.bootstrapTable&&$.fn.bootstrapTable.defaults.filterTemplate){var o=$.fn.bootstrapTable.Constructor,l=o.prototype.initColumn;o.prototype.initColumn=function(e){var t=e.filterControl;if("string"==typeof t&&"dict"==t.toLowerCase()){var a=e.filterData;if("string"==typeof a){var n=e.filterDataName||"dictName";e.formatter||(e.formatter=d.format("{{{0}.dicts[row.{1}].{2}}}",a,e.field,n))}}return $.extend({},l.apply(this,Array.prototype.slice.apply(arguments)),e)},$.extend($.fn.bootstrapTable.defaults.filterTemplate,{dict:function(e,t,a,n,i,r){var o=r.filterData||"DICT",l=r.filterDataKey||"key",s=r.filterDataName||"value";if("string"==typeof o)return"key"==l&&(l="dictKey"),s&&"value"!=s||(s="dictName"),d.format('<select class="form-control odata-filter select-filter-control bootstrap-table-filter-control-{0}" name="{0}" style="width: 100%; visibility: {1}"><option value="">请选择……</option><option ng-repeat="x in {2}.dictList" value="{{{3}}}">{{{4}}}</option></select>',t,a,o,"x."+l,"x."+s);if($.isArray(o)){var c=[d.format('<select class="form-control odata-filter select-filter-control bootstrap-table-filter-control-{0}" name="{0}" style="width: 100%; visibility: {1}">',t,a)];return c.push('<option value="">请选择……</option>'),$.each(o,function(e,t){var a=t[l],n=t[s];a&&n&&c.push(d.format('<option value="{0}">{1}</option>',a,n))}),c.push("</select>"),c.join("")}return""}})}}(window);